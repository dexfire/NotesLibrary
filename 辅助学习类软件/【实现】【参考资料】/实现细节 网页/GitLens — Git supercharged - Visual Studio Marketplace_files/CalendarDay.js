//dependencies=tslib#?,react#?,@uifabric/utilities/Async#0,@uifabric/utilities/object#0,@uifabric/utilities/EventGroup,@uifabric/utilities/dom#0,@uifabric/merge-styles/Stylesheet,@uifabric/merge-styles/transforms/kebabRules#0,@uifabric/merge-styles/getVendorSettings#0,@uifabric/merge-styles/transforms/prefixRules,@uifabric/merge-styles/transforms/provideUnits#0,@uifabric/merge-styles/transforms/rtlifyRules,@uifabric/merge-styles/styleToClassName,@uifabric/merge-styles/extractStyleParts,@uifabric/merge-styles/mergeStyles,@uifabric/merge-styles/concatStyleSets#0,@uifabric/merge-styles/mergeStyleSets,@uifabric/merge-styles/fontFace,@uifabric/merge-styles/keyframes,@uifabric/merge-styles/index,@uifabric/merge-styles/lib/index,@uifabric/utilities/scroll,@uifabric/utilities/AutoScroll,@uifabric/utilities/warn#0,@uifabric/utilities/keyboard#0,@uifabric/utilities/initializeFocusRects,@uifabric/utilities/initializeDir,@uifabric/utilities/BaseComponent,@uifabric/utilities/Context,@uifabric/utilities/GlobalSettings#0,@uifabric/utilities/Customizations,prop-types#?,@uifabric/utilities/Customizer,@uifabric/utilities/DelayedRender,@uifabric/utilities/FabricPerformance#0,@uifabric/utilities/KeyCodes#0,@uifabric/utilities/Rectangle#0,@uifabric/utilities/array#0,@uifabric/utilities/assertNever#0,@uifabric/utilities/autobind#0,@uifabric/utilities/classNamesFunction,@uifabric/utilities/createRef#0,@uifabric/utilities/css#0,@uifabric/utilities/hoistStatics#0,@uifabric/utilities/customizable,@uifabric/utilities/focus,@uifabric/utilities/hoist#0,@uifabric/utilities/initials#0,@uifabric/utilities/localStorage#0,@uifabric/utilities/language,@uifabric/utilities/math#0,@uifabric/utilities/memoize#0,@uifabric/utilities/overflow#0,@uifabric/utilities/properties,@uifabric/utilities/resources#0,@uifabric/utilities/sessionStorage#0,@uifabric/merge-styles/lib/transforms/rtlifyRules,@uifabric/utilities/rtl,@uifabric/utilities/string#0,@uifabric/utilities/styled,@uifabric/utilities/index,@uifabric/utilities/lib/index,OfficeFabric/Utilities,OfficeFabric/utilities/dateValues/DateValues#0,OfficeFabric/components/FocusZone/FocusZone.types#0,OfficeFabric/components/FocusZone/FocusZone,OfficeFabric/components/FocusZone/index,OfficeFabric/FocusZone,OfficeFabric/components/Icon/Icon.types#0,OfficeFabric/components/Image/Image.types#0,OfficeFabric/components/Image/Image.base,@uifabric/styling/MergeStyles,@uifabric/styling/utilities/buildClassMap,@uifabric/utilities/lib/warn,@uifabric/utilities/lib/GlobalSettings,@uifabric/styling/utilities/icons,@uifabric/styling/utilities/getIconClassName,@uifabric/styling/utilities/index,@uifabric/styling/styles/AnimationStyles,@uifabric/styling/styles/DefaultPalette#0,@uifabric/styling/styles/fonts#0,@uifabric/utilities/lib/language,@uifabric/styling/styles/DefaultFontStyles,@uifabric/styling/styles/CommonStyles#0,@uifabric/utilities/lib/initializeFocusRects,@uifabric/styling/styles/zIndexes#0,@uifabric/styling/styles/getFocusStyle,@uifabric/styling/styles/hiddenContentStyle#0,@uifabric/styling/styles/PulsingBeaconAnimationStyles,@uifabric/styling/styles/getGlobalClassNames#0,@uifabric/utilities/lib/Customizations,@microsoft/load-themed-styles#?,@uifabric/styling/styles/theme,@uifabric/styling/styles/GeneralStyles#0,@uifabric/styling/styles/index,@uifabric/styling/classNames/AnimationClassNames,@uifabric/styling/classNames/FontClassNames,@uifabric/styling/classNames/ColorClassNames,@uifabric/styling/classNames/index,@uifabric/styling/index,@uifabric/styling/lib/index,OfficeFabric/Styling,OfficeFabric/components/Image/Image.styles,OfficeFabric/components/Image/Image,OfficeFabric/components/Icon/Icon.base,OfficeFabric/components/Icon/Icon.styles#0,OfficeFabric/components/Icon/Icon,OfficeFabric/components/Icon/index,OfficeFabric/Icon,OfficeFabric/utilities/dateValues/TimeConstants#0,OfficeFabric/utilities/dateMath/DateMath,OfficeFabric/components/Calendar/Calendar.scss
define(["require","exports","tslib","react","../../Utilities","../../utilities/dateValues/DateValues","../../FocusZone","../../Icon","../../utilities/dateMath/DateMath","./Calendar.scss"],function(n,t,i,r,u,f,e,o,s,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=h,l=7,a=function(n){function t(t){var i=n.call(this,t)||this;return i.days={},i._onKeyDown=function(n,t){(t.which===13||t.which===32)&&n()},i._onDayKeyDown=function(n,t,r){return function(u){i._navigateMonthEdge(u,n,t,r)}},i._onDayMouseDown=function(n,t,r,u){return function(){u===f.DateRangeType.Month?i._applyFunctionToDayRefs(function(t,i){t&&i.originalDate.getMonth()===n.getMonth()&&t.classList.add(c.dayPress)}):i._applyFunctionToDayRefs(function(n,i,r){n&&r===t?(n.classList.add(c.dayPress),n.classList.add(c.dayIsHighlighted)):n&&n.classList.remove(c.dayIsHighlighted)})}},i._onDayMouseUp=function(n,t,r,u){return function(){u===f.DateRangeType.Month?i._applyFunctionToDayRefs(function(t,i){t&&i.originalDate.getMonth()===n.getMonth()&&t.classList.remove(c.dayPress)}):i._applyFunctionToDayRefs(function(n,i,r){n&&r===t&&n.classList.remove(c.dayPress)})}},i._onDayMouseOver=function(n,t,r,u){return function(){u===f.DateRangeType.Month?i._applyFunctionToDayRefs(function(t,i){t&&i.originalDate.getMonth()===n.getMonth()&&t.classList.add(c.dayHover)}):i._applyFunctionToDayRefs(function(n,i,r){n&&r===t&&n.classList.add(c.dayHover)})}},i._onDayMouseLeave=function(n,t,r,u){return function(){u===f.DateRangeType.Month?i._applyFunctionToDayRefs(function(t,i){t&&i.originalDate.getMonth()===n.getMonth()&&t.classList.remove(c.dayHover)}):i._applyFunctionToDayRefs(function(n,i,r){n&&r===t&&n.classList.remove(c.dayHover)})}},i._onTableMouseLeave=function(n){n.target.contains&&n.relatedTarget&&n.relatedTarget.contains&&n.target.contains(n.relatedTarget)||i._applyFunctionToDayRefs(function(n){n&&(n.classList.remove(c.dayHover),n.classList.remove(c.dayPress))})},i._onTableMouseUp=function(n){n.target.contains&&n.relatedTarget&&n.relatedTarget.contains&&n.target.contains(n.relatedTarget)||i._applyFunctionToDayRefs(function(n){n&&n.classList.remove(c.dayPress)})},i._onSelectDate=function(n){var t=i.props,e=t.onSelectDate,o=t.dateRangeType,c=t.firstDayOfWeek,h=t.navigatedDate,l=t.autoNavigateOnSelection,a=t.minDate,v=t.maxDate,y=t.workWeekDays,r=s.getDateRangeArray(n,o,c,y),u;o!==f.DateRangeType.Day&&(r=i._getBoundedDateRange(r,a,v));e&&e(n,r);l&&n.getMonth()!==h.getMonth()&&(u=s.compareDatePart(n,h),u<0?i._onSelectPrevMonth():u>0&&i._onSelectNextMonth())},i._onSelectNextMonth=function(){i.props.onNavigateDate(s.addMonths(i.props.navigatedDate,1),!1)},i._onSelectPrevMonth=function(){i.props.onNavigateDate(s.addMonths(i.props.navigatedDate,-1),!1)},i._onHeaderSelect=function(){var n=i.props.onHeaderSelect;n&&n(!0)},i._onHeaderKeyDown=function(n){var t=i.props.onHeaderSelect;t&&(n.which===13||n.which===32)&&t(!0)},i._onPrevMonthKeyDown=function(n){n.which===13&&i._onKeyDown(i._onSelectPrevMonth,n)},i._onNextMonthKeyDown=function(n){n.which===13&&i._onKeyDown(i._onSelectNextMonth,n)},i.state={activeDescendantId:u.getId("DatePickerDay-active"),weeks:i._getWeeks(t)},i._onSelectNextMonth=i._onSelectNextMonth.bind(i),i._onSelectPrevMonth=i._onSelectPrevMonth.bind(i),i}return i.__extends(t,n),t.prototype.componentWillReceiveProps=function(n){this.setState({weeks:this._getWeeks(n)})},t.prototype.render=function(){var v=this,it=this.state,rt=it.activeDescendantId,d=it.weeks,i=this.props,y=i.firstDayOfWeek,n=i.strings,h=i.navigatedDate,ht=i.selectedDate,t=i.dateRangeType,ut=i.navigationIcons,p=i.showWeekNumbers,ft=i.firstWeekOfYear,w=i.dateTimeFormatter,et=i.minDate,ot=i.maxDate,g=u.getId("DatePickerDay-dayPicker"),st=u.getId("DatePickerDay-monthAndYear"),ct=ut.leftNavigation,lt=ut.rightNavigation,a=p?s.getWeekNumbersInMonth(d.length,y,ft,h):null,at=p?s.getWeekNumber(ht,y,ft):undefined,vt=this._getWeekCornerStyles(d,t),b=et?s.compareDatePart(et,s.getMonthStart(h))<0:!0,k=ot?s.compareDatePart(s.getMonthEnd(h),ot)<0:!0,nt,tt;return r.createElement("div",{className:u.css("ms-DatePicker-dayPicker",c.dayPicker,p&&"ms-DatePicker-showWeekNumbers"&&(u.getRTL()?c.showWeekNumbersRTL:c.showWeekNumbers)),id:g},r.createElement("div",{className:u.css("ms-DatePicker-header",c.header)},r.createElement("div",{"aria-live":"polite","aria-relevant":"text","aria-atomic":"true",id:st,className:c.monthAndYear},this.props.onHeaderSelect?r.createElement("div",{className:u.css("ms-DatePicker-monthAndYear js-showMonthPicker",c.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":w.formatMonthYear(h,n),role:"button",tabIndex:0},w.formatMonthYear(h,n)):r.createElement("div",{className:u.css("ms-DatePicker-monthAndYear",c.monthAndYear)},w.formatMonthYear(h,n))),r.createElement("div",{className:u.css("ms-DatePicker-monthComponents",c.monthComponents)},r.createElement("div",{className:u.css("ms-DatePicker-navContainer",c.navContainer)},r.createElement("button",{className:u.css("ms-DatePicker-prevMonth js-prevMonth",c.prevMonth,(nt={},nt["ms-DatePicker-prevMonth--disabled "+c.prevMonthIsDisabled]=!b,nt)),disabled:!b,onClick:b?this._onSelectPrevMonth:undefined,onKeyDown:b?this._onPrevMonthKeyDown:undefined,"aria-controls":g,"aria-label":n.prevMonthAriaLabel?n.prevMonthAriaLabel+" "+n.months[s.addMonths(h,-1).getMonth()]:undefined,role:"button"},r.createElement(o.Icon,{iconName:ct})),r.createElement("button",{className:u.css("ms-DatePicker-nextMonth js-nextMonth",c.nextMonth,(tt={},tt["ms-DatePicker-nextMonth--disabled "+c.nextMonthIsDisabled]=!k,tt)),disabled:!k,onClick:k?this._onSelectNextMonth:undefined,onKeyDown:k?this._onNextMonthKeyDown:undefined,"aria-controls":g,"aria-label":n.nextMonthAriaLabel?n.nextMonthAriaLabel+" "+n.months[s.addMonths(h,1).getMonth()]:undefined,role:"button"},r.createElement(o.Icon,{iconName:lt}))))),r.createElement(e.FocusZone,null,r.createElement("table",{className:u.css("ms-DatePicker-table",c.table),"aria-readonly":"true","aria-multiselectable":"false","aria-labelledby":st,"aria-activedescendant":rt},r.createElement("thead",null,r.createElement("tr",null,p&&r.createElement("th",{className:u.css("ms-DatePicker-weekday",c.weekday)}),n.shortDays.map(function(t,i){return r.createElement("th",{className:u.css("ms-DatePicker-weekday",c.weekday),role:"grid",scope:"col",key:i,title:n.days[(i+y)%l],"aria-label":n.days[(i+y)%l]},n.shortDays[(i+y)%l])}))),r.createElement("tbody",{onMouseLeave:t!==f.DateRangeType.Day?this._onTableMouseLeave:undefined,onMouseUp:t!==f.DateRangeType.Day?this._onTableMouseUp:undefined},d.map(function(i,e){return r.createElement("tr",{key:a?a[e]:e,role:"row"},p&&a&&r.createElement("th",{className:u.css("ms-DatePicker-weekNumbers","ms-DatePicker-weekday",c.weekday,c.weekNumbers),key:e,title:a&&n.weekNumberFormatString&&u.format(n.weekNumberFormatString,a[e]),"aria-label":a&&n.weekNumberFormatString&&u.format(n.weekNumberFormatString,a[e]),scope:"row"},r.createElement("div",{className:u.css("ms-DatePicker-day",c.day,(o={},o["ms-DatePicker-week--highlighted "+c.weekIsHighlighted]=at===a[e],o))},r.createElement("span",null,a[e]))),i.map(function(i,o){var a=s.compareDates(h,i.originalDate),l,y;return r.createElement("td",{key:i.key,className:u.css(c.dayWrapper,"ms-DatePicker-day",v._getHighlightedCornerStyle(vt,o,e),(l={},l["ms-DatePicker-weekBackground "+c.weekBackground]=i.isSelected&&(t===f.DateRangeType.Week||t===f.DateRangeType.WorkWeek),l["ms-DatePicker-dayBackground "+c.dayBackground]=t===f.DateRangeType.Day,l["ms-DatePicker-day--highlighted "+c.dayIsHighlighted]=i.isSelected&&t===f.DateRangeType.Day,l["ms-DatePicker-day--disabled "+c.dayIsDisabled]=!i.isInBounds,l["ms-DatePicker-day--infocus "+c.dayIsFocused]=i.isInBounds&&i.isInMonth,l["ms-DatePicker-day--outfocus "+c.dayIsUnfocused]=i.isInBounds&&!i.isInMonth,l)),ref:function(n){return v._setDayCellRef(n,i,a)},onClick:i.isInBounds?i.onSelected:undefined,onMouseOver:t!==f.DateRangeType.Day?v._onDayMouseOver(i.originalDate,e,o,t):undefined,onMouseLeave:t!==f.DateRangeType.Day?v._onDayMouseLeave(i.originalDate,e,o,t):undefined,onMouseDown:t!==f.DateRangeType.Day?v._onDayMouseDown(i.originalDate,e,o,t):undefined,onMouseUp:t!==f.DateRangeType.Day?v._onDayMouseUp(i.originalDate,e,o,t):undefined},r.createElement("div",{key:i.key+"div",className:u.css(c.day,(y={},y["ms-DatePicker-day--today "+c.dayIsToday]=i.isToday,y)),role:"gridcell",onKeyDown:v._onDayKeyDown(i.originalDate,e,o),"aria-label":w.formatMonthDayYear(i.originalDate,n),id:a?rt:undefined,"aria-selected":i.isInBounds?i.isSelected:undefined,"data-is-focusable":i.isInBounds?!0:undefined,ref:function(n){return v._setDayRef(n,i,a)}},r.createElement("span",{"aria-hidden":"true"},w.formatDay(i.originalDate))))}));var o})))))},t.prototype.focus=function(){this.navigatedDay&&(this.navigatedDay.tabIndex=0,this.navigatedDay.focus())},t.prototype._setDayRef=function(n,t,i){i&&(this.navigatedDay=n)},t.prototype._setDayCellRef=function(n,t){this.days[t.key]=n},t.prototype._getWeekCornerStyles=function(n,t){var i={};switch(t){case f.DateRangeType.Month:n.forEach(function(t,r){t.forEach(function(t,f){var o=n[r-1]&&n[r-1][f]&&n[r-1][f].originalDate.getMonth()===n[r][f].originalDate.getMonth(),s=n[r+1]&&n[r+1][f]&&n[r+1][f].originalDate.getMonth()===n[r][f].originalDate.getMonth(),h=n[r][f-1]&&n[r][f-1].originalDate.getMonth()===n[r][f].originalDate.getMonth(),l=n[r][f+1]&&n[r][f+1].originalDate.getMonth()===n[r][f].originalDate.getMonth(),a=!o&&!h,v=!o&&!l,y=!s&&!h,p=!s&&!l,e="";a&&(e=u.getRTL()?e.concat(c.topRightCornerDate+" "):e.concat(c.topLeftCornerDate+" "));v&&(e=u.getRTL()?e.concat(c.topLeftCornerDate+" "):e.concat(c.topRightCornerDate+" "));y&&(e=u.getRTL()?e.concat(c.bottomRightCornerDate+" "):e.concat(c.bottomLeftCornerDate+" "));p&&(e=u.getRTL()?e.concat(c.bottomLeftCornerDate+" "):e.concat(c.bottomRightCornerDate+" "));i[r+"_"+f]=e})});break;case f.DateRangeType.Week:case f.DateRangeType.WorkWeek:n.forEach(function(n,t){var r=c.topLeftCornerDate+" "+c.bottomLeftCornerDate,f=c.topRightCornerDate+" "+c.bottomRightCornerDate;i[t+"_0"]=u.getRTL()?f:r;i[t+"_"+(l-1)]=u.getRTL()?r:f})}return i},t.prototype._getHighlightedCornerStyle=function(n,t,i){return n[i+"_"+t]?n[i+"_"+t]:""},t.prototype._navigateMonthEdge=function(n,t,i,r){var e=this.props,o=e.minDate,h=e.maxDate,f=undefined;if(i===0&&n.which===38?f=s.addWeeks(t,-1):i===this.state.weeks.length-1&&n.which===40?f=s.addWeeks(t,1):r===0&&n.which===u.getRTLSafeKeyCode(37)?f=s.addDays(t,-1):r===l-1&&n.which===u.getRTLSafeKeyCode(39)&&(f=s.addDays(t,1)),f&&(o?s.compareDatePart(o,f)<1:!0)&&(h?s.compareDatePart(f,h)<1:!0)){this.props.onNavigateDate(f,!0);n.preventDefault()}},t.prototype._applyFunctionToDayRefs=function(n){var t=this;this.state.weeks&&this.state.weeks.map(function(i,r){i.map(function(i){var u=t.days[i.key];n(u,i,r)})})},t.prototype._getWeeks=function(n){for(var u=n.navigatedDate,d=n.selectedDate,e=n.dateRangeType,b=n.firstDayOfWeek,g=n.today,o=n.minDate,h=n.maxDate,nt=n.showSixWeeksByDefault,tt=n.workWeekDays,t=new Date(u.getFullYear(),u.getMonth(),1),it=g||new Date,k=[],r,a,v,y,p,w;t.getDay()!==b;)t.setDate(t.getDate()-1);var i=!1,rt=e===f.DateRangeType.WorkWeek?f.DateRangeType.Week:e,c=s.getDateRangeArray(d,rt,b,tt);for(e!==f.DateRangeType.Day&&(c=this._getBoundedDateRange(c,o,h)),r=!0,a=0;r;a++){for(v=[],i=!0,y=0;y<l;y++)p=new Date(t.toString()),w={key:t.toString(),date:t.getDate().toString(),originalDate:p,isInMonth:t.getMonth()===u.getMonth(),isToday:s.compareDates(it,t),isSelected:s.isInDateRangeArray(t,c),onSelected:this._onSelectDate.bind(this,p),isInBounds:(o?s.compareDatePart(o,t)<1:!0)&&(h?s.compareDatePart(t,h)<1:!0)},v.push(w),w.isInMonth&&(i=!1),t.setDate(t.getDate()+1);r=nt?!i||a<=5:!i;r&&k.push(v)}return k},t.prototype._getBoundedDateRange=function(n,t,i){var r=n.slice();return t&&(r=r.filter(function(n){return s.compareDatePart(n,t)>=0})),i&&(r=r.filter(function(n){return s.compareDatePart(n,i)<=0})),r},t}(u.BaseComponent);t.CalendarDay=a});
//direct-dependencies=tslib,react,OfficeFabric/Utilities,OfficeFabric/utilities/dateValues/DateValues,OfficeFabric/FocusZone,OfficeFabric/Icon,OfficeFabric/utilities/dateMath/DateMath,OfficeFabric/components/Calendar/Calendar.scss
