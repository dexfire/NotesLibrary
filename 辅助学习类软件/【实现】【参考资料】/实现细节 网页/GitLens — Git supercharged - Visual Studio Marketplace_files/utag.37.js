//tealium universal tag - utag.37 ut4.0.201806220101, Copyright 2018 Tealium.com Inc. All Rights Reserved.
window.oa=window.oa||{};window.oa.tagging=window.oa.tagging||{data:{},setup:{complete:{}},factory:{}};window.oa.tagging.utfv='6476a66ef045f2a0b7637730c2b256082807e375';(function(){var factory=window.oa.tagging.factory;var logLevels={critical:10,error:20,warn:30,info:40};function _convertLogLevel(logLevel){if(logLevel in logLevels){return logLevels[logLevel];}
return logLevel;}
factory.handler=function handler(name,handleMethod,logLevel){if(this instanceof handler){this._utfversion="2018-06-22 00:40:13";this.name=name;this.handleMethod=handleMethod;this.logLevel=logLevel;}else return new handler(name,handleMethod,logLevel);};factory.handler.prototype={};factory.handlerBlock=function handlerBlock(){if(this instanceof handlerBlock){this._utfversion="2018-06-22 00:40:13";this.newHandler=false;this.handlers=[];this.organizedHandlers={};this.logLevels=logLevels;}else return new handlerBlock();};factory.handlerBlock.prototype={add:function add(name,reportFunc,logLevel){this.newHandler=true;logLevel=_convertLogLevel(logLevel);this.handlers.push(factory.handler(name,reportFunc,logLevel));this._cullHandlers(logLevel);},remove:function remove(name){for(var i=0;i<this.handlers.length;i++){if(this.handlers[i].name===name){this.handlers.splice(i,1);}}},handle:function(record){var handlers=this._retrieveHandlers(record.logLevel);for(var i=0;i<handlers.length;i++){var handler=handlers[i];handler.handleMethod(record);}},_retrieveHandlers:function(logLevel){if(!(logLevel in this.organizedHandlers)){this._generateOrganizedHandlers(logLevel);}
return this.organizedHandlers[logLevel];},_generateOrganizedHandlers:function(logLevel){var handlerArr=[];for(var i=0;i<this.handlers.length;i++){var handler=this.handlers[i];if(handler.logLevel>=logLevel){handlerArr.push(handler);}}
this.organizedHandlers[logLevel]=handlerArr;},_cullHandlers:function(logLevel){var newOrganizedHandlers={};for(var i=0;i<this.organizedHandlers.length;i++){if(i>logLevel){newOrganizedHandlers[i]=this.organizedHandlers[i];}}
this.organizedHandlers=newOrganizedHandlers;}};factory.logRecord=function logRecord(logLevel,extensionName,message){if(this instanceof logRecord){this._utfversion="2018-06-22 00:40:13";this.logLevel=logLevel;this.extensionName=extensionName;this.message=message;var d=new Date();this.timestamp=("0"+d.getHours()).slice(-2)+
":"+
("0"+d.getMinutes()).slice(-2)+
":"+
("0"+d.getSeconds()).slice(-2)+
":"+
("00"+d.getMilliseconds()).slice(-3)+
"T"+
d.getFullYear()+
("0"+(d.getMonth()+1)).slice(-2)+
("0"+d.getDate()).slice(-2);}else return new logRecord(logLevel,extensionName,message);};factory.sherlock=function sherlock(records){if(this instanceof sherlock){this._utfversion="2018-06-22 00:40:13";this.records=records;}else return new sherlock(records);};factory.sherlock.prototype={getExactLevel:function(logLevel){var recordArr=[];logLevel=_convertLogLevel(logLevel);for(var i=0;i<this.records.length;i++){if(this.records[i].logLevel===logLevel){recordArr.push(this.records[i]);}}
return recordArr;},getAboveOrEqualLevel:function(logLevel){var recordArr=[];logLevel=_convertLogLevel(logLevel);for(var i=0;i<this.records.length;i++){if(this.records[i].logLevel>=logLevel){recordArr.push(this.records[i]);}}
return recordArr;},getBelowOrEqualLevel:function(logLevel){var recordArr=[];logLevel=_convertLogLevel(logLevel);for(var i=0;i<this.records.length;i++){if(this.records[i].logLevel<=logLevel){recordArr.push(this.records[i]);}}
return recordArr;},getExtensionAndExactLevel:function(extensionName,logLevel){var recordArr=[];logLevel=_convertLogLevel(logLevel);for(var i=0;i<this.records.length;i++){if(this.records[i].extensionName===extensionName&&this.records[i].logLevel===logLevel){recordArr.push(this.records[i]);}}
return recordArr;},getExtension:function(extensionName){var recordArr=[];for(var i=0;i<this.records.length;i++){if(this.records[i].extensionName===extensionName){recordArr.push(this.records[i]);}}
return recordArr;}};factory.logger=function logger(){if(this instanceof logger){this._utfversion="2018-06-22 00:40:13";this.records=[];this.handlers=factory.handlerBlock();this.logLevels=logLevels;this.sherlock=factory.sherlock(this.records);this.portable=function portable(extensionName,message){this.info(extensionName,message);};this.portable.info=this.info;this.portable.warn=this.warn;this.portable.error=this.error;this.portable.critical=this.critical;}else return new logger();};factory.logger.prototype={handle:function(extensionName,message,logLevel){logLevel=_convertLogLevel(logLevel);var rec=factory.logRecord(logLevel,extensionName,message);this.handlers.handle(rec);this.records.push(rec);},info:function(extensionName,message){this.handle(extensionName,message,"info");},warn:function(extensionName,message){this.handle(extensionName,message,"warn");},error:function(extensionName,message){this.handle(extensionName,message,"error");},critical:function(extensionName,message){this.handle(extensionName,message,"critical");},addHandler:function(name,reportMethod,logLevel){this.handlers.add(name,reportMethod,logLevel);},removeHandler:function(name){this.handlers.remove(name);},_clearLogs:function(){this.records=[];}};var cflogging=factory.logger();cflogging.addHandler("console",function(record){if(window.oa.tagging.data.store.get("isDebug")){if(record.message instanceof Error&&record.message.stack&&record.message){console.log(record.logLevel+" "+record.message.stack);}else{console.log(record.logLevel+" "+record.message);}}},"error");window.oa.tagging.logger=cflogging;})();var eventTagging;if(window.oa){eventTagging=window.oa.tagging;}else{eventTagging={};}
eventTagging.eventDriver=(function(){var _utfversion="2018-05-23 00:24:03";function eventDriver(){"use strict";var listenerGroups={};function listen(eventName,callback){if(document.addEventListener){document.addEventListener(eventName,callback,false);}else{document.documentElement.attachEvent("onpropertychange",function(e){if(e.propertyName===eventName){callback(eventName);}});}}
function listenGroup(eventName,callback){if(!listenerGroups[eventName]){listenerGroups[eventName]=[];listen(eventName,fireListenerGroup);}
listenerGroups[eventName].push(callback);function fireListenerGroup(event){var eventName="";var data=null;if(event instanceof Event){eventName=event.type;if(event.detail){data=event.detail;}}else{eventName=event;}
var listenerArray=listenerGroups[eventName];var arrLength=listenerArray.length;for(var i=0;i<arrLength;i++){window.oa.tagging.eventDriver.oaPromise(function(){listenerArray[i](data,eventName);});}}
return true;}
function trigger(eventName,data){data=data==null?[eventName]:(function(){var arr=[data];arr.push(eventName);return arr;})();if(document.createEvent){var event=new CustomEvent(eventName,{detail:data});document.dispatchEvent(event);}else{document.documentElement[eventName]++;}}
function oaRetryUntilResolve(maxTries,promiseGenerator,resolve,reject,progressFunc,currentRetry){var currentTry=currentRetry||1;return promiseGenerator().then(function(success){resolve(success);},function(error){if(progressFunc!==undefined){progressFunc(error,currentTry,maxTries);}
if(currentTry>=maxTries){reject(error);}else{return oaRetryUntilResolve(maxTries,promiseGenerator,resolve,reject,progressFunc,(currentRetry=currentTry+1));}});}
function oaReduce(array,callback,initialVal){var accumulator=initialVal===undefined?undefined:initialVal;for(var i=0;i<array.length;i++){if(accumulator!==undefined){accumulator=callback.call(undefined,accumulator,array[i],i,this);}else{accumulator=array[i];}}
return accumulator;}
function oaForEach(array,callingFunc,context){var value;var i=0;var cont=context?context:this;while((value=array[i++])){callingFunc.call(cont,value,i);}}
function oaPromiseAll(promises){var results=[];var merged=oaReduce(promises,function(acc,p){acc
.then(function(){return p;})
.then(function(r){results.push(r);});},new oaPromise(function(resolve,reject){resolve(null);}));}
var oaPromise=(function(){function isFunction(obj){return typeof obj==="function";}
function isPromise(obj){return obj&&obj.constructor===oaPromise;}
function isObject(obj){return obj!==null&&typeof obj==="object";}
function delayFire(fn,args,rejection){setTimeout(function(){try{fn(args);}catch(e){rejection(e);}},1);}
function oaPromise(call){var self=this;if(this instanceof oaPromise){this.state=1;this.value=undefined;this.handlers={onFulfilled:[],onRejected:[]};this.handlerCalled={onFulfilled:false,onRejected:false};this._listeners=[];this._utfversion="2017-09-21 02:38:28";this.resolve=function resolve(val){self.fulfill(val);};this.fulfill=function fulfill(fulfilledValue){if(self.state!==1&&(self.handlerCalled.onFulfilled===true||self.handlerCalled.onRejected===true)){return;}
self.state=2;self.value=fulfilledValue;self.handlerCalled.onFulfilled=true;if(self.handlers.onFulfilled.length>0){while(self.handlers.onFulfilled.length!==0){var fulfillCaller=self.handlers.onFulfilled.shift();delayFire(fulfillCaller,self.value,self.reject);}}
self._fireListeners();return self;};this.reject=function reject(rejectionReason){if(self.state!==1&&(self.handlerCalled.onRejected===true||self.handlerCalled.onFulfilled===true)){return;}
self.state=3;self.value=rejectionReason;self.handlerCalled.onRejected=true;if(self.handlers.onRejected.length>0){while(self.handlers.onRejected.length!==0){var rejectCaller=self.handlers.onRejected.shift();delayFire(rejectCaller,self.value,self.reject);}}
self._fireListeners();return self;};this._fireListeners=function fireListeners(){if(self.state!==1){var i=self._listeners.length;while(--i>=0){var listener=self._listeners[i];delayFire(function(obj){var state=0;var value=obj[1];if(obj[0]===2){state="resolve";}else if(obj[0]===3){state="reject";}
if(listener["status"]!=="fired"){listener[state](value);listener["status"]="fired";}},[self.state,self.value],self.reject);}}};this.listen=function listen(resolve,reject){self._listeners.push({resolve:resolve,reject:reject,status:"unfired"});self._fireListeners();};if(isFunction(call)){call(function(value){self.resolution(self,value);},function(reason){self.reject(reason);});}}else{var obj=new oaPromise();var ret=oaPromise.apply(obj,arguments);return ret===undefined?obj:ret;}}
oaPromise.Resolve=function(val){return new oaPromise().fulfill(val);};oaPromise.Reject=function(val){return new oaPromise().reject(val);};oaPromise.prototype={resolution:function promiseResolution(self,x){if(self===x){self.reject("type error");}else if(isPromise(x)){if(x.state===1){x.then(function(fulfilled){self.resolve(self,fulfilled);},function(rejected){self.reject(reject);});}else if(x.state===2){self.fulfill(x.value);}else if(x.state===3){self.reject(x.value);}}else if(isObject(x)||isFunction(x)){var then;var promiseCallAvailable=true;try{then=x.then;}catch(e){self.reject(e);}
if(isFunction(then)){try{then.call(x,function resolvePromise(y){if(promiseCallAvailable){promiseCallAvailable=false;self.resolution(self,y);}},function rejectPromise(r){if(promiseCallAvailable){promiseCallAvailable=false;self.reject(r);}});}catch(e){if(promiseCallAvailable){self.reject(e);}}}else{self.fulfill(x);}}else{self.fulfill(x);}},wrappedlisten:function(resolve,reject){this._listeners.push({resolve:resolve,reject:reject,status:"unfired"});if(this._status==="completed"){this._fireListeners(this._resultType,this._result);}
return this;},then:function then(onFulfilled,onRejected){onFulfilled=typeof onFulfilled==="function"?onFulfilled:function(v){return v;};onRejected=typeof onRejected==="function"?onRejected:function(r){throw r;};if(!isFunction(onFulfilled)){onFulfilled=null;}
if(!isFunction(onRejected)){onRejected=null;}
var promise=new oaPromise();this.handlers.onFulfilled.push(function FulFilledHandler(value){try{var fulFilledVal=onFulfilled(value);promise.resolution(promise,fulFilledVal);}catch(e){promise.reject(e);}});this.handlers.onRejected.push(function rejectionHandler(reason){try{var rejectionVal=onRejected(reason);promise.resolution(promise,rejectionVal);}catch(e){promise.reject(e);}});if(!isFunction(onFulfilled)&&this.state===2){promise.resolve(this.value);}
if(!isFunction(onRejected)&&this.state===3){promise.reject(this.value);}
if(isFunction(onFulfilled)&&this.state===2){try{var val=this.value;delayFire(function(){var fulFulledVal=onFulfilled(val);promise.resolution(promise,fulFulledVal);},val,promise.reject);}catch(e){promise.reject(e);}}
if(isFunction(onRejected)&&this.state===3){try{var val=this.value;delayFire(function(){var rejectionVal=onRejected(val);promise.resolution(promise,rejectionVal);},val,promise.reject);}catch(e){promise.reject(e);}}
return promise;},_fireListeners:function(completeType,arg){var listener;var i=0;while((listener=this._listeners[i++])){if(listener["status"]!=="fired"){listener[completeType]&&listener[completeType](arg);this._listeners[i-1]["status"]="fired";}}}};oaPromise.All=function(promises){return new oaPromise(function(resolve,reject){var results=new Array(promises.length);if(promises.length===0){resolve.call(this,promises);}
var left=promises.length;oaForEach(promises,function(promise,i){promise.then(function(result){results[i-1]=result;left-=1;if(left===0){resolve.call(this,results);}},function(error){reject.call(this,error);});},this);});};oaPromise.ListenAll=function(promises){return new oaPromise(function(resolve,reject){var results=new Array(promises.length);if(promises.length===0){resolve.call(this,promises);}
var left=promises.length;oaForEach(promises,function(promise,i){promise.listen(function(result){results[i-1]=result;left-=1;if(left===0){resolve.call(this,results);}},function(error){reject.call(this,error);});promise;},this);});};oaPromise.deferred=function oaDeferred(){var p=new oaPromise();return{promise:p,resolve:p.resolve,reject:p.reject};};return oaPromise;})();return{listen:listen,trigger:trigger,listenGroup:listenGroup,oaReduce:oaReduce,oaForEach:oaForEach,oaPromiseAll:oaPromiseAll,oaPromise:oaPromise,oaRetryUntilResolve:oaRetryUntilResolve,utfVersion:_utfversion};}
return eventDriver();})();oaTagging=window.oa.tagging;util=oaTagging.util||{};util._utfversion="2018-06-07 17:58:47";util.toObject=function(arr){var newObj={};for(var i=0;i<arr.length;++i)newObj[arr[i]]=arr[i];return newObj;};util.getVersion=function(){var tmsProfile="";var dn="";var dv="";var utfv="";if(window.utag&&window.utag.id){tmsProfile=window.utag.id.split(".")[1];}else{tmsProfile="Unknown";}
if(window.oa.tagging.dn){dn=window.oa.tagging.dn;}else{dn="Unknown";}
if(window.oa.tagging.dv){dv=window.oa.tagging.dv;}else{dv="Unknown";}
if(window.oa.tagging.utfv){utfv=window.oa.tagging.utfv;}else{utfv="Unknown";}
return tmsProfile+"|"+dn+"|"+dv+"|"+utfv;};util.isJSLLElement=function(elem){var jReg=/(^a$|button|img|input)/i;return jReg.test(elem);};util.getCookie=function(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===" ")c=c.substring(1,c.length);if(c.indexOf(nameEQ)===0)return c.substring(nameEQ.length,c.length);}
return null;};util.createCookie=function(name,value,days){var expires;if(days){var date=new Date();date.setTime(date.getTime()+days*24*60*60*1000);expires="; expires="+date.toGMTString();}else{expires="";}
document.cookie=name+"="+value+expires+"; path=/";};util.deleteCookie=function(name){window.oa.tagging.util.createCookie(name,"",-1);};util.debugOn=function(){window.oa.tagging.util.createCookie("cfDebug","true",8);};util.debugOff=function(){window.oa.tagging.util.deleteCookie("cfDebug");};util.setMetaTags=function(metaTagArray){var metaTag,existingMetaTag;for(var i=0;i<metaTagArray.length;i++){metaTag=metaTagArray[i].split("::");existingMetaTag=document.querySelector("meta[name='"+metaTag[0]+"']");if(existingMetaTag){if(existingMetaTag.getAttribute("content")!==metaTag[1]){existingMetaTag.setAttribute("content",metaTag[1]);}}else{var meta=document.createElement("meta");meta.name=metaTag[0];meta.content=metaTag[1];document.getElementsByTagName("head")[0].appendChild(meta);}}};util.setJSLLMeta=function(metaDictionary){var m;var mtf=[];for(var i in metaDictionary){m=metaDictionary[i];if(m===""){window.oa.tagging.logger.info("JSLL","settingMeta tag key: awa-"+i+" value is empty");}else{window.oa.tagging.logger.info("JSLL","settingMeta tag key: awa-"+i+" value is "+m);mtf.push("awa-"+i+"::"+m);}}
return mtf;};util.extend=function(){var target=arguments[0]||{},i=1,length=arguments.length;for(;i<length;i++){if(!arguments[i])continue;for(var key in arguments[i]){if(arguments[i].hasOwnProperty(key))target[key]=arguments[i][key];}}
return target;};util.replaceValue=function(modString,matchCriteria,replaceValue){return modString.split(new RegExp(matchCriteria,"gi")).join(replaceValue);};util.build={img:function(tagObj){var to=tagObj;window.oa.tagging.logger.info("util.build.img","tagObj is: "+JSON.stringify(to));var src=to.url,rMatch=new RegExp(/(%RAND%)/i),idMatch=new RegExp(/(%ID%)/gi),catchall=new RegExp(/(%.*%)/gi),random=Math.round(Date.now()*Math.random()).toString(),match,val;var isDebug=(function(url){var isDebug=false;if(window.oa.tagging.data.store&&window.oa.tagging.data.store.get("isDebug")){isDebug=window.oa.tagging.data.store.get("isDebug");}else{isDebug=url.indexOf("tealium=1")!==-1;}
return isDebug;})(location.search);if(to.id!==undefined&&src.match(idMatch)!==null){src=src.replace(idMatch,encodeURIComponent(to.id));}
if(to!==undefined&&typeof to==="object"){for(var prop in to){if(prop==="bustcache"||prop==="url"||prop==="id"){continue;}
if(Boolean(to[prop])&&to[prop].encode!==undefined&&!to[prop].encode){src=window.oa.tagging.util.replaceValue(src,"%"+prop+"%",to[prop].val);}else{var val=to[prop];if(to[prop]!==null&&to[prop].val!==undefined){val=to[prop].val;}
src=window.oa.tagging.util.replaceValue(src,"%"+prop+"%",encodeURIComponent(val));}}}
if(to.bustcache===true){if(src.match(rMatch)!==null){src=src.replace(rMatch,encodeURIComponent(random));}else{src=src+encodeURIComponent(random);}}
if(isDebug){var prodLink=document.createElement("a");prodLink.setAttribute("href","https://www.campfireanalytics.com/testPixel/?requestUrl=%newUrl%");prodLink.search=window.oa.tagging.util.replaceValue(prodLink.search,"%newUrl%",src);new Image().src=prodLink.href;}else{new Image().src=src;window.oa.tagging.logger.info("util.build.img","Pixel fired with src: "+src);}
return src?src:false;},script:function(tagObj){var to=tagObj;window.oa.tagging.logger.info("util.build.script","tagObj is: "+JSON.stringify(to));var script=document.createElement("script");script.type="text/javascript";script.src=to.src;if(to.id){script.id=to.id;}
document.getElementsByTagName("head")[0].appendChild(script);script.onload=tagObj.callback;script.onreadystatechange=function(){if(this.readyState==="complete"){window.oa.tagging.logger.info("util.build.script","Building script with src: "+tagObj.src);tagObj.callback();}};return to.src?to.src:false;},iframe:function(tagObj){var to=tagObj;window.oa.tagging.logger.info("util.build.iframe","tagObj is: "+JSON.stringify(to));var iframe=document.createElement("iframe");iframe.src=to.url;iframe.style.display="none";if(to.id!==undefined){iframe.id=to.id;}
if(to.returnIframe!==undefined&&to.returnIframe===true){window.oa.tagging.logger.info("util.build.iframe","Returning iframe with src: "+to.src);return iframe;}else{window.oa.tagging.logger.info("util.build.iframe","Building iframe with src: "+to.src);document.body.appendChild(iframe);return to.src?to.src:false;}}};util.dlValsToString=function(delimiter,catchall,obj){var a=arguments,data=obj,str="";for(var i=obj!==undefined?3:2;i<a.length;i++){str=str+
(data[a[i]]!==undefined&&data[a[i]].length!==0?data[a[i]]:catchall)+
(i<a.length-1?delimiter:"");}
return str;};util.findNearestElement=function(find,start){if(start!==null&&start.nodeName===find){return start;}
return start!==null&&start.nodeName==="BODY"?false:this.findNearestElement(find,start.parentNode);};util.matchfwlink=function(fwlinks,matchCriteria){var match=[];var keys=Object.keys(fwlinks);for(var i=0;i<keys.length;i++){if(fwlinks[keys[i]].fwlink_id===matchCriteria){match.push(keys[i]);}}
return match;};util.getQueryParam=function(name){var jQuery=window.oa.tagging.data.store.get("jquery");name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return jQuery.trim(results===null?"":decodeURIComponent(results[1].replace(/\+/g," ")));};util.guidToBytes=function(guid){var bytes=[];var splitG=guid.split("-");for(var i=0;i<splitG.length;i++){var bytesInChar=i<3?splitG[i].match(/.{1,2}/g).reverse():splitG[i].match(/.{1,2}/g);for(var b=0;b<bytesInChar.length;b++){bytes.push(parseInt(bytesInChar[b],16));}}
return bytes;};util.encodeASCII85=function(bytearray){var _encodedBlock=new Array(5);var _decodedBlock=new Array(4);var sb=[];var _linePos=0;var count=0;var _tuple=0;for(var i=0;i<bytearray.length;i++){var b=bytearray[i];if(count>=_decodedBlock.length-1){_tuple|=b;if(_tuple<0){_tuple=_tuple>>>0;}
if(_tuple===0){sb.push("z");}else{window.oa.tagging.util.encodeBlock(_encodedBlock.length,sb,_encodedBlock,_tuple,33);}
_tuple=0;count=0;}else{var _newTuple=(b<<(24-count*8))>>>0;var oldTuple=_tuple;_tuple|=_newTuple;_tuple=_tuple>>>0;count++;}}
if(count>0){window.oa.tagging.util.encodeBlock(count+1,sb,_encodedBlock,_tuple,33);}
return sb.join("");};util.encodeBlock=function(count,sb,encoded,tuple,asciiOffset){for(var i=encoded.length-1;i>=0;i--){encoded[i]=tuple%85+asciiOffset;tuple/=85;}
for(var i=0;i<count;i++){var c=String.fromCharCode(encoded[i]);sb.push(c);}};util.waitUntilPromise=function(condition,promise,timeOut,maxWait){var timeWaited=0;if(timeOut===undefined){timeOut=500;}
if(maxWait===undefined){maxWait=3000;}
function runTimeout(){if(condition()){promise.resolve(true);}else{if(timeWaited>=maxWait){promise.reject(false);}else{timeWaited+=timeOut;setTimeout(runTimeout,timeOut);}}}
runTimeout();};util.waitUntil=function(condition,cb,timeOut,maxWait){var timeWaited=0;if(timeOut===undefined){timeOut=500;}
if(maxWait===undefined){maxWait=3000;}
function runTimeout(){if(condition()){cb(true);}else{if(timeWaited>=maxWait){cb(false);return false;}else{timeWaited+=timeOut;setTimeout(runTimeout,timeOut);}}}
runTimeout();};util.delay=function(timeOut,cb){setTimeout(cb,timeOut);};util.jQuery=(function(){function cfjquery(element){if(this instanceof cfjquery){this._element=element&&element.nodeType?element:document.querySelector(element);this.length=this._element!==null?1:0;this._utfversion="";}else{obj=new cfjquery();ret=cfjquery.apply(obj,arguments);return ret===undefined?obj:ret;}}
function find(elem,selector){return elem._element.querySelectorAll(selector);}
function closest(elem,selector){if(!Element.prototype.closest)
Element.prototype.closest=function(s){var el=this;if(!document.documentElement.contains(el))return null;do{if(el.matches(s))return el;el=el.parentElement||el.parentNode;}while(el!==null&&el.nodeType===1);return null;};return elem._element.closest(selector);}
function on(elem,eventTypes,eventDelegate,handler,one){if(typeof eventDelegate==="function"){handler=eventDelegate;eventDelegate=undefined;}
if(!Element.prototype.matches)
Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;if(!elem){return null;}
if(elem.addEventListener){elem.addEventListener(eventTypes,function(event){var ele=event.target;if(eventDelegate&&ele.matches(eventDelegate)){handler.call(event);}
if(!eventDelegate){handler.call(event);}});}else{elem.attachEvent("on"+eventTypes,function(event){var ele=event.target;if(eventDelegate&&ele.matches(eventDelegate)){handler.call(event);}});}}
cfjquery.ajax=function(params){var request=new XMLHttpRequest();request.open(params.type,params.url,true);request.onreadystatechange=function(){if(this.readyState===4){if(this.status>=200&&this.status<400){var resp=this.responseText;params.success(JSON.parse(resp));}else{params.error();}}};request.send();request=null;};cfjquery.inArray=function(item,array){if(!!array&&this.isArray(array)&&!!item){for(var i=0;i<array.length;i++){if(array[i]===item)return i;}}
return-1;};cfjquery.trim=function(string_to_trim){return string_to_trim.replace(/^\s+|\s+$/g,"");};cfjquery.isArray=function(obj){return toString.call(obj)==="[object Array]";};cfjquery.prototype={find:function(selector){return find(this,selector);},closest:function(selector){return closest(this,selector);},ready:function(fn){if(document.readyState!=="loading"){fn();}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",fn);}else{document.attachEvent("onreadystatechange",function(){if(document.readyState!=="loading")fn();});}},on:function(eventName,eventDelegate,handler){return on(this._element,eventName,eventDelegate,handler);},hide:function(){if(this._element!==null){this._element.style.display="none";}}};return cfjquery;})();util.bind=function(fToBind,oThis){if(typeof fToBind!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}
var aArgs=Array.prototype.slice.call(arguments,2),fNOP=function(){},fBound=function(){return fToBind.apply(this instanceof fNOP?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)));};if(this.prototype){fNOP.prototype=this.prototype;}
fBound.prototype=new fNOP();return fBound;};window.oa.tagging.util=util;window.oa.tagging.createDataStore=function(tagging,logger){function store(tagging,logger){if(this instanceof store){this._registers={};this._taggingContainer=tagging;this._logger=logger;this._utfversion="2017-11-21 00:19:58";this._options={};}else{obj=new store();ret=store.apply(obj,arguments);return ret===undefined?obj:ret;}}
store.prototype.register=function(registerName,options,populator){if(this._registers[registerName]!==undefined){return this.populate(registerName);}
var newRegister=new register(registerName,populator,this._taggingContainer,this._logger,options);if(this._options[registerName]!==undefined){newRegister.setOptions(this._options[registerName]);}
this._registers[registerName]=newRegister;this[registerName]=function(){return this.populate(registerName);};};store.prototype.populate=function(storeName,defaultValue,callback){if(!this._registers[storeName]){return defaultValue;}
this._registers[storeName].populate();if(callback){callback();}
return this._registers[storeName].values;};store.prototype.get=function(registerName,options){if(this._registers[registerName]===undefined){return undefined;}
var o=options||{};return this._registers[registerName].get(o);};store.prototype.set=function(registerName,value,options){if(this._registers[registerName]===undefined){var newRegister=new register(registerName,function(register,values){return values;},this._taggingContainer,this._logger,options);if(this._options[registerName]!==undefined){newRegister.setOptions(this._options[registerName]);}
this._registers[registerName]=newRegister;}
return this._registers[registerName].set(value,options);};store.prototype.setOptions=function(registerName,options){if(this._registers[registerName]===undefined){var extend=this._taggingContainer.util.extend;this._options[registerName]=extend(this._options[registerName]!==undefined?this._options[registerName]:{},options);return false;}
return this._registers[registerName].setOptions(options);};function register(name,populator,tagging,logger,options){if(this instanceof register){this.name=name;this._populator=populator;this._taggingContainer=tagging;this._logger=logger;this._values=undefined;this._options=this._setOptions(options);this.populated=false;this.hasException=false;this._populatorException=undefined;this._utfversion="2017-11-21 00:19:58";}else{obj=new register();ret=register.apply(obj,arguments);return ret===undefined?obj:ret;}}
register.prototype._setOptions=function(options){var defaultValue=null;var autoPopSetting="always";var extend=this._taggingContainer.util.extend;options=extend({},options);if(typeof options==="object"&&(options!==null&&options!==undefined)){if(options.hasOwnProperty("defaultValue")){defaultValue=options.defaultValue;}
if(options.hasOwnProperty("autoPopSetting")){if(options.autoPopSetting in{once:true,always:true,never:true}){autoPopSetting=options.autoPopSetting;}}}
options.defaultValue=defaultValue;options.autoPopSetting=autoPopSetting;return options;};register.prototype.populate=function(options){try{this._values=this._populator(this,this._values,options);this.populated=true;}catch(e){this._values=options.defaultValue;this.hasException=true;this._populatorException=e;}
return this._values;};register.prototype.get=function(options){var o={},populateFlag=false,defaultValue=this._options.defaultValue,autoPopSetting=this._options.autoPopSetting;if(typeof options==="boolean"){populateFlag=options;}else if(typeof options==="object"){if(options.hasOwnProperty("populateFlag")){populateFlag=options.populateFlag;}
if(options.hasOwnProperty("defaultValue")){defaultValue=options.defaultValue;}}
o.populateFlag=populateFlag;o.defaultValue=defaultValue;o=this._taggingContainer.util.extend(o,this._options);if(autoPopSetting==="once"&&this.populated===false){return this.populate(o);}
if(populateFlag||autoPopSetting==="always"){return this.populate(o);}
return this._values;};register.prototype.set=function(value,options){this.populated=true;this._values=value;return this._values;};register.prototype.setOptions=function(options){this._options=this._setOptions(options);return this._values;};return new store(tagging,logger);};oaTaggingStore=window.oa.tagging.createDataStore(window.oa.tagging,window.oa.tagging.logger);window.oa.tagging.data.store=oaTaggingStore;window.oa.tagging.createSetupProvider=function(tagging,dataStore){function setupStep(name,execution,filter,tagging,dataStore,logger){if(this instanceof setupStep){this.name=name;this.status="not ran";this._filter=filter;this._activity=execution;this._dataStore=dataStore;this._taggingContainer=tagging;this.dataStore=(function facadeDataStore(name,taggingContainer,realDataStore){var facade={};facade.get=function(storeName,options){taggingContainer.logger.info(name,"Getting DataStore Value from "+storeName);var tempVal=realDataStore.get(storeName,options);return tempVal;};facade.set=function(storeName,value,options){taggingContainer.logger.info(name,"Setting DataStore Value at "+storeName);var tempVal=realDataStore.set(storeName,value,options);taggingContainer.logger.info(name,"Set value is "+JSON.stringify(tempVal));return tempVal;};facade.register=function(registerName,options,populator){taggingContainer.logger.info(name,"Registering new Data Store Register "+registerName);var tempVal=realDataStore.register(registerName,options,populator);taggingContainer.logger.info(name,"Registration Complete with return of "+JSON.stringify(tempVal));return tempVal;};facade._dataStore=realDataStore;return facade;})(this.name,this._taggingContainer,this._dataStore);}else{obj=new setupStep();ret=setupStep.apply(obj,arguments);return ret===undefined?obj:ret;}}
setupStep.prototype.filter=function(){return this._filter===undefined?function(){return true;}:this._filter(this._taggingContainer,this.dataStore);};setupStep.prototype.isCompleteOrFail=function(){if(this.status==="complete"||this.status==="failed"){return true;}
return false;};setupStep.prototype.execute=function(){return this._activity(this._taggingContainer,this.dataStore);};function setupProvider(tagging,dataStore){var obj;var ret;if(this instanceof setupProvider){this._tags={};this._setupFunctions={};this._dataStore=dataStore;this._taggingContainer=tagging;this._utfversion="2018-05-22 17:01:48";}else{obj=new setupProvider();ret=setupProvider.apply(obj,arguments);return ret===undefined?obj:ret;}}
setupProvider.prototype.addTag=function(tagName,tag){this._tags[tagName]=tag;if(tag.hasOwnProperty("pageload")){}};setupProvider.prototype.addSetupFunc=function(functionName,func){this._taggingContainer.logger.info("setupProvider","Adding setupStep "+functionName+" to list");var newTag=new setupStep(functionName,func,undefined,this._taggingContainer,this._dataStore);this._setupFunctions[functionName]=newTag;};setupProvider.prototype.start=function(){for(var key in this._setupFunctions){if(this._setupFunctions.hasOwnProperty(key)){try{this._taggingContainer.logger.info("setupProvider","Tag "+key+" started");this.runTag(key);}catch(e){this._taggingContainer.logger.error("Exception","setupProvider: throwing exception for tag "+key);this._taggingContainer.logger.error("Exception","setupProvider: "+e);}}}};setupProvider.prototype.runTag=function(tagName){try{if(this._setupFunctions[tagName]){var step=this._setupFunctions[tagName];step.execute();this._taggingContainer.logger.info("setupProvider","Tag "+tagName+" completed without exception");return true;}
return false;}catch(e){this._taggingContainer.logger.error("setupProvider","Tag "+tagName+" failed with exception");this._taggingContainer.logger.error("setupProvider","Exception: "+e);return false;}};return new setupProvider(tagging,dataStore);};oaSetupProvider=window.oa.tagging.createSetupProvider(window.oa.tagging,window.oa.tagging.data.store);window.oa.tagging.setupProvider=oaSetupProvider;window.oa.tagging.createQueueProvider=function(tagging,dataStore){"use strict";var oaPromise=tagging.eventDriver.oaPromise;var oaRetryUntilResolve=tagging.eventDriver.oaRetryUntilResolve;function piece(name,execution,filter,tagging,dataStore,logger){if(this instanceof piece){this.name=name;this.status="not ran";this._utfversion="2018-06-04 23:40:44";this._filter=filter;this._activity=execution;this._dataStore=dataStore;this._taggingContainer=tagging;this.update=tagging.util.bind(function updatePiece(loggedItem){this._taggingContainer.logger.info(this.name,loggedItem);},this);this.update.info=tagging.util.bind(function updatePiece(loggedItem){this._taggingContainer.logger.info(this.name,loggedItem);},this);this.update.warn=tagging.util.bind(function updatePieceWarn(loggedItem){this._taggingContainer.logger.warn(this.name,loggedItem);},this);this.update.error=tagging.util.bind(function updatePieceError(loggedItem){this._taggingContainer.logger.error(this.name,loggedItem);},this);this.update.critical=tagging.util.bind(function updatePiececritical(loggedItem){this._taggingContainer.logger.critical(this.name,loggedItem);},this);this.dataStore=(function facadeDataStore(name,taggingContainer,realDataStore){var facade={};facade.get=function(storeName,options){taggingContainer.logger.info(name,"Getting DataStore Value from "+storeName);var tempVal=realDataStore.get(storeName,options);return tempVal;};facade.set=function(storeName,value,options){taggingContainer.logger.info(name,"Setting DataStore Value at "+storeName);var tempVal=realDataStore.set(storeName,value,options);taggingContainer.logger.info(name,"Set value is "+JSON.stringify(tempVal));return tempVal;};facade.register=function(registerName,options,populator){taggingContainer.logger.info(name,"Registering new Data Store Register "+registerName);var tempVal=realDataStore.register(registerName,options,populator);taggingContainer.logger.info(name,"Registration Complete with return of "+JSON.stringify(tempVal));return tempVal;};facade._dataStore=realDataStore;return facade;})(this.name,this._taggingContainer,this._dataStore);}else{var obj=new piece();var ret=piece.apply(obj,arguments);return ret===undefined?obj:ret;}}
piece.prototype.filter=function(){return this._filter===undefined?function(){return true;}:this._filter(this._taggingContainer,this.dataStore);};piece.prototype.isCompleteOrFail=function(){if(this.status==="complete"||this.status==="failed"){return true;}
return false;};piece.prototype.execute=function(){var that=this;return new oaPromise(function(resolve,reject){try{var result=that._activity(that._taggingContainer,that.dataStore,resolve,that.update);if(result!==undefined){resolve(result===undefined?true:result);}}catch(e){reject(e);}});};function t_queue(tagging,dataStore){var queue={};queue._utfversion="2018-06-04 23:40:44";queue.list={};queue.workingList=[];queue.workingQueue=[];queue._dataStore=dataStore;queue.taggingContainer=tagging;queue._notFinished=undefined;queue._counts=undefined;queue.errorCount=0;queue._maxErrorCount=4;queue.getTotalCount=function(){return this._counts.totalCount;};queue.getWorkingTotal=function(){return this._counts.workingCount;};queue._increment_TotalCounter=function(){if(this._counts===undefined){this._counts={workingCount:0,totalCount:0};}
this._counts.totalCount++;};queue._increment_WorkingCounter=function(){if(this._counts===undefined){this._counts={workingCount:0,totalCount:0};}
this._counts.workingCount++;};queue._decrement_WorkingCounter=function(){if(this._notFinished===undefined||this._notFinished===0){this._notFinished=this._counts.workingCount;}
this._notFinished--;};queue._startWorkingCounter=function(){this._notFinished=this._counts.workingCount;};queue._piecesNotComplete=function(){if(this._notFinished===undefined){var count=0;for(var key in this.list){if(this.list.hasOwnProperty(key)){if(!this.list[key].isCompleteOrFail){count++;}}}
this._notFinished=count;}
return this._notFinished;};queue._prepareWorkingList=function(){for(var i=this.workingList.length-1;i>-1;i--){this.workingQueue.push(this.workingList[i]);}};queue._processNext=function(){try{var _this=this;var curProcessName=this.workingQueue.pop();_this._decrement_WorkingCounter();var processPromise=new oaPromise(function(resolve,reject){var runCount=0;var maxRunCount=30;var errorCount=0;var maxError=3;var processName=curProcessName;var promise=oaRetryUntilResolve(maxError,function(){return _this._execute(curProcessName);},function(success){if(success||success===undefined){_this.taggingContainer.logger.info("queueProvider","process successful "+curProcessName);_this.taggingContainer.logger.info(curProcessName,"process successful "+curProcessName);errorCount=0;resolve(processName);}},function(error){errorCount++;_this.taggingContainer.logger.error("queueProvider",curProcessName+" Failed with exception:  "+error);_this.taggingContainer.logger.error("queueProvider",error);reject(error);},function(error,currentTry,maxTries){_this.taggingContainer.logger.error(curProcessName,curProcessName+
" failed to execute properly. Retried "+
currentTry+
" errors of "+
maxTries);_this.taggingContainer.logger.error(curProcessName,error);});});return processPromise;}catch(e){this.taggingContainer.logger.error("queueProvider",e);this._decrement_WorkingCounter();}};queue._execute=function(curProcessName){if(curProcessName===undefined){return oaPromise.Reject("Process name must be given");}
var curProcess=this.list[curProcessName];if(curProcess===undefined){this.taggingContainer.logger.warn("Process: "+curProcessName+" does not exist");return oaPromise.Reject("Process: "+curProcessName+" does not exist");}
var success=false;this.taggingContainer.logger.info(curProcessName,"Tag "+curProcessName+" processing in queue");try{var promise;if(curProcess.filter(this.taggingContainer,this._dataStore)){promise=new oaPromise(function(resolve,reject){try{var success=curProcess.execute();success.then(function(result){resolve(result);},function(error){reject(error);});}catch(e){reject(e);}});}else{promise=oaPromise.Resolve(false);this.taggingContainer.logger.warn(curProcessName,"Tag "+curProcessName+" failed filter. Skipping");}}catch(e){this.errorCount++;this.taggingContainer.logger.error("queueProvider","Process:"+curProcess.name);this.taggingContainer.logger.error("queueProvider",e);this.taggingContainer.logger.error(curProcessName,curProcessName+" failed to execute with error: "+e);}
return promise;};queue.addPiece=function(name,execution,options,filter){this.taggingContainer.logger.info(name,"Adding Tag "+name+" to queue");var newPiece=new piece(name,execution,filter,this.taggingContainer,this._dataStore);this.list[newPiece.name]=newPiece;if(options===undefined||!options.skip){this.workingList.push(newPiece.name);this._increment_WorkingCounter();}
this._increment_TotalCounter();};queue.runPiece=function(name){var _that=this;this.taggingContainer.logger.info("queueProvider",name+" being called to run");var success=_that._execute(name);success.then(function(result){_that.taggingContainer.logger.info("queueProvider",name+" executed with result of "+result);},function(error){_that.taggingContainer.logger.error("queueProvider",name+" rejected with result of "+error);_that.taggingContainer.logger.error("queueProvider",error);});return success;};queue.start=function(){this._prepareWorkingList();this._startWorkingCounter();var count=0;var promiseArray=[];while(this._notFinished>0){promiseArray.push(this._processNext());count++;}
var listenPromise=oaPromise.ListenAll(promiseArray);return listenPromise;};return queue;}
return t_queue(tagging,dataStore);};oaQueueProvider=window.oa.tagging.createQueueProvider(window.oa.tagging,window.oa.tagging.data.store);window.oa.tagging.queueProvider=oaQueueProvider;oaSetupProvider.addSetupFunc("Setup EU Zone Compliance",function(t,ds){ds.register("EUComplianceDebug",{defaultValue:undefined,autoPopSetting:"once"},function(register,values){return function(){console.log("isEUzone value               : "+ds.get("isEUzone"));console.log("hasUHF value                 : "+ds.get("hasUHF"));console.log("hasMSCCbanner value          : "+ds.get("hasMSCCbanner"));console.log("llcc value                   : "+ds.get("llcc"));console.log("llcc_body value              : "+ds.get("llcc_body"));console.log("lcid_url value               : "+ds.get("lcid_url"));console.log("processedLCID value          : "+ds.get("processedLCID"));console.log("isEULanginURL value          : "+ds.get("isEULanginURL"));console.log("haveEUConsent value          : "+ds.get("haveEUConsent"));console.log("hasEUFlaginURL value         : "+ds.get("hasEUFlaginURL"));console.log("MSCCCookie value         : "+ds.get("MSCCCookie").value);};});ds.register("hasUHF",{defaultValue:false,autoPopSetting:"once"},function(register,values){var jQuery=ds.get("jquery");var uhf=jQuery("#headerUniversalHeader").length;return uhf!==0;});ds.register("hasMSCCbanner",{defaultValue:false,autoPopSetting:"once"},function(register,values){var jQuery=ds.get("jquery");var msccBanner=jQuery("#msccBanner").length;return msccBanner!==0;});ds.register("hasEUFlaginURL",{defaultValue:true,autoPopSetting:"once"},function(register,values){var location=ds.get("location");var EUflagRegex=new RegExp(/eu=true/i);var EUflagmatch=location.search.match(EUflagRegex);return!!EUflagmatch;});ds.register("isEUzone",{defaultValue:true,autoPopSetting:"once"},function(register,values){try{var jQuery=ds.get("jquery");var euZoneLangLocs=["bg-bg","cs-cz","da-dk","de-at","de-ch","de-de","pl-pl","pt-pt","ro-ro","sk-sk","sl-si","sv-se","it-it","lt-lt","lv-lv","nb-no","nl-be","nl-nl","fi-fi","fr-be","fr-ch","fr-fr","hr-hr","hu-hu","el-gr","en-gb","en-ie","en-cy","es-es","et-ee"];var euZoneLangs=["bg","cs","da","de","pl","pt","ro","sk","sl","sv","it","lt","lv","nb","nl","fi","fr","hr","hu","el","en","es","et"];var langLoc=ds.get("llcc");var lcid=ds.get("lcid_url")!==null&&ds.get("lcid_url")[1]?ds.get("lcid_url")[1].toLowerCase():null;if((langLoc===null||langLoc===undefined||langLoc==="")&&(lcid===null||lcid===undefined)){return true;}else if(ds.get("isEULanginURL")){if(ds.get("isEULanginURL")==="en"){if(langLoc&&jQuery.inArray(langLoc,euZoneLangLocs)!==-1){return true;}else if(lcid&&jQuery.inArray(lcid,euZoneLangLocs)!==-1){return true;}}else{return true;}}
if(jQuery.inArray(langLoc,euZoneLangLocs)!==-1||jQuery.inArray(lcid,euZoneLangLocs)!==-1||(jQuery.inArray(lcid,euZoneLangs)!==-1&&lcid!=="en")){return true;}else{return false;}}catch(e){t.logger.error("Exception","isEUzone: exception defaulting to safe state");t.logger.error("Exception","isEUzone: "+e);return true;}});ds.register("UHFeuCookieAPIcall",{defaultValue:false,autoPopSetting:"once"},function(register,values){return values;});ds.register("euEventListener",{defaultValue:false,autoPopSetting:"once"},function(register,values){return values;});ds.register("lcid",{defaultValue:null,autoPopSetting:"once"},function(register,values){var jQuery=ds.get("jquery");lcid=jQuery("input[name='systemFormsLanguageLocaleProduct']").val();lcid=typeof lcid!=="undefined"?lcid.trim().substr(0,5):null;return lcid;});ds.register("lcid_url",{defaultValue:null,autoPopSetting:"once"},function(register,values){var location=ds.get("location");var lcidURLMatch=new RegExp(/LCID=(\w{2}(?:-\w{2})?)/i);return location.href.match(lcidURLMatch);});ds.register("processedLCID",{defaultValue:"en-gb",autoPopSetting:"always"},function(register,values){var lcid;if(ds.get("lcid_url")){lcid=ds.get("lcid_url")[1]?ds.get("lcid_url")[1].toLowerCase():null;}else{lcid=ds.get("lcid");}
if(lcid!==null){if(typeof lcid==="string"){lcid=lcid.split("-")[1];}else{lcid=lcid[1];}}else{if(lcid===null&&ds.get("isEULanginURL")){lcid=ds.get("isEULanginURL");}
if(lcid===null){try{var llcc=ds.get("llcc")!==null?ds.get("llcc").split("-"):ds.get("llcc_body").split("-");var ll=null;if(llcc){ll=llcc[0];}
if(ll!==null){lcid=ll;}}catch(e){t.logger.warn("getLCID","lcid unable to find language. Defaulting to en-gb");lcid="en-gb";}}}
return lcid;});ds.register("isEULanginURL",{defaultValue:null,autoPopSetting:"once"},function(register,values){try{var location=ds.get("location");var jQuery=ds.get("jquery");var path=location.pathname;var langReg=new RegExp(/^(?:\W)([a-zA-Z]{2})(?:\W)(?!([a-zA-Z]{2})(?:\/))/);var matches=path.match(langReg);var euZoneLangs=["bg","cs","da","de","pl","pt","ro","sk","sl","sv","it","lt","lv","nb","nl","fi","fr","hr","hu","el","en","es","et"];var langMatch=null;if(matches!==null){langMatch=matches[1].toLowerCase();}else{return false;}
if(jQuery.inArray(langMatch,euZoneLangs)!==-1){return langMatch;}else{return false;}}catch(e){t.logger.error("setup","EU Lang in URL error");t.logger.error("setup",e);t.logger.error("exception","EU Lang in URL error");t.logger.error("exception",e);return register._options.defaultValue;}});ds.register("MSCCCookie",{defaultValue:{value:null,present:false},autoPopSetting:"always"},function(register,values){var cookieValue=t.util.getCookie("MSCC");return{value:cookieValue,present:cookieValue!==null};});function setCookie(cname,cvalue,exdays){var d=new Date();d.setTime(d.getTime()+exdays*24*60*60*1000);var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";path=/";}
function getCookie(cname){var name=cname+"=";var decodedCookie=decodeURIComponent(document.cookie);var ca=decodedCookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===" "){c=c.substring(1);}
if(c.indexOf(name)===0){return c.substring(name.length,c.length);}}
return"";}
function checkCookie(cname){var valid=getCookie(cname);return valid!=="";}
function getLCID(refreshFlag){var refresh;refresh=!!refreshFlag;return ds.get("processedLCID",refresh);}
function displayBanner(response){var head=document.getElementsByTagName("head")[0];var banner=document.createElement("div");banner.id="cookie-banner";var firstBodyItem=document.querySelector("body>*:first-child");document.body.insertBefore(banner,firstBodyItem);document.getElementById("cookie-banner").innerHTML=response.Markup;var bannerCSS=document.createElement("link");bannerCSS.href=response.Css;bannerCSS.rel="stylesheet";bannerCSS.type="text/css";head.appendChild(bannerCSS);var bannerJS=document.createElement("script");bannerJS.src=response.Js[0];head.appendChild(bannerJS);}
function callAPI(locale,siteName,loadEUComplianceBannerFlag,suppressBannerLoad){var jQuery=ds.get("jquery");if(!ds.get("UHFeuCookieAPIcall")&&loadEUComplianceBannerFlag&&!ds.get("hasMSCCbanner")){ds.set("UHFeuCookieAPIcall",true);jQuery.ajax({url:"https://uhf.microsoft.com/"+
locale+
"/shell/api/mscc?domain="+
siteName+
"&mscc_eudomain=true",type:"GET",success:function(resp){var data=resp;if(document.getElementById("cookie-banner")===null){if(!suppressBannerLoad){displayBanner(data);}else{t.logger.warn("EUCheck","Supressing the banner load event due to supressBannerLoad flag");}}
return data;},error:function(){t.logger.error("EU Banner","Error receiving banner information from UHF API");}});}}
function checkConsent(loadEUComplianceBannerFlag,forceLoadBannerWithUHFFlag,suppressBannerLoad){var language=getLCID();var hasConsent=checkCookie("MSCC");if(!hasConsent&&!ds.get("hasMSCCbanner")&&(!ds.get("hasUHF")||forceLoadBannerWithUHFFlag)){if(window.MktoForms2){if(ds.get("MktoFormsListener")===undefined||ds.get("MktoFormsListener")===false){window.MktoForms2.whenReady(function(form){language=ds.get("lcid",true);if(!language){language=getLCID(true);}
callAPI(language,"microsoft.com",loadEUComplianceBannerFlag,suppressBannerLoad);});}
ds.set("MktoFormsListener",true);}else{callAPI(language,"microsoft.com",loadEUComplianceBannerFlag,suppressBannerLoad);}}
return hasConsent;}
function hasUHForMSCCBanner(){return!ds.get("hasUHF")&&!ds.get("hasMSCCbanner");}
function setBannerListener(consent,hasUHF,hasMSCCbanner,euEventListener_flag,forceSetListenerWithUHFFlag,jQuery){try{if(!consent&&!ds.get("hasMSCCbanner")&&(!ds.get("hasUHF")||forceSetListenerWithUHFFlag)&&!euEventListener_flag){ds.set("euEventListener",true);jQuery(document).ready(function(){jQuery(document).on("click","select, input, button, a",function(){setCookie("MSCC",Date.now(),355);jQuery("#cookie-banner").hide();});});}}catch(e){t.logger.error("EUcheck","EUcheck: setBannerListener erroring");t.logger.error("EUcheck","setBannerListener: "+e);return false;}}
function EUCheck(forceEUConsentCheckFlag,loadEUComplianceBannerFlag,forceLoadBannerWithUHFFlag,forceSetListenerWithUHFFlag,suppressBannerLoad){var areWeInEU=ds.get("isEUzone")||ds.get("hasEUFlaginURL");var jQuery=ds.get("jquery");if(areWeInEU||forceEUConsentCheckFlag){var hasConsent=checkConsent(loadEUComplianceBannerFlag,forceLoadBannerWithUHFFlag,suppressBannerLoad);var hasUHF=ds.get("hasUHF");var hasMSCCbanner=ds.get("hasMSCCbanner");var euEventListener=ds.get("euEventListener");setBannerListener(hasConsent,hasUHF,hasMSCCbanner,euEventListener,forceSetListenerWithUHFFlag,jQuery);return hasConsent;}
return true;}
ds.register("haveEUConsent",{defaultValue:"",autoPopSetting:"always"},function(register,values,options){try{function handleQueryStringToOptions(){var getQP=t.util.getQueryParam;if(getQP("cc")==="off"){options.suppressBannerLoad=true;}}
var forceEUConsentCheckFlag=false;var loadEUComplianceBannerFlag=true;var forceLoadBannerWithUHFFlag=false;var forceSetListenerWithUHFFlag=false;var suppressBannerLoad=false;handleQueryStringToOptions();if(options.forceEUConsentCheck){forceEUConsentCheckFlag=options.forceEUConsentCheck;}
if(options.loadEUComplianceBannerFlag){loadEUComplianceBannerFlag=options.loadEUComplianceBannerFlag;if(typeof loadEUComplianceBannerFlag!=="boolean"){loadEUComplianceBannerFlag=true;}}
if(options.forceLoadBannerWithUHFFlag){forceLoadBannerWithUHFFlag=options.forceLoadBannerWithUHFFlag;if(typeof forceLoadBannerWithUHFFlag!=="boolean"){forceLoadBannerWithUHFFlag=true;}}
if(options.forceSetListenerWithUHFFlag){forceSetListenerWithUHFFlag=options.forceSetListenerWithUHFFlag;if(typeof forceSetListenerWithUHFFlag!=="boolean"){forceSetListenerWithUHFFlag=true;}}
if(options.suppressBannerLoad){suppressBannerLoad=options.suppressBannerLoad;if(typeof suppressBannerLoad!=="boolean"){suppressBannerLoad=true;}}
return EUCheck(forceEUConsentCheckFlag,loadEUComplianceBannerFlag,forceLoadBannerWithUHFFlag,forceSetListenerWithUHFFlag,suppressBannerLoad);}catch(e){t.logger.warn("Exception","haveEUConsent: haveEUConsent failing. Defaulting to safe State");t.logger.warn("Exception","haveEUConsent: "+e);return false;}});},{utfversion:"2018-05-22 17:01:36"});oaSetupProvider.addSetupFunc("prepare_conversionListenerUtils",function(t,ds){ds.set("isIxpFormFound",function(){if(typeof window.ixp!=="undefined"&&typeof window.ixp.runtime!=="undefined"&&typeof window.ixp.runtime.components!=="undefined"){return(Object.keys(window.ixp.runtime.components.instancesByType).indexOf("ixp-form")!==-1);}else{return false;}},{defaultValue:false,autoPopSetting:"always"});ds.set("isConfirmationPage",function(location){var loc=location!==undefined?location:ds.get("location");var pathname=loc.pathname,href=loc.href,hostname=loc.hostname,jQuery=ds.get("jquery");var oa_sessionExists=document.cookie.indexOf("oa_session")!==-1;var returnVal=false;if(hostname==="info.microsoft.com"){if((pathname.match(/thank/i)&&oa_sessionExists)||(pathname.match(/confirm/i)&&oa_sessionExists)||(!jQuery("#formArea").length&&!jQuery("#formWrapper").length&&!jQuery(".event-listings").length&&oa_sessionExists)||href.indexOf("info.microsoft.com/CO-SQL-Trial-FY17-10Oct-Microsite-Trial-Download_Download-en-au")!==-1){returnVal=true;}}else if(hostname==="products.office.com"&&pathname.indexOf("en/tracking")!==-1){returnVal=true;}else if(hostname==="resources.office.com"){if((pathname.match(/thank/i)&&oa_sessionExists)||(pathname.match(/confirm/i)&&oa_sessionExists)){returnVal=true;}}else{}
return returnVal;},{defaultValue:null,autoPopSetting:"always"});ds.set("_arrayContainsValueFromOtherArray",function(sourceArray,referenceArray){if(!!sourceArray&&sourceArray.constructor===Object){var keys=[];for(var key in sourceArray)keys.push(key);sourceArray=keys;}
if(!!referenceArray&&referenceArray.constructor===Object){var keys=[];for(var key in referenceArray)keys.push(key);referenceArray=keys;}
var foundValues=[];var cachedValues={};for(var i=0;i<sourceArray.length;i++){var checkingVal=sourceArray[i];if(!cachedValues[checkingVal]){for(var b=0;b<referenceArray.length;b++){if(referenceArray[b]===checkingVal){foundValues.push(checkingVal);cachedValues[checkingVal]=true;}}}}
return foundValues;},{defaultValue:null,autoPopSetting:"once"});});oaSetupProvider.addSetupFunc("prepare_detectConversion",function(t,ds){ds.set("detectConversionLogic",function(options){var credited=options.credited;var knownLocation=!!options.knownLocation?options.knownLocation.toLowerCase():"";var order_type=!!options.order_type?options.order_type.toLowerCase():"";var skus=options.skus;var knownPageType=!!options.knownPageType?options.knownPageType.toLowerCase():"";var isOfficePurchase=ds.get("isOfficePurchase");var isOfficeTrial=ds.get("isOfficeTrial");var isDynamicsPurchase=ds.get("isDynamicsPurchase");var isDynamicsTrial=ds.get("isDynamicsTrial");var isStudentOrTeacher=ds.get("isStudentOrTeacher");var isPowerBiTrial=ds.get("isPowerBiTrial");var isAzureTrial=ds.get("isAzureTrial");var conversionLogics=null;try{if(knownLocation==="roc"&&knownPageType==="thankyou"){conversionLogics="office lead";}
if(knownLocation==="imc"&&knownPageType==="thankyou"){conversionLogics="ce lead";}
if(knownLocation==="techsummit"){conversionLogics="ce lead";}
if(knownLocation==="ms events"){conversionLogics="ce lead";}
if(knownLocation==="ms events::build"){conversionLogics="ce lead";}
if(knownLocation==="ms events::ignite"){conversionLogics="ce lead";}
if(knownLocation==="ms events::envision"){conversionLogics="ce lead";}
if(knownLocation==="ms events::businessappssummit"){conversionLogics="ce lead";}
if(knownLocation==="content"){conversionLogics="ce lead";}
if(knownLocation==="indigo"){conversionLogics="ce lead";}
if(credited&&knownLocation==="poc iframe"&&order_type==="commercial purchase complete"&&isOfficePurchase(skus)){conversionLogics="office commercial smb purchase";}
if(knownLocation==="poc iframe"&&order_type==="commercial trial complete"&&isOfficeTrial(skus)){conversionLogics="office commercial trial";}
if(knownLocation==="poc iframe"&&order_type==="signup complete"&&isStudentOrTeacher(skus)){conversionLogics="office student/teacher signup";}
if(knownLocation==="poc iframe"&&order_type==="commercial purchase complete"&&isDynamicsPurchase(skus)){conversionLogics="dynamics 365 purchase";}
if(knownLocation==="poc iframe"&&(order_type==="commercial trial complete"||order_type==="signup complete")&&isDynamicsTrial(skus)){conversionLogics="dynamics 365 trial";}
if(knownLocation==="poc iframe"&&order_type==="signup complete"&&isPowerBiTrial(skus)){conversionLogics="powerbi trial";}
if(knownLocation==="azure"&&!isAzureTrial(skus)){conversionLogics="azure purchase";}
if(knownLocation==="azure"&&isAzureTrial(skus)){conversionLogics="azure trial";}
if(knownLocation==="defender atp"){conversionLogics="windows trial";}}catch(e){t.logger.error("setup_conversionLogic","exception "+e);conversionLogics="";}
return conversionLogics;},{defaultValue:null,autoPopSetting:"once"});});oaSetupProvider.addSetupFunc("prepare_ctagData",function(t,ds){ds.set("cTagParam_default",{dl_sku:"[OFFER ID]",dl_seats:"[SEATS]",dl_order_id:"[ORDER ID]",c_size:"[EMPLOYEE SIZE]"},{defaultValue:{},autoPopSetting:"once"});ds.set("cTag_data",function ctag_data(knownLocation){"use strict";var tealiumDL=ds.get("tealiumDL");var location=ds.get("location");var jquery=ds.get("jquery");var dataPayload={llcc:"[LANGLOC]",dl_country:"[COUNTRY]",dl_assettype:"[ASSET TYPE]",dl_pageid:"[ASSET TYPE]",dl_sku:"[OFFER ID]",dl_seats:"[SEATS]",dl_order_id:"[ORDER ID]",c_size:"[EMPLOYEE SIZE]",guid:"[ORDER ID]",pageUrl:location.href};switch(knownLocation.toLowerCase()){case"imc":var pageId=jquery("meta[name='ms.ea_targetcampaign']")[0]?jquery("meta[name='ms.ea_targetcampaign']")[0]:"[ASSET TYPE]";if(!!pageId&&typeof pageId==="object"){pageId=pageId.content;}
var llcc=ds.get("llcc")&&ds.get("llcc")!==null?ds.get("llcc"):"[LANGLOC]";dataPayload.llcc=llcc;dataPayload.dl_country=llcc&&llcc!=="[LANGLOC]"&&llcc.indexOf("-")!==-1?llcc.split("-")[1]:"[COUNTRY]";dataPayload.dl_assettype=tealiumDL.asset_type?tealiumDL.asset_type:"[ASSET TYPE]";dataPayload.c_size=ds.get("company_size")?ds.get("company_size"):"[EMPLOYEE SIZE]";dataPayload.guid=ds.get("guid")?ds.get("guid"):"[ORDER ID]";dataPayload.dl_pageid=pageId;dataPayload.pageUrl=location.href;break;case"roc":var pageId=tealiumDL.universal_page_id?tealiumDL.universal_page_id:"[ASSET TYPE]";var llcc=ds.get("llcc")&&ds.get("llcc")!==null?ds.get("llcc"):"[LANGLOC]";dataPayload.llcc=llcc;dataPayload.dl_country=llcc&&llcc!=="[LANGLOC]"&&llcc.indexOf("-")!==-1?llcc.split("-")[1]:"[COUNTRY]";dataPayload.dl_assettype=tealiumDL.asset_type?tealiumDL.asset_type:"[ASSET TYPE]";dataPayload.c_size=ds.get("company_size")?ds.get("company_size"):"[EMPLOYEE SIZE]";dataPayload.guid=ds.get("guid")?ds.get("guid"):"[ORDER ID]";dataPayload.dl_pageid=pageId;dataPayload.pageUrl=location.href;break;case"poc iframe":var iframeValues=ds.get("dl_iframe_vals");var dl_matched=ds.get("dl_matched");var dl_matched_offers=dl_matched.matchedOffers||{};var credited=dl_matched.credited||undefined;var dl_type=iframeValues.dl_type;var dl_sku=iframeValues.dl_sku?iframeValues.dl_sku:"[OFFER ID]";var product_name="[PRODUCT NAME]";if(dl_sku.length>0&&Object.keys(dl_matched_offers).length>0){product_name=typeof credited!==undefined?dl_matched_offers[dl_sku[0]].offer_prod_full_name:product_name;}
var pageId=tealiumDL.universal_page_id?tealiumDL.universal_page_id:"[ASSET TYPE]";var llcc=ds.get("llcc")&&ds.get("llcc")!==null?ds.get("llcc"):"[LANGLOC]";dataPayload.llcc=llcc;dataPayload.dl_country=llcc&&llcc!=="[LANGLOC]"&&llcc.indexOf("-")!==-1?llcc.split("-")[1]:"[COUNTRY]";dataPayload.dl_assettype=tealiumDL.asset_type?tealiumDL.asset_type:"[ASSET TYPE]";dataPayload.c_size=ds.get("company_size")?ds.get("company_size"):"[EMPLOYEE SIZE]";dataPayload.dl_seats=iframeValues.dl_seats?iframeValues.dl_seats:"[SEATS]";dataPayload.dl_type=dl_type;dataPayload.dl_matched=dl_matched;dataPayload.credited=credited;dataPayload.dl_sku=dl_sku;dataPayload.dl_order_id=iframeValues.dl_order_id?iframeValues.dl_order_id:"[ORDER ID]";dataPayload.dl_locale=iframeValues.dl_locale?iframeValues.dl_locale:"[COUNTRY]";dataPayload.product_name=product_name;dataPayload.guid=ds.get("guid")?ds.get("guid"):"[ORDER ID]";dataPayload.dl_pageid=pageId;dataPayload.pageUrl=location.href;break;case"azure":dataPayload.offerID=ds
.get("location")
.search.match(/[?&]offer(Id)?=/gi)?ds
.get("location")
.search.match(/offer(Id)?=.[^&]+&?/gi)[0]
.split("=")[1]
.replace("&",""):"";dataPayload.order_id="[ORDER ID]";dataPayload.c_size=ds.get("company_size")?ds.get("company_size"):"[EMPLOYEE SIZE]";break;case"content":case"defender atp":var pageId=jquery("meta[name='ms.ea_targetcampaign']")[0]?jquery("meta[name='ms.ea_targetcampaign']")[0]:"[ASSET TYPE]";if(!!pageId&&typeof pageId==="object"){dataPayload.dl_pageid=pageId.content;}else{dataPayload.dl_pageid=pageId;}
var llcc=ds.get("llcc")&&ds.get("llcc")!==null?ds.get("llcc"):"[LANGLOC]";dataPayload.dl_country=llcc&&llcc!=="[LANGLOC]"&&llcc.indexOf("-")!==-1?llcc.split("-")[1]:"[COUNTRY]";dataPayload.guid=ds.get("guid")?ds.get("guid"):"[ORDER ID]";dataPayload.c_size=ds.get("company_size")?ds.get("company_size"):"[EMPLOYEE SIZE]";break;case"indigo":var pageId=jquery("meta[name='ms.ea_targetcampaign']")[0]?jquery("meta[name='ms.ea_targetcampaign']")[0]:"[ASSET TYPE]";if(!!pageId&&typeof pageId==="object"){dataPayload.dl_pageid=pageId.content;}else{dataPayload.dl_pageid=pageId;}
var llcc=ds.get("llcc")&&ds.get("llcc")!==null?ds.get("llcc"):"[LANGLOC]";dataPayload.dl_country=llcc&&llcc!=="[LANGLOC]"&&llcc.indexOf("-")!==-1?llcc.split("-")[1]:"[COUNTRY]";dataPayload.guid=ds.get("guid")?ds.get("guid"):"[ORDER ID]";dataPayload.c_size=document.getElementById("companysize").options[document.getElementById("companysize").selectedIndex].text?document.getElementById("companysize").options[document.getElementById("companysize").selectedIndex].text:"[Company Size]";break;case"techsummit":var pageId=jquery("meta[name='ms.ea_targetcampaign']")[0]?jquery("meta[name='ms.ea_targetcampaign']")[0]:"[ASSET TYPE]";if(!!pageId&&typeof pageId==="object"){dataPayload.dl_pageid=pageId.content;}else{dataPayload.dl_pageid=pageId;}
var llcc=ds.get("llcc");var eventcore_llcc=ds.get("llcc_MeControl");if(llcc&&llcc!==null){dataPayload.llcc=llcc;}else if(eventcore_llcc&&eventcore_llcc!==null){dataPayload.llcc=eventcore_llcc;}
dataPayload.dl_country=llcc&&llcc!=="[LANGLOC]"&&llcc.indexOf("-")!==-1?llcc.split("-")[1]:"[COUNTRY]";dataPayload.guid=ds.get("guid")?ds.get("guid"):"[ORDER ID]";dataPayload.c_size=ds.get("company_size")?ds.get("company_size"):"[EMPLOYEE SIZE]";break;case"ms events":case"ms events::ignite":case"ms events::envision":case"ms events::build":var pageId=jquery("meta[name='ms.ea_targetcampaign']")[0]?jquery("meta[name='ms.ea_targetcampaign']")[0]:"[ASSET TYPE]";if(!!pageId&&typeof pageId==="object"){dataPayload.dl_pageid=pageId.content;}else{dataPayload.dl_pageid=pageId;}
var llcc=ds.get("llcc");var eventcore_llcc=ds.get("llcc_MeControl");if(llcc&&llcc!==null){dataPayload.llcc=llcc;}else if(eventcore_llcc&&eventcore_llcc!==null){dataPayload.llcc=eventcore_llcc;}
dataPayload.dl_country=llcc&&llcc!=="[LANGLOC]"&&llcc.indexOf("-")!==-1?llcc.split("-")[1]:"[COUNTRY]";dataPayload.guid=ds.get("guid")?ds.get("guid"):"[ORDER ID]";dataPayload.c_size=ds.get("company_size")?ds.get("company_size"):"[EMPLOYEE SIZE]";break;}
return dataPayload;},{defaultValue:{},autoPopSetting:"once"});});oaSetupProvider.addSetupFunc("prepare_setConversionListeners",function(t,ds){ds.set("addConversionListener",function(knownLocation,callback){var listenerName=false;switch(knownLocation){case"roc":case"imc":if(!ds.get("isConfirmationPage")()){listenerName="setMarketoConversionListener";}
break;case"signup azure":listenerName="setSignupAzureConversionListener";break;case"content":listenerName="setContentMicrosoftConversionListener";break;case"ms events":listenerName="setMSEventsConversionListener";break;case"defender atp":listenerName="windowsTrialConversionListener";break;case"techsummit":case"ms events::build":listenerName="setEventcoreConversionListener";break;case"ms events::ignite":case"ms events::envision":case"ms events::businessappssummit":listenerName="setEventcoreConfirmRegConversionListener";break;case"indigo":listenerName="setIndigoConversionListener";break;default:return null;}
return listenerName?ds.get(listenerName)(knownLocation,callback):null;},{defaultValue:null,autoPopSetting:"always"});ds.set("setMarketoConversionListener",function(knownLocation,callback){var jquery=ds.get("jquery");var isDebug=ds.get("isDebug");var marketoListenerLogic=function(marketo,knownLocation,callback){var allForms=marketo.allForms().constructor===Array?marketo.allForms():[];for(var i=0;i<allForms.length;i++){var form=allForms[i];var formSelector=form.getFormElem().selector;var eventName=isDebug?"contextmenu":"submit";jquery(formSelector).on(eventName,function(event){var ctag_data=ds.get("cTag_data")(knownLocation);ctag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():"",knownPageType:"thankyou"});var form=event.currentTarget;var formId=false;if(form.tagName==="FORM"&&form.id&&form.id.match("mktoForm_")!==null){formId=form.id.split("mktoForm_")[1];}
if(formId&&marketo.getForm(formId).validate()){ctag_data.eventData=event;ds.set("cData",ctag_data);callback(ctag_data);}});}};var marketo=window.MktoForms2;if(!marketo){return null;}
if(typeof marketo.allForms==="function"&&marketo.allForms().constructor===Array&&marketo.allForms().length!==0){marketoListenerLogic(marketo,knownLocation,callback);}else{marketo.whenReady(function(){marketoListenerLogic(marketo,knownLocation,callback);});}
return true;},{defaultValue:null,autoPopSetting:"always"});ds.set("setSignupAzureConversionListener",function(knownLocation,callback){var currentLocation=ds.get("location");var wlh=currentLocation.hostname;var href=currentLocation.href;var signupAzure="signup.azure.com";var accountAzure="account.azure.com";var accountAzureConfirmationPage=accountAzure+"/signuplanding/index";var isSignupAzure=wlh===signupAzure;var isAccountAzureConfirmationPage=wlh===accountAzure&&href.toLowerCase().match(accountAzureConfirmationPage);try{var cTag_data=ds.get("cTag_data")(knownLocation);cTag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():"",skus:[cTag_data.offerID.toLowerCase()]});if(isSignupAzure){document.addEventListener("kpiEvent",function(event){var detail=event.detail;var message=detail&&typeof detail.message==="string"?detail.message:null;if(message!==null&&message==="PurchaseComplete"){try{var additionalInfo=detail.additionalInfo&&detail.additionalInfo!==null?JSON.parse(detail.additionalInfo):{};cTag_data.commerceSubscriptionId=additionalInfo.commerceSubscriptionId?additionalInfo.commerceSubscriptionId:"[Commerce Subscription ID]";cTag_data.azureSubscriptionId=additionalInfo.azureSubscriptionId?additionalInfo.azureSubscriptionId:"[Azure Subscription ID]";cTag_data.eventData=detail;ds.set("cData",cTag_data);callback(cTag_data);}catch(error){t.logger.error("setSignupAzureConversionListener","Failed to handle signup.azure.com conversion flow");t.logger.error("setSignupAzureConversionListener",error);}}});}else if(isAccountAzureConfirmationPage){try{var accountAzureSubId=null;if(typeof window.Signup!=="undefined"&&typeof window.Signup.Landing!=="undefined"){accountAzureSubId=window.Signup.Landing.resources.SubscriptionId?window.Signup.Landing.resources.SubscriptionId:null;}
cTag_data.commerceSubscriptionId=accountAzureSubId!==null?accountAzureSubId:"[Commerce Subscription ID]";cTag_data.azureSubscriptionId=accountAzureSubId!==null?accountAzureSubId:"[Azure Subscription ID]";window.oa.tagging.eventDriver.oaPromise(function(){ds.set("cData",cTag_data);callback(cTag_data);});}catch(error){t.logger.error("setSignupAzureConversionListener","Failed to handle account.azure.com conversion flow");t.logger.error("setSignupAzureConversionListener",error);return null;}}else{return null;}
return true;}catch(error){t.logger.error("setSignupAzureConversionListener",error);return null;}},{defaultValue:null,autoPopSetting:"always"});ds.set("setContentMicrosoftConversionListener",function(knownLocation,callback){try{var jquery=ds.get("jquery");var isDebug=ds.get("isDebug");var ixpListenerReady=ds.get("ixpListenerReady");if(ixpListenerReady===undefined)ds.set("ixpListenerReady",false);var isValidIxpObj=function(ixpObjInstance){return(ixpObjInstance&&Object.keys(ixpObjInstance).length>0&&typeof ixpObjInstance.runtime!=="undefined"&&typeof ixpObjInstance.runtime.components!=="undefined"&&typeof ixpObjInstance.runtime.components.instances!=="undefined"&&typeof ixpObjInstance.runtime.components.instancesByType!=="undefined");};var ixpListenerLogic=function(ixpObj,ctag_data,callback){if(!isValidIxpObj(ixpObj)){window.oa.tagging.logger.error("setContentMicrosoftConversionListener","Form information unavailable");return null;}
var ic=ixpObj.runtime.components;if(!ic.instancesByType["ixp-form"]){window.oa.tagging.logger.error("setContentMicrosoftConversionListener","Failed to find form on page at page load");return null;}else{var allForms=typeof ic.instancesByType["ixp-form"]!=="undefined"&&ic.instancesByType["ixp-form"].constructor===Object?Object.keys(ic.instancesByType["ixp-form"]):[];var isIxpRegistrationForm=typeof ic.instancesByType["ixp-textbox"]!=="undefined"&&ic.instancesByType["ixp-textbox"].constructor===Object?Object.keys(ic.instancesByType["ixp-textbox"]).length>1:false;if(!isIxpRegistrationForm){window.oa.tagging.logger.error("setContentMicrosoftConversionListener","Form does not appear to be a valid registration form");return null;}
for(var i=0;i<allForms.length;i++){var form=allForms[i];var formSelector=ic.instances[form]!=="undefined"&&ic.instances[form].instance&&ic.instances[form].instance["$el"]?ic.instances[form].instance["$el"].selector:"";var eventName=isDebug?"contextmenu":"submit";jquery(formSelector).on(eventName,function(event){var ctag_data=ds.get("cTag_data")(knownLocation);ctag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():""});window.oa.tagging.logger.info("setContentMicrosoftConversionListener","Firing...");ctag_data.eventData=event;ds.set("cData",ctag_data);callback(ctag_data);});}}
window.oa.tagging.logger.info("setContentMicrosoftConversionListener","IXP ready state triggered; listener now fully set up");ds.set("ixpListenerReady",true);return true;};if(!window.ixp){return null;}else{ixp.runtime.ready(function(){ixpListenerLogic(window.ixp,knownLocation,callback);});return true;}}catch(error){window.oa.tagging.logger.error("setContentMicrosoftConversionListener",error);return null;}},{defaultValue:null,autoPopSetting:"always"});ds.set("setEventcoreConversionListener",function(knownLocation,callback){try{var ctag_data=ds.get("cTag_data")(knownLocation);ctag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():""});var location=ds.get("location");var isRegistrationSite=location.hostname.match(/(register\.[a-zA-Z]+\.microsoft\.com|\.eventcore\.com)/i);if(isRegistrationSite){var isNewRegistration;if(location.pathname.match(/\/edit\/?$/i)&&document.querySelector("script[src*='/edit/confirmcomplete']")!==null){isNewRegistration=true;}else{isNewRegistration=false;}
if(isNewRegistration){window.oa.tagging.eventDriver.oaPromise(function(){ds.set("cData",ctag_data);callback(ctag_data);});return true;}else{return null;}}else{return null;}}catch(error){window.oa.tagging.logger.error("setEventcoreConversionListener",error);return null;}},{defaultValue:null,autoPopSetting:"always"});ds.set("setEventcoreConfirmRegConversionListener",function(knownLocation,callback){try{var ctag_data=ds.get("cTag_data")(knownLocation);ctag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():""});var location=ds.get("location");var isRegistrationSite=location.hostname.match(/(register\.[a-zA-Z]+\.microsoft\.com)|(eventcore\.com)/i);if(isRegistrationSite){var isNewRegistration;var regSrc=document.querySelector("script[src*='/edit/confirmregistration'][src*='userCount='][src*='registrantID=']");if(regSrc!==null){isNewRegistration=true;ctag_data.numRegistrations=regSrc.src
.split("userCount=")[1]
.split("&")[0];ctag_data.registrantId=regSrc.src
.split("registrantID=")[1]
.split("&")[0];}else{isNewRegistration=false;}
if(isNewRegistration){window.oa.tagging.eventDriver.oaPromise(function(){ds.set("cData",ctag_data);callback(ctag_data);});return true;}else{return null;}}else{return null;}}catch(error){window.oa.tagging.logger.error("setEventcoreConfirmRegConversionListener",error);return null;}},{defaultValue:null,autoPopSetting:"always"});ds.set("setIndigoConversionListener",function(knownLocation,callback){var jquery=ds.get("jquery");var isDebug=ds.get("isDebug");try{var ctag_data=ds.get("cTag_data")(knownLocation);ctag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():""});var buttonSelector="marketo-continue-button";var location=ds.get("location");var isDataModernizationPlannerSite=location.hostname.match(/datamodernizationplanner.azurewebsites.net/i)&&location.pathname=="/";if(isDataModernizationPlannerSite){var eventName=isDebug?"contextmenu":"click";jquery(document).on(eventName,function(event){if(this.path.length>0){for(var i=0;i<this.path.length;i++){if(this.path[i].id==buttonSelector){var ctag_data=ds.get("cTag_data")(knownLocation);ctag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():"",knownPageType:"thankyou"});ds.set("cData",ctag_data);callback(ctag_data);}}}
if(this.target.id===buttonSelector){var ctag_data=ds.get("cTag_data")(knownLocation);ctag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():"",knownPageType:"thankyou"});ds.set("cData",ctag_data);callback(ctag_data);}});return true;}else{return null;}}catch(error){window.oa.tagging.logger.error("setIndigoConversionListener",error);return null;}},{defaultValue:null,autoPopSetting:"always"});ds.set("msEventsRegistrationComplete",false);ds.set("setMSEventsConversionListener",function(knownLocation,callback){try{var location=ds.get("location");var isRegistrationSite=location.hostname.match(/microsoftevents\.com/i);var isDebug=ds.get("isDebug");var jQuery=ds.get("jquery");var gc=t.util.getCookie;var dc=t.util.deleteCookie;var cc=t.util.createCookie;var errorsSelector="#errorStack";var msEventsCookieName="oa_MSEventsRegSubmitted";var msEventsCookie=gc(msEventsCookieName);var fireMSEventsConversion=function(){if(msEventsCookie)dc(msEventsCookieName);window.oa.tagging.eventDriver.oaPromise(function(){var ctag_data=ds.get("cTag_data")(knownLocation);ctag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():""});ds.set("cData",ctag_data);callback(ctag_data);});};if(isRegistrationSite){if(msEventsCookie&&msEventsCookie==="true"&&jQuery(errorsSelector).length===0){ds.set("msEventsRegistrationComplete",true);}
if(ds.get("msEventsRegistrationComplete")){fireMSEventsConversion();return true;}else{var formSelector=isDebug?"#submitForm":"form";if(jQuery(formSelector).length>0){var eventName=isDebug?"contextmenu":"submit";jQuery(formSelector).on(eventName,function(){if(isDebug){ds.set("msEventsRegistrationComplete",true);fireMSEventsConversion();}else{if(!msEventsCookie)cc(msEventsCookieName,"true");}});return true;}else{return null;}}}else{return null;}}catch(error){window.oa.tagging.logger.error("setMSEventsConversionListener",error);return null;}},{defaultValue:null,autoPopSetting:"always"});ds.set("windowsTrialSignupComplete",false);ds.set("windowsTrialConversionListener",function(knownLocation,callback){try{var location=ds.get("location");var isRegistrationSite=location.pathname.match(/(ContactInformation|Finish)$/i);var isDebug=ds.get("isDebug");var jQuery=ds.get("jquery");var gc=t.util.getCookie;var dc=t.util.deleteCookie;var cc=t.util.createCookie;var errorsSelector=".field-validation-error";var successPageSelector=".registration-content-justified";var winTrialCookieName="oa_winTrialRegSubmitted";var winTrialCookie=gc(winTrialCookieName);var fireWinTrialConversion=function(){if(winTrialCookie)dc(winTrialCookieName);window.oa.tagging.eventDriver.oaPromise(function(){var ctag_data=ds.get("cTag_data")(knownLocation);ctag_data.conversionType=ds.get("detectConversionLogic")({knownLocation:knownLocation?knownLocation.toLowerCase():""});ds.set("cData",ctag_data);callback(ctag_data);});};if(isRegistrationSite){if(winTrialCookie&&winTrialCookie==="true"&&jQuery(errorsSelector).length===0&&jQuery(successPageSelector).length>0){ds.set("windowsTrialSignupComplete",true);}
if(ds.get("windowsTrialSignupComplete")){fireWinTrialConversion();return true;}else{var formSelector=isDebug?"#contactInformationSubmit":"form";if(jQuery(formSelector).length>0){var eventName=isDebug?"contextmenu":"submit";jQuery(formSelector).on(eventName,function(){if(isDebug){ds.set("windowsTrialSignupComplete",true);fireWinTrialConversion();}else{if(!winTrialCookie)cc(winTrialCookieName,"true");}});return true;}else{return null;}}}else{return null;}}catch(error){window.oa.tagging.logger.error("windowsTrialConversionListener",error);return null;}},{defaultValue:null,autoPopSetting:"always"});});oaSetupProvider.addSetupFunc("prepare_conversionlogic",function(t,ds){ds.set("studentOrTeacher",["78e66a63-337a-4a9a-8959-41c6654dfb56","e82ae690-a2d5-4d76-8d30-7c6e01e6022e","314c4481-f395-4525-be8b-2ec4bb1e9d91","94763226-9b3c-4e75-a931-5c89701abe66"],{defaultValue:{},autoPopSetting:"once"});ds.set("dynamics_purchase",["95142fe2-f5e1-4585-88c0-f2d0f0f84f35","7d99fd82-7195-410d-a9d0-2d3a144d8606","4fe1cd4d-88c3-4a81-8235-0ba2b49bba9f","39ce6204-6bb5-4ff1-a2a7-3b03c53731c1"],{defaultValue:{},autoPopSetting:"once"});ds.set("dynamics_trial",["6a4a1628-9b9a-424d-bed5-4118f0ede3fd","fcecd1f9-a91e-488d-a918-a96cdb6ce2b0","338148b6-1b11-4102-afb9-f92b6cdc0f8d","bd569279-37f5-4f5c-99d0-425873bb9a4b","dcb1a3ae-b33f-4487-846a-a640262fadf4"],{defaultValue:{},autoPopSetting:"once"});ds.set("powerBi_trial",["a403ebcc-fae0-4ca2-8c8c-7a907fd6c235"],{defaultValue:{},autoPopSetting:"once"});ds.set("azure_offerId",["ms-azr-0044p"],{defaultValue:{},autoPopSetting:"once"});ds.set("isOfficePurchase",function(skus){var isDynamicsPurchase=ds.get("isDynamicsPurchase");return!isDynamicsPurchase(skus);},{defaultValue:null,autoPopSetting:"once"});ds.set("isOfficeTrial",function(skus){var isDynamicsTrial=ds.get("isDynamicsTrial");return!isDynamicsTrial(skus);},{defaultValue:null,autoPopSetting:"once"});ds.set("isDynamicsPurchase",function(skus){var dynamicsPurchaseSkus=ds.get("dynamics_purchase");var checkArrays=ds.get("_arrayContainsValueFromOtherArray");return checkArrays(skus,dynamicsPurchaseSkus).length>0;},{defaultValue:null,autoPopSetting:"once"});ds.set("isDynamicsTrial",function(skus){var dynamicsTrialSkus=ds.get("dynamics_trial");var checkArrays=ds.get("_arrayContainsValueFromOtherArray");return checkArrays(skus,dynamicsTrialSkus).length>0;},{defaultValue:null,autoPopSetting:"once"});ds.set("isStudentOrTeacher",function(skus){var studentTeacherSkus=ds.get("studentOrTeacher");var checkArrays=ds.get("_arrayContainsValueFromOtherArray");return checkArrays(skus,studentTeacherSkus).length>0;},{defaultValue:null,autoPopSetting:"once"});ds.set("isPowerBiTrial",function(skus){var powerBiSkus=ds.get("powerBi_trial");var checkArrays=ds.get("_arrayContainsValueFromOtherArray");return checkArrays(skus,powerBiSkus).length>0;},{defaultValue:null,autoPopSetting:"once"});ds.set("isAzureTrial",function(skus){var azureTrialoffers=ds.get("azure_offerId");var checkArrays=ds.get("_arrayContainsValueFromOtherArray");return checkArrays(skus,azureTrialoffers).length>0;},{defaultValue:null,autoPopSetting:"once"});});oaSetupProvider=window.oa.tagging.setupProvider;oaDataStore=window.oa.tagging.data.store;oaQueueProvider=window.oa.tagging.queueProvider;oaDataStore.register("location",{defaultValue:"",autoPopSetting:"once"},function(register,values){return document.location;});oaDataStore.register("isDebug",{defaultValue:false,autoPopSetting:"once"},function(register,values){return(oaDataStore.get("location").search.indexOf("tealium=1")!==-1||window.oa.tagging.util.getCookie("cfDebug")==="true");});oaDataStore.register("enrichments",{defaultValue:undefined,autoPopSetting:"once"},function(register,values){try{if(window.utag.globals){return window.utag.globals.dle.enrichments;}else{window.oa.tagging.logger.warn("enrichments","Unable to locate window.utag.globals for DLE");return null;}}catch(e){window.oa.tagging.logger.error("setup","Enrichments error");window.oa.tagging.logger.error("setup",e);return null;}});oaDataStore.register("enrichments_obj",{defaultValue:null,autoPopSetting:"once"},function(register,values){try{var enrichments=oaDataStore.get("enrichments");var location=oaDataStore.get("location");for(var prop in enrichments){if(prop.indexOf(location.hostname.replace(/\./g,"-"))!==-1){return enrichments[prop];}}
return null;}catch(e){window.oa.tagging.logger.error("setup","Enrichments error");window.oa.tagging.logger.error("setup",e);return null;}});oaDataStore.register("query_string",{defaultValue:"",autoPopSetting:"once"},function(register,values){var qd={};if(location.search)
location.search
.substr(1)
.split("&")
.forEach(function(item){var s=item.split("="),k=s[0],v=s[1]&&decodeURIComponent(s[1]);(qd[k]=qd[k]||[]).push(v);});return qd;});oaDataStore.register("jquery",{defaultValue:{},autoPopSetting:"once"},function(register,values){if(window.jQuery){return window.jQuery;}else{return window.oa.tagging.util.jQuery;}});oaSetupProvider.addSetupFunc("getMC1",function(t,ds){ds.register("mc1",{defaultValue:null,autoPopSetting:"always"},function(register,values){var cookie2=t.util.getCookie("MC1");var GUID="";if(cookie2){try{GUID=cookie2.split("=")[1].split("&")[0];}catch(e){GUID="";}}
return GUID;});});oaSetupProvider.addSetupFunc("getMSFPC",function(t,ds){ds.register("msfpc",{defaultValue:null,autoPopSetting:"always"},function(register,values){var msfpc=t.util.getCookie("MSFPC");msfpc=msfpc!==null?msfpc.match(/((?:id=)|(?:guid=))(([a-z]|[0-9])*)/i)[2]:false;t.setup.complete.getMSFPC=register.values===true;return msfpc;});ds.get("msfpc",true);});oaSetupProvider.addSetupFunc("getANID",function(t,ds){ds.register("anid",{defaultValue:"",autoPopSetting:"always"},function(register,values){return document.cookie.match(/anon=a=(.*)&/i)!==null?document.cookie.match(/anon=a=(.*)&/i)[1]:0;});});oaSetupProvider.addSetupFunc("setguid",function(t,ds){ds.register("guid",{defaultValue:null,autoPopSetting:"once"},function(register,values){function generateGUID(){function uuidv4(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(c){return(c^(crypto.getRandomValues(new Uint8Array(1))[0]&(15>>(c/4)))).toString(16);});}
function uuid_safe(){var lut=[];for(var i=0;i<256;i++){lut[i]=(i<16?"0":"")+i.toString(16);}
function e7(){var d0=(Math.random()*0xffffffff)|0;var d1=(Math.random()*0xffffffff)|0;var d2=(Math.random()*0xffffffff)|0;var d3=(Math.random()*0xffffffff)|0;return(lut[d0&0xff]+
lut[(d0>>8)&0xff]+
lut[(d0>>16)&0xff]+
lut[(d0>>24)&0xff]+
"-"+
lut[d1&0xff]+
lut[(d1>>8)&0xff]+
"-"+
lut[((d1>>16)&0x0f)|0x40]+
lut[(d1>>24)&0xff]+
"-"+
lut[(d2&0x3f)|0x80]+
lut[(d2>>8)&0xff]+
"-"+
lut[(d2>>16)&0xff]+
lut[(d2>>24)&0xff]+
lut[d3&0xff]+
lut[(d3>>8)&0xff]+
lut[(d3>>16)&0xff]+
lut[(d3>>24)&0xff]);}
return e7();}
try{return uuidv4();}catch(err){return uuid_safe();}}
return generateGUID();});ds.register("shortguid",{defaultValue:null,autoPopSetting:"once"},function(register,values){var guid=ds.get("guid");return t.util.encodeASCII85(t.util.guidToBytes(guid));});ds.register("shortguid_func",{defaultValue:null,autoPopSetting:"once"},function(register,values){return function(guidVal){var guid=guidVal;try{return t.util.encodeASCII85(t.util.guidToBytes(guid));}catch(e){window.oa.tagging.logger.error("shortguid_func","unable to convert guid");return null;}};});ds.register("noncryptoshortid",{defaultValue:null,autoPopSetting:"once"},function(register,values){function randomString(len,charSet){charSet=charSet||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";var randomString="";for(var i=0;i<len;i++){var randomPoz=Math.floor(Math.random()*charSet.length);randomString+=charSet.substring(randomPoz,randomPoz+1);}
return randomString;}
if(ds.get("isDebug")){return ds.get("shortguid_func")?ds.get("shortguid_func")(window.orderId):"testordershortid";}
return randomString(20);});});oaSetupProvider.addSetupFunc("getLLCC",function(t,ds){ds.register("llcc_full",{defaultValue:null,autoPopSetting:"always"},function(register,values){var url=ds.get("location").href;var match=new RegExp(/((?:\W|_)([a-zA-Z]{2}-[a-zA-Z]{2})(?:\W|_|$))|((?:\W|_)[a-z]{2}-[a-z]{4}-[a-z]{2}(?:\W|_))|(\/[a-zA-Z]{2}\/)/i);return url.match(match);});ds.register("llcc",{defaultValue:"",autoPopSetting:"once"},function(register,values){var tempLLCC=ds.get("llcc_full")!==null?ds.get("llcc_full")[2].toLowerCase():null;t.setup.complete.getLLCC=true;return tempLLCC;});ds.register("llcc_body",{defaultValue:null,autoPopSetting:"always"},function(register,values){try{return document
.getElementsByTagName("body")[0]
.getAttribute("lang")
.toLowerCase();}catch(error){t.logger.warn("llcc_body","Unable to retrieve llcc_body.");t.logger.warn("llcc_body",error);return null;}});ds.register("llcc_html",{defaultValue:null,autoPopSetting:"always"},function(register,values){try{return document
.getElementsByTagName("html")[0]
.getAttribute("lang")
.toLowerCase();}catch(error){t.logger.error("llcc_html","Error when retrieving llcc_html.");t.logger.error("llcc_html",error);return null;}});ds.register("llcc_MeControl",{defaultValue:null,autoPopSetting:"always"},function(register,values){try{var global=window;var msa=global.MSA;if(msa&&msa.MeControl&&msa.MeControl.Config){var market=msa.MeControl.Config.mkt;return market&&typeof market==="string"&&market.length>0?market.toLowerCase():null;}else{return null;}}catch(error){t.logger.error("llcc_MeControl","Error when retrieving llcc_MeControl.");t.logger.error("llcc_MeControl",error);return null;}});ds.get("llcc",true);});oaSetupProvider.addSetupFunc("Setup oa_session",function(t,ds){ds.register("oa_session",{defaultValue:null,autoPopSetting:"once"},function(register,values){var oa_session=t.util.getCookie("oa_session");var isConfirmationPage=ds.get("isConfirmationPage")();if(oa_session===null&&isConfirmationPage===false){oa_session=ds.get("guid");document.cookie="oa_session="+oa_session;}
return oa_session;});});oaSetupProvider.addSetupFunc("getTealiumDL",function(t,ds){ds.register("tealiumDL",{defaultValue:[],autoPopSetting:"once"},function(register,values){try{var u=ds.get("enrichments");if(u===null||u===undefined){return[];}
var tealium={};for(var dl in u){if(typeof u[dl]==="object"){for(var prop in u[dl]){tealium[prop]=u[dl][prop];}}}
t.setup.complete.getTealiumDL=true;return tealium;}catch(e){window.oa.tagging.logger.error("setup","Error in get tealiumDL");window.oa.tagging.logger.error("setup",e);return[];}});ds.get("tealiumDL",true);});oaSetupProvider.addSetupFunc("matchFwLinks",function(t,ds){ds.register("anchorTags",undefined,function(register,values){return document.getElementsByTagName("a");});ds.register("fwlinks",{defaultValue:false,autoPopSetting:"once"},function(register,values){var anchorTags=ds.get("anchorTags",true);var arr=[];for(var i=0;i<anchorTags.length;i++){var f=anchorTags[i];var match;if(f.href&&f.href.indexOf("go.microsoft.com")!==-1&&f.href.match(/linkid/i)){match=f.href.match(/linkid=(.*)&?/i);match!==null&&match!==undefined?arr.push(match[1].split("&")[0]):"";}}
return arr.length!==0?arr:false;});ds.register("matchedfwlinks",undefined,function(register,values){var fwlinks=ds.get("fwlinks");var dle=ds.get("tealiumDL");var dleKeys=Object.keys(dle);var matchedFwLinks={};var notMatchedFwlinks={};var credited=false;if(fwlinks!==false){for(var i=0;i<dleKeys.length;i++){var fwlink=dle[dleKeys[i]].fwlink_id;if(fwlinks.indexOf(fwlink)!==-1){matchedFwLinks[dleKeys[i]]=dle[dleKeys[i]];}else{notMatchedFwlinks[dleKeys[i]]=dle[dleKeys[i]];}}
if(matchedFwLinks!==undefined&&Object.keys(matchedFwLinks).length>0){for(var x in matchedFwLinks){if(matchedFwLinks[x].offer_license_type==="subscription"){credited=true;break;}}}}
var t_obj={};t_obj.matchedFwLinks=matchedFwLinks;t_obj.notMatchedFwlinks=notMatchedFwlinks;t_obj.credited=credited;return t_obj;});return true;});oaSetupProvider.addSetupFunc("product_setup",function(t,ds){ds.register("product",{defaultValue:[],autoPopSetting:"once"},function(register,values){var matchedFwlinks=ds.get("matchedfwlinks").matchedFwLinks;if(!Object.keys){Object.keys=function(object){var keys=[];for(var key in object){if(object.hasOwnProperty(key)){keys.push(key);}}};}
return Object.keys(matchedFwlinks);});ds.register("product_string",{defaultValue:[],autoPopSetting:"once"},function(register,values){var productArray=ds.get("product");return productArray.toString();});return true;});oaSetupProvider.addSetupFunc("company_size",function(t,ds){ds.register("company_size",{defaultValue:null,autoPopSetting:"always"},function(register,values){var c_size_form=document.getElementById("employeeRange");if(c_size_form&&c_size_form.value&&c_size_form.value!=""){return c_size_form.value;}else{return t.util.getCookie("quantC_size")!==null?t.util.getCookie("quantC_size"):null;}});});oaSetupProvider.addSetupFunc("add_raw_iframe_values",function(t,ds){ds.register("iframe_values",{defaultValue:{},autoPopSetting:"once"},function(register,values){if(document.location.href.indexOf("products.office.com/en/tracking")===-1){return{};}
var iframeDict={};var qsParams=["ms.office_part_number","ms.ocpub.assetid","ms.trans_market","ms.office_order_id","ms.ms_sales_part_quantity","ms.office_tid"];for(var i=0;i<qsParams.length;i++){var paramValue=t.util.getQueryParam(qsParams[i]).toLowerCase();if(paramValue===""){continue;}
var param=qsParams[i];if(param==="ms.office_part_number"&&paramValue.split(",").length>1){iframeDict[param]=paramValue.split(",");}else{iframeDict[param]=[paramValue];}}
return iframeDict;});});oaSetupProvider.addSetupFunc("add_iframe_values_to_dl",function(t,ds){ds.register("dl_iframe_vals",{defaultValue:{},autoPopSetting:"once"},function(register,values){if(document.location.href.indexOf("products.office.com/en/tracking")===-1){return{};}
var iframeDict={};var rawVals=ds.get("iframe_values");var sku=rawVals["ms.office_part_number"];var type=rawVals["ms.ocpub.assetid"];var locale=rawVals["ms.trans_market"];var seats=rawVals["ms.ms_sales_part_quantity"];var order_id=rawVals["ms.office_order_id"];var tenant_id=rawVals["ms.office_tid"];(iframeDict.dl_sku=sku&&sku.constructor===Array?sku:[]),(iframeDict.dl_type=type&&type.constructor===Array?type.join(","):""),(iframeDict.dl_locale=locale&&locale.constructor===Array?locale.join(","):""),(iframeDict.dl_seats=seats&&seats.constructor===Array?seats.join(","):"0"),(iframeDict.dl_order_id=order_id&&order_id.constructor===Array?order_id.join(","):""),(iframeDict.dl_tenant_id=tenant_id&&tenant_id.constructor===Array?tenant_id.join(","):"");return iframeDict;});});oaSetupProvider.addSetupFunc("prepare_iframeMatches",function(t,ds){ds.set("buildMatchedState",function buildMatchedState(valueDict,skus,tealiumDL){var tealiumDLKeys=typeof tealiumDL==="object"?Object.keys(tealiumDL):[];for(var i=0;i<skus.length;i++){var sku=skus[i];var skuData=tealiumDL[sku];var isWildcard=false;if(skuData===undefined){for(var j=0;j<tealiumDLKeys.length;j++){if(sku.match(tealiumDLKeys[j])&&tealiumDL[tealiumDLKeys[j]].wildcard){skuData=tealiumDL[tealiumDLKeys[j]];isWildcard=true;break;}}}
if(tealiumDLKeys.indexOf(sku)!==-1||isWildcard){valueDict.matchedOffers[sku]=skuData;}else{valueDict.notMatchedOffers[sku]=skuData;}}
return(valueDict.matchedOffers&&Object.keys(valueDict.matchedOffers).length>0);},{defaultValue:{},autoPopSetting:"once"});ds.set("isCredited",function isCredited(valueDict){for(var x in valueDict.matchedOffers){if(valueDict.matchedOffers[x].offer_license_type==="subscription"){valueDict.credited=true;break;}}},{defaultValue:{},autoPopSetting:"once"});ds.register("dl_matched",{defaultValue:{},autoPopSetting:"once"},function(register,values){if(document.location.href.indexOf("products.office.com/en/tracking")===-1){return{};}
var buildMatchedState=ds.get("buildMatchedState");var isCredited=ds.get("isCredited");var valueDict={};valueDict.matchedOffers={};valueDict.notMatchedOffers={};valueDict.credited=false;var skus=ds.get("dl_iframe_vals").dl_sku;var tealiumDL=ds.get("tealiumDL");var matchedSkusExist=buildMatchedState(valueDict,skus,tealiumDL);if(matchedSkusExist){isCredited(valueDict);}
return valueDict;});});oaSetupProvider.addSetupFunc("prepare_tagconfigs",function(t,ds){ds.set("JSLL_config",function(appId,hasEUConsent){if(typeof appId!=="string"||appId===undefined){return{};}
if(typeof hasEUConsent!=="boolean"||hasEUConsent===undefined){hasEUConsent=ds.get("haveEUConsent");}
var config={};var isDebug=ds.get("isDebug");var location=ds.get("location");var tealiumDL=ds.get("tealiumDL",true);config.logLevel=isDebug?3:0;config.cookiesToCollect=["MSFPC","_mkto_trk"];if(hasEUConsent){config.ix={};config.ix.a=true;config.ix.g=true;config.syncMuid=true;}else{config.syncMuid=false;}
config.coreData={};config.coreData.appId=appId;config.coreData.market=ds.get("llcc")!==null?ds.get("llcc"):"[LANGLOC]";config.coreData.pageName=tealiumDL.page_title?tealiumDL.page_title:location.pathname;config.coreData.pageType=tealiumDL.page_type?tealiumDL.page_type:"";config.autoCapture={};config.debounceMS={};config.callback={};return appId?config:{};},{defaultValue:null,autoPopSetting:"always"});});if(window.utf_event){window.utf_event.trigger("frameworkLoaded");}
window.utfLoaded=true;try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1};u.initialized=false;u.map={};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
}};utag.o[loader].loader.LOAD(id);})("37","msft.office");}catch(error){utag.DB(error);}
