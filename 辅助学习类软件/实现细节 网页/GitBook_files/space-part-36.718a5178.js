webpackJsonp([56],{1524:function(e,t,n){(function(t){(function(){"use strict";function n(e){var n;n=e instanceof t?e:new t(e.toString(),"binary");return n.toString("base64")}e.exports=n})()}).call(t,n(141).Buffer)},1527:function(e,t,n){n(1528);e.exports=n(215).default},1528:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});(function(e,t){var r=n(1530);var i=n.n(r);var o=setTimeout;function a(){}function s(e,t){return function(){e.apply(t,arguments)}}function u(e){if(!(this instanceof u))throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("not a function");this._state=0;this._handled=false;this._value=void 0;this._deferreds=[];d(e,this)}function c(e,t){while(3===e._state)e=e._value;if(0===e._state){e._deferreds.push(t);return}e._handled=true;u._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n){(1===e._state?l:h)(t.promise,e._value);return}var r;try{r=n(e._value)}catch(e){h(t.promise,e);return}l(t.promise,r)})}function l(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var n=t.then;if(t instanceof u){e._state=3;e._value=t;f(e);return}if("function"===typeof n){d(s(n,t),e);return}}e._state=1;e._value=t;f(e)}catch(t){h(e,t)}}function h(e,t){e._state=2;e._value=t;f(e)}function f(e){2===e._state&&0===e._deferreds.length&&u._immediateFn(function(){e._handled||u._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)c(e,e._deferreds[t]);e._deferreds=null}function p(e,t,n){this.onFulfilled="function"===typeof e?e:null;this.onRejected="function"===typeof t?t:null;this.promise=n}function d(e,t){var n=false;try{e(function(e){if(n)return;n=true;l(t,e)},function(e){if(n)return;n=true;h(t,e)})}catch(e){if(n)return;n=true;h(t,e)}}u.prototype["catch"]=function(e){return this.then(null,e)};u.prototype.then=function(e,t){var n=new this.constructor(a);c(this,new p(e,t,n));return n};u.prototype["finally"]=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})};u.all=function(e){return new u(function(t,n){if(!e||"undefined"===typeof e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var i=r.length;function o(e,a){try{if(a&&("object"===typeof a||"function"===typeof a)){var s=a.then;if("function"===typeof s){s.call(a,function(t){o(e,t)},n);return}}r[e]=a;0===--i&&t(r)}catch(e){n(e)}}for(var a=0;a<r.length;a++)o(a,r[a])})};u.resolve=function(e){if(e&&"object"===typeof e&&e.constructor===u)return e;return new u(function(t){t(e)})};u.reject=function(e){return new u(function(t,n){n(e)})};u.race=function(e){return new u(function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)})};u._immediateFn="function"===typeof e&&function(t){e(t)}||function(e){o(e,0)};u._unhandledRejectionFn=function e(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var v=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof t)return t;throw new Error("unable to locate global object")}();v.Promise||(v.Promise=u);function y(e,t){return t={exports:{}},e(t,t.exports),t.exports}var g=y(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)});var _=y(function(e){var t=e.exports={version:"2.5.5"};"number"==typeof __e&&(__e=t)});var m=_.version;var b=function(e){return"object"===typeof e?null!==e:"function"===typeof e};var w=function(e){if(!b(e))throw TypeError(e+" is not an object!");return e};var E=function(e){try{return!!e()}catch(e){return true}};var T=!E(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a});var S=g.document;var I=b(S)&&b(S.createElement);var C=function(e){return I?S.createElement(e):{}};var O=!T&&!E(function(){return 7!=Object.defineProperty(C("div"),"a",{get:function(){return 7}}).a});var N=function(e,t){if(!b(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!b(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!b(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!b(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")};var A=Object.defineProperty;var D=T?Object.defineProperty:function e(t,n,r){w(t);n=N(n,true);w(r);if(O)try{return A(t,n,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");"value"in r&&(t[n]=r.value);return t};var R={f:D};var P=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}};var k=T?function(e,t,n){return R.f(e,t,P(1,n))}:function(e,t,n){e[t]=n;return e};var L={}.hasOwnProperty;var x=function(e,t){return L.call(e,t)};var M=0;var U=Math.random();var F=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++M+U).toString(36))};var j=y(function(e){var t=F("src");var n="toString";var r=Function[n];var i=(""+r).split(n);_.inspectSource=function(e){return r.call(e)};(e.exports=function(e,n,r,o){var a="function"==typeof r;a&&(x(r,"name")||k(r,"name",n));if(e[n]===r)return;a&&(x(r,t)||k(r,t,e[n]?""+e[n]:i.join(String(n))));if(e===g)e[n]=r;else if(o)e[n]?e[n]=r:k(e,n,r);else{delete e[n];k(e,n,r)}})(Function.prototype,n,function e(){return"function"==typeof this&&this[t]||r.call(this)})});var B=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e};var W=function(e,t,n){B(e);if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}};var q="prototype";var V=function(e,t,n){var r=e&V.F;var i=e&V.G;var o=e&V.S;var a=e&V.P;var s=e&V.B;var u=i?g:o?g[t]||(g[t]={}):(g[t]||{})[q];var c=i?_:_[t]||(_[t]={});var l=c[q]||(c[q]={});var h,f,p,d;i&&(n=t);for(h in n){f=!r&&u&&void 0!==u[h];p=(f?u:n)[h];d=s&&f?W(p,g):a&&"function"==typeof p?W(Function.call,p):p;u&&j(u,h,p,e&V.U);c[h]!=p&&k(c,h,d);a&&l[h]!=p&&(l[h]=p)}};g.core=_;V.F=1;V.G=2;V.S=4;V.P=8;V.B=16;V.W=32;V.U=64;V.R=128;var H=V;var K={}.toString;var G=function(e){return K.call(e).slice(8,-1)};var z=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==G(e)?e.split(""):Object(e)};var Q=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e};var Y=function(e){return Object(Q(e))};var X=Math.ceil;var $=Math.floor;var J=function(e){return isNaN(e=+e)?0:(e>0?$:X)(e)};var Z=Math.min;var ee=function(e){return e>0?Z(J(e),9007199254740991):0};var te=Array.isArray||function e(t){return"Array"==G(t)};var ne="__core-js_shared__";var re=g[ne]||(g[ne]={});var ie=function(e){return re[e]||(re[e]={})};var oe=y(function(e){var t=ie("wks");var n=g.Symbol;var r="function"==typeof n;var i=e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:F)("Symbol."+e))};i.store=t});var ae=oe("species");var se=function(e){var t;if(te(e)){t=e.constructor;"function"!=typeof t||t!==Array&&!te(t.prototype)||(t=void 0);if(b(t)){t=t[ae];null===t&&(t=void 0)}}return void 0===t?Array:t};var ue=function(e,t){return new(se(e))(t)};var ce=function(e,t){var n=1==e;var r=2==e;var i=3==e;var o=4==e;var a=6==e;var s=5==e||a;var u=t||ue;return function(t,c,l){var h=Y(t);var f=z(h);var p=W(c,l,3);var d=ee(f.length);var v=0;var y=n?u(t,d):r?u(t,0):void 0;var g,_;for(;d>v;v++)if(s||v in f){g=f[v];_=p(g,v,h);if(e)if(n)y[v]=_;else if(_)switch(e){case 3:return true;case 5:return g;case 6:return v;case 2:y.push(g)}else if(o)return false}return a?-1:i||o?o:y}};var le=oe("unscopables");var he=Array.prototype;void 0==he[le]&&k(he,le,{});var fe=function(e){he[le][e]=true};var pe=ce(5);var de="find";var ve=true;de in[]&&Array(1)[de](function(){ve=false});H(H.P+H.F*ve,"Array",{find:function e(t){return pe(this,t,arguments.length>1?arguments[1]:void 0)}});fe(de);var ye=_.Array.find;var ge=ce(6);var _e="findIndex";var me=true;_e in[]&&Array(1)[_e](function(){me=false});H(H.P+H.F*me,"Array",{findIndex:function e(t){return ge(this,t,arguments.length>1?arguments[1]:void 0)}});fe(_e);var be=_.Array.findIndex;var we=oe("match");var Ee=function(e){var t;return b(e)&&(void 0!==(t=e[we])?!!t:"RegExp"==G(e))};var Te=function(e,t,n){if(Ee(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(Q(e))};var Se=oe("match");var Ie=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{t[Se]=false;return!"/./"[e](t)}catch(e){}}return true};var Ce="startsWith";var Oe=""[Ce];H(H.P+H.F*Ie(Ce),"String",{startsWith:function e(t){var n=Te(this,t,Ce);var r=ee(Math.min(arguments.length>1?arguments[1]:void 0,n.length));var i=String(t);return Oe?Oe.call(n,i,r):n.slice(r,r+i.length)===i}});var Ne=_.String.startsWith}).call(t,n(89).setImmediate,n(18))},1530:function(e,t){(function(e){"use strict";if(e.fetch)return;var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{new Blob;return true}catch(e){return false}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer){var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"];var r=function(e){return e&&DataView.prototype.isPrototypeOf(e)};var i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1}}function o(e){"string"!==typeof e&&(e=String(e));if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function a(e){"string"!==typeof e&&(e=String(e));return e}function s(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};t.iterable&&(n[Symbol.iterator]=function(){return n});return n}function u(e){this.map={};e instanceof u?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}u.prototype.append=function(e,t){e=o(e);t=a(t);var n=this.map[e];this.map[e]=n?n+","+t:t};u.prototype["delete"]=function(e){delete this.map[o(e)]};u.prototype.get=function(e){e=o(e);return this.has(e)?this.map[e]:null};u.prototype.has=function(e){return this.map.hasOwnProperty(o(e))};u.prototype.set=function(e,t){this.map[o(e)]=a(t)};u.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)};u.prototype.keys=function(){var e=[];this.forEach(function(t,n){e.push(n)});return s(e)};u.prototype.values=function(){var e=[];this.forEach(function(t){e.push(t)});return s(e)};u.prototype.entries=function(){var e=[];this.forEach(function(t,n){e.push([n,t])});return s(e)};t.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);function c(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=true}function l(e){return new Promise(function(t,n){e.onload=function(){t(e.result)};e.onerror=function(){n(e.error)}})}function h(e){var t=new FileReader;var n=l(t);t.readAsArrayBuffer(e);return n}function f(e){var t=new FileReader;var n=l(t);t.readAsText(e);return n}function p(e){var t=new Uint8Array(e);var n=new Array(t.length);for(var r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e));return t.buffer}function v(){this.bodyUsed=false;this._initBody=function(e){this._bodyInit=e;if(e)if("string"===typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e)){this._bodyArrayBuffer=d(e.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(e)}else this._bodyText="";this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};if(t.blob){this.blob=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))};this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}}this.text=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return f(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(p(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)};t.formData&&(this.formData=function(){return this.text().then(m)});this.json=function(){return this.text().then(JSON.parse)};return this}var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function g(e){var t=e.toUpperCase();return y.indexOf(t)>-1?t:e}function _(e,t){t=t||{};var n=t.body;if(e instanceof _){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url;this.credentials=e.credentials;t.headers||(this.headers=new u(e.headers));this.method=e.method;this.mode=e.mode;if(!n&&null!=e._bodyInit){n=e._bodyInit;e.bodyUsed=true}}else this.url=String(e);this.credentials=t.credentials||this.credentials||"omit";!t.headers&&this.headers||(this.headers=new u(t.headers));this.method=g(t.method||this.method||"GET");this.mode=t.mode||this.mode||null;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})};function m(e){var t=new FormData;e.trim().split("&").forEach(function(e){if(e){var n=e.split("=");var r=n.shift().replace(/\+/g," ");var i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}});return t}function b(e){var t=new u;var n=e.replace(/\r?\n[\t ]+/g," ");n.split(/\r?\n/).forEach(function(e){var n=e.split(":");var r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}});return t}v.call(_.prototype);function w(e,t){t||(t={});this.type="default";this.status=void 0===t.status?200:t.status;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in t?t.statusText:"OK";this.headers=new u(t.headers);this.url=t.url||"";this._initBody(e)}v.call(w.prototype);w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})};w.error=function(){var e=new w(null,{status:0,statusText:""});e.type="error";return e};var E=[301,302,303,307,308];w.redirect=function(e,t){if(-1===E.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})};e.Headers=u;e.Request=_;e.Response=w;e.fetch=function(e,n){return new Promise(function(r,i){var o=new _(e,n);var a=new XMLHttpRequest;a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:b(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;r(new w(t,e))};a.onerror=function(){i(new TypeError("Network request failed"))};a.ontimeout=function(){i(new TypeError("Network request failed"))};a.open(o.method,o.url,true);"include"===o.credentials?a.withCredentials=true:"omit"===o.credentials&&(a.withCredentials=false);"responseType"in a&&t.blob&&(a.responseType="blob");o.headers.forEach(function(e,t){a.setRequestHeader(t,e)});a.send("undefined"===typeof o._bodyInit?null:o._bodyInit)})};e.fetch.polyfill=true})("undefined"!==typeof self?self:this)},1531:function(e,t,n){n(1532)},1532:function(e,t,n){(function(e){(function(){var e=n(215).default;var t,r=r||{},i=this;function o(e){return"string"==typeof e}function a(e){return"boolean"==typeof e}function s(){}function u(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t}function c(e){return null===e}function l(e){return"array"==u(e)}function h(e){var t=u(e);return"array"==t||"object"==t&&"number"==typeof e.length}function f(e){return"function"==u(e)}function p(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var d="closure_uid_"+(1e9*Math.random()>>>0),v=0;function y(e,t,n){return e.call.apply(e.bind,arguments)}function g(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(n,r);return e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function _(e,t,n){_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:g;return _.apply(null,arguments)}function m(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();t.push.apply(t,arguments);return e.apply(this,t)}}var b=Date.now||function(){return+new Date};function w(e,t){function n(){}n.prototype=t.prototype;e.lb=t.prototype;e.prototype=new n;e.prototype.constructor=e;e.ad=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function E(e){e.prototype.then=e.prototype.then;e.prototype.$goog_Thenable=!0}function T(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(e){return!1}}function S(e){if(Error.captureStackTrace)Error.captureStackTrace(this,S);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}w(S,Error);S.prototype.name="CustomError";function I(e,t){e=e.split("%s");for(var n="",r=e.length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");S.call(this,n+e[r])}w(I,S);I.prototype.name="AssertionError";function C(e,t){throw new I("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function O(e,t){this.c=e;this.f=t;this.b=0;this.a=null}O.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next;e.next=null}else e=this.c();return e};function N(e,t){e.f(t);100>e.b&&(e.b++,t.next=e.a,e.a=t)}function A(){this.b=this.a=null}var D=new O(function(){return new P},function(e){e.reset()});A.prototype.add=function(e,t){var n=D.get();n.set(e,t);this.b?this.b.next=n:this.a=n;this.b=n};function R(){var e=_e,t=null;e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null);return t}function P(){this.next=this.b=this.a=null}P.prototype.set=function(e,t){this.a=e;this.b=t;this.next=null};P.prototype.reset=function(){this.next=this.b=this.a=null};var k=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(o(e))return o(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},L=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=o(e)?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function x(e,t){var n=e.length,r=o(e)?e.split(""):e;for(--n;0<=n;--n)n in r&&t.call(void 0,r[n],n,e)}var M=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i=o(e)?e.split(""):e,a=0;a<n;a++)a in i&&(r[a]=t.call(void 0,i[a],a,e));return r},U=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=o(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function F(e){e:{var t=ia;for(var n=e.length,r=o(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:o(e)?e.charAt(t):e[t]}function j(e,t){return 0<=k(e,t)}function B(e,t){t=k(e,t);var n;(n=0<=t)&&Array.prototype.splice.call(e,t,1);return n}function W(e,t){var n=0;x(e,function(r,i){t.call(void 0,r,i,e)&&1==Array.prototype.splice.call(e,i,1).length&&n++})}function q(e){return Array.prototype.concat.apply([],arguments)}function V(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function H(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}var K=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function G(e){if(!Z.test(e))return e;-1!=e.indexOf("&")&&(e=e.replace(z,"&amp;"));-1!=e.indexOf("<")&&(e=e.replace(Q,"&lt;"));-1!=e.indexOf(">")&&(e=e.replace(Y,"&gt;"));-1!=e.indexOf('"')&&(e=e.replace(X,"&quot;"));-1!=e.indexOf("'")&&(e=e.replace($,"&#39;"));-1!=e.indexOf("\0")&&(e=e.replace(J,"&#0;"));return e}var z=/&/g,Q=/</g,Y=/>/g,X=/"/g,$=/'/g,J=/\x00/g,Z=/[\x00&<>"']/;function ee(e,t){return-1!=e.indexOf(t)}function te(e,t){return e<t?-1:e>t?1:0}var ne;e:{var re=i.navigator;if(re){var ie=re.userAgent;if(ie){ne=ie;break e}}ne=""}function oe(e){return ee(ne,e)}function ae(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function se(e){for(var t in e)return!1;return!0}function ue(e){var t={},n;for(n in e)t[n]=e[n];return t}var ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function le(e,t){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)e[n]=r[n];for(var o=0;o<ce.length;o++)n=ce[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function he(e){i.setTimeout(function(){throw e},0)}var fe;function pe(){var e=i.MessageChannel;"undefined"===typeof e&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!oe("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none";e.src="";document.documentElement.appendChild(e);var t=e.contentWindow;e=t.document;e.open();e.write("");e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=_(function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()},this);t.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){t.postMessage(n,r)}}});if("undefined"!==typeof e&&!oe("Trident")&&!oe("MSIE")){var t=new e,n={},r=n;t.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var e=n.rb;n.rb=null;e()}};return function(e){r.next={rb:e};r=r.next;t.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null;t.parentNode.removeChild(t);t=null;e();e=null};document.documentElement.appendChild(t)}:function(e){i.setTimeout(e,0)}}function de(e,t){ve||ye();ge||(ve(),ge=!0);_e.add(e,t)}var ve;function ye(){if(i.Promise&&i.Promise.resolve){var e=i.Promise.resolve(void 0);ve=function(){e.then(me)}}else ve=function(){var e=me;!f(i.setImmediate)||i.Window&&i.Window.prototype&&!oe("Edge")&&i.Window.prototype.setImmediate==i.setImmediate?(fe||(fe=pe()),fe(e)):i.setImmediate(e)}}var ge=!1,_e=new A;function me(){for(var e;e=R();){try{e.a.call(e.b)}catch(e){he(e)}N(D,e)}ge=!1}function be(e,t){this.a=we;this.j=void 0;this.f=this.b=this.c=null;this.g=this.h=!1;if(e!=s)try{var n=this;e.call(t,function(e){xe(n,Ee,e)},function(e){if(!(e instanceof He))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(e){}xe(n,Te,e)})}catch(e){xe(this,Te,e)}}var we=0,Ee=2,Te=3;function Se(){this.next=this.f=this.b=this.g=this.a=null;this.c=!1}Se.prototype.reset=function(){this.f=this.b=this.g=this.a=null;this.c=!1};var Ie=new O(function(){return new Se},function(e){e.reset()});function Ce(e,t,n){var r=Ie.get();r.g=e;r.b=t;r.f=n;return r}function Oe(e){if(e instanceof be)return e;var t=new be(s);xe(t,Ee,e);return t}function Ne(e){return new be(function(t,n){n(e)})}function Ae(e,t,n){Me(e,t,n,null)||de(m(t,e))}function De(e){return new be(function(t,n){var r=e.length,i=[];if(r)for(var o=function(e,n){r--;i[e]=n;0==r&&t(i)},a=function(e){n(e)},s=0,u;s<e.length;s++)u=e[s],Ae(u,m(o,s),a);else t(i)})}function Re(e){return new be(function(t){var n=e.length,r=[];if(n)for(var i=function(e,i,o){n--;r[e]=i?{Zb:!0,value:o}:{Zb:!1,reason:o};0==n&&t(r)},o=0,a;o<e.length;o++)a=e[o],Ae(a,m(i,o,!0),m(i,o,!1));else t(r)})}be.prototype.then=function(e,t,n){return Le(this,f(e)?e:null,f(t)?t:null,n)};E(be);t=be.prototype;t.ha=function(e,t){e=Ce(e,e,t);e.c=!0;ke(this,e);return this};t.m=function(e,t){return Le(this,null,e,t)};t.cancel=function(e){this.a==we&&de(function(){var t=new He(e);Pe(this,t)},this)};function Pe(e,t){if(e.a==we)if(e.c){var n=e.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==e&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==we&&1==r?Pe(n,t):(o?(r=o,r.next==n.f&&(n.f=r),r.next=r.next.next):je(n),Be(n,i,Te,t)))}e.c=null}else xe(e,Te,t)}function ke(e,t){e.b||e.a!=Ee&&e.a!=Te||Fe(e);e.f?e.f.next=t:e.b=t;e.f=t}function Le(e,t,n,r){var i=Ce(null,null,null);i.a=new be(function(e,o){i.g=t?function(n){try{var i=t.call(r,n);e(i)}catch(e){o(e)}}:e;i.b=n?function(t){try{var i=n.call(r,t);void 0===i&&t instanceof He?o(t):e(i)}catch(e){o(e)}}:o});i.a.c=e;ke(e,i);return i.a}t.Kc=function(e){this.a=we;xe(this,Ee,e)};t.Lc=function(e){this.a=we;xe(this,Te,e)};function xe(e,t,n){e.a==we&&(e===n&&(t=Te,n=new TypeError("Promise cannot resolve to itself")),e.a=1,Me(n,e.Kc,e.Lc,e)||(e.j=n,e.a=t,e.c=null,Fe(e),t!=Te||n instanceof He||qe(e,n)))}function Me(e,t,n,r){if(e instanceof be)return ke(e,Ce(t||s,n||null,r)),!0;if(T(e))return e.then(t,n,r),!0;if(p(e))try{var i=e.then;if(f(i))return Ue(e,i,t,n,r),!0}catch(e){return n.call(r,e),!0}return!1}function Ue(e,t,n,r,i){function o(e){s||(s=!0,r.call(i,e))}function a(e){s||(s=!0,n.call(i,e))}var s=!1;try{t.call(e,a,o)}catch(e){o(e)}}function Fe(e){e.h||(e.h=!0,de(e.Ub,e))}function je(e){var t=null;e.b&&(t=e.b,e.b=t.next,t.next=null);e.b||(e.f=null);return t}t.Ub=function(){for(var e;e=je(this);)Be(this,e,this.a,this.j);this.h=!1};function Be(e,t,n,r){if(n==Te&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,We(t,n,r);else try{t.c?t.g.call(t.f):We(t,n,r)}catch(e){Ve.call(null,e)}N(Ie,t)}function We(e,t,n){t==Ee?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}function qe(e,t){e.g=!0;de(function(){e.g&&Ve.call(null,t)})}var Ve=he;function He(e){S.call(this,e)}w(He,S);He.prototype.name="cancel";function Ke(){0!=Ge&&(ze[this[d]||(this[d]=++v)]=this);this.pa=this.pa;this.oa=this.oa}var Ge=0,ze={};Ke.prototype.pa=!1;function Qe(e){if(!e.pa&&(e.pa=!0,e.ua(),0!=Ge)){var t=e[d]||(e[d]=++v);if(0!=Ge&&e.oa&&0<e.oa.length)throw Error(e+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete ze[t]}}Ke.prototype.ua=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};function Ye(e){Ye[" "](e);return e}Ye[" "]=s;function Xe(e,t){var n=ut;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}var $e=oe("Opera"),Je=oe("Trident")||oe("MSIE"),Ze=oe("Edge"),et=Ze||Je,tt=oe("Gecko")&&!(ee(ne.toLowerCase(),"webkit")&&!oe("Edge"))&&!(oe("Trident")||oe("MSIE"))&&!oe("Edge"),nt=ee(ne.toLowerCase(),"webkit")&&!oe("Edge");function rt(){var e=i.document;return e?e.documentMode:void 0}var it;e:{var ot="",at=function(){var e=ne;if(tt)return/rv:([^\);]+)(\)|;)/.exec(e);if(Ze)return/Edge\/([\d\.]+)/.exec(e);if(Je)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(nt)return/WebKit\/(\S+)/.exec(e);if($e)return/(?:Version)[ \/]?(\S+)/.exec(e)}();at&&(ot=at?at[1]:"");if(Je){var st=rt();if(null!=st&&st>parseFloat(ot)){it=String(st);break e}}it=ot}var ut={};function ct(e){return Xe(e,function(){for(var t=0,n=K(String(it)).split("."),r=K(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""];s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""];if(0==a[0].length&&0==s[0].length)break;t=te(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||te(0==a[2].length,0==s[2].length)||te(a[2],s[2]);a=a[3];s=s[3]}while(0==t)}return 0<=t})}var lt;var ht=i.document;lt=ht&&Je?rt()||("CSS1Compat"==ht.compatMode?parseInt(it,10):5):void 0;var ft=Object.freeze||function(e){return e};var pt=!Je||9<=Number(lt),dt=Je&&!ct("9"),vt=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});i.addEventListener("test",s,t);i.removeEventListener("test",s,t);return e}();function yt(e,t){this.type=e;this.b=this.target=t;this.Eb=!0}yt.prototype.preventDefault=function(){this.Eb=!1};function gt(e,t){yt.call(this,e?e.type:"");this.relatedTarget=this.b=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.a=null;if(e){var n=this.type=e.type,r=e.changedTouches?e.changedTouches[0]:null;this.target=e.target||e.srcElement;this.b=t;if(t=e.relatedTarget){if(tt){e:{try{Ye(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t;null===r?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0);this.button=e.button;this.key=e.key||"";this.ctrlKey=e.ctrlKey;this.altKey=e.altKey;this.shiftKey=e.shiftKey;this.metaKey=e.metaKey;this.pointerId=e.pointerId||0;this.pointerType=o(e.pointerType)?e.pointerType:_t[e.pointerType]||"";this.a=e;e.defaultPrevented&&this.preventDefault()}}w(gt,yt);var _t=ft({2:"touch",3:"pen",4:"mouse"});gt.prototype.preventDefault=function(){gt.lb.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,dt)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}};gt.prototype.f=function(){return this.a};var mt="closure_listenable_"+(1e6*Math.random()|0),bt=0;function wt(e,t,n,r,i){this.listener=e;this.proxy=null;this.src=t;this.type=n;this.capture=!!r;this.La=i;this.key=++bt;this.ma=this.Ha=!1}function Et(e){e.ma=!0;e.listener=null;e.proxy=null;e.src=null;e.La=null}function Tt(e){this.src=e;this.a={};this.b=0}Tt.prototype.add=function(e,t,n,r,i){var o=e.toString();e=this.a[o];e||(e=this.a[o]=[],this.b++);var a=It(e,t,r,i);-1<a?(t=e[a],n||(t.Ha=!1)):(t=new wt(t,this.src,o,!!r,i),t.Ha=n,e.push(t));return t};function St(e,t){var n=t.type;n in e.a&&B(e.a[n],t)&&(Et(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function It(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.ma&&o.listener==t&&o.capture==!!n&&o.La==r)return i}return-1}var Ct="closure_lm_"+(1e6*Math.random()|0),Ot={},Nt=0;function At(e,t,n,r,i){if(r&&r.once)Pt(e,t,n,r,i);else if(l(t))for(var o=0;o<t.length;o++)At(e,t[o],n,r,i);else n=Wt(n),e&&e[mt]?Vt(e,t,n,p(r)?!!r.capture:!!r,i):Dt(e,t,n,!1,r,i)}function Dt(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=p(i)?!!i.capture:!!i,s=jt(e);s||(e[Ct]=s=new Tt(e));n=s.add(t,n,r,a,o);if(!n.proxy){r=Rt();n.proxy=r;r.src=e;r.listener=n;if(e.addEventListener)vt||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(xt(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}Nt++}}function Rt(){var e=Ft,t=pt?function(n){return e.call(t.src,t.listener,n)}:function(n){n=e.call(t.src,t.listener,n);if(!n)return n};return t}function Pt(e,t,n,r,i){if(l(t))for(var o=0;o<t.length;o++)Pt(e,t[o],n,r,i);else n=Wt(n),e&&e[mt]?Ht(e,t,n,p(r)?!!r.capture:!!r,i):Dt(e,t,n,!0,r,i)}function kt(e,t,n,r,i){if(l(t))for(var o=0;o<t.length;o++)kt(e,t[o],n,r,i);else r=p(r)?!!r.capture:!!r,n=Wt(n),e&&e[mt]?(e=e.u,t=String(t).toString(),t in e.a&&(o=e.a[t],n=It(o,n,r,i),-1<n&&(Et(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--)))):e&&(e=jt(e))&&(t=e.a[t.toString()],e=-1,t&&(e=It(t,n,r,i)),(n=-1<e?t[e]:null)&&Lt(n))}function Lt(e){if("number"!=typeof e&&e&&!e.ma){var t=e.src;if(t&&t[mt])St(t.u,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(xt(n),r):t.addListener&&t.removeListener&&t.removeListener(r);Nt--;(n=jt(t))?(St(n,e),0==n.b&&(n.src=null,t[Ct]=null)):Et(e)}}}function xt(e){return e in Ot?Ot[e]:Ot[e]="on"+e}function Mt(e,t,n,r){var i=!0;if((e=jt(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.ma&&(o=Ut(o,r),i=i&&!1!==o)}return i}function Ut(e,t){var n=e.listener,r=e.La||e.src;e.Ha&&Lt(e);return n.call(r,t)}function Ft(e,t){if(e.ma)return!0;if(!pt){if(!t)e:{t=["window","event"];for(var n=i,r=0;r<t.length;r++)if(n=n[t[r]],null==n){t=null;break e}t=n}r=t;t=new gt(r,this);n=!0;if(!(0>r.keyCode||void 0!=r.returnValue)){e:{var o=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(e){o=!0}(o||void 0==r.returnValue)&&(r.returnValue=!0)}r=[];for(o=t.b;o;o=o.parentNode)r.push(o);e=e.type;for(o=r.length-1;0<=o;o--){t.b=r[o];var a=Mt(r[o],e,!0,t);n=n&&a}for(o=0;o<r.length;o++)t.b=r[o],a=Mt(r[o],e,!1,t),n=n&&a}return n}return Ut(e,new gt(t,this))}function jt(e){e=e[Ct];return e instanceof Tt?e:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Wt(e){if(f(e))return e;e[Bt]||(e[Bt]=function(t){return e.handleEvent(t)});return e[Bt]}function qt(){Ke.call(this);this.u=new Tt(this);this.Mb=this;this.Ta=null}w(qt,Ke);qt.prototype[mt]=!0;qt.prototype.addEventListener=function(e,t,n,r){At(this,e,t,n,r)};qt.prototype.removeEventListener=function(e,t,n,r){kt(this,e,t,n,r)};qt.prototype.dispatchEvent=function(e){var t,n=this.Ta;if(n)for(t=[];n;n=n.Ta)t.push(n);n=this.Mb;var r=e.type||e;if(o(e))e=new yt(e,n);else if(e instanceof yt)e.target=e.target||n;else{var i=e;e=new yt(r,n);le(e,i)}i=!0;if(t)for(var a=t.length-1;0<=a;a--){var s=e.b=t[a];i=Kt(s,r,!0,e)&&i}s=e.b=n;i=Kt(s,r,!0,e)&&i;i=Kt(s,r,!1,e)&&i;if(t)for(a=0;a<t.length;a++)s=e.b=t[a],i=Kt(s,r,!1,e)&&i;return i};qt.prototype.ua=function(){qt.lb.ua.call(this);if(this.u){var e=this.u,t=0,n;for(n in e.a){for(var r=e.a[n],i=0;i<r.length;i++)++t,Et(r[i]);delete e.a[n];e.b--}}this.Ta=null};function Vt(e,t,n,r,i){e.u.add(String(t),n,!1,r,i)}function Ht(e,t,n,r,i){e.u.add(String(t),n,!0,r,i)}function Kt(e,t,n,r){t=e.u.a[String(t)];if(!t)return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.ma&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ha&&St(e.u,a);i=!1!==s.call(u,r)&&i}}return i&&0!=r.Eb}function Gt(e,t,n){if(f(e))n&&(e=_(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=_(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function zt(e){var t=null;return new be(function(n,r){t=Gt(function(){n(void 0)},e);-1==t&&r(Error("Failed to schedule timer."))}).m(function(e){i.clearTimeout(t);throw e})}function Qt(e){if(e.S&&"function"==typeof e.S)return e.S();if(o(e))return e.split("");if(h(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}t=[];n=0;for(r in e)t[n++]=e[r];return t}function Yt(e){if(e.U&&"function"==typeof e.U)return e.U();if(!e.S||"function"!=typeof e.S){if(h(e)||o(e)){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[];n=0;for(var r in e)t[n++]=r;return t}}function Xt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(h(e)||o(e))L(e,t,void 0);else for(var n=Yt(e),r=Qt(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}function $t(e,t){this.b={};this.a=[];this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof $t)for(n=e.U(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}t=$t.prototype;t.S=function(){Jt(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e};t.U=function(){Jt(this);return this.a.concat()};t.clear=function(){this.b={};this.c=this.a.length=0};function Jt(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Zt(e.b,r)&&(e.a[n++]=r);t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)r=e.a[t],Zt(i,r)||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}t.get=function(e,t){return Zt(this.b,e)?this.b[e]:t};t.set=function(e,t){Zt(this.b,e)||(this.c++,this.a.push(e));this.b[e]=t};t.forEach=function(e,t){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};function Zt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var en=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function tn(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function nn(e,t){this.b=this.l=this.c="";this.j=null;this.h=this.g="";this.f=!1;if(e instanceof nn){this.f=void 0!==t?t:e.f;rn(this,e.c);this.l=e.l;this.b=e.b;on(this,e.j);this.g=e.g;t=e.a;var n=new mn;n.c=t.c;t.a&&(n.a=new $t(t.a),n.b=t.b);an(this,n);this.h=e.h}else e&&(n=String(e).match(en))?(this.f=!!t,rn(this,n[1]||"",!0),this.l=hn(n[2]||""),this.b=hn(n[3]||"",!0),on(this,n[4]),this.g=hn(n[5]||"",!0),an(this,n[6]||"",!0),this.h=hn(n[7]||"")):(this.f=!!t,this.a=new mn(null,this.f))}nn.prototype.toString=function(){var e=[],t=this.c;t&&e.push(fn(t,dn,!0),":");var n=this.b;(n||"file"==t)&&(e.push("//"),(t=this.l)&&e.push(fn(t,dn,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.j,null!=n&&e.push(":",String(n)));(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(fn(n,"/"==n.charAt(0)?yn:vn,!0)));(n=this.a.toString())&&e.push("?",n);(n=this.h)&&e.push("#",fn(n,_n));return e.join("")};function rn(e,t,n){e.c=n?hn(t,!0):t;e.c&&(e.c=e.c.replace(/:$/,""))}function on(e,t){if(t){t=Number(t);if(isNaN(t)||0>t)throw Error("Bad port number "+t);e.j=t}else e.j=null}function an(e,t,n){t instanceof mn?(e.a=t,Cn(e.a,e.f)):(n||(t=fn(t,gn)),e.a=new mn(t,e.f))}function sn(e,t,n){e.a.set(t,n)}function un(e,t){return e.a.get(t)}function cn(e){return e instanceof nn?new nn(e):new nn(e,void 0)}function ln(e,t){var n=new nn(null,void 0);rn(n,"https");e&&(n.b=e);t&&(n.g=t);return n}function hn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function fn(e,t,n){return o(e)?(e=encodeURI(e).replace(t,pn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pn(e){e=e.charCodeAt(0);return"%"+(e>>4&15).toString(16)+(15&e).toString(16)}var dn=/[#\/\?@]/g,vn=/[#\?:]/g,yn=/[#\?]/g,gn=/[#\?@]/g,_n=/#/g;function mn(e,t){this.b=this.a=null;this.c=e||null;this.f=!!t}function bn(e){e.a||(e.a=new $t,e.b=0,e.c&&tn(e.c,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function wn(e){var t=Yt(e);if("undefined"==typeof t)throw Error("Keys are undefined");var n=new mn(null,void 0);e=Qt(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];l(o)?Sn(n,i,o):n.add(i,o)}return n}t=mn.prototype;t.add=function(e,t){bn(this);this.c=null;e=In(this,e);var n=this.a.get(e);n||this.a.set(e,n=[]);n.push(t);this.b+=1;return this};function En(e,t){bn(e);t=In(e,t);Zt(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,e=e.a,Zt(e.b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Jt(e)))}t.clear=function(){this.a=this.c=null;this.b=0};function Tn(e,t){bn(e);t=In(e,t);return Zt(e.a.b,t)}t.forEach=function(e,t){bn(this);this.a.forEach(function(n,r){L(n,function(n){e.call(t,n,r,this)},this)},this)};t.U=function(){bn(this);for(var e=this.a.S(),t=this.a.U(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n};t.S=function(e){bn(this);var t=[];if(o(e))Tn(this,e)&&(t=q(t,this.a.get(In(this,e))));else{e=this.a.S();for(var n=0;n<e.length;n++)t=q(t,e[n])}return t};t.set=function(e,t){bn(this);this.c=null;e=In(this,e);Tn(this,e)&&(this.b-=this.a.get(e).length);this.a.set(e,[t]);this.b+=1;return this};t.get=function(e,t){e=e?this.S(e):[];return 0<e.length?String(e[0]):t};function Sn(e,t,n){En(e,t);0<n.length&&(e.c=null,e.a.set(In(e,t),V(n)),e.b+=n.length)}t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.U(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o])));e.push(a)}}return this.c=e.join("&")};function In(e,t){t=String(t);e.f&&(t=t.toLowerCase());return t}function Cn(e,t){t&&!e.f&&(bn(e),e.c=null,e.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(En(this,t),Sn(this,n,e))},e));e.f=t}var On=!Je||9<=Number(lt);function Nn(){this.a="";this.b=Dn}Nn.prototype.la=!0;Nn.prototype.ja=function(){return this.a};Nn.prototype.toString=function(){return"Const{"+this.a+"}"};function An(e){if(e instanceof Nn&&e.constructor===Nn&&e.b===Dn)return e.a;C("expected object of type Const, got '"+e+"'");return"type_error:Const"}var Dn={};function Rn(e){var t=new Nn;t.a=e;return t}Rn("");function Pn(){this.a="";this.b=Un}Pn.prototype.la=!0;Pn.prototype.ja=function(){return this.a};Pn.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};function kn(e){if(e instanceof Pn&&e.constructor===Pn&&e.b===Un)return e.a;C("expected object of type TrustedResourceUrl, got '"+e+"' of type "+u(e));return"type_error:TrustedResourceUrl"}function Ln(e,t){var n=An(e);if(!Mn.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);e=n.replace(xn,function(e,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(t));e=t[r];return e instanceof Nn?An(e):encodeURIComponent(String(e))});return Fn(e)}var xn=/%{(\w+)}/g,Mn=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i,Un={};function Fn(e){var t=new Pn;t.a=e;return t}function jn(){this.a="";this.b=Vn}jn.prototype.la=!0;jn.prototype.ja=function(){return this.a};jn.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};function Bn(e){if(e instanceof jn&&e.constructor===jn&&e.b===Vn)return e.a;C("expected object of type SafeUrl, got '"+e+"' of type "+u(e));return"type_error:SafeUrl"}var Wn=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function qn(e){if(e instanceof jn)return e;e=e.la?e.ja():String(e);Wn.test(e)||(e="about:invalid#zClosurez");return Hn(e)}var Vn={};function Hn(e){var t=new jn;t.a=e;return t}Hn("about:blank");function Kn(){this.a="";this.b=zn}Kn.prototype.la=!0;Kn.prototype.ja=function(){return this.a};Kn.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};function Gn(e){if(e instanceof Kn&&e.constructor===Kn&&e.b===zn)return e.a;C("expected object of type SafeHtml, got '"+e+"' of type "+u(e));return"type_error:SafeHtml"}var zn={};function Qn(e){var t=new Kn;t.a=e;return t}Qn("<!DOCTYPE html>");Qn("");Qn("<br>");function Yn(e){var t=document;return o(e)?t.getElementById(e):e}function Xn(e,t){ae(t,function(t,n){t&&t.la&&(t=t.ja());"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:$n.hasOwnProperty(n)?e.setAttribute($n[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t})}var $n={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Jn(e,t,n){var r=arguments,i=document,a=String(r[0]),s=r[1];if(!On&&s&&(s.name||s.type)){a=["<",a];s.name&&a.push(' name="',G(s.name),'"');if(s.type){a.push(' type="',G(s.type),'"');var u={};le(u,s);delete u.type;s=u}a.push(">");a=a.join("")}a=i.createElement(a);s&&(o(s)?a.className=s:l(s)?a.className=s.join(" "):Xn(a,s));2<r.length&&Zn(i,a,r);return a}function Zn(e,t,n){function r(n){n&&t.appendChild(o(n)?e.createTextNode(n):n)}for(var i=2;i<n.length;i++){var a=n[i];!h(a)||p(a)&&0<a.nodeType?r(a):L(er(a)?V(a):a,r)}}function er(e){if(e&&"number"==typeof e.length){if(p(e))return"function"==typeof e.item||"string"==typeof e.item;if(f(e))return"function"==typeof e.item}return!1}function tr(e){var t=[];rr(new nr,e,t);return t.join("")}function nr(){}function rr(e,t,n){if(null==t)n.push("null");else{if("object"==typeof t){if(l(t)){var r=t;t=r.length;n.push("[");for(var i="",o=0;o<t;o++)n.push(i),rr(e,r[o],n),i=",";n.push("]");return}if(!(t instanceof String||t instanceof Number||t instanceof Boolean)){n.push("{");i="";for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o=t[r],"function"!=typeof o&&(n.push(i),ar(r,n),n.push(":"),rr(e,o,n),i=","));n.push("}");return}t=t.valueOf()}switch(typeof t){case"string":ar(t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?String(t):"null");break;case"boolean":n.push(String(t));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof t)}}}var ir={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},or=/\uffff/.test("ï¿¿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function ar(e,t){t.push('"',e.replace(or,function(e){var t=ir[e];t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),ir[e]=t);return t}),'"')}function sr(){var e=Ar();return Je&&!!lt&&11==lt||/Edge\/\d+/.test(e)}function ur(){return i.window&&i.window.location.href||self&&self.location&&self.location.href||""}function cr(e,t){t=t||i.window;var n="about:blank";e&&(n=Bn(qn(e)));t.location.href=n}function lr(e,t){var n=[],r;for(r in e)if(r in t)if(typeof e[r]!=typeof t[r])n.push(r);else if(l(e[r])){e:{var i=void 0;var o=e[r],a=t[r];for(i in o)if(!(i in a)||o[i]!==a[i]){i=!1;break e}for(i in a)if(!(i in o)){i=!1;break e}i=!0}i||n.push(r)}else"object"==typeof e[r]&&null!=e[r]&&null!=t[r]?0<lr(e[r],t[r]).length&&n.push(r):e[r]!==t[r]&&n.push(r);else n.push(r);for(r in t)r in e||n.push(r);return n}function hr(){var e=Ar();e=Cr(e)!=Ir?null:(e=e.match(/\sChrome\/(\d+)/i))&&2==e.length?parseInt(e[1],10):null;return!(e&&30>e)&&(!Je||!lt||9<lt)}function fr(e){e=(e||Ar()).toLowerCase();return!!(e.match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function pr(e){e=e||i.window;try{e.close()}catch(e){}}function dr(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500;n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1};n=Ar().toLowerCase();r&&(t.target=r,ee(n,"crios/")&&(t.target="_blank"));Cr(Ar())==Sr&&(e=e||"http://localhost",t.scrollbars=!0);n=e||"";(e=t)||(e={});r=window;t=n instanceof jn?n:qn("undefined"!=typeof n.href?n.href:String(n));n=e.target||n.target;i=[];for(a in e)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+e[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(e[a]?1:0))}var a=i.join(",");(oe("iPhone")&&!oe("iPod")&&!oe("iPad")||oe("iPad")||oe("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(a=r.document.createElement("A"),t instanceof jn||t instanceof jn||(t=t.la?t.ja():String(t),Wn.test(t)||(t="about:invalid#zClosurez"),t=Hn(t)),a.href=Bn(t),a.setAttribute("target",n),e.noreferrer&&a.setAttribute("rel","noreferrer"),e=document.createEvent("MouseEvent"),e.initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(e),a={}):e.noreferrer?(a=r.open("",n,a),e=Bn(t),a&&(et&&ee(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),a.opener=null,Rn("b/12014412, meta tag with sanitized URL"),e='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+G(e)+'">',e=Qn(e),a.document.write(Gn(e)),a.document.close())):(a=r.open(Bn(t),n,a))&&e.noopener&&(a.opener=null);if(a)try{a.focus()}catch(e){}return a}function vr(e){return new be(function(t){function n(){zt(2e3).then(function(){if(e&&!e.closed)return n();t()})}return n()})}var yr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;function gr(){var e=null;return new be(function(t){"complete"==i.document.readyState?t():(e=function(){t()},Pt(window,"load",e))}).m(function(t){kt(window,"load",e);throw t})}function _r(){return mr(void 0)?gr().then(function(){return new be(function(e,t){var n=i.document,r=setTimeout(function(){t(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r);e()},!1)})}):Ne(Error("Cordova must run in an Android or iOS file scheme."))}function mr(e){e=e||Ar();return!("file:"!==Lr()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function br(){var e=i.window;try{return!(!e||e==e.top)}catch(e){return!1}}function wr(){return"object"!==typeof i.window&&"function"===typeof i.importScripts}function Er(){return e.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":e.INTERNAL.hasOwnProperty("node")?"Node":wr()?"Worker":"Browser"}function Tr(){var e=Er();return"ReactNative"===e||"Node"===e}var Sr="Firefox",Ir="Chrome";function Cr(e){var t=e.toLowerCase();if(ee(t,"opera/")||ee(t,"opr/")||ee(t,"opios/"))return"Opera";if(ee(t,"iemobile"))return"IEMobile";if(ee(t,"msie")||ee(t,"trident/"))return"IE";if(ee(t,"edge/"))return"Edge";if(ee(t,"firefox/"))return Sr;if(ee(t,"silk/"))return"Silk";if(ee(t,"blackberry"))return"Blackberry";if(ee(t,"webos"))return"Webos";if(ee(t,"safari/")&&!ee(t,"chrome/")&&!ee(t,"crios/")&&!ee(t,"android"))return"Safari";if((ee(t,"chrome/")||ee(t,"crios/"))&&!ee(t,"edge/"))return Ir;if(ee(t,"android"))return"Android";if((e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length)return e[1];return"Other"}var Or={Qc:"FirebaseCore-web",Sc:"FirebaseUI-web"};function Nr(e,t){t=t||[];var n=[],r={},i;for(i in Or)r[Or[i]]=!0;for(i=0;i<t.length;i++)"undefined"!==typeof r[t[i]]&&(delete r[t[i]],n.push(t[i]));n.sort();t=n;t.length||(t=["FirebaseCore-web"]);n=Er();"Browser"===n?(r=Ar(),n=Cr(r)):"Worker"===n&&(r=Ar(),n=Cr(r)+"-"+n);return n+"/JsCore/"+e+"/"+t.join(",")}function Ar(){return i.navigator&&i.navigator.userAgent||""}function Dr(e,t){e=e.split(".");t=t||i;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];n!=e.length&&(t=void 0);return t}function Rr(){try{var e=i.localStorage,t=jr();if(e)return e.setItem(t,"1"),e.removeItem(t),!sr()||!!i.indexedDB}catch(e){return wr()&&!!i.indexedDB}return!1}function Pr(){return(kr()||"chrome-extension:"===Lr()||mr())&&!Tr()&&Rr()&&!wr()}function kr(){return"http:"===Lr()||"https:"===Lr()}function Lr(){return i.location&&i.location.protocol||null}function xr(e){e=e||Ar();return!fr(e)&&Cr(e)!=Sr}function Mr(e){return"undefined"===typeof e?null:tr(e)}function Ur(e){var t={},n;for(n in e)e.hasOwnProperty(n)&&null!==e[n]&&void 0!==e[n]&&(t[n]=e[n]);return t}function Fr(e){if(null!==e)return JSON.parse(e)}function jr(e){return e||Math.floor(1e9*Math.random()).toString()}function Br(e){e=e||Ar();return"Safari"!=Cr(e)&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function Wr(){var e=i.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function qr(e,t){if(e>t)throw Error("Short delay should be less than long delay!");this.a=e;this.c=t;e=Ar();t=Er();this.b=fr(e)||"ReactNative"===t}qr.prototype.get=function(){var e=i.navigator;return(e&&"boolean"===typeof e.onLine&&(kr()||"chrome-extension:"===Lr()||"undefined"!==typeof e.connection)?e.onLine:1)?this.b?this.c:this.a:Math.min(5e3,this.a)};function Vr(){var e=i.document;return!e||"undefined"===typeof e.visibilityState||"visible"==e.visibilityState}function Hr(){var e=i.document,t=null;return Vr()||!e?Oe():new be(function(n){t=function(){Vr()&&(e.removeEventListener("visibilitychange",t,!1),n())};e.addEventListener("visibilitychange",t,!1)}).m(function(n){e.removeEventListener("visibilitychange",t,!1);throw n})}function Kr(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(e){}return null}function Gr(){return!(!Dr("fireauth.oauthhelper",i)&&!Dr("fireauth.iframe",i))}var zr={};var Qr;try{var Yr={};Object.defineProperty(Yr,"abcd",{configurable:!0,enumerable:!0,value:1});Object.defineProperty(Yr,"abcd",{configurable:!0,enumerable:!0,value:2});Qr=2==Yr.abcd}catch(e){Qr=!1}function Xr(e,t,n){Qr?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function $r(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&Xr(e,n,t[n])}function Jr(e){var t={};$r(t,e);return t}function Zr(e){var t={},n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function ei(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(void 0===r||null===r||""===r)return!1}return!0}function ti(e){var t=e;if("object"==typeof e&&null!=e){t="length"in e?[]:{};for(var n in e)Xr(t,n,ti(e[n]))}return t}function ni(e){var t={},n=e[ii],r=e[oi];e=e[ai];if(!e||e!=ri&&!n)throw Error("Invalid provider user info!");t[ui]=r||null;t[si]=n||null;Xr(this,li,e);Xr(this,ci,ti(t))}var ri="EMAIL_SIGNIN",ii="email",oi="newEmail",ai="requestType",si="email",ui="fromEmail",ci="data",li="operation";function hi(e,t){this.code=pi+e;this.message=t||di[e]||""}w(hi,Error);hi.prototype.C=function(){return{code:this.code,message:this.message}};hi.prototype.toJSON=function(){return this.C()};function fi(e){var t=e&&e.code;return t?new hi(t.substring(pi.length),e.message):null}var pi="auth/",di={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function vi(e){var t=e[mi];if("undefined"===typeof t)throw new hi("missing-continue-uri");if("string"!==typeof t||"string"===typeof t&&!t.length)throw new hi("invalid-continue-uri");this.h=t;this.b=this.a=null;this.g=!1;var n=e[yi];if(n&&"object"===typeof n){t=n[Ei];var r=n[bi];n=n[wi];if("string"===typeof t&&t.length){this.a=t;if("undefined"!==typeof r&&"boolean"!==typeof r)throw new hi("argument-error",bi+" property must be a boolean when specified.");this.g=!!r;if("undefined"!==typeof n&&("string"!==typeof n||"string"===typeof n&&!n.length))throw new hi("argument-error",wi+" property must be a non empty string when specified.");this.b=n||null}else{if("undefined"!==typeof t)throw new hi("argument-error",Ei+" property must be a non empty string when specified.");if("undefined"!==typeof r||"undefined"!==typeof n)throw new hi("missing-android-pkg-name")}}else if("undefined"!==typeof n)throw new hi("argument-error",yi+" property must be a non null object when specified.");this.f=null;if((t=e[_i])&&"object"===typeof t){if(t=t[Ti],"string"===typeof t&&t.length)this.f=t;else if("undefined"!==typeof t)throw new hi("argument-error",Ti+" property must be a non empty string when specified.")}else if("undefined"!==typeof t)throw new hi("argument-error",_i+" property must be a non null object when specified.");e=e[gi];if("undefined"!==typeof e&&"boolean"!==typeof e)throw new hi("argument-error",gi+" property must be a boolean when specified.");this.c=!!e}var yi="android",gi="handleCodeInApp",_i="iOS",mi="url",bi="installApp",wi="minimumVersion",Ei="packageName",Ti="bundleId";function Si(e){var t={};t.continueUrl=e.h;t.canHandleCodeInApp=e.c;(t.androidPackageName=e.a)&&(t.androidMinimumVersion=e.b,t.androidInstallApp=e.g);t.iOSBundleId=e.f;for(var n in t)null===t[n]&&delete t[n];return t}function Ii(e){return M(e,function(e){e=e.toString(16);return 1<e.length?e:"0"+e}).join("")}var Ci=null,Oi=null;function Ni(e){var t="";Ai(e,function(e){t+=String.fromCharCode(e)});return t}function Ai(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=Oi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}Di();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4);64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}function Di(){if(!Ci){Ci={};Oi={};for(var e=0;65>e;e++)Ci[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e),Oi[Ci[e]]=e,62<=e&&(Oi["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(e)]=e)}}function Ri(e){this.c=e.sub;b();this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null;this.b=!!e.is_anonymous||"anonymous"==this.a}Ri.prototype.f=function(){return this.b};function Pi(e){return(e=ki(e))&&e.sub&&e.iss&&e.aud&&e.exp?new Ri(e):null}function ki(e){if(!e)return null;e=e.split(".");if(3!=e.length)return null;e=e[1];for(var t=(4-e.length%4)%4,n=0;n<t;n++)e+=".";try{return JSON.parse(Ni(e))}catch(e){}return null}var Li="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),xi=["client_id","response_type","scope","redirect_uri","state"],Mi={Rc:{Ma:"locale",Aa:500,za:600,Na:"facebook.com",cb:xi},Tc:{Ma:null,Aa:500,za:620,Na:"github.com",cb:xi},Uc:{Ma:"hl",Aa:515,za:680,Na:"google.com",cb:xi},$c:{Ma:"lang",Aa:485,za:705,Na:"twitter.com",cb:Li}};function Ui(e){for(var t in Mi)if(Mi[t].Na==e)return Mi[t];return null}function Fi(e){var t={};t["facebook.com"]=Vi;t["google.com"]=Ki;t["github.com"]=Hi;t["twitter.com"]=Gi;var n=e&&e[Bi];try{if(n)return t[n]?new t[n](e):new qi(e);if("undefined"!==typeof e[ji])return new Wi(e)}catch(e){}return null}var ji="idToken",Bi="providerId";function Wi(e){var t=e[Bi];if(!t&&e[ji]){var n=Pi(e[ji]);n&&n.a&&(t=n.a)}if(!t)throw Error("Invalid additional user info!");"anonymous"!=t&&"custom"!=t||(t=null);n=!1;"undefined"!==typeof e.isNewUser?n=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(n=!0);Xr(this,"providerId",t);Xr(this,"isNewUser",n)}function qi(e){Wi.call(this,e);e=Fr(e.rawUserInfo||"{}");Xr(this,"profile",ti(e||{}))}w(qi,Wi);function Vi(e){qi.call(this,e);if("facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}w(Vi,qi);function Hi(e){qi.call(this,e);if("github.com"!=this.providerId)throw Error("Invalid provider ID!");Xr(this,"username",this.profile&&this.profile.login||null)}w(Hi,qi);function Ki(e){qi.call(this,e);if("google.com"!=this.providerId)throw Error("Invalid provider ID!")}w(Ki,qi);function Gi(e){qi.call(this,e);if("twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Xr(this,"username",e.screenName||null)}w(Gi,qi);function zi(e){this.a=cn(e)}function Qi(e){var t=cn(e),n=un(t,"link"),r=un(cn(n),"link");t=un(t,"deep_link_id");return un(cn(t),"link")||t||r||n||e}function Yi(e,t){return e.then(function(e){if(e[xa]){var n=Pi(e[xa]);if(!n||t!=n.c)throw new hi("user-mismatch");return e}throw new hi("user-mismatch")}).m(function(e){throw e&&e.code&&e.code==pi+"user-not-found"?new hi("user-mismatch"):e})}function Xi(e,t,n){if(t.idToken||t.accessToken)t.idToken&&Xr(this,"idToken",t.idToken),t.accessToken&&Xr(this,"accessToken",t.accessToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new hi("internal-error","failed to construct a credential");Xr(this,"accessToken",t.oauthToken),Xr(this,"secret",t.oauthTokenSecret)}Xr(this,"providerId",e);Xr(this,"signInMethod",n)}Xi.prototype.xa=function(e){return as(e,$i(this))};Xi.prototype.c=function(e,t){var n=$i(this);n.idToken=t;return ss(e,n)};Xi.prototype.f=function(e,t){var n=$i(this);return Yi(us(e,n),t)};function $i(e){var t={};e.idToken&&(t.id_token=e.idToken);e.accessToken&&(t.access_token=e.accessToken);e.secret&&(t.oauth_token_secret=e.secret);t.providerId=e.providerId;return{postBody:wn(t).toString(),requestUri:"http://localhost"}}Xi.prototype.C=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};this.idToken&&(e.oauthIdToken=this.idToken);this.accessToken&&(e.oauthAccessToken=this.accessToken);this.secret&&(e.oauthTokenSecret=this.secret);return e};function Ji(e,t){this.Ac=t||[];$r(this,{providerId:e,isOAuthProvider:!0});this.tb={};this.Za=(Ui(e)||{}).Ma||null;this.Xa=null}Ji.prototype.Ca=function(e){this.tb=ue(e);return this};function Zi(e){Ji.call(this,e,xi);this.a=[]}w(Zi,Ji);Zi.prototype.ta=function(e){j(this.a,e)||this.a.push(e);return this};Zi.prototype.yb=function(){return V(this.a)};Zi.prototype.credential=function(e,t){if(!e&&!t)throw new hi("argument-error","credential failed: must provide the ID token and/or the access token.");return new Xi(this.providerId,{idToken:e||null,accessToken:t||null},this.providerId)};function eo(){Zi.call(this,"facebook.com")}w(eo,Zi);Xr(eo,"PROVIDER_ID","facebook.com");Xr(eo,"FACEBOOK_SIGN_IN_METHOD","facebook.com");function to(e){if(!e)throw new hi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;p(e)&&(t=e.accessToken);return(new eo).credential(null,t)}function no(){Zi.call(this,"github.com")}w(no,Zi);Xr(no,"PROVIDER_ID","github.com");Xr(no,"GITHUB_SIGN_IN_METHOD","github.com");function ro(e){if(!e)throw new hi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;p(e)&&(t=e.accessToken);return(new no).credential(null,t)}function io(){Zi.call(this,"google.com");this.ta("profile")}w(io,Zi);Xr(io,"PROVIDER_ID","google.com");Xr(io,"GOOGLE_SIGN_IN_METHOD","google.com");function oo(e,t){var n=e;p(e)&&(n=e.idToken,t=e.accessToken);return(new io).credential(n,t)}function ao(){Ji.call(this,"twitter.com",Li)}w(ao,Ji);Xr(ao,"PROVIDER_ID","twitter.com");Xr(ao,"TWITTER_SIGN_IN_METHOD","twitter.com");function so(e,t){var n=e;p(n)||(n={oauthToken:e,oauthTokenSecret:t});if(!n.oauthToken||!n.oauthTokenSecret)throw new hi("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Xi("twitter.com",n,"twitter.com")}function uo(e,t,n){this.a=e;this.b=t;Xr(this,"providerId","password");Xr(this,"signInMethod",n===co.EMAIL_LINK_SIGN_IN_METHOD?co.EMAIL_LINK_SIGN_IN_METHOD:co.EMAIL_PASSWORD_SIGN_IN_METHOD)}uo.prototype.xa=function(e){return this.signInMethod==co.EMAIL_LINK_SIGN_IN_METHOD?Us(e,ys,{email:this.a,oobCode:this.b}):Us(e,ks,{email:this.a,password:this.b})};uo.prototype.c=function(e,t){return this.signInMethod==co.EMAIL_LINK_SIGN_IN_METHOD?Us(e,gs,{idToken:t,email:this.a,oobCode:this.b}):Us(e,Os,{idToken:t,email:this.a,password:this.b})};uo.prototype.f=function(e,t){return Yi(this.xa(e),t)};uo.prototype.C=function(){return{email:this.a,password:this.b,signInMethod:this.signInMethod}};function co(){$r(this,{providerId:"password",isOAuthProvider:!1})}function lo(e,t){t=ho(t);if(!t)throw new hi("argument-error","Invalid email link!");return new uo(e,t,co.EMAIL_LINK_SIGN_IN_METHOD)}function ho(e){e=Qi(e);e=new zi(e);var t=un(e.a,"oobCode")||null;return"signIn"===(un(e.a,"mode")||null)&&t?t:null}$r(co,{PROVIDER_ID:"password"});$r(co,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"});$r(co,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"});function fo(e){if(!(e.Ra&&e.Qa||e.Ea&&e.Z))throw new hi("internal-error");this.a=e;Xr(this,"providerId","phone");Xr(this,"signInMethod","phone")}fo.prototype.xa=function(e){return e.Sa(po(this))};fo.prototype.c=function(e,t){var n=po(this);n.idToken=t;return Us(e,xs,n)};fo.prototype.f=function(e,t){var n=po(this);n.operation="REAUTH";e=Us(e,Ms,n);return Yi(e,t)};fo.prototype.C=function(){var e={providerId:"phone"};this.a.Ra&&(e.verificationId=this.a.Ra);this.a.Qa&&(e.verificationCode=this.a.Qa);this.a.Ea&&(e.temporaryProof=this.a.Ea);this.a.Z&&(e.phoneNumber=this.a.Z);return e};function po(e){return e.a.Ea&&e.a.Z?{temporaryProof:e.a.Ea,phoneNumber:e.a.Z}:{sessionInfo:e.a.Ra,code:e.a.Qa}}function vo(t){try{this.a=t||e.auth()}catch(e){throw new hi("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}$r(this,{providerId:"phone",isOAuthProvider:!1})}vo.prototype.Sa=function(e,t){var n=this.a.b;return Oe(t.verify()).then(function(r){if(!o(r))throw new hi("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(t.type){case"recaptcha":return ns(n,{phoneNumber:e,recaptchaToken:r}).then(function(e){"function"===typeof t.reset&&t.reset();return e},function(e){"function"===typeof t.reset&&t.reset();throw e});default:throw new hi("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})};function yo(e,t){if(!e)throw new hi("missing-verification-id");if(!t)throw new hi("missing-verification-code");return new fo({Ra:e,Qa:t})}$r(vo,{PROVIDER_ID:"phone"});$r(vo,{PHONE_SIGN_IN_METHOD:"phone"});function go(e){if(e.temporaryProof&&e.phoneNumber)return new fo({Ea:e.temporaryProof,Z:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret;e=e&&e.oauthIdToken;try{switch(t){case"google.com":return oo(e,n);case"facebook.com":return to(n);case"github.com":return ro(n);case"twitter.com":return so(n,r);default:return new Zi(t).credential(e,n)}}catch(e){return null}}function _o(e){if(!e.isOAuthProvider)throw new hi("invalid-oauth-provider")}function mo(e,t,n,r,i){this.b=e;this.c=t||null;this.f=n||null;this.g=r||null;this.a=i||null;if(!this.f&&!this.a)throw new hi("invalid-auth-event");if(this.f&&this.a)throw new hi("invalid-auth-event");if(this.f&&!this.g)throw new hi("invalid-auth-event")}mo.prototype.C=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,error:this.a&&this.a.C()}};function bo(e){e=e||{};return e.type?new mo(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&fi(e.error)):null}function wo(){this.b=null;this.a=[]}var Eo=null;wo.prototype.subscribe=function(e){var t=this;this.a.push(e);this.b||(this.b=function(e){for(var n=0;n<t.a.length;n++)t.a[n](e)},e=Dr("universalLinks.subscribe",i),"function"===typeof e&&e(null,this.b))};wo.prototype.unsubscribe=function(e){W(this.a,function(t){return t==e})};function To(e){var t="unauthorized-domain",n=void 0,r=cn(e);e=r.b;r=r.c;"chrome-extension"==r?n=H("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=H("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment";hi.call(this,t,n)}w(To,hi);function So(e,t,n){hi.call(this,e,n);e=t||{};e.ub&&Xr(this,"email",e.ub);e.Z&&Xr(this,"phoneNumber",e.Z);e.credential&&Xr(this,"credential",e.credential)}w(So,hi);So.prototype.C=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email);this.phoneNumber&&(e.phoneNumber=this.phoneNumber);var t=this.credential&&this.credential.C();t&&le(e,t);return e};So.prototype.toJSON=function(){return this.C()};function Io(e){if(e.code){var t=e.code||"";0==t.indexOf(pi)&&(t=t.substring(pi.length));var n={credential:go(e)};if(e.email)n.ub=e.email;else{if(!e.phoneNumber)return new hi(t,e.message||void 0);n.Z=e.phoneNumber}return new So(t,n,e.message)}return null}var Co=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/;function Oo(){}Oo.prototype.c=null;function No(e){return e.c||(e.c=e.b())}var Ao;function Do(){}w(Do,Oo);Do.prototype.a=function(){var e=Ro(this);return e?new ActiveXObject(e):new XMLHttpRequest};Do.prototype.b=function(){var e={};Ro(this)&&(e[0]=!0,e[1]=!0);return e};function Ro(e){if(!e.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.f}Ao=new Do;function Po(){}w(Po,Oo);Po.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new ko;throw Error("Unsupported browser")};Po.prototype.b=function(){return{}};function ko(){this.a=new XDomainRequest;this.readyState=0;this.onreadystatechange=null;this.responseText="";this.status=-1;this.statusText="";this.a.onload=_(this.bc,this);this.a.onerror=_(this.zb,this);this.a.onprogress=_(this.cc,this);this.a.ontimeout=_(this.fc,this)}t=ko.prototype;t.open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)};t.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()};t.abort=function(){this.a.abort()};t.setRequestHeader=function(){};t.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""};t.bc=function(){this.status=200;this.responseText=this.a.responseText;Lo(this,4)};t.zb=function(){this.status=500;this.responseText="";Lo(this,4)};t.fc=function(){this.zb()};t.cc=function(){this.status=200;Lo(this,1)};function Lo(e,t){e.readyState=t;e.onreadystatechange&&e.onreadystatechange()}t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType};function xo(e,t,n){this.reset(e,t,n,void 0,void 0)}xo.prototype.a=null;var Mo=0;xo.prototype.reset=function(e,t,n,r,i){"number"==typeof i||Mo++;r||b();delete this.a};function Uo(e){this.f=e;this.b=this.c=this.a=null}function Fo(e,t){this.name=e;this.value=t}Fo.prototype.toString=function(){return this.name};var jo=new Fo("SEVERE",1e3),Bo=new Fo("WARNING",900),Wo=new Fo("CONFIG",700),qo=new Fo("FINE",500);function Vo(e){if(e.c)return e.c;if(e.a)return Vo(e.a);C("Root logger has no level set.");return null}Uo.prototype.log=function(e,t,n){if(e.value>=Vo(this).value)for(f(t)&&(t=t()),e=new xo(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var Ho={},Ko=null;function Go(e){Ko||(Ko=new Uo(""),Ho[""]=Ko,Ko.c=Wo);var t;if(!(t=Ho[e])){t=new Uo(e);var n=e.lastIndexOf("."),r=e.substr(n+1);n=Go(e.substr(0,n));n.b||(n.b={});n.b[r]=t;t.a=n;Ho[e]=t}return t}function zo(e,t){e&&e.log(qo,t,void 0)}function Qo(e){this.f=e}w(Qo,Oo);Qo.prototype.a=function(){return new Yo(this.f)};Qo.prototype.b=function(e){return function(){return e}}({});function Yo(e){qt.call(this);this.j=e;this.readyState=Xo;this.status=0;this.responseText=this.statusText="";this.onreadystatechange=null;this.g=new Headers;this.b=null;this.h="GET";this.c="";this.a=!1;this.f=Go("goog.net.FetchXmlHttp")}w(Yo,qt);var Xo=0;t=Yo.prototype;t.open=function(e,t){if(this.readyState!=Xo)throw this.abort(),Error("Error reopening a connection");this.h=e;this.c=t;this.readyState=1;$o(this)};t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.g,method:this.h,credentials:void 0,cache:void 0};e&&(t.body=e);this.j.fetch(new Request(this.c,t)).then(this.ec.bind(this),this.Ab.bind(this))};t.abort=function(){this.responseText="";this.g=new Headers;this.status=0;1<=this.readyState&&this.a&&4!=this.readyState&&(this.readyState=4,this.a=!1,$o(this));this.readyState=Xo};t.ec=function(e){this.a&&(this.b||(this.b=e.headers,this.readyState=2,$o(this)),this.a&&(this.readyState=3,$o(this),this.a&&e.text().then(this.dc.bind(this,e),this.Ab.bind(this))))};t.dc=function(e,t){this.a&&(this.status=e.status,this.statusText=e.statusText,this.responseText=t,this.readyState=4,$o(this))};t.Ab=function(e){var t=this.f;t&&t.log(Bo,"Failed to fetch url "+this.c,e instanceof Error?e:Error(e));this.a&&(this.readyState=4,$o(this))};t.setRequestHeader=function(e,t){this.g.append(e,t)};t.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.f)&&e.log(Bo,"Attempting to get response header but no headers have been received for url: "+this.c,void 0),"")};t.getAllResponseHeaders=function(){if(!this.b){var e=this.f;e&&e.log(Bo,"Attempting to get all response headers but no headers have been received for url: "+this.c,void 0);return""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")};function $o(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Jo(e){qt.call(this);this.headers=new $t;this.D=e||null;this.c=!1;this.B=this.a=null;this.h=this.N=this.l="";this.f=this.I=this.j=this.G=!1;this.g=0;this.s=null;this.o=Zo;this.v=this.O=!1}w(Jo,qt);var Zo="";Jo.prototype.b=Go("goog.net.XhrIo");var ea=/^https?$/i,ta=["POST","PUT"];function na(e,t,n,r,o){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET";e.l=t;e.h="";e.N=n;e.G=!1;e.c=!0;e.a=e.D?e.D.a():Ao.a();e.B=e.D?No(e.D):No(Ao);e.a.onreadystatechange=_(e.Db,e);try{zo(e.b,pa(e,"Opening Xhr")),e.I=!0,e.a.open(n,String(t),!0),e.I=!1}catch(t){zo(e.b,pa(e,"Error opening Xhr: "+t.message));oa(e,t);return}t=r||"";var a=new $t(e.headers);o&&Xt(o,function(e,t){a.set(t,e)});o=F(a.U());r=i.FormData&&t instanceof i.FormData;!j(ta,n)||o||r||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");a.forEach(function(e,t){this.a.setRequestHeader(t,e)},e);e.o&&(e.a.responseType=e.o);"withCredentials"in e.a&&e.a.withCredentials!==e.O&&(e.a.withCredentials=e.O);try{ca(e),0<e.g&&(e.v=ra(e.a),zo(e.b,pa(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.v)),e.v?(e.a.timeout=e.g,e.a.ontimeout=_(e.Fa,e)):e.s=Gt(e.Fa,e.g,e)),zo(e.b,pa(e,"Sending request")),e.j=!0,e.a.send(t),e.j=!1}catch(t){zo(e.b,pa(e,"Send error: "+t.message)),oa(e,t)}}function ra(e){return Je&&ct(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}function ia(e){return"content-type"==e.toLowerCase()}t=Jo.prototype;t.Fa=function(){"undefined"!=typeof r&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",zo(this.b,pa(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))};function oa(e,t){e.c=!1;e.a&&(e.f=!0,e.a.abort(),e.f=!1);e.h=t;aa(e);ua(e)}function aa(e){e.G||(e.G=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}t.abort=function(){this.a&&this.c&&(zo(this.b,pa(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ua(this))};t.ua=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ua(this,!0));Jo.lb.ua.call(this)};t.Db=function(){this.pa||(this.I||this.j||this.f?sa(this):this.tc())};t.tc=function(){sa(this)};function sa(e){if(e.c&&"undefined"!=typeof r)if(e.B[1]&&4==la(e)&&2==ha(e))zo(e.b,pa(e,"Local request error detected and ignored"));else if(e.j&&4==la(e))Gt(e.Db,0,e);else if(e.dispatchEvent("readystatechange"),4==la(e)){zo(e.b,pa(e,"Request complete"));e.c=!1;try{var t=ha(e);e:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break e;default:n=!1}var o;if(!(o=n)){var a;if(a=0===t){var s=String(e.l).match(en)[1]||null;if(!s&&i.self&&i.self.location){var u=i.self.location.protocol;s=u.substr(0,u.length-1)}a=!ea.test(s?s.toLowerCase():"")}o=a}if(o)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var c=2<la(e)?e.a.statusText:""}catch(t){zo(e.b,"Can not get status: "+t.message),c=""}e.h=c+" ["+ha(e)+"]";aa(e)}}finally{ua(e)}}}function ua(e,t){if(e.a){ca(e);var n=e.a,r=e.B[0]?s:null;e.a=null;e.B=null;t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){(e=e.b)&&e.log(jo,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function ca(e){e.a&&e.v&&(e.a.ontimeout=null);e.s&&(i.clearTimeout(e.s),e.s=null)}function la(e){return e.a?e.a.readyState:0}function ha(e){try{return 2<la(e)?e.a.status:-1}catch(e){return-1}}function fa(e){try{return e.a?e.a.responseText:""}catch(t){return zo(e.b,"Can not get responseText: "+t.message),""}}t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case Zo:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;e&&e.log(jo,"Response type "+this.o+" is not supported on this browser",void 0);return null}catch(e){return zo(this.b,"Can not get response: "+e.message),null}};function pa(e,t){return t+" ["+e.N+" "+e.l+" "+ha(e)+"]"}function da(e,t){this.g=[];this.v=e;this.s=t||null;this.f=this.a=!1;this.c=void 0;this.u=this.B=this.j=!1;this.h=0;this.b=null;this.l=0}da.prototype.cancel=function(e){if(this.a)this.c instanceof da&&this.c.cancel();else{if(this.b){var t=this.b;delete this.b;e?t.cancel(e):(t.l--,0>=t.l&&t.cancel())}this.v?this.v.call(this.s,this):this.u=!0;this.a||(e=new Ea(this),ya(this),va(this,!1,e))}};da.prototype.o=function(e,t){this.j=!1;va(this,e,t)};function va(e,t,n){e.a=!0;e.c=n;e.f=!t;ba(e)}function ya(e){if(e.a){if(!e.u)throw new wa(e);e.u=!1}}da.prototype.D=function(){ya(this);va(this,!0,null)};function ga(e,t){_a(e,null,t,void 0)}function _a(e,t,n,r){e.g.push([t,n,r]);e.a&&ba(e)}da.prototype.then=function(e,t,n){var r,i,o=new be(function(e,t){r=e;i=t});_a(this,r,function(e){e instanceof Ea?o.cancel():i(e)});return o.then(e,t,n)};E(da);function ma(e){return U(e.g,function(e){return f(e[1])})}function ba(e){if(e.h&&e.a&&ma(e)){var t=e.h,n=Sa[t];n&&(i.clearTimeout(n.a),delete Sa[t]);e.h=0}e.b&&(e.b.l--,delete e.b);t=e.c;for(var r=n=!1;e.g.length&&!e.j;){var o=e.g.shift(),a=o[0],s=o[1];o=o[2];if(a=e.f?s:a)try{var u=a.call(o||e.s,t);void 0!==u&&(e.f=e.f&&(u==t||u instanceof Error),e.c=t=u);(T(t)||"function"===typeof i.Promise&&t instanceof i.Promise)&&(r=!0,e.j=!0)}catch(r){t=r,e.f=!0,ma(e)||(n=!0)}}e.c=t;r&&(u=_(e.o,e,!0),r=_(e.o,e,!1),t instanceof da?(_a(t,u,r),t.B=!0):t.then(u,r));n&&(t=new Ta(t),Sa[t.a]=t,e.h=t.a)}function wa(){S.call(this)}w(wa,S);wa.prototype.message="Deferred has already fired";wa.prototype.name="AlreadyCalledError";function Ea(){S.call(this)}w(Ea,S);Ea.prototype.message="Deferred was canceled";Ea.prototype.name="CanceledError";function Ta(e){this.a=i.setTimeout(_(this.c,this),0);this.b=e}Ta.prototype.c=function(){delete Sa[this.a];throw this.b};var Sa={};function Ia(e){var t={},n=t.document||document,r=kn(e),i=document.createElement("SCRIPT"),o={Fb:i,Fa:void 0},a=new da(Oa,o),s=null,u=null!=t.timeout?t.timeout:5e3;0<u&&(s=window.setTimeout(function(){Na(i,!0);var e=new Ra(Da,"Timeout reached for loading script "+r);ya(a);va(a,!1,e)},u),o.Fa=s);i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Na(i,t.bd||!1,s),a.D())};i.onerror=function(){Na(i,!0,s);var e=new Ra(Aa,"Error while loading script "+r);ya(a);va(a,!1,e)};o=t.attributes||{};le(o,{type:"text/javascript",charset:"UTF-8"});Xn(i,o);i.src=kn(e);Ca(n).appendChild(i);return a}function Ca(e){var t;return(t=(e||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:e.documentElement}function Oa(){if(this&&this.Fb){var e=this.Fb;e&&"SCRIPT"==e.tagName&&Na(e,!0,this.Fa)}}function Na(e,t,n){null!=n&&i.clearTimeout(n);e.onload=s;e.onerror=s;e.onreadystatechange=s;t&&window.setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e)},0)}var Aa=0,Da=1;function Ra(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t);S.call(this,n);this.code=e}w(Ra,S);function Pa(e){this.f=e}w(Pa,Oo);Pa.prototype.a=function(){return new this.f};Pa.prototype.b=function(){return{}};function ka(t,n,r){this.b=t;t=n||{};this.j=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token";this.l=t.secureTokenTimeout||Ma;this.f=ue(t.secureTokenHeaders||Ua);this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/";this.h=t.firebaseTimeout||Fa;this.a=ue(t.firebaseHeaders||ja);r&&(this.a["X-Client-Version"]=r,this.f["X-Client-Version"]=r);r="Node"==Er();r=i.XMLHttpRequest||r&&e.INTERNAL.node&&e.INTERNAL.node.XMLHttpRequest;if(!r&&!wr())throw new hi("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0;wr()?this.c=new Qo(self):Tr()?this.c=new Pa(r):this.c=new Po}var La,xa="idToken",Ma=new qr(3e4,6e4),Ua={"Content-Type":"application/x-www-form-urlencoded"},Fa=new qr(3e4,6e4),ja={"Content-Type":"application/json"};function Ba(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function Wa(e,t){t?(e.a["X-Client-Version"]=t,e.f["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.f["X-Client-Version"])}function qa(e,t,n,r,i,o,a){hr()||wr()?e=_(e.o,e):(La||(La=new be(function(e,t){Ka(e,t)})),e=_(e.u,e));e(t,n,r,i,o,a)}ka.prototype.o=function(e,t,n,r,o,a){if(wr()&&("undefined"===typeof i.fetch||"undefined"===typeof i.Headers||"undefined"===typeof i.Request))throw new hi("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new Jo(this.c);if(a){s.g=Math.max(0,a);var u=setTimeout(function(){s.dispatchEvent("timeout")},a)}Vt(s,"complete",function(){u&&clearTimeout(u);var e=null;try{e=JSON.parse(fa(this))||null}catch(t){e=null}t&&t(e)});Ht(s,"ready",function(){u&&clearTimeout(u);Qe(this)});Ht(s,"timeout",function(){u&&clearTimeout(u);Qe(this);t&&t(null)});na(s,e,n,r,o)};var Va=Rn("https://apis.google.com/js/client.js?onload=%{onload}"),Ha="__fcb"+Math.floor(1e6*Math.random()).toString();function Ka(e,t){if(((window.gapi||{}).client||{}).request)e();else{i[Ha]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))};var n=Ln(Va,{onload:Ha});ga(Ia(n),function(){t(Error("CORS_UNSUPPORTED"))})}}ka.prototype.u=function(e,t,n,r,i){var o=this;La.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null);window.gapi.client.request({path:e,method:n,body:r,headers:i,authType:"none",callback:function(e){window.gapi.auth.setToken(a);t&&t(e)}})}).m(function(e){t&&t({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})})};function Ga(e,t){return new be(function(n,r){"refresh_token"==t.grant_type&&t.refresh_token||"authorization_code"==t.grant_type&&t.code?qa(e,e.j+"?key="+encodeURIComponent(e.b),function(e){e?e.error?r(js(e)):e.access_token&&e.refresh_token?n(e):r(new hi("internal-error")):r(new hi("network-request-failed"))},"POST",wn(t).toString(),e.f,e.l.get()):r(new hi("internal-error"))})}function za(e,t,n,r,i,o){var a=cn(e.g+t);sn(a,"key",e.b);o&&sn(a,"cb",b().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&sn(a,u,r[u]);return new be(function(t,o){qa(e,a.toString(),function(e){e?e.error?o(js(e,i||{})):t(e):o(new hi("network-request-failed"))},n,s?void 0:tr(Ur(r)),e.a,e.h.get())})}function Qa(e){if(!Co.test(e.email))throw new hi("invalid-email")}function Ya(e){"email"in e&&Qa(e)}function Xa(e,t){return Us(e,ps,{identifier:t,continueUri:kr()?ur():"http://localhost"}).then(function(e){return e.allProviders||[]})}function $a(e,t){return Us(e,ps,{identifier:t,continueUri:kr()?ur():"http://localhost"}).then(function(e){return e.signinMethods||[]})}function Ja(e){return Us(e,Es,{}).then(function(e){return e.authorizedDomains||[]})}function Za(e){if(!e[xa])throw new hi("internal-error")}function es(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new hi("internal-error")}else{if(!e.sessionInfo)throw new hi("missing-verification-id");if(!e.code)throw new hi("missing-verification-code")}}ka.prototype.jb=function(){return Us(this,Ns,{})};ka.prototype.mb=function(e,t){return Us(this,Cs,{idToken:e,email:t})};ka.prototype.nb=function(e,t){return Us(this,Os,{idToken:e,password:t})};var ts={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};t=ka.prototype;t.ob=function(e,t){var n={idToken:e},r=[];ae(ts,function(e,i){var o=t[i];null===o?r.push(e):i in t&&(n[i]=o)});r.length&&(n.deleteAttribute=r);return Us(this,Cs,n)};t.gb=function(e,t){e={requestType:"PASSWORD_RESET",email:e};le(e,t);return Us(this,ws,e)};t.hb=function(e,t){e={requestType:"EMAIL_SIGNIN",email:e};le(e,t);return Us(this,ms,e)};t.fb=function(e,t){e={requestType:"VERIFY_EMAIL",idToken:e};le(e,t);return Us(this,bs,e)};function ns(e,t){return Us(e,Is,t)}t.Sa=function(e){return Us(this,Ls,e)};function rs(e,t,n){return Us(e,vs,{idToken:t,deleteProvider:n})}function is(e){if(!e.requestUri||!e.sessionId&&!e.postBody)throw new hi("internal-error")}function os(e){var t=null;e.needConfirmation?(e.code="account-exists-with-different-credential",t=Io(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=Io(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=Io(e)):e.errorMessage&&(t=Fs(e.errorMessage));if(t)throw t;if(!e[xa])throw new hi("internal-error")}function as(e,t){t.returnIdpCredential=!0;return Us(e,As,t)}function ss(e,t){t.returnIdpCredential=!0;return Us(e,Rs,t)}function us(e,t){t.returnIdpCredential=!0;t.autoCreate=!1;return Us(e,Ds,t)}function cs(e){if(!e.oobCode)throw new hi("invalid-action-code")}t.Wa=function(e,t){return Us(this,Ss,{oobCode:e,newPassword:t})};t.Ia=function(e){return Us(this,hs,{oobCode:e})};t.Ua=function(e){return Us(this,ls,{oobCode:e})};var ls={endpoint:"setAccountInfo",A:cs,ba:"email"},hs={endpoint:"resetPassword",A:cs,J:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t)throw new hi("internal-error")}},fs={endpoint:"signupNewUser",A:function(e){Qa(e);if(!e.password)throw new hi("weak-password")},J:Za,R:!0},ps={endpoint:"createAuthUri"},ds={endpoint:"deleteAccount",T:["idToken"]},vs={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],A:function(e){if(!l(e.deleteProvider))throw new hi("internal-error")}},ys={endpoint:"emailLinkSignin",T:["email","oobCode"],A:Qa,J:Za,R:!0},gs={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],A:Qa,J:Za,R:!0},_s={endpoint:"getAccountInfo"},ms={endpoint:"getOobConfirmationCode",T:["requestType"],A:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new hi("internal-error");Qa(e)},ba:"email"},bs={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],A:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new hi("internal-error")},ba:"email"},ws={endpoint:"getOobConfirmationCode",T:["requestType"],A:function(e){if("PASSWORD_RESET"!=e.requestType)throw new hi("internal-error");Qa(e)},ba:"email"},Es={pb:!0,endpoint:"getProjectConfig",Cb:"GET"},Ts={pb:!0,endpoint:"getRecaptchaParam",Cb:"GET",J:function(e){if(!e.recaptchaSiteKey)throw new hi("internal-error")}},Ss={endpoint:"resetPassword",A:cs,ba:"email"},Is={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],ba:"sessionInfo"},Cs={endpoint:"setAccountInfo",T:["idToken"],A:Ya,R:!0},Os={endpoint:"setAccountInfo",T:["idToken"],A:function(e){Ya(e);if(!e.password)throw new hi("weak-password")},J:Za,R:!0},Ns={endpoint:"signupNewUser",J:Za,R:!0},As={endpoint:"verifyAssertion",A:is,J:os,R:!0},Ds={endpoint:"verifyAssertion",A:is,J:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new hi("user-not-found");if(e.errorMessage)throw Fs(e.errorMessage);if(!e[xa])throw new hi("internal-error")},R:!0},Rs={endpoint:"verifyAssertion",A:function(e){is(e);if(!e.idToken)throw new hi("internal-error")},J:os,R:!0},Ps={endpoint:"verifyCustomToken",A:function(e){if(!e.token)throw new hi("invalid-custom-token")},J:Za,R:!0},ks={endpoint:"verifyPassword",A:function(e){Qa(e);if(!e.password)throw new hi("wrong-password")},J:Za,R:!0},Ls={endpoint:"verifyPhoneNumber",A:es,J:Za},xs={endpoint:"verifyPhoneNumber",A:function(e){if(!e.idToken)throw new hi("internal-error");es(e)},J:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",Io(e);Za(e)}},Ms={Tb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:es,J:Za};function Us(e,t,n){if(!ei(n,t.T))return Ne(new hi("internal-error"));var r=t.Cb||"POST",i;return Oe(n).then(t.A).then(function(){t.R&&(n.returnSecureToken=!0);return za(e,t.endpoint,r,n,t.Tb,t.pb||!1)}).then(function(e){return i=e}).then(t.J).then(function(){if(!t.ba)return i;if(!(t.ba in i))throw new hi("internal-error");return i[t.ba]})}function Fs(e){return js({error:{errors:[{message:e}],code:400,message:e}})}function js(e,t){var n=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"";var r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new hi(r[n]):null)return n;n=e.error&&e.error.message||"";r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"};le(r,t||{});t=(t=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<t.length?t[1]:void 0;for(var i in r)if(0===n.indexOf(i))return new hi(r[i],t);!t&&e&&(t=Mr(e));return new hi("internal-error",t)}var Bs={Wc:{Ya:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",eb:"https://securetoken.googleapis.com/v1/token",id:"p"},Yc:{Ya:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",eb:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},Zc:{Ya:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",eb:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function Ws(e){for(var t in Bs)if(Bs[t].id===e)return e=Bs[t],{firebaseEndpoint:e.Ya,secureTokenEndpoint:e.eb};return null}var qs;qs=Ws("__EID__")?"__EID__":void 0;function Vs(e){this.b=e;this.a=null;this.ab=Hs(this)}function Hs(e){return $s().then(function(){return new be(function(t,n){Dr("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o);t()}e.a=r;e.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},Ys.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}function Ks(e,t){return e.ab.then(function(){return new be(function(n){e.a.send(t.type,t,n,Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}function Gs(e,t){e.ab.then(function(){e.a.register("authEvent",t,Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}var zs=Rn("https://apis.google.com/js/api.js?onload=%{onload}"),Qs=new qr(3e4,6e4),Ys=new qr(5e3,15e3),Xs=null;function $s(){return Xs||(Xs=new be(function(e,t){function n(){Wr();Dr("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){Wr();t(Error("Network Error"))},timeout:Qs.get()})}if(Dr("gapi.iframes.Iframe"))e();else if(Dr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();i[r]=function(){Dr("gapi.load")?n():t(Error("Network Error"))};r=Ln(zs,{onload:r});Oe(Ia(r)).m(function(){t(Error("Network Error"))})}}).m(function(e){Xs=null;throw e}))}function Js(e,t,n){this.j=e;this.g=t;this.h=n;this.f=null;this.a=ln(this.j,"/__/auth/iframe");sn(this.a,"apiKey",this.g);sn(this.a,"appName",this.h);this.b=null;this.c=[]}Js.prototype.toString=function(){this.f?sn(this.a,"v",this.f):En(this.a.a,"v");this.b?sn(this.a,"eid",this.b):En(this.a.a,"eid");this.c.length?sn(this.a,"fw",this.c.join(",")):En(this.a.a,"fw");return this.a.toString()};function Zs(e,t,n,r,i){this.o=e;this.u=t;this.c=n;this.l=r;this.h=this.g=this.j=null;this.a=i;this.f=null}Zs.prototype.toString=function(){var t=ln(this.o,"/__/auth/handler");sn(t,"apiKey",this.u);sn(t,"appName",this.c);sn(t,"authType",this.l);if(this.a.isOAuthProvider){var n=this.a;try{var r=e.app(this.c).auth().ca()}catch(e){r=null}n.Xa=r;sn(t,"providerId",this.a.providerId);n=this.a;r=Ur(n.tb);for(var i in r)r[i]=r[i].toString();i=n.Ac;r=ue(r);for(var o=0;o<i.length;o++){var a=i[o];a in r&&delete r[a]}n.Za&&n.Xa&&!r[n.Za]&&(r[n.Za]=n.Xa);se(r)||sn(t,"customParameters",Mr(r))}"function"===typeof this.a.yb&&(n=this.a.yb(),n.length&&sn(t,"scopes",n.join(",")));this.j?sn(t,"redirectUrl",this.j):En(t.a,"redirectUrl");this.g?sn(t,"eventId",this.g):En(t.a,"eventId");this.h?sn(t,"v",this.h):En(t.a,"v");if(this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!un(t,s)&&sn(t,s,this.b[s]);this.f?sn(t,"eid",this.f):En(t.a,"eid");s=eu(this.c);s.length&&sn(t,"fw",s.join(","));return t.toString()};function eu(t){try{return e.app(t).auth().Ka()}catch(e){return[]}}function tu(e,t,n,r,i){this.u=e;this.f=t;this.b=n;this.c=r||null;this.h=i||null;this.o=this.s=this.v=null;this.g=[];this.l=this.a=null}function nu(e){var t=ur();return Ja(e).then(function(e){e:{var n=cn(t),r=n.c;n=n.b;for(var i=0;i<e.length;i++){var o=e[i];var a=n;var s=r;0==o.indexOf("chrome-extension://")?a=cn(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:yr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a));if(a){e=!0;break e}}e=!1}if(!e)throw new To(ur())})}function ru(e){if(e.l)return e.l;e.l=gr().then(function(){if(!e.s){var t=e.c,n=e.h,r=eu(e.b),i=new Js(e.u,e.f,e.b);i.f=t;i.b=n;i.c=V(r||[]);e.s=i.toString()}e.j=new Vs(e.s);au(e)});return e.l}t=tu.prototype;t.Da=function(e,t,n){var r=new hi("popup-closed-by-user"),i=new hi("web-storage-unsupported"),o=this,a=!1;return this.ea().then(function(){su(o).then(function(n){n||(e&&pr(e),t(i),a=!0)})}).m(function(){}).then(function(){if(!a)return vr(e)}).then(function(){if(!a)return zt(n).then(function(){t(r)})})};t.Gb=function(){var e=Ar();return!xr(e)&&!Br(e)};t.Bb=function(){return!1};t.xb=function(e,t,n,r,i,o,a){if(!e)return Ne(new hi("popup-blocked"));if(a&&!xr())return this.ea().m(function(t){pr(e);i(t)}),r(),Oe();this.a||(this.a=nu(iu(this)));var s=this;return this.a.then(function(){var t=s.ea().m(function(t){pr(e);i(t);throw t});r();return t}).then(function(){_o(n);if(!a){var r=ou(s.u,s.f,s.b,t,n,null,o,s.c,void 0,s.h);cr(r,e)}}).m(function(e){"auth/network-request-failed"==e.code&&(s.a=null);throw e})};function iu(e){e.o||(e.v=e.c?Nr(e.c,eu(e.b)):null,e.o=new ka(e.f,Ws(e.h),e.v));return e.o}t.Ba=function(e,t,n){this.a||(this.a=nu(iu(this)));var r=this;return this.a.then(function(){_o(t);var i=ou(r.u,r.f,r.b,e,t,ur(),n,r.c,void 0,r.h);cr(i)}).m(function(e){"auth/network-request-failed"==e.code&&(r.a=null);throw e})};t.ea=function(){var e=this;return ru(this).then(function(){return e.j.ab}).m(function(){e.a=null;throw new hi("network-request-failed")})};t.Lb=function(){return!0};function ou(e,t,n,r,i,o,a,s,u,c){e=new Zs(e,t,n,r,i);e.j=o;e.g=a;e.h=s;e.b=ue(u||null);e.f=c;return e.toString()}function au(e){if(!e.j)throw Error("IfcHandler must be initialized!");Gs(e.j,function(t){var n={};if(t&&t.authEvent){var r=!1;t=bo(t.authEvent);for(n=0;n<e.g.length;n++)r=e.g[n](t)||r;n={};n.status=r?"ACK":"ERROR";return Oe(n)}n.status="ERROR";return Oe(n)})}function su(e){var t={type:"webStorageSupport"};return ru(e).then(function(){return Ks(e.j,t)}).then(function(e){if(e&&e.length&&"undefined"!==typeof e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()})}t.va=function(e){this.g.push(e)};t.Ja=function(e){W(this.g,function(t){return t==e})};function uu(t){this.a=t||e.INTERNAL.reactNative&&e.INTERNAL.reactNative.AsyncStorage;if(!this.a)throw new hi("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}t=uu.prototype;t.get=function(e){return Oe(this.a.getItem(e)).then(function(e){return e&&Fr(e)})};t.set=function(e,t){return Oe(this.a.setItem(e,Mr(t)))};t.P=function(e){return Oe(this.a.removeItem(e))};t.Y=function(){};t.aa=function(){};function cu(){if(!du())throw new hi("web-storage-unsupported");this.f={};this.a=[];this.b=0;this.g=i.indexedDB;this.type="indexedDB"}var lu;function hu(e){return new be(function(t,n){var r=e.g.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){t()};r.onerror=function(e){n(Error(e.target.error))}})}function fu(e){return new be(function(t,n){var r=e.g.open("firebaseLocalStorageDb",1);r.onerror=function(e){try{e.preventDefault()}catch(e){}n(Error(e.target.error))};r.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}};r.onsuccess=function(r){r=r.target.result;r.objectStoreNames.contains("firebaseLocalStorage")?t(r):hu(e).then(function(){return fu(e)}).then(function(e){t(e)}).m(function(e){n(e)})}})}function pu(e){e.h||(e.h=fu(e));return e.h}function du(){try{return!!i.indexedDB}catch(e){return!1}}function vu(e){return e.objectStore("firebaseLocalStorage")}function yu(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function gu(e){return new be(function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()};e.onerror=function(e){n(Error(e.target.errorCode))}})}t=cu.prototype;t.set=function(e,t){var n=!1,r,i=this;return pu(this).then(function(t){r=t;t=vu(yu(r,!0));return gu(t.get(e))}).then(function(o){var a=vu(yu(r,!0));if(o)return o.value=t,gu(a.put(o));i.b++;n=!0;o={};o.fbase_key=e;o.value=t;return gu(a.add(o))}).then(function(){i.f[e]=t}).ha(function(){n&&i.b--})};t.get=function(e){return pu(this).then(function(t){return gu(vu(yu(t,!1)).get(e))}).then(function(e){return e&&e.value})};t.P=function(e){var t=!1,n=this;return pu(this).then(function(r){t=!0;n.b++;return gu(vu(yu(r,!0))["delete"](e))}).then(function(){delete n.f[e]}).ha(function(){t&&n.b--})};t.Jc=function(){var e=this;return pu(this).then(function(e){var t=vu(yu(e,!1));return t.getAll?gu(t.getAll()):new be(function(e,n){var r=[],i=t.openCursor();i.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t["continue"]()):e(r)};i.onerror=function(e){n(Error(e.target.errorCode))}})}).then(function(t){var n={},r=[];if(0==e.b){for(r=0;r<t.length;r++)n[t[r].fbase_key]=t[r].value;r=lr(e.f,n);e.f=n}return r})};t.Y=function(e){0==this.a.length&&_u(this);this.a.push(e)};t.aa=function(e){W(this.a,function(t){return t==e});0==this.a.length&&this.c&&this.c.cancel("STOP_EVENT")};function _u(e){function t(){e.c=zt(800).then(_(e.Jc,e)).then(function(t){0<t.length&&L(e.a,function(e){e(t)})}).then(t).m(function(e){"STOP_EVENT"!=e.message&&t()});return e.c}e.c&&e.c.cancel("STOP_EVENT");t()}function mu(e){var t=this,n=null;this.a=[];this.type="indexedDB";this.c=e;this.b=Oe().then(function(){return du()?(lu||(lu=new cu),n=lu,n.set("__sak","!").then(function(){return n.get("__sak")}).then(function(e){if("!"!==e)throw Error("indexedDB not supported!");return n.P("__sak")}).then(function(){return n}).m(function(){return t.c})):t.c}).then(function(e){t.type=e.type;e.Y(function(e){L(t.a,function(t){t(e)})});return e})}t=mu.prototype;t.get=function(e){return this.b.then(function(t){return t.get(e)})};t.set=function(e,t){return this.b.then(function(n){return n.set(e,t)})};t.P=function(e){return this.b.then(function(t){return t.P(e)})};t.Y=function(e){this.a.push(e)};t.aa=function(e){W(this.a,function(t){return t==e})};function bu(){this.a={};this.type="inMemory"}t=bu.prototype;t.get=function(e){return Oe(this.a[e])};t.set=function(e,t){this.a[e]=t;return Oe()};t.P=function(e){delete this.a[e];return Oe()};t.Y=function(){};t.aa=function(){};function wu(){if(!Tu()){if("Node"==Er())throw new hi("internal-error","The LocalStorage compatibility library was not found.");throw new hi("web-storage-unsupported")}this.a=Eu()||e.INTERNAL.node.localStorage;this.type="localStorage"}function Eu(){try{var e=i.localStorage,t=jr();e&&(e.setItem(t,"1"),e.removeItem(t));return e}catch(e){return null}}function Tu(){var t="Node"==Er();t=Eu()||t&&e.INTERNAL.node&&e.INTERNAL.node.localStorage;if(!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}t=wu.prototype;t.get=function(e){var t=this;return Oe().then(function(){var n=t.a.getItem(e);return Fr(n)})};t.set=function(e,t){var n=this;return Oe().then(function(){var r=Mr(t);null===r?n.P(e):n.a.setItem(e,r)})};t.P=function(e){var t=this;return Oe().then(function(){t.a.removeItem(e)})};t.Y=function(e){i.window&&At(i.window,"storage",e)};t.aa=function(e){i.window&&kt(i.window,"storage",e)};function Su(){this.type="nullStorage"}t=Su.prototype;t.get=function(){return Oe(null)};t.set=function(){return Oe()};t.P=function(){return Oe()};t.Y=function(){};t.aa=function(){};function Iu(){if(!Ou()){if("Node"==Er())throw new hi("internal-error","The SessionStorage compatibility library was not found.");throw new hi("web-storage-unsupported")}this.a=Cu()||e.INTERNAL.node.sessionStorage;this.type="sessionStorage"}function Cu(){try{var e=i.sessionStorage,t=jr();e&&(e.setItem(t,"1"),e.removeItem(t));return e}catch(e){return null}}function Ou(){var t="Node"==Er();t=Cu()||t&&e.INTERNAL.node&&e.INTERNAL.node.sessionStorage;if(!t)return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}t=Iu.prototype;t.get=function(e){var t=this;return Oe().then(function(){var n=t.a.getItem(e);return Fr(n)})};t.set=function(e,t){var n=this;return Oe().then(function(){var r=Mr(t);null===r?n.P(e):n.a.setItem(e,r)})};t.P=function(e){var t=this;return Oe().then(function(){t.a.removeItem(e)})};t.Y=function(){};t.aa=function(){};function Nu(){var e={};e.Browser=Du;e.Node=Ru;e.ReactNative=Pu;e.Worker=ku;this.a=e[Er()]}var Au,Du={w:wu,Pa:Iu},Ru={w:wu,Pa:Iu},Pu={w:uu,Pa:Su},ku={w:wu,Pa:Su};var Lu={Vc:"local",NONE:"none",Xc:"session"};function xu(e){var t=new hi("invalid-persistence-type"),n=new hi("unsupported-persistence-type");e:{for(r in Lu)if(Lu[r]==e){var r=!0;break e}r=!1}if(!r||"string"!==typeof e)throw t;switch(Er()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;default:if(!Rr()&&"none"!==e)throw n}}function Mu(){var e=!(Br(Ar())||!br()),t=xr(),n=Rr();this.o=e;this.h=t;this.l=n;this.a={};Au||(Au=new Nu);e=Au;try{this.g=!sr()&&Gr()||!i.indexedDB?new e.a.w:new mu(wr()?new bu:new e.a.w)}catch(e){this.g=new bu,this.h=!0}try{this.j=new e.a.Pa}catch(e){this.j=new bu}this.u=new bu;this.f=_(this.Kb,this);this.b={}}var Uu;function Fu(){Uu||(Uu=new Mu);return Uu}function ju(e,t){switch(t){case"session":return e.j;case"none":return e.u;default:return e.g}}function Bu(e,t){return"firebase:"+e.name+(t?":"+t:"")}function Wu(e,t,n){var r=Bu(t,n),o=ju(e,t.w);return e.get(t,n).then(function(a){var s=null;try{s=Fr(i.localStorage.getItem(r))}catch(e){}if(s&&!a)return i.localStorage.removeItem(r),e.set(t,s,n);s&&a&&"localStorage"!=o.type&&i.localStorage.removeItem(r)})}t=Mu.prototype;t.get=function(e,t){return ju(this,e.w).get(Bu(e,t))};function qu(e,t,n){n=Bu(t,n);"local"==t.w&&(e.b[n]=null);return ju(e,t.w).P(n)}t.set=function(e,t,n){var r=Bu(e,n),i=this,o=ju(this,e.w);return o.set(r,t).then(function(){return o.get(r)}).then(function(t){"local"==e.w&&(i.b[r]=t)})};t.addListener=function(e,t,n){e=Bu(e,t);this.l&&(this.b[e]=i.localStorage.getItem(e));se(this.a)&&(ju(this,"local").Y(this.f),this.h||(sr()||!Gr())&&i.indexedDB||!this.l||Vu(this));this.a[e]||(this.a[e]=[]);this.a[e].push(n)};t.removeListener=function(e,t,n){e=Bu(e,t);this.a[e]&&(W(this.a[e],function(e){return e==n}),0==this.a[e].length&&delete this.a[e]);se(this.a)&&(ju(this,"local").aa(this.f),Hu(this))};function Vu(e){Hu(e);e.c=setInterval(function(){for(var t in e.a){var n=i.localStorage.getItem(t),r=e.b[t];n!=r&&(e.b[t]=n,n=new gt({type:"storage",key:t,target:window,oldValue:r,newValue:n,a:!0}),e.Kb(n))}},1e3)}function Hu(e){e.c&&(clearInterval(e.c),e.c=null)}t.Kb=function(e){if(e&&e.f){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];"undefined"===typeof r&&(r=null);var o=i.localStorage.getItem(n);o!==r&&(this.b[n]=o,this.Va(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){"undefined"!==typeof e.a.a?ju(this,"local").aa(this.f):Hu(this);if(this.o)if(n=i.localStorage.getItem(t),r=e.a.newValue,r!==n)null!==r?i.localStorage.setItem(t,r):i.localStorage.removeItem(t);else if(this.b[t]===r&&"undefined"===typeof e.a.a)return;var a=this;n=function(){"undefined"===typeof e.a.a&&a.b[t]===i.localStorage.getItem(t)||(a.b[t]=i.localStorage.getItem(t),a.Va(t))};Je&&lt&&10==lt&&i.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else L(e,_(this.Va,this))};t.Va=function(e){this.a[e]&&L(this.a[e],function(e){e()})};function Ku(e){this.a=e;this.b=Fu()}var Gu={name:"authEvent",w:"local"};function zu(e){return e.b.get(Gu,e.a).then(function(e){return bo(e)})}function Qu(){this.a=Fu()}function Yu(){this.b=-1}function Xu(e,t){this.b=-1;this.b=Ju;this.f=i.Uint8Array?new Uint8Array(this.b):Array(this.b);this.g=this.c=0;this.a=[];this.j=e;this.h=t;this.l=i.Int32Array?new Int32Array(64):Array(64);void 0!==$u||($u=i.Int32Array?new Int32Array(oc):oc);this.reset()}var $u;w(Xu,Yu);for(var Ju=64,Zu=Ju-1,ec=[],tc=0;tc<Zu;tc++)ec[tc]=0;var nc=q(128,ec);Xu.prototype.reset=function(){this.g=this.c=0;this.a=i.Int32Array?new Int32Array(this.h):V(this.h)};function rc(e){for(var t=e.f,n=e.l,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;64>t;t++){i=0|n[t-15];r=0|n[t-2];var o=(0|n[t-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[t-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+a|0}r=0|e.a[0];i=0|e.a[1];var s=0|e.a[2],u=0|e.a[3],c=0|e.a[4],l=0|e.a[5],h=0|e.a[6];o=0|e.a[7];for(t=0;64>t;t++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=c&l^~c&h;o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0;a=a+(0|$u[t])|0;a=o+(a+(0|n[t])|0)|0;o=h;h=l;l=c;c=u+a|0;u=s;s=i;i=r;r=a+f|0}e.a[0]=e.a[0]+r|0;e.a[1]=e.a[1]+i|0;e.a[2]=e.a[2]+s|0;e.a[3]=e.a[3]+u|0;e.a[4]=e.a[4]+c|0;e.a[5]=e.a[5]+l|0;e.a[6]=e.a[6]+h|0;e.a[7]=e.a[7]+o|0}function ic(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if(o(t))for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(rc(e),i=0);else{if(!h(t))throw Error("message must be string or array");for(;r<n;){var a=t[r++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");e.f[i++]=a;i==e.b&&(rc(e),i=0)}}e.c=i;e.g+=n}var oc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ac(){Xu.call(this,8,sc)}w(ac,Xu);var sc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function uc(e,t,n,r,i){this.u=e;this.j=t;this.l=n;this.o=r||null;this.s=i||null;this.h=t+":"+n;this.v=new Qu;this.g=new Ku(this.h);this.f=null;this.b=[];this.a=this.c=null}function cc(e){return new hi("invalid-cordova-configuration",e)}t=uc.prototype;t.ea=function(){return this.ya?this.ya:this.ya=_r().then(function(){if("function"!==typeof Dr("universalLinks.subscribe",i))throw cc("cordova-universal-links-plugin is not installed");if("undefined"===typeof Dr("BuildInfo.packageName",i))throw cc("cordova-plugin-buildinfo is not installed");if("function"!==typeof Dr("cordova.plugins.browsertab.openUrl",i))throw cc("cordova-plugin-browsertab is not installed");if("function"!==typeof Dr("cordova.InAppBrowser.open",i))throw cc("cordova-plugin-inappbrowser is not installed")},function(){throw new hi("cordova-not-ready")})};function lc(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}function hc(e){var t=new ac;ic(t,e);e=[];var n=8*t.g;56>t.c?ic(t,nc,56-t.c):ic(t,nc,t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;rc(t);for(r=n=0;r<t.j;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return Ii(e)}t.Da=function(e,t){t(new hi("operation-not-supported-in-this-environment"));return Oe()};t.xb=function(){return Ne(new hi("operation-not-supported-in-this-environment"))};t.Lb=function(){return!1};t.Gb=function(){return!0};t.Bb=function(){return!0};t.Ba=function(e,t,n){if(this.c)return Ne(new hi("redirect-operation-pending"));var r=this,o=i.document,a=null,s=null,u=null,c=null;return this.c=Oe().then(function(){_o(t);return dc(r)}).then(function(){return fc(r,e,t,n)}).then(function(){return new be(function(e,t){s=function(){var t=Dr("cordova.plugins.browsertab.close",i);e();"function"===typeof t&&t();r.a&&"function"===typeof r.a.close&&(r.a.close(),r.a=null);return!1};r.va(s);u=function(){a||(a=zt(2e3).then(function(){t(new hi("redirect-cancelled-by-user"))}))};c=function(){Vr()&&u()};o.addEventListener("resume",u,!1);Ar().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)}).m(function(e){return vc(r).then(function(){throw e})})}).ha(function(){u&&o.removeEventListener("resume",u,!1);c&&o.removeEventListener("visibilitychange",c,!1);a&&a.cancel();s&&r.Ja(s);r.c=null})};function fc(e,t,n,r){var o=lc(),a=new mo(t,r,null,o,new hi("no-auth-event")),s=Dr("BuildInfo.packageName",i);if("string"!==typeof s)throw new hi("invalid-cordova-configuration");var u=Dr("BuildInfo.displayName",i),c={};if(Ar().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!Ar().toLowerCase().match(/android/))return Ne(new hi("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u);o=hc(o);c.sessionId=o;var l=ou(e.u,e.j,e.l,t,n,null,r,e.o,c,e.s);return e.ea().then(function(){var t=e.h;return e.v.a.set(Gu,a.C(),t)}).then(function(){var t=Dr("cordova.plugins.browsertab.isAvailable",i);if("function"!==typeof t)throw new hi("invalid-cordova-configuration");var n=null;t(function(t){if(t){n=Dr("cordova.plugins.browsertab.openUrl",i);if("function"!==typeof n)throw new hi("invalid-cordova-configuration");n(l)}else{n=Dr("cordova.InAppBrowser.open",i);if("function"!==typeof n)throw new hi("invalid-cordova-configuration");t=Ar();t=!(!t.match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!t.match(/(iPad|iPhone|iPod).*OS 8_\d/i));e.a=n(l,t?"_blank":"_system","location=yes")}})})}function pc(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(e){}}function dc(e){e.f||(e.f=e.ea().then(function(){return new be(function(t){function n(r){t(r);e.Ja(n);return!1}e.va(n);yc(e)})}));return e.f}function vc(e){var t=null;return zu(e.g).then(function(n){t=n;n=e.g;return qu(n.b,Gu,n.a)}).then(function(){return t})}function yc(e){function t(t){r=!0;o&&o.cancel();vc(e).then(function(r){var i=n;if(r&&t&&t.url){var o=null;i=Qi(t.url);-1!=i.indexOf("/__/auth/callback")&&(o=cn(i),o=Fr(un(o,"firebaseError")||null),o=(o="object"===typeof o?fi(o):null)?new mo(r.b,r.c,null,null,o):new mo(r.b,r.c,i,r.g));i=o||n}pc(e,i)})}var n=new mo("unknown",null,null,null,new hi("no-auth-event")),r=!1,o=zt(500).then(function(){return vc(e).then(function(){r||pc(e,n)})}),a=i.handleOpenURL;i.handleOpenURL=function(e){0==e.toLowerCase().indexOf(Dr("BuildInfo.packageName",i).toLowerCase()+"://")&&t({url:e});if("function"===typeof a)try{a(e)}catch(e){console.error(e)}};Eo||(Eo=new wo);Eo.subscribe(t)}t.va=function(e){this.b.push(e);dc(this).m(function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new mo("unknown",null,null,null,new hi("no-auth-event")),e(t))})};t.Ja=function(e){W(this.b,function(t){return t==e})};function gc(e){this.a=e;this.b=Fu()}var _c={name:"pendingRedirect",w:"session"};function mc(e){return e.b.set(_c,"pending",e.a)}function bc(e){return qu(e.b,_c,e.a)}function wc(e){return e.b.get(_c,e.a).then(function(e){return"pending"==e})}function Ec(e,t,n){this.v=e;this.l=t;this.u=n;this.h=[];this.f=!1;this.j=_(this.o,this);this.c=new Pc;this.s=new jc;this.g=new gc(this.l+":"+this.u);this.b={};this.b.unknown=this.c;this.b.signInViaRedirect=this.c;this.b.linkViaRedirect=this.c;this.b.reauthViaRedirect=this.c;this.b.signInViaPopup=this.s;this.b.linkViaPopup=this.s;this.b.reauthViaPopup=this.s;this.a=Tc(this.v,this.l,this.u,qs)}function Tc(t,n,r,i){var o=e.SDK_VERSION||null;return mr()?new uc(t,n,r,o,i):new tu(t,n,r,o,i)}Ec.prototype.reset=function(){this.f=!1;this.a.Ja(this.j);this.a=Tc(this.v,this.l,this.u)};function Sc(e){e.f||(e.f=!0,e.a.va(e.j));var t=e.a;return e.a.ea().m(function(n){e.a==t&&e.reset();throw n})}function Ic(e){e.a.Gb()&&Sc(e).m(function(t){var n=new mo("unknown",null,null,null,new hi("operation-not-supported-in-this-environment"));Ac(t)&&e.o(n)});e.a.Bb()||kc(e.c)}Ec.prototype.subscribe=function(e){j(this.h,e)||this.h.push(e);if(!this.f){var t=this;wc(this.g).then(function(e){e?bc(t.g).then(function(){Sc(t).m(function(e){var n=new mo("unknown",null,null,null,new hi("operation-not-supported-in-this-environment"));Ac(e)&&t.o(n)})}):Ic(t)}).m(function(){Ic(t)})}};Ec.prototype.unsubscribe=function(e){W(this.h,function(t){return t==e})};Ec.prototype.o=function(e){if(!e)throw new hi("invalid-auth-event");for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.qb(e.b,e.c)){(t=this.b[e.b])&&t.h(e,r);t=!0;break}}kc(this.c);return t};var Cc=new qr(2e3,1e4),Oc=new qr(3e4,6e4);Ec.prototype.da=function(){return this.c.da()};function Nc(e,t,n,r,i,o){return e.a.xb(t,n,r,function(){e.f||(e.f=!0,e.a.va(e.j))},function(){e.reset()},i,o)}function Ac(e){return!(!e||"auth/cordova-not-ready"!=e.code)}Ec.prototype.Ba=function(e,t,n){var r=this,i;return mc(this.g).then(function(){return r.a.Ba(e,t,n).m(function(e){if(Ac(e))throw new hi("operation-not-supported-in-this-environment");i=e;return bc(r.g).then(function(){throw i})}).then(function(){return r.a.Lb()?new be(function(){}):bc(r.g).then(function(){return r.da()}).then(function(){}).m(function(){})})})};Ec.prototype.Da=function(e,t,n,r){return this.a.Da(n,function(n){e.ga(t,null,n,r)},Cc.get())};var Dc={};function Rc(e,t,n){var r=t+":"+n;Dc[r]||(Dc[r]=new Ec(e,t,n));return Dc[r]}function Pc(){this.b=null;this.f=[];this.c=[];this.a=null;this.g=!1}Pc.prototype.reset=function(){this.b=null;this.a&&(this.a.cancel(),this.a=null)};Pc.prototype.h=function(e,t){if(e){this.reset();this.g=!0;var n=e.b,r=e.c,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code;"unknown"!=n||i||o?e.a?(Uc(this,!0,null,e.a),Oe()):t.wa(n,r)?Lc(this,e,t):Ne(new hi("invalid-auth-event")):(Uc(this,!1,null,null),Oe())}else Ne(new hi("invalid-auth-event"))};function kc(e){e.g||(e.g=!0,Uc(e,!1,null,null))}function Lc(e,t,n){n=n.wa(t.b,t.c);var r=t.f,i=t.g,o=!!t.b.match(/Redirect$/);n(r,i).then(function(t){Uc(e,o,t,null)}).m(function(t){Uc(e,o,null,t)})}function xc(e,t){e.b=function(){return Ne(t)};if(e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}function Mc(e,t){e.b=function(){return Oe(t)};if(e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function Uc(e,t,n,r){t?r?xc(e,r):Mc(e,n):Mc(e,{user:null});e.f=[];e.c=[]}Pc.prototype.da=function(){var e=this;return new be(function(t,n){e.b?e.b().then(t,n):(e.f.push(t),e.c.push(n),Fc(e))})};function Fc(e){var t=new hi("timeout");e.a&&e.a.cancel();e.a=zt(Oc.get()).then(function(){e.b||Uc(e,!0,null,t)})}function jc(){}jc.prototype.h=function(e,t){if(e){var n=e.b,r=e.c;e.a?(t.ga(e.b,null,e.a,e.c),Oe()):t.wa(n,r)?Bc(e,t):Ne(new hi("invalid-auth-event"))}else Ne(new hi("invalid-auth-event"))};function Bc(e,t){var n=e.c,r=e.b;t.wa(r,n)(e.f,e.g).then(function(e){t.ga(r,e,null,n)}).m(function(e){t.ga(r,null,e,n)})}function Wc(e,t){this.a=t;Xr(this,"verificationId",e)}Wc.prototype.confirm=function(e){e=yo(this.verificationId,e);return this.a(e)};function qc(e,t,n,r){return new vo(e).Sa(t,n).then(function(e){return new Wc(e,r)})}function Vc(e){var t=ki(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new hi("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");$r(this,{token:e,expirationTime:Kr(1e3*t.exp),authTime:Kr(1e3*t.auth_time),issuedAtTime:Kr(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,claims:t})}function Hc(e,t,n){this.h=e;this.j=t;this.g=n;this.c=3e4;this.f=96e4;this.b=null;this.a=this.c;if(this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}Hc.prototype.start=function(){this.a=this.c;Gc(this,!0)};function Kc(e,t){if(t)return e.a=e.c,e.g();t=e.a;e.a*=2;e.a>e.f&&(e.a=e.f);return t}function Gc(e,t){e.stop();e.b=zt(Kc(e,t)).then(function(){return Hr()}).then(function(){return e.h()}).then(function(){Gc(e,!0)}).m(function(t){e.j(t)&&Gc(e,!1)})}Hc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)};function zc(e){this.f=e;this.b=this.a=null;this.c=0}zc.prototype.C=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}};function Qc(e,t){var n=t[xa],r=t.refreshToken;t=Yc(t.expiresIn);e.b=n;e.c=t;e.a=r}function Yc(e){return b()+1e3*parseInt(e,10)}function Xc(e,t){return Ga(e.f,t).then(function(t){e.b=t.access_token;e.c=Yc(t.expires_in);e.a=t.refresh_token;return{accessToken:e.b,expirationTime:e.c,refreshToken:e.a}}).m(function(t){"auth/user-token-expired"==t.code&&(e.a=null);throw t})}zc.prototype.getToken=function(e){e=!!e;return this.b&&!this.a?Ne(new hi("user-token-expired")):e||!this.b||b()>this.c-3e4?this.a?Xc(this,{grant_type:"refresh_token",refresh_token:this.a}):Oe(null):Oe({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})};function $c(e,t){this.a=e||null;this.b=t||null;$r(this,{lastSignInTime:Kr(t||null),creationTime:Kr(e||null)})}function Jc(e){return new $c(e.a,e.b)}$c.prototype.C=function(){return{lastLoginAt:this.b,createdAt:this.a}};function Zc(e,t,n,r,i,o){$r(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}function el(e,t){yt.call(this,e);for(var n in t)this[n]=t[n]}w(el,yt);function tl(t,n,r){this.D=[];this.G=t.apiKey;this.s=t.appName;this.B=t.authDomain||null;t=e.SDK_VERSION?Nr(e.SDK_VERSION):null;this.b=new ka(this.G,Ws(qs),t);this.h=new zc(this.b);cl(this,n[xa]);Qc(this.h,n);Xr(this,"refreshToken",this.h.a);pl(this,r||{});qt.call(this);this.I=!1;this.B&&Pr()&&(this.a=Rc(this.B,this.G,this.s));this.N=[];this.j=null;this.l=al(this);this.V=_(this.Ga,this);var i=this;this.ia=null;this.sa=function(e){i.na(e.g)};this.X=null;this.O=[];this.ra=function(e){rl(i,e.c)};this.W=null}w(tl,qt);tl.prototype.na=function(e){this.ia=e;Ba(this.b,e)};tl.prototype.ca=function(){return this.ia};function nl(e,t){e.X&&kt(e.X,"languageCodeChanged",e.sa);(e.X=t)&&At(t,"languageCodeChanged",e.sa)}function rl(t,n){t.O=n;Wa(t.b,e.SDK_VERSION?Nr(e.SDK_VERSION,t.O):null)}tl.prototype.Ka=function(){return V(this.O)};function il(e,t){e.W&&kt(e.W,"frameworkChanged",e.ra);(e.W=t)&&At(t,"frameworkChanged",e.ra)}tl.prototype.Ga=function(){this.l.b&&(this.l.stop(),this.l.start())};function ol(t){try{return e.app(t.s).auth()}catch(e){throw new hi("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.s+"'!")}}function al(e){return new Hc(function(){return e.F(!0)},function(e){return!(!e||"auth/network-request-failed"!=e.code)},function(){var t=e.h.c-b()-3e5;return 0<t?t:0})}function sl(e){e.o||e.l.b||(e.l.start(),kt(e,"tokenChanged",e.V),At(e,"tokenChanged",e.V))}function ul(e){kt(e,"tokenChanged",e.V);e.l.stop()}function cl(e,t){e.qa=t;Xr(e,"_lat",t)}function ll(e,t){W(e.N,function(e){return e==t})}function hl(e){for(var t=[],n=0;n<e.N.length;n++)t.push(e.N[n](e));return Re(t).then(function(){return e})}function fl(e){e.a&&!e.I&&(e.I=!0,e.a.subscribe(e))}function pl(e,t){$r(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,metadata:new $c(t.createdAt,t.lastLoginAt),providerData:[]})}Xr(tl.prototype,"providerId","firebase");function dl(){}function vl(e){return Oe().then(function(){if(e.o)throw new hi("app-deleted")})}function yl(e){return M(e.providerData,function(e){return e.providerId})}function gl(e,t){t&&(_l(e,t.providerId),e.providerData.push(t))}function _l(e,t){W(e.providerData,function(e){return e.providerId==t})}function ml(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&Xr(e,t,n)}function bl(e,t){e!=t&&($r(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,providerData:[]}),t.metadata?Xr(e,"metadata",Jc(t.metadata)):Xr(e,"metadata",new $c),L(t.providerData,function(t){gl(e,t)}),e.h=t.h,Xr(e,"refreshToken",e.h.a))}t=tl.prototype;t.reload=function(){var e=this;return Rl(this,vl(this).then(function(){return wl(e).then(function(){return hl(e)}).then(dl)}))};function wl(e){return e.F().then(function(t){var n=e.isAnonymous;return Tl(e,t).then(function(){n||ml(e,"isAnonymous",!1);return t})})}t.ac=function(e){return this.F(e).then(function(e){return new Vc(e)})};t.F=function(e){var t=this;return Rl(this,vl(this).then(function(){return t.h.getToken(e)}).then(function(e){if(!e)throw new hi("internal-error");e.accessToken!=t.qa&&(cl(t,e.accessToken),t.dispatchEvent(new el("tokenChanged")));ml(t,"refreshToken",e.refreshToken);return e.accessToken}))};t.getToken=function(e){zr["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]||(zr["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn("firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."));return this.F(e)};function El(e,t){t[xa]&&e.qa!=t[xa]&&(Qc(e.h,t),e.dispatchEvent(new el("tokenChanged")),cl(e,t[xa]),ml(e,"refreshToken",e.h.a))}function Tl(e,t){return Us(e.b,_s,{idToken:t}).then(_(e.uc,e))}t.uc=function(e){e=e.users;if(!e||!e.length)throw new hi("internal-error");e=e[0];pl(this,{uid:e.localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt});for(var t=Sl(e),n=0;n<t.length;n++)gl(this,t[n]);ml(this,"isAnonymous",!(this.email&&e.passwordHash)&&!(this.providerData&&this.providerData.length))};function Sl(e){return(e=e.providerUserInfo)&&e.length?M(e,function(e){return new Zc(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)}):[]}t.bb=function(e){var t=this,n=null;return Rl(this,e.f(this.b,this.uid).then(function(e){El(t,e);n=Cl(t,e,"reauthenticate");t.j=null;return t.reload()}).then(function(){return n}),!0)};t.vc=function(e){return this.bb(e).then(function(){})};function Il(e,t){return wl(e).then(function(){if(j(yl(e),t))return hl(e).then(function(){throw new hi("provider-already-linked")})})}t.$a=function(e){var t=this,n=null;return Rl(this,Il(this,e.providerId).then(function(){return t.F()}).then(function(n){return e.c(t.b,n)}).then(function(e){n=Cl(t,e,"link");return Ol(t,e)}).then(function(){return n}))};t.mc=function(e){return this.$a(e).then(function(e){return e.user})};t.nc=function(e,t){var n=this;return Rl(this,Il(this,"phone").then(function(){return qc(ol(n),e,t,_(n.$a,n))}))};t.wc=function(e,t){var n=this;return Rl(this,Oe().then(function(){return qc(ol(n),e,t,_(n.bb,n))}),!0)};function Cl(e,t,n){var r=go(t);t=Fi(t);return Jr({user:e,credential:r,additionalUserInfo:t,operationType:n})}function Ol(e,t){El(e,t);return e.reload().then(function(){return e})}t.mb=function(e){var t=this;return Rl(this,this.F().then(function(n){return t.b.mb(n,e)}).then(function(e){El(t,e);return t.reload()}))};t.Nc=function(e){var t=this;return Rl(this,this.F().then(function(n){return e.c(t.b,n)}).then(function(e){El(t,e);return t.reload()}))};t.nb=function(e){var t=this;return Rl(this,this.F().then(function(n){return t.b.nb(n,e)}).then(function(e){El(t,e);return t.reload()}))};t.ob=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return vl(this);var t=this;return Rl(this,this.F().then(function(n){return t.b.ob(n,{displayName:e.displayName,photoUrl:e.photoURL})}).then(function(e){El(t,e);ml(t,"displayName",e.displayName||null);ml(t,"photoURL",e.photoUrl||null);L(t.providerData,function(e){"password"===e.providerId&&(Xr(e,"displayName",t.displayName),Xr(e,"photoURL",t.photoURL))});return hl(t)}).then(dl))};t.Mc=function(e){var t=this;return Rl(this,wl(this).then(function(n){return j(yl(t),e)?rs(t.b,n,[e]).then(function(e){var n={};L(e.providerUserInfo||[],function(e){n[e.providerId]=!0});L(yl(t),function(e){n[e]||_l(t,e)});n[vo.PROVIDER_ID]||Xr(t,"phoneNumber",null);return hl(t)}):hl(t).then(function(){throw new hi("no-such-provider")})}))};t.delete=function(){var e=this;return Rl(this,this.F().then(function(t){return Us(e.b,ds,{idToken:t})}).then(function(){e.dispatchEvent(new el("userDeleted"))})).then(function(){for(var t=0;t<e.D.length;t++)e.D[t].cancel("app-deleted");nl(e,null);il(e,null);e.D=[];e.o=!0;ul(e);Xr(e,"refreshToken",null);e.a&&e.a.unsubscribe(e)})};t.qb=function(e,t){return!!("linkViaPopup"==e&&(this.g||null)==t&&this.f||"reauthViaPopup"==e&&(this.g||null)==t&&this.f||"linkViaRedirect"==e&&(this.$||null)==t||"reauthViaRedirect"==e&&(this.$||null)==t)};t.ga=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.g||null)||(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)};t.wa=function(e,t){return"linkViaPopup"==e&&t==(this.g||null)?_(this.vb,this):"reauthViaPopup"==e&&t==(this.g||null)?_(this.wb,this):"linkViaRedirect"==e&&(this.$||null)==t?_(this.vb,this):"reauthViaRedirect"==e&&(this.$||null)==t?_(this.wb,this):null};t.oc=function(e){var t=this;return Nl(this,"linkViaPopup",e,function(){return Il(t,e.providerId).then(function(){return hl(t)})},!1)};t.xc=function(e){return Nl(this,"reauthViaPopup",e,function(){return Oe()},!0)};function Nl(t,n,r,i,o){if(!Pr())return Ne(new hi("operation-not-supported-in-this-environment"));if(t.j&&!o)return Ne(t.j);var a=Ui(r.providerId),s=jr(t.uid+":::"),u=null;(!xr()||br())&&t.B&&r.isOAuthProvider&&(u=ou(t.B,t.G,t.s,n,r,null,s,e.SDK_VERSION||null));var c=dr(u,a&&a.Aa,a&&a.za);i=i().then(function(){Dl(t);if(!o)return t.F().then(function(){})}).then(function(){return Nc(t.a,c,n,r,s,!!u)}).then(function(){return new be(function(e,r){t.ga(n,null,new hi("cancelled-popup-request"),t.g||null);t.f=e;t.v=r;t.g=s;t.c=t.a.Da(t,n,c,s)})}).then(function(e){c&&pr(c);return e?Jr(e):null}).m(function(e){c&&pr(c);throw e});return Rl(t,i,o)}t.pc=function(e){var t=this;return Al(this,"linkViaRedirect",e,function(){return Il(t,e.providerId)},!1)};t.yc=function(e){return Al(this,"reauthViaRedirect",e,function(){return Oe()},!0)};function Al(e,t,n,r,i){if(!Pr())return Ne(new hi("operation-not-supported-in-this-environment"));if(e.j&&!i)return Ne(e.j);var o=null,a=jr(e.uid+":::");r=r().then(function(){Dl(e);if(!i)return e.F().then(function(){})}).then(function(){e.$=a;return hl(e)}).then(function(t){e.fa&&(t=e.fa,t=t.b.set(Ml,e.C(),t.a));return t}).then(function(){return e.a.Ba(t,n,a)}).m(function(t){o=t;if(e.fa)return Ul(e.fa);throw o}).then(function(){if(o)throw o});return Rl(e,r,i)}function Dl(e){if(!e.a||!e.I){if(e.a&&!e.I)throw new hi("internal-error");throw new hi("auth-domain-config-required")}}t.vb=function(e,t){var n=this;this.c&&(this.c.cancel(),this.c=null);var r=null,i=this.F().then(function(r){return ss(n.b,{requestUri:e,sessionId:t,idToken:r})}).then(function(e){r=Cl(n,e,"link");return Ol(n,e)}).then(function(){return r});return Rl(this,i)};t.wb=function(e,t){var n=this;this.c&&(this.c.cancel(),this.c=null);var r=null,i=Oe().then(function(){return Yi(us(n.b,{requestUri:e,sessionId:t}),n.uid)}).then(function(e){r=Cl(n,e,"reauthenticate");El(n,e);n.j=null;return n.reload()}).then(function(){return r});return Rl(this,i,!0)};t.fb=function(e){var t=this,n=null;return Rl(this,this.F().then(function(t){n=t;return"undefined"===typeof e||se(e)?{}:Si(new vi(e))}).then(function(e){return t.b.fb(n,e)}).then(function(e){if(t.email!=e)return t.reload()}).then(function(){}))};function Rl(e,t,n){var r=Pl(e,t,n);e.D.push(r);r.ha(function(){B(e.D,r)});return r}function Pl(e,t,n){return e.j&&!n?(t.cancel(),Ne(e.j)):t.m(function(t){!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(e.j||e.dispatchEvent(new el("userInvalidated")),e.j=t);throw t})}t.toJSON=function(){return this.C()};t.C=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.G,appName:this.s,authDomain:this.B,stsTokenManager:this.h.C(),redirectEventId:this.$||null};this.metadata&&le(e,this.metadata.C());L(this.providerData,function(t){e.providerData.push(Zr(t))});return e};function kl(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName},n={};if(!(e.stsTokenManager&&e.stsTokenManager.accessToken&&e.stsTokenManager.expirationTime))return null;n[xa]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null,n.expiresIn=(e.stsTokenManager.expirationTime-b())/1e3;var r=new tl(t,n,e);e.providerData&&L(e.providerData,function(e){e&&gl(r,Jr(e))});e.redirectEventId&&(r.$=e.redirectEventId);return r}function Ll(e,t,n,r){var i=new tl(e,t);n&&(i.fa=n);r&&rl(i,r);return i.reload().then(function(){return i})}function xl(e){this.a=e;this.b=Fu()}var Ml={name:"redirectUser",w:"session"};function Ul(e){return qu(e.b,Ml,e.a)}function Fl(e,t){return e.b.get(Ml,e.a).then(function(e){e&&t&&(e.authDomain=t);return kl(e||{})})}function jl(e){this.a=e;this.b=Fu();this.c=null;this.f=Wl(this);this.b.addListener(Vl("local"),this.a,_(this.g,this))}jl.prototype.g=function(){var e=this,t=Vl("local");Ql(this,function(){return Oe().then(function(){return e.c&&"local"!=e.c.w?e.b.get(t,e.a):null}).then(function(n){if(n)return Bl(e,"local").then(function(){e.c=t})})})};function Bl(e,t){var n=[],r;for(r in Lu)Lu[r]!==t&&n.push(qu(e.b,Vl(Lu[r]),e.a));n.push(qu(e.b,ql,e.a));return De(n)}function Wl(e){var t=Vl("local"),n=Vl("session"),r=Vl("none");return Wu(e.b,t,e.a).then(function(){return e.b.get(n,e.a)}).then(function(i){return i?n:e.b.get(r,e.a).then(function(n){return n?r:e.b.get(t,e.a).then(function(n){return n?t:e.b.get(ql,e.a).then(function(e){return e?Vl(e):t})})})}).then(function(t){e.c=t;return Bl(e,t.w)}).m(function(){e.c||(e.c=t)})}var ql={name:"persistence",w:"session"};function Vl(e){return{name:"authUser",w:e}}jl.prototype.ib=function(e){var t=null,n=this;xu(e);return Ql(this,function(){return e!=n.c.w?n.b.get(n.c,n.a).then(function(r){t=r;return Bl(n,e)}).then(function(){n.c=Vl(e);if(t)return n.b.set(n.c,t,n.a)}):Oe()})};function Hl(e){return Ql(e,function(){return e.b.set(ql,e.c.w,e.a)})}function Kl(e,t){return Ql(e,function(){return e.b.set(e.c,t.C(),e.a)})}function Gl(e){return Ql(e,function(){return qu(e.b,e.c,e.a)})}function zl(e,t){return Ql(e,function(){return e.b.get(e.c,e.a).then(function(e){e&&t&&(e.authDomain=t);return kl(e||{})})})}function Ql(e,t){e.f=e.f.then(t,t);return e.f}function Yl(t){this.l=!1;Xr(this,"app",t);if(!sh(this).options||!sh(this).options.apiKey)throw new hi("invalid-api-key");t=e.SDK_VERSION?Nr(e.SDK_VERSION):null,this.b=new ka(sh(this).options&&sh(this).options.apiKey,Ws(qs),t);this.N=[];this.o=[];this.I=[];this.Ob=e.INTERNAL.createSubscribe(_(this.ic,this));this.O=void 0;this.Pb=e.INTERNAL.createSubscribe(_(this.jc,this));nh(this,null);this.h=new jl(sh(this).options.apiKey+":"+sh(this).name);this.G=new xl(sh(this).options.apiKey+":"+sh(this).name);this.V=fh(this,ih(this));this.j=fh(this,oh(this));this.X=!1;this.ia=_(this.Ic,this);this.Ga=_(this.ka,this);this.qa=_(this.Yb,this);this.ra=_(this.gc,this);this.sa=_(this.hc,this);eh(this);this.INTERNAL={};this.INTERNAL["delete"]=_(this.delete,this);this.INTERNAL.logFramework=_(this.qc,this);this.s=0;qt.call(this);Jl(this);this.D=[]}w(Yl,qt);function Xl(e){yt.call(this,"languageCodeChanged");this.g=e}w(Xl,yt);function $l(e){yt.call(this,"frameworkChanged");this.c=e}w($l,yt);t=Yl.prototype;t.ib=function(e){e=this.h.ib(e);return fh(this,e)};t.na=function(e){this.W===e||this.l||(this.W=e,Ba(this.b,this.W),this.dispatchEvent(new Xl(this.ca())))};t.ca=function(){return this.W};t.Oc=function(){var e=i.navigator;this.na(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)};t.qc=function(t){this.D.push(t);Wa(this.b,e.SDK_VERSION?Nr(e.SDK_VERSION,this.D):null);this.dispatchEvent(new $l(this.D))};t.Ka=function(){return V(this.D)};function Jl(e){Object.defineProperty(e,"lc",{get:function(){return this.ca()},set:function(e){this.na(e)},enumerable:!1});e.W=null}t.toJSON=function(){return{apiKey:sh(this).options.apiKey,authDomain:sh(this).options.authDomain,appName:sh(this).name,currentUser:uh(this)&&uh(this).C()}};function Zl(e){return e.Nb||Ne(new hi("auth-domain-config-required"))}function eh(e){var t=sh(e).options.authDomain,n=sh(e).options.apiKey;t&&Pr()&&(e.Nb=e.V.then(function(){if(!e.l){e.a=Rc(t,n,sh(e).name);e.a.subscribe(e);uh(e)&&fl(uh(e));if(e.B){fl(e.B);var r=e.B;r.na(e.ca());nl(r,e);r=e.B;rl(r,e.D);il(r,e);e.B=null}return e.a}}))}t.qb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==t&&!!this.f;default:return!1}};t.ga=function(e,t,n,r){"signInViaPopup"==e&&this.g==r&&(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)};t.wa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.g==t&&this.f?_(this.Xb,this):null};t.Xb=function(e,t){var n=this;e={requestUri:e,sessionId:t};this.c&&(this.c.cancel(),this.c=null);var r=null,i=null,o=as(n.b,e).then(function(e){r=go(e);i=Fi(e);return e});e=n.V.then(function(){return o}).then(function(e){return th(n,e)}).then(function(){return Jr({user:uh(n),credential:r,additionalUserInfo:i,operationType:"signIn"})});return fh(this,e)};t.Gc=function(t){if(!Pr())return Ne(new hi("operation-not-supported-in-this-environment"));var n=this,r=Ui(t.providerId),i=jr(),o=null;(!xr()||br())&&sh(this).options.authDomain&&t.isOAuthProvider&&(o=ou(sh(this).options.authDomain,sh(this).options.apiKey,sh(this).name,"signInViaPopup",t,null,i,e.SDK_VERSION||null));var a=dr(o,r&&r.Aa,r&&r.za);r=Zl(this).then(function(e){return Nc(e,a,"signInViaPopup",t,i,!!o)}).then(function(){return new be(function(e,t){n.ga("signInViaPopup",null,new hi("cancelled-popup-request"),n.g);n.f=e;n.v=t;n.g=i;n.c=n.a.Da(n,"signInViaPopup",a,i)})}).then(function(e){a&&pr(a);return e?Jr(e):null}).m(function(e){a&&pr(a);throw e});return fh(this,r)};t.Hc=function(e){if(!Pr())return Ne(new hi("operation-not-supported-in-this-environment"));var t=this,n=Zl(this).then(function(){return Hl(t.h)}).then(function(){return t.a.Ba("signInViaRedirect",e)});return fh(this,n)};t.da=function(){if(!Pr())return Ne(new hi("operation-not-supported-in-this-environment"));var e=this,t=Zl(this).then(function(){return e.a.da()}).then(function(e){return e?Jr(e):null});return fh(this,t)};function th(e,t){var n={};n.apiKey=sh(e).options.apiKey;n.authDomain=sh(e).options.authDomain;n.appName=sh(e).name;return e.V.then(function(){return Ll(n,t,e.G,e.Ka())}).then(function(t){if(uh(e)&&t.uid==uh(e).uid)return bl(uh(e),t),e.ka(t);nh(e,t);fl(t);return e.ka(t)}).then(function(){lh(e)})}function nh(e,t){uh(e)&&(ll(uh(e),e.Ga),kt(uh(e),"tokenChanged",e.qa),kt(uh(e),"userDeleted",e.ra),kt(uh(e),"userInvalidated",e.sa),ul(uh(e)));t&&(t.N.push(e.Ga),At(t,"tokenChanged",e.qa),At(t,"userDeleted",e.ra),At(t,"userInvalidated",e.sa),0<e.s&&sl(t));Xr(e,"currentUser",t);t&&(t.na(e.ca()),nl(t,e),rl(t,e.D),il(t,e))}t.kb=function(){var e=this,t=this.j.then(function(){if(!uh(e))return Oe();nh(e,null);return Gl(e.h).then(function(){lh(e)})});return fh(this,t)};function rh(e){var t=Fl(e.G,sh(e).options.authDomain).then(function(t){(e.B=t)&&(t.fa=e.G);return Ul(e.G)});return fh(e,t)}function ih(e){var t=sh(e).options.authDomain,n=rh(e).then(function(){return zl(e.h,t)}).then(function(t){return t?(t.fa=e.G,e.B&&(e.B.$||null)==(t.$||null)?t:t.reload().then(function(){return Kl(e.h,t).then(function(){return t})}).m(function(n){return"auth/network-request-failed"==n.code?t:Gl(e.h)})):null}).then(function(t){nh(e,t||null)});return fh(e,n)}function oh(e){return e.V.then(function(){return e.da()}).m(function(){}).then(function(){if(!e.l)return e.ia()}).m(function(){}).then(function(){if(!e.l){e.X=!0;var t=e.h;t.b.addListener(Vl("local"),t.a,e.ia)}})}t.Ic=function(){var e=this;return zl(this.h,sh(this).options.authDomain).then(function(t){if(!e.l){var n;if(n=uh(e)&&t){n=uh(e).uid;var r=t.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return bl(uh(e),t),uh(e).F();(uh(e)||t)&&(nh(e,t),t&&(fl(t),t.fa=e.G),e.a&&e.a.subscribe(e),lh(e))}})};t.ka=function(e){return Kl(this.h,e)};t.Yb=function(){lh(this);this.ka(uh(this))};t.gc=function(){this.kb()};t.hc=function(){this.kb()};function ah(e,t){var n=null,r=null;return fh(e,t.then(function(t){n=go(t);r=Fi(t);return th(e,t)}).then(function(){return Jr({user:uh(e),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}t.ic=function(e){var t=this;this.addAuthTokenListener(function(){e.next(uh(t))})};t.jc=function(e){var t=this;hh(this,function(){e.next(uh(t))})};t.sc=function(t,n,r){var i=this;this.X&&e.Promise.resolve().then(function(){f(t)?t(uh(i)):f(t.next)&&t.next(uh(i))});return this.Ob(t,n,r)};t.rc=function(t,n,r){var i=this;this.X&&e.Promise.resolve().then(function(){i.O=i.getUid();f(t)?t(uh(i)):f(t.next)&&t.next(uh(i))});return this.Pb(t,n,r)};t.$b=function(e){var t=this,n=this.j.then(function(){return uh(t)?uh(t).F(e).then(function(e){return{accessToken:e}}):null});return fh(this,n)};t.Cc=function(e){return this.Hb(e).then(function(e){return e.user})};t.Hb=function(e){var t=this;return this.j.then(function(){return ah(t,Us(t.b,Ps,{token:e}))}).then(function(e){var n=e.user;ml(n,"isAnonymous",!1);t.ka(n);return e})};t.Ib=function(e,t){var n=this;return this.j.then(function(){return ah(n,Us(n.b,ks,{email:e,password:t}))})};t.Dc=function(e,t){return this.Ib(e,t).then(function(e){return e.user})};t.Sb=function(e,t){return this.sb(e,t).then(function(e){return e.user})};t.sb=function(e,t){var n=this;return this.j.then(function(){return ah(n,Us(n.b,fs,{email:e,password:t}))})};t.Bc=function(e){return this.Oa(e).then(function(e){return e.user})};t.Oa=function(e){var t=this;return this.j.then(function(){return ah(t,e.xa(t.b))})};t.jb=function(){return this.Jb().then(function(e){return e.user})};t.Jb=function(){var e=this;return this.j.then(function(){var t=uh(e);if(t&&t.isAnonymous){var n=Jr({providerId:null,isNewUser:!1});return Jr({user:t,credential:null,additionalUserInfo:n,operationType:"signIn"})}return ah(e,e.b.jb()).then(function(t){var n=t.user;ml(n,"isAnonymous",!0);e.ka(n);return t})})};function sh(e){return e.app}function uh(e){return e.currentUser}t.getUid=function(){return uh(this)&&uh(this).uid||null};function ch(e){return uh(e)&&uh(e)._lat||null}function lh(e){if(e.X){for(var t=0;t<e.o.length;t++)e.o[t]&&e.o[t](ch(e));if(e.O!==e.getUid()&&e.I.length)for(e.O=e.getUid(),t=0;t<e.I.length;t++)e.I[t]&&e.I[t](ch(e))}}t.Qb=function(e){this.addAuthTokenListener(e);this.s++;0<this.s&&uh(this)&&sl(uh(this))};t.zc=function(e){var t=this;L(this.o,function(n){n==e&&t.s--});0>this.s&&(this.s=0);0==this.s&&uh(this)&&ul(uh(this));this.removeAuthTokenListener(e)};t.addAuthTokenListener=function(e){var t=this;this.o.push(e);fh(this,this.j.then(function(){t.l||j(t.o,e)&&e(ch(t))}))};t.removeAuthTokenListener=function(e){W(this.o,function(t){return t==e})};function hh(e,t){e.I.push(t);fh(e,e.j.then(function(){!e.l&&j(e.I,t)&&e.O!==e.getUid()&&(e.O=e.getUid(),t(ch(e)))}))}t.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");this.N=[];this.h&&(t=this.h,t.b.removeListener(Vl("local"),t.a,this.ia));this.a&&this.a.unsubscribe(this);return e.Promise.resolve()};function fh(e,t){e.N.push(t);t.ha(function(){B(e.N,t)});return t}t.Vb=function(e){return fh(this,Xa(this.b,e))};t.Wb=function(e){return fh(this,$a(this.b,e))};t.kc=function(e){return!!ho(e)};t.hb=function(e,t){var n=this;return fh(this,Oe().then(function(){var e=new vi(t);if(!e.c)throw new hi("argument-error",gi+" must be true when sending sign in link to email");return Si(e)}).then(function(t){return n.b.hb(e,t)}).then(function(){}))};t.Pc=function(e){return this.Ia(e).then(function(e){return e.data.email})};t.Wa=function(e,t){return fh(this,this.b.Wa(e,t).then(function(){}))};t.Ia=function(e){return fh(this,this.b.Ia(e).then(function(e){return new ni(e)}))};t.Ua=function(e){return fh(this,this.b.Ua(e).then(function(){}))};t.gb=function(e,t){var n=this;return fh(this,Oe().then(function(){return"undefined"===typeof t||se(t)?{}:Si(new vi(t))}).then(function(t){return n.b.gb(e,t)}).then(function(){}))};t.Fc=function(e,t){return fh(this,qc(this,e,t,_(this.Oa,this)))};t.Ec=function(e,t){var n=this;return fh(this,Oe().then(function(){var r=lo(e,t||ur());return n.Oa(r)}))};function ph(e,t,n,r,o,a){Xr(this,"type","recaptcha");this.b=this.c=null;this.o=!1;this.l=t;this.a=n||{theme:"light",type:"image"};this.g=[];if(this.a[yh])throw new hi("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");this.h="invisible"===this.a[gh];if(!i.document)throw new hi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Yn(t)||!this.h&&Yn(t).hasChildNodes())throw new hi("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new ka(e,a||null,o||null);this.s=r||function(){return null};var s=this;this.j=[];var u=this.a[dh];this.a[dh]=function(e){_h(s,e);if("function"===typeof u)u(e);else if("string"===typeof u){var t=Dr(u,i);"function"===typeof t&&t(e)}};var c=this.a[vh];this.a[vh]=function(){_h(s,null);if("function"===typeof c)c();else if("string"===typeof c){var e=Dr(c,i);"function"===typeof e&&e()}}}var dh="callback",vh="expired-callback",yh="sitekey",gh="size";function _h(e,t){for(var n=0;n<e.j.length;n++)try{e.j[n](t)}catch(e){}}function mh(e,t){W(e.j,function(e){return e==t})}function bh(e,t){e.g.push(t);t.ha(function(){B(e.g,t)});return t}t=ph.prototype;t.ya=function(){var e=this;return this.c?this.c:this.c=bh(this,Oe().then(function(){if(kr()&&!wr())return gr();throw new hi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return Ih(Oh(),e.s())}).then(function(){return Us(e.u,Ts,{})}).then(function(t){e.a[yh]=t.recaptchaSiteKey}).m(function(t){e.c=null;throw t}))};t.render=function(){wh(this);var e=this;return bh(this,this.ya().then(function(){if(null===e.b){var t=e.l;if(!e.h){var n=Yn(t);t=Jn("DIV");n.appendChild(t)}e.b=grecaptcha.render(t,e.a)}return e.b}))};t.verify=function(){wh(this);var e=this;return bh(this,this.render().then(function(t){return new be(function(n){var r=grecaptcha.getResponse(t);if(r)n(r);else{var i=function(t){t&&(mh(e,i),n(t))};e.j.push(i);e.h&&grecaptcha.execute(e.b)}})}))};t.reset=function(){wh(this);null!==this.b&&grecaptcha.reset(this.b)};function wh(e){if(e.o)throw new hi("internal-error","RecaptchaVerifier instance has been destroyed.")}t.clear=function(){wh(this);this.o=!0;Oh().b--;for(var e=0;e<this.g.length;e++)this.g[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.h){e=Yn(this.l);for(var t;t=e.firstChild;)e.removeChild(t)}};var Eh=Rn("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}");function Th(){this.b=i.grecaptcha?Infinity:0;this.c=null;this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Sh=new qr(3e4,6e4);function Ih(e,t){return new be(function(n,r){var o=setTimeout(function(){r(new hi("network-request-failed"))},Sh.get());if(!i.grecaptcha||t!==e.c&&!e.b){i[e.a]=function(){if(i.grecaptcha){e.c=t;var a=i.grecaptcha.render;i.grecaptcha.render=function(t,n){t=a(t,n);e.b++;return t};clearTimeout(o);n()}else clearTimeout(o),r(new hi("internal-error"));delete i[e.a]};var a=Ln(Eh,{onload:e.a,hl:t||""});Oe(Ia(a)).m(function(){clearTimeout(o);r(new hi("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else clearTimeout(o),n()})}var Ch=null;function Oh(){Ch||(Ch=new Th);return Ch}function Nh(t,n,r){try{this.f=r||e.app()}catch(e){throw new hi("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.f.options||!this.f.options.apiKey)throw new hi("invalid-api-key");r=this.f.options.apiKey;var i=this,o=null;try{o=this.f.auth().Ka()}catch(e){}o=e.SDK_VERSION?Nr(e.SDK_VERSION,o):null;ph.call(this,r,t,n,function(){try{var e=i.f.auth().ca()}catch(t){e=null}return e},o,Ws(qs))}w(Nh,ph);function Ah(e,t,n,r){e:{n=Array.prototype.slice.call(n);var i=0;for(var o=!1,a=0;a<t.length;a++)if(t[a].optional)o=!0;else{if(o)throw new hi("internal-error","Argument validator encountered a required argument after an optional argument.");i++}o=t.length;if(n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].M(n[i])&&!o){t=t[i];if(0>i||i>=Dh.length)throw new hi("internal-error","Argument validator received an unsupported number of arguments.");n=Dh[i];r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.K+".";break e}r=null}}if(r)throw new hi("argument-error",e+" failed: "+r)}var Dh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Rh(e,t){return{name:e||"",K:"a valid string",optional:!!t,M:o}}function Ph(){return{name:"opt_forceRefresh",K:"a boolean",optional:!0,M:a}}function kh(e,t){return{name:e||"",K:"a valid object",optional:!!t,M:p}}function Lh(e,t){return{name:e||"",K:"a function",optional:!!t,M:f}}function xh(e,t){return{name:e||"",K:"null",optional:!!t,M:c}}function Mh(){return{name:"",K:"an HTML element",optional:!1,M:function(e){return!!(e&&e instanceof Element)}}}function Uh(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(e){return!!(e&&e instanceof Yl)}}}function Fh(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof e.app.App)}}}function jh(e){return{name:e?e+"Credential":"credential",K:e?"a valid "+e+" credential":"a valid credential",optional:!1,M:function(t){if(!t)return!1;var n=!e||t.providerId===e;return!(!t.xa||!n)}}}function Bh(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}}function Wh(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!!(e&&o(e.type)&&f(e.verify))}}}function qh(e,t,n,r){return{name:n||"",K:e.K+" or "+t.K,optional:!!r,M:function(n){return e.M(n)||t.M(n)}}}function Vh(e,t){for(var n in t){var r=t[n].name;e[r]=Kh(r,e[n],t[n].i)}}function Hh(e,t,n,r){e[t]=Kh(t,n,r)}function Kh(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);Ah(i,n,e);return t.apply(this,e)}if(!n)return t;var i=Gh(e),o;for(o in t)r[o]=t[o];for(o in t.prototype)r.prototype[o]=t.prototype[o];return r}function Gh(e){e=e.split(".");return e[e.length-1]}Vh(Yl.prototype,{Ua:{name:"applyActionCode",i:[Rh("code")]},Ia:{name:"checkActionCode",i:[Rh("code")]},Wa:{name:"confirmPasswordReset",i:[Rh("code"),Rh("newPassword")]},Sb:{name:"createUserWithEmailAndPassword",i:[Rh("email"),Rh("password")]},sb:{name:"createUserAndRetrieveDataWithEmailAndPassword",i:[Rh("email"),Rh("password")]},Vb:{name:"fetchProvidersForEmail",i:[Rh("email")]},Wb:{name:"fetchSignInMethodsForEmail",i:[Rh("email")]},da:{name:"getRedirectResult",i:[]},kc:{name:"isSignInWithEmailLink",i:[Rh("emailLink")]},rc:{name:"onAuthStateChanged",i:[qh(kh(),Lh(),"nextOrObserver"),Lh("opt_error",!0),Lh("opt_completed",!0)]},sc:{name:"onIdTokenChanged",i:[qh(kh(),Lh(),"nextOrObserver"),Lh("opt_error",!0),Lh("opt_completed",!0)]},gb:{name:"sendPasswordResetEmail",i:[Rh("email"),qh(kh("opt_actionCodeSettings",!0),xh(null,!0),"opt_actionCodeSettings",!0)]},hb:{name:"sendSignInLinkToEmail",i:[Rh("email"),kh("actionCodeSettings")]},ib:{name:"setPersistence",i:[Rh("persistence")]},Oa:{name:"signInAndRetrieveDataWithCredential",i:[jh()]},jb:{name:"signInAnonymously",i:[]},Jb:{name:"signInAnonymouslyAndRetrieveData",i:[]},Bc:{name:"signInWithCredential",i:[jh()]},Cc:{name:"signInWithCustomToken",i:[Rh("token")]},Hb:{name:"signInAndRetrieveDataWithCustomToken",i:[Rh("token")]},Dc:{name:"signInWithEmailAndPassword",i:[Rh("email"),Rh("password")]},Ec:{name:"signInWithEmailLink",i:[Rh("email"),Rh("emailLink",!0)]},Ib:{name:"signInAndRetrieveDataWithEmailAndPassword",i:[Rh("email"),Rh("password")]},Fc:{name:"signInWithPhoneNumber",i:[Rh("phoneNumber"),Wh()]},Gc:{name:"signInWithPopup",i:[Bh()]},Hc:{name:"signInWithRedirect",i:[Bh()]},kb:{name:"signOut",i:[]},toJSON:{name:"toJSON",i:[Rh(null,!0)]},Oc:{name:"useDeviceLanguage",i:[]},Pc:{name:"verifyPasswordResetCode",i:[Rh("code")]}});(function(e,t){for(var n in t){var r=t[n].name;if(r!==n){var i=t[n].Rb;Object.defineProperty(e,r,{get:function(){return this[n]},set:function(e){Ah(r,[i],[e],!0);this[n]=e},enumerable:!0})}}})(Yl.prototype,{lc:{name:"languageCode",Rb:qh(Rh(),xh(),"languageCode")}});Yl.Persistence=Lu;Yl.Persistence.LOCAL="local";Yl.Persistence.SESSION="session";Yl.Persistence.NONE="none";Vh(tl.prototype,{delete:{name:"delete",i:[]},ac:{name:"getIdTokenResult",i:[Ph()]},F:{name:"getIdToken",i:[Ph()]},getToken:{name:"getToken",i:[Ph()]},$a:{name:"linkAndRetrieveDataWithCredential",i:[jh()]},mc:{name:"linkWithCredential",i:[jh()]},nc:{name:"linkWithPhoneNumber",i:[Rh("phoneNumber"),Wh()]},oc:{name:"linkWithPopup",i:[Bh()]},pc:{name:"linkWithRedirect",i:[Bh()]},bb:{name:"reauthenticateAndRetrieveDataWithCredential",i:[jh()]},vc:{name:"reauthenticateWithCredential",i:[jh()]},wc:{name:"reauthenticateWithPhoneNumber",i:[Rh("phoneNumber"),Wh()]},xc:{name:"reauthenticateWithPopup",i:[Bh()]},yc:{name:"reauthenticateWithRedirect",i:[Bh()]},reload:{name:"reload",i:[]},fb:{name:"sendEmailVerification",i:[qh(kh("opt_actionCodeSettings",!0),xh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",i:[Rh(null,!0)]},Mc:{name:"unlink",i:[Rh("provider")]},mb:{name:"updateEmail",i:[Rh("email")]},nb:{name:"updatePassword",i:[Rh("password")]},Nc:{name:"updatePhoneNumber",i:[jh("phone")]},ob:{name:"updateProfile",i:[kh("profile")]}});Vh(be.prototype,{ha:{name:"finally"},m:{name:"catch"},then:{name:"then"}});Vh(Wc.prototype,{confirm:{name:"confirm",i:[Rh("verificationCode")]}});Hh(co,"credential",function(e,t){return new uo(e,t)},[Rh("email"),Rh("password")]);Vh(eo.prototype,{ta:{name:"addScope",i:[Rh("scope")]},Ca:{name:"setCustomParameters",i:[kh("customOAuthParameters")]}});Hh(eo,"credential",to,[qh(Rh(),kh(),"token")]);Hh(co,"credentialWithLink",lo,[Rh("email"),Rh("emailLink")]);Vh(no.prototype,{ta:{name:"addScope",i:[Rh("scope")]},Ca:{name:"setCustomParameters",i:[kh("customOAuthParameters")]}});Hh(no,"credential",ro,[qh(Rh(),kh(),"token")]);Vh(io.prototype,{ta:{name:"addScope",i:[Rh("scope")]},Ca:{name:"setCustomParameters",i:[kh("customOAuthParameters")]}});Hh(io,"credential",oo,[qh(Rh(),qh(kh(),xh()),"idToken"),qh(Rh(),xh(),"accessToken",!0)]);Vh(ao.prototype,{Ca:{name:"setCustomParameters",i:[kh("customOAuthParameters")]}});Hh(ao,"credential",so,[qh(Rh(),kh(),"token"),Rh("secret",!0)]);Vh(Zi.prototype,{ta:{name:"addScope",i:[Rh("scope")]},credential:{name:"credential",i:[qh(Rh(),xh(),"idToken",!0),qh(Rh(),xh(),"accessToken",!0)]},Ca:{name:"setCustomParameters",i:[kh("customOAuthParameters")]}});Hh(vo,"credential",yo,[Rh("verificationId"),Rh("verificationCode")]);Vh(vo.prototype,{Sa:{name:"verifyPhoneNumber",i:[Rh("phoneNumber"),Wh()]}});Vh(hi.prototype,{toJSON:{name:"toJSON",i:[Rh(null,!0)]}});Vh(So.prototype,{toJSON:{name:"toJSON",i:[Rh(null,!0)]}});Vh(To.prototype,{toJSON:{name:"toJSON",i:[Rh(null,!0)]}});Vh(Nh.prototype,{clear:{name:"clear",i:[]},render:{name:"render",i:[]},verify:{name:"verify",i:[]}});(function(){if("undefined"===typeof e||!e.INTERNAL||!e.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:Yl,Error:hi};Hh(t,"EmailAuthProvider",co,[]);Hh(t,"FacebookAuthProvider",eo,[]);Hh(t,"GithubAuthProvider",no,[]);Hh(t,"GoogleAuthProvider",io,[]);Hh(t,"TwitterAuthProvider",ao,[]);Hh(t,"OAuthProvider",Zi,[Rh("providerId")]);Hh(t,"PhoneAuthProvider",vo,[Uh()]);Hh(t,"RecaptchaVerifier",Nh,[qh(Rh(),Mh(),"recaptchaContainer"),kh("recaptchaParameters",!0),Fh()]);e.INTERNAL.registerService("auth",function(e,t){e=new Yl(e);t({INTERNAL:{getUid:_(e.getUid,e),getToken:_(e.$b,e),addAuthTokenListener:_(e.Qb,e),removeAuthTokenListener:_(e.zc,e)}});return e},t,function(e,t){if("create"===e)try{t.auth()}catch(e){}});e.INTERNAL.extendNamespace({User:tl})})()}).call("undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})}).call(t,n(18))},1533:function(e,t,n){e.exports=n(1534)},1534:function(e,t,n){"use strict";(function(r){Object.defineProperty(t,"__esModule",{value:true});function i(e){return e&&"object"===typeof e&&"default"in e?e["default"]:e}var o=n(405);var a=n(1535);var s=n(406);var u=i(n(215));var c=function(){function e(e){this.domStorage_=e;this.prefix_="firebase:"}e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),o.stringify(t))};e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:o.jsonEval(t)};e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))};e.prototype.prefixedName_=function(e){return this.prefix_+e};e.prototype.toString=function(){return this.domStorage_.toString()};return e}();var l=function(){function e(){this.cache_={};this.isInMemoryStorage=true}e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t};e.prototype.get=function(e){if(o.contains(this.cache_,e))return this.cache_[e];return null};e.prototype.remove=function(e){delete this.cache_[e]};return e}();var h=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];t.setItem("firebase:sentinel","cache");t.removeItem("firebase:sentinel");return new c(t)}}catch(e){}return new l};var f=h("localStorage");var p=h("sessionStorage");var d=new a.Logger("@firebase/database");var v=function(){var e=1;return function(){return e++}}();var y=function(e){var t=o.stringToByteArray(e);var n=new o.Sha1;n.update(t);var r=n.digest();return o.base64.encodeByteArray(r)};var g=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";for(var r=0;r<e.length;r++){Array.isArray(e[r])||e[r]&&"object"===typeof e[r]&&"number"===typeof e[r].length?n+=g.apply(null,e[r]):"object"===typeof e[r]?n+=o.stringify(e[r]):n+=e[r];n+=" "}return n};var _=null;var m=true;var b=function(e,t){o.assert(!t||true===e||false===e,"Can't turn on custom loggers persistently.");if(true===e){d.logLevel=a.LogLevel.VERBOSE;_=d.log.bind(d);t&&p.set("logging_enabled",true)}else if("function"===typeof e)_=e;else{_=null;p.remove("logging_enabled")}};var w=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];if(true===m){m=false;null===_&&true===p.get("logging_enabled")&&b(true)}if(_){var n=g.apply(null,e);_(n)}};var E=function(e){return function(){var t=[];for(var n=0;n<arguments.length;n++)t[n]=arguments[n];w.apply(void 0,[e].concat(t))}};var T=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+g.apply(void 0,e);d.error(n)};var S=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+g.apply(void 0,e);d.error(n);throw new Error(n)};var I=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+g.apply(void 0,e);d.warn(n)};var C=function(){"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&I("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")};var O=function(e){return"number"===typeof e&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)};var N=function(e){if(o.isNodeSdk()||"complete"===document.readyState)e();else{var t=false;var n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}if(!t){t=true;e()}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",n,false);window.addEventListener("load",n,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()});window.attachEvent("onload",n)}}};var A="[MIN_NAME]";var D="[MAX_NAME]";var R=function(e,t){if(e===t)return 0;if(e===A||t===D)return-1;if(t===A||e===D)return 1;var n=q(e),r=q(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1};var P=function(e,t){return e===t?0:e<t?-1:1};var k=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+o.stringify(t))};var L=function(e){if("object"!==typeof e||null===e)return o.stringify(e);var t=[];for(var n in e)t.push(n);t.sort();var r="{";for(var i=0;i<t.length;i++){0!==i&&(r+=",");r+=o.stringify(t[i]);r+=":";r+=L(e[t[i]])}r+="}";return r};var x=function(e,t){var n=e.length;if(n<=t)return[e];var r=[];for(var i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};var M=function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;++n)t(n,e[n]);else o.forEach(e,function(e,n){return t(n,e)})};var U=function(e){o.assert(!O(e),"Invalid JSON number");var t=11,n=52;var r=(1<<t-1)-1,i,a,s,u,c,l,h;if(0===e){a=0;s=0;i=1/e===-Infinity?1:0}else{i=e<0;e=Math.abs(e);if(e>=Math.pow(2,1-r)){u=Math.min(Math.floor(Math.log(e)/Math.LN2),r);a=u+r;s=Math.round(e*Math.pow(2,n-u)-Math.pow(2,n))}else{a=0;s=Math.round(e/Math.pow(2,1-r-n))}}l=[];for(c=n;c;c-=1){l.push(s%2?1:0);s=Math.floor(s/2)}for(c=t;c;c-=1){l.push(a%2?1:0);a=Math.floor(a/2)}l.push(i?1:0);l.reverse();h=l.join("");var f="";for(c=0;c<64;c+=8){var p=parseInt(h.substr(c,8),2).toString(16);1===p.length&&(p="0"+p);f+=p}return f.toLowerCase()};var F=function(){return!!("object"===typeof window&&window["chrome"]&&window["chrome"]["extension"]&&!/^chrome/.test(window.location.href))};var j=function(){return"object"===typeof Windows&&"object"===typeof Windows.UI};var B=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==e?n="Client doesn't have permission to access the desired data.":"unavailable"==e&&(n="The service is unavailable");var r=new Error(e+" at "+t.path.toString()+": "+n);r.code=e.toUpperCase();return r};var W=new RegExp("^-?\\d{1,10}$");var q=function(e){if(W.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null};var V=function(e){try{e()}catch(e){setTimeout(function(){var t=e.stack||"";I("Exception was thrown by user callback.",t);throw e},Math.floor(0))}};var H=function(){var e="object"===typeof window&&window["navigator"]&&window["navigator"]["userAgent"]||"";return e.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0};var K=function(e,t){var n=setTimeout(e,t);"object"===typeof n&&n["unref"]&&n["unref"]();return n};var G=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");var n=0;for(var r=0;r<this.pieces_.length;r++)if(this.pieces_[r].length>0){this.pieces_[n]=this.pieces_[r];n++}this.pieces_.length=n;this.pieceNum_=0}else{this.pieces_=e;this.pieceNum_=t}}Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:true,configurable:true});e.prototype.getFront=function(){if(this.pieceNum_>=this.pieces_.length)return null;return this.pieces_[this.pieceNum_]};e.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_};e.prototype.popFront=function(){var t=this.pieceNum_;t<this.pieces_.length&&t++;return new e(this.pieces_,t)};e.prototype.getBack=function(){if(this.pieceNum_<this.pieces_.length)return this.pieces_[this.pieces_.length-1];return null};e.prototype.toString=function(){var e="";for(var t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"};e.prototype.toUrlEncodedString=function(){var e="";for(var t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"};e.prototype.slice=function(e){void 0===e&&(e=0);return this.pieces_.slice(this.pieceNum_+e)};e.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;var t=[];for(var n=this.pieceNum_;n<this.pieces_.length-1;n++)t.push(this.pieces_[n]);return new e(t,0)};e.prototype.child=function(t){var n=[];for(var r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(t instanceof e)for(var r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(var r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new e(n,0)};e.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length};e.relativePath=function(t,n){var r=t.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return e.relativePath(t.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+t+")")};e.comparePaths=function(e,t){var n=e.slice();var r=t.slice();for(var i=0;i<n.length&&i<r.length;i++){var o=R(n[i],r[i]);if(0!==o)return o}if(n.length===r.length)return 0;return n.length<r.length?-1:1};e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return false;for(var t=this.pieceNum_,n=e.pieceNum_;t<=this.pieces_.length;t++,n++)if(this.pieces_[t]!==e.pieces_[n])return false;return true};e.prototype.contains=function(e){var t=this.pieceNum_;var n=e.pieceNum_;if(this.getLength()>e.getLength())return false;while(t<this.pieces_.length){if(this.pieces_[t]!==e.pieces_[n])return false;++t;++n}return true};return e}();var z=function(){function e(e,t){this.errorPrefix_=t;this.parts_=e.slice();this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=o.stringLength(this.parts_[n]);this.checkValid_()}Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:true,configurable:true});Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:true,configurable:true});e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1);this.parts_.push(e);this.byteLength_+=o.stringLength(e);this.checkValid_()};e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=o.stringLength(e);this.parts_.length>0&&(this.byteLength_-=1)};e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())};e.prototype.toErrorString=function(){if(0==this.parts_.length)return"";return"in property '"+this.parts_.join(".")+"'"};return e}();var Q="5";var Y="v";var X="s";var $="r";var J="f";var Z="firebaseio.com";var ee="ls";var te="websocket";var ne="long_polling";var re=function(){function e(e,t,n,r,i){void 0===i&&(i="");this.secure=t;this.namespace=n;this.webSocketOnly=r;this.persistenceKey=i;this.host=e.toLowerCase();this.domain=this.host.substr(this.host.indexOf(".")+1);this.internalHost=f.get("host:"+e)||this.host}e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()};e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)};e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain};e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain};e.prototype.updateHost=function(e){if(e!==this.internalHost){this.internalHost=e;this.isCacheableHost()&&f.set("host:"+this.host,this.internalHost)}};e.prototype.connectionURL=function(e,t){o.assert("string"===typeof e,"typeof type must == string");o.assert("object"===typeof t,"typeof params must == object");var n;if(e===te)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==ne)throw new Error("Unknown connection type: "+e);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t["ns"]=this.namespace);var r=[];o.forEach(t,function(e,t){r.push(e+"="+t)});return n+r.join("&")};e.prototype.toString=function(){var e=this.toURLString();this.persistenceKey&&(e+="<"+this.persistenceKey+">");return e};e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host};return e}();function ie(e){var t="";var n=e.split("/");for(var r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}function oe(e){var t={};e.startsWith("?")&&(e=e.substring(1));for(var n=0,r=e.split("&");n<r.length;n++){var i=r[n];if(0===i.length)continue;var o=i.split("=");2===o.length?t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):I("Invalid query segment '"+i+"' in query '"+e+"'")}return t}var ae=function(e){var t=se(e),n=t.subdomain;"firebase"===t.domain&&S(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead");n&&"undefined"!=n||"localhost"===t.domain||S("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com");t.secure||C();var r="ws"===t.scheme||"wss"===t.scheme;return{repoInfo:new re(t.host,t.secure,n,r),path:new G(t.pathString)}};var se=function(e){var t="",n="",r="",i="";var o=true,a="https",s=443;if("string"===typeof e){var u=e.indexOf("//");if(u>=0){a=e.substring(0,u-1);e=e.substring(u+2)}var c=e.indexOf("/");-1===c&&(c=e.length);var l=e.indexOf("?");-1===l&&(l=e.length);t=e.substring(0,Math.min(c,l));c<l&&(i=ie(e.substring(c,l)));var h=oe(e.substring(Math.min(e.length,l)));u=t.indexOf(":");if(u>=0){o="https"===a||"wss"===a;s=parseInt(t.substring(u+1),10)}else u=e.length;var f=t.split(".");if(3===f.length){n=f[1];r=f[0].toLowerCase()}else 2===f.length?n=f[0]:"localhost"===f[0].slice(0,u).toLowerCase()&&(n="localhost");""===r&&"ns"in h&&(r=h["ns"])}return{host:t,port:s,domain:n,subdomain:r,secure:o,scheme:a,pathString:i}};var ue=/[\[\].#$\/\u0000-\u001F\u007F]/;var ce=/[\[\].#$\u0000-\u001F\u007F]/;var le=10485760;var he=function(e){return"string"===typeof e&&0!==e.length&&!ue.test(e)};var fe=function(e){return"string"===typeof e&&0!==e.length&&!ce.test(e)};var pe=function(e){e&&(e=e.replace(/^\/*\.info(\/|$)/,"/"));return fe(e)};var de=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!O(e)||e&&"object"===typeof e&&o.contains(e,".sv")};var ve=function(e,t,n,r,i){if(i&&void 0===n)return;ye(o.errorPrefix(e,t,i),n,r)};var ye=function(e,t,n){var r=n instanceof G?new z(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+r.toErrorString());if("function"===typeof t)throw new Error(e+"contains a function "+r.toErrorString()+" with contents = "+t.toString());if(O(t))throw new Error(e+"contains "+t.toString()+" "+r.toErrorString());if("string"===typeof t&&t.length>le/3&&o.stringLength(t)>le)throw new Error(e+"contains a string greater than "+le+" utf8 bytes "+r.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){var i=false,a=false;o.forEach(t,function(t,n){if(".value"===t)i=true;else if(".priority"!==t&&".sv"!==t){a=true;if(!he(t))throw new Error(e+" contains an invalid key ("+t+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}r.push(t);ye(e,n,r);r.pop()});if(i&&a)throw new Error(e+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}};var ge=function(e,t){var n,r;for(n=0;n<t.length;n++){r=t[n];var i=r.slice();for(var o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!he(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(G.comparePaths);var a=null;for(n=0;n<t.length;n++){r=t[n];if(null!==a&&a.contains(r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}};var _e=function(e,t,n,r,i){if(i&&void 0===n)return;var a=o.errorPrefix(e,t,i);if(!(n&&"object"===typeof n)||Array.isArray(n))throw new Error(a+" must be an object containing the children to replace.");var s=[];o.forEach(n,function(e,t){var n=new G(e);ye(a,t,r.child(n));if(".priority"===n.getBack()&&!de(t))throw new Error(a+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(n)});ge(a,s)};var me=function(e,t,n,r){if(r&&void 0===n)return;if(O(n))throw new Error(o.errorPrefix(e,t,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!de(n))throw new Error(o.errorPrefix(e,t,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")};var be=function(e,t,n,r){if(r&&void 0===n)return;switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(o.errorPrefix(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var we=function(e,t,n,r){if(r&&void 0===n)return;if(!he(n))throw new Error(o.errorPrefix(e,t,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')};var Ee=function(e,t,n,r){if(r&&void 0===n)return;if(!fe(n))throw new Error(o.errorPrefix(e,t,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')};var Te=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/"));Ee(e,t,n,r)};var Se=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")};var Ie=function(e,t,n){var r=n.path.toString();if(!("string"===typeof n.repoInfo.host)||0===n.repoInfo.host.length||!he(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!pe(r))throw new Error(o.errorPrefix(e,t,false)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};var Ce=function(e,t,n,r){if(r&&void 0===n)return;if("boolean"!==typeof n)throw new Error(o.errorPrefix(e,t,r)+"must be a boolean.")};var Oe=function(){function e(e,t){this.repo_=e;this.path_=t}e.prototype.cancel=function(e){o.validateArgCount("OnDisconnect.cancel",0,1,arguments.length);o.validateCallback("OnDisconnect.cancel",1,e,true);var t=new o.Deferred;this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e));return t.promise};e.prototype.remove=function(e){o.validateArgCount("OnDisconnect.remove",0,1,arguments.length);Se("OnDisconnect.remove",this.path_);o.validateCallback("OnDisconnect.remove",1,e,true);var t=new o.Deferred;this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e));return t.promise};e.prototype.set=function(e,t){o.validateArgCount("OnDisconnect.set",1,2,arguments.length);Se("OnDisconnect.set",this.path_);ve("OnDisconnect.set",1,e,this.path_,false);o.validateCallback("OnDisconnect.set",2,t,true);var n=new o.Deferred;this.repo_.onDisconnectSet(this.path_,e,n.wrapCallback(t));return n.promise};e.prototype.setWithPriority=function(e,t,n){o.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length);Se("OnDisconnect.setWithPriority",this.path_);ve("OnDisconnect.setWithPriority",1,e,this.path_,false);me("OnDisconnect.setWithPriority",2,t,false);o.validateCallback("OnDisconnect.setWithPriority",3,n,true);var r=new o.Deferred;this.repo_.onDisconnectSetWithPriority(this.path_,e,t,r.wrapCallback(n));return r.promise};e.prototype.update=function(e,t){o.validateArgCount("OnDisconnect.update",1,2,arguments.length);Se("OnDisconnect.update",this.path_);if(Array.isArray(e)){var n={};for(var r=0;r<e.length;++r)n[""+r]=e[r];e=n;I("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_e("OnDisconnect.update",1,e,this.path_,false);o.validateCallback("OnDisconnect.update",2,t,true);var i=new o.Deferred;this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t));return i.promise};return e}();var Ne=function(){function e(e,t){this.committed=e;this.snapshot=t}e.prototype.toJSON=function(){o.validateArgCount("TransactionResult.toJSON",0,1,arguments.length);return{committed:this.committed,snapshot:this.snapshot.toJSON()}};return e}();var Ae=function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";var t=0;var n=[];return function(r){var i=r===t;t=r;var a;var s=new Array(8);for(a=7;a>=0;a--){s[a]=e.charAt(r%64);r=Math.floor(r/64)}o.assert(0===r,"Cannot push at time == 0");var u=s.join("");if(i){for(a=11;a>=0&&63===n[a];a--)n[a]=0;n[a]++}else for(a=0;a<12;a++)n[a]=Math.floor(64*Math.random());for(a=0;a<12;a++)u+=e.charAt(n[a]);o.assert(20===u.length,"nextPushId: Length should be 20.");return u}}();var De=function(){function e(e,t){this.name=e;this.node=t}e.Wrap=function(t,n){return new e(t,n)};return e}();var Re=function(){function e(){}e.prototype.getCompare=function(){return this.compare.bind(this)};e.prototype.indexedValueChanged=function(e,t){var n=new De(A,e);var r=new De(A,t);return 0!==this.compare(n,r)};e.prototype.minPost=function(){return De.MIN};return e}();var Pe;var ke=function(e){s.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return Pe},set:function(e){Pe=e},enumerable:true,configurable:true});t.prototype.compare=function(e,t){return R(e.name,t.name)};t.prototype.isDefinedOn=function(e){throw o.assertionError("KeyIndex.isDefinedOn not expected to be called.")};t.prototype.indexedValueChanged=function(e,t){return false};t.prototype.minPost=function(){return De.MIN};t.prototype.maxPost=function(){return new De(D,Pe)};t.prototype.makePost=function(e,t){o.assert("string"===typeof e,"KeyIndex indexValue must always be a string.");return new De(e,Pe)};t.prototype.toString=function(){return".key"};return t}(Re);var Le=new ke;var xe;function Me(e){xe=e}var Ue=function(e){return"number"===typeof e?"number:"+U(e):"string:"+e};var Fe=function(e){if(e.isLeafNode()){var t=e.val();o.assert("string"===typeof t||"number"===typeof t||"object"===typeof t&&o.contains(t,".sv"),"Priority must be a string or number.")}else o.assert(e===xe||e.isEmpty(),"priority of unexpected type.");o.assert(e===xe||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var je;var Be=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE);this.value_=t;this.priorityNode_=n;this.lazyHash_=null;o.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value.");Fe(this.priorityNode_)}Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return je},set:function(e){je=e},enumerable:true,configurable:true});e.prototype.isLeafNode=function(){return true};e.prototype.getPriority=function(){return this.priorityNode_};e.prototype.updatePriority=function(t){return new e(this.value_,t)};e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE};e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE};e.prototype.hasChild=function(){return false};e.prototype.getPredecessorChildName=function(e,t){return null};e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)};e.prototype.updateChild=function(t,n){var r=t.getFront();if(null===r)return n;if(n.isEmpty()&&".priority"!==r)return this;o.assert(".priority"!==r||1===t.getLength(),".priority must be the last token in a path");return this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),n))};e.prototype.isEmpty=function(){return false};e.prototype.numChildren=function(){return 0};e.prototype.forEachChild=function(e,t){return false};e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()};e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ue(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":";e+="number"===t?U(this.value_):this.value_;this.lazyHash_=y(e)}return this.lazyHash_};e.prototype.getValue=function(){return this.value_};e.prototype.compareTo=function(t){if(t===e.__childrenNodeConstructor.EMPTY_NODE)return 1;if(t instanceof e.__childrenNodeConstructor)return-1;o.assert(t.isLeafNode(),"Unknown node type");return this.compareToLeafNode_(t)};e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_;var r=typeof this.value_;var i=e.VALUE_TYPE_ORDER.indexOf(n);var a=e.VALUE_TYPE_ORDER.indexOf(r);o.assert(i>=0,"Unknown leaf type: "+n);o.assert(a>=0,"Unknown leaf type: "+r);return i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i};e.prototype.withIndex=function(){return this};e.prototype.isIndexed=function(){return true};e.prototype.equals=function(e){if(e===this)return true;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return false};e.VALUE_TYPE_ORDER=["object","boolean","number","string"];return e}();var We;var qe;function Ve(e){We=e}function He(e){qe=e}var Ke=function(e){s.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.compare=function(e,t){var n=e.node.getPriority();var r=t.node.getPriority();var i=n.compareTo(r);return 0===i?R(e.name,t.name):i};t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()};t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())};t.prototype.minPost=function(){return De.MIN};t.prototype.maxPost=function(){return new De(D,new Be("[PRIORITY-POST]",qe))};t.prototype.makePost=function(e,t){var n=We(e);return new De(t,new Be("[PRIORITY-POST]",n))};t.prototype.toString=function(){return".priority"};return t}(Re);var Ge=new Ke;var ze=function(){function e(e,t,n,r,i){void 0===i&&(i=null);this.isReverse_=r;this.resultGenerator_=i;this.nodeStack_=[];var o=1;while(!e.isEmpty()){e=e;o=t?n(e.key,t):1;r&&(o*=-1);if(o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e);e=this.isReverse_?e.right:e.left}}}e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_.pop();var t;t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value};if(this.isReverse_){e=e.left;while(!e.isEmpty()){this.nodeStack_.push(e);e=e.right}}else{e=e.right;while(!e.isEmpty()){this.nodeStack_.push(e);e=e.left}}return t};e.prototype.hasNext=function(){return this.nodeStack_.length>0};e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}};return e}();var Qe=function(){function e(t,n,r,i,o){this.key=t;this.value=n;this.color=null!=r?r:e.RED;this.left=null!=i?i:Xe.EMPTY_NODE;this.right=null!=o?o:Xe.EMPTY_NODE}e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)};e.prototype.count=function(){return this.left.count()+1+this.right.count()};e.prototype.isEmpty=function(){return false};e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)};e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)};e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()};e.prototype.minKey=function(){return this.min_().key};e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()};e.prototype.insert=function(e,t,n){var r,i;i=this;r=n(e,i.key);i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n));return i.fixUp_()};e.prototype.removeMin_=function(){if(this.left.isEmpty())return Xe.EMPTY_NODE;var e=this;e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_());e=e.copy(null,null,null,e.left.removeMin_(),null);return e.fixUp_()};e.prototype.remove=function(e,t){var n,r;n=this;if(t(e,n.key)<0){n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_());n=n.copy(null,null,null,n.left.remove(e,t),null)}else{n.left.isRed_()&&(n=n.rotateRight_());n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_());if(0===t(e,n.key)){if(n.right.isEmpty())return Xe.EMPTY_NODE;r=n.right.min_();n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()};e.prototype.isRed_=function(){return this.color};e.prototype.fixUp_=function(){var e=this;e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_());e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_());e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_());return e};e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();if(e.right.left.isRed_()){e=e.copy(null,null,null,null,e.right.rotateRight_());e=e.rotateLeft_();e=e.colorFlip_()}return e};e.prototype.moveRedRight_=function(){var e=this.colorFlip_();if(e.left.left.isRed_()){e=e.rotateRight_();e=e.colorFlip_()}return e};e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)};e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)};e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null);var t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)};e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1};e.prototype.check_=function(){var e;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)};e.RED=true;e.BLACK=false;return e}();var Ye=function(){function e(){}e.prototype.copy=function(e,t,n,r,i){return this};e.prototype.insert=function(e,t,n){return new Qe(e,t,null)};e.prototype.remove=function(e,t){return this};e.prototype.count=function(){return 0};e.prototype.isEmpty=function(){return true};e.prototype.inorderTraversal=function(e){return false};e.prototype.reverseTraversal=function(e){return false};e.prototype.minKey=function(){return null};e.prototype.maxKey=function(){return null};e.prototype.check_=function(){return 0};e.prototype.isRed_=function(){return false};return e}();var Xe=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE);this.comparator_=t;this.root_=n}e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Qe.BLACK,null,null))};e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Qe.BLACK,null,null))};e.prototype.get=function(e){var t;var n=this.root_;while(!n.isEmpty()){t=this.comparator_(e,n.key);if(0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null};e.prototype.getPredecessorKey=function(e){var t,n=this.root_,r=null;while(!n.isEmpty()){t=this.comparator_(e,n.key);if(0===t){if(n.left.isEmpty())return r?r.key:null;n=n.left;while(!n.right.isEmpty())n=n.right;return n.key}if(t<0)n=n.left;else if(t>0){r=n;n=n.right}}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")};e.prototype.isEmpty=function(){return this.root_.isEmpty()};e.prototype.count=function(){return this.root_.count()};e.prototype.minKey=function(){return this.root_.minKey()};e.prototype.maxKey=function(){return this.root_.maxKey()};e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)};e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)};e.prototype.getIterator=function(e){return new ze(this.root_,null,this.comparator_,false,e)};e.prototype.getIteratorFrom=function(e,t){return new ze(this.root_,e,this.comparator_,false,t)};e.prototype.getReverseIteratorFrom=function(e,t){return new ze(this.root_,e,this.comparator_,true,t)};e.prototype.getReverseIterator=function(e){return new ze(this.root_,null,this.comparator_,true,e)};e.EMPTY_NODE=new Ye;return e}();var $e=Math.log(2);var Je=function(){function e(e){var t=function(e){return parseInt(Math.log(e)/$e,10)};var n=function(e){return parseInt(Array(e+1).join("1"),2)};this.count=t(e+1);this.current_=this.count-1;var r=n(this.count);this.bits_=e+1&r}e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);this.current_--;return e};return e}();var Ze=function(e,t,n,r){e.sort(t);var i=function(t,r){var o=r-t;var a;var s;if(0==o)return null;if(1==o){a=e[t];s=n?n(a):a;return new Qe(s,a.node,Qe.BLACK,null,null)}var u=parseInt(o/2,10)+t;var c=i(t,u);var l=i(u+1,r);a=e[u];s=n?n(a):a;return new Qe(s,a.node,Qe.BLACK,c,l)};var o=function(t){var r=null;var o=null;var a=e.length;var s=function(t,r){var o=a-t;var s=a;a-=t;var c=i(o+1,s);var l=e[o];var h=n?n(l):l;u(new Qe(h,l.node,r,null,c))};var u=function(e){if(r){r.left=e;r=e}else{o=e;r=e}};for(var c=0;c<t.count;++c){var l=t.nextBitIsOne();var h=Math.pow(2,t.count-(c+1));if(l)s(h,Qe.BLACK);else{s(h,Qe.BLACK);s(h,Qe.RED)}}return o};var a=new Je(e.length);var s=o(a);return new Xe(r||t,s)};var et;var tt={};var nt=function(){function e(e,t){this.indexes_=e;this.indexSet_=t}Object.defineProperty(e,"Default",{get:function(){o.assert(tt&&Ge,"ChildrenNode.ts has not been loaded");et=et||new e({".priority":tt},{".priority":Ge});return et},enumerable:true,configurable:true});e.prototype.get=function(e){var t=o.safeGet(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t===tt?null:t};e.prototype.hasIndex=function(e){return o.contains(this.indexSet_,e.toString())};e.prototype.addIndex=function(t,n){o.assert(t!==Le,"KeyIndex always exists and isn't meant to be added to the IndexMap.");var r=[];var i=false;var a=n.getIterator(De.Wrap);var s=a.getNext();while(s){i=i||t.isDefinedOn(s.node);r.push(s);s=a.getNext()}var u;u=i?Ze(r,t.getCompare()):tt;var c=t.toString();var l=o.clone(this.indexSet_);l[c]=t;var h=o.clone(this.indexes_);h[c]=u;return new e(h,l)};e.prototype.addToIndexes=function(t,n){var r=this;var i=o.map(this.indexes_,function(e,i){var a=o.safeGet(r.indexSet_,i);o.assert(a,"Missing index implementation for "+i);if(e===tt){if(a.isDefinedOn(t.node)){var s=[];var u=n.getIterator(De.Wrap);var c=u.getNext();while(c){c.name!=t.name&&s.push(c);c=u.getNext()}s.push(t);return Ze(s,a.getCompare())}return tt}var l=n.get(t.name);var h=e;l&&(h=h.remove(new De(t.name,l)));return h.insert(t,t.node)});return new e(i,this.indexSet_)};e.prototype.removeFromIndexes=function(t,n){var r=o.map(this.indexes_,function(e){if(e===tt)return e;var r=n.get(t.name);return r?e.remove(new De(t.name,r)):e});return new e(r,this.indexSet_)};return e}();function rt(e,t){return R(e.name,t.name)}function it(e,t){return R(e,t)}var ot;var at=function(){function e(e,t,n){this.children_=e;this.priorityNode_=t;this.indexMap_=n;this.lazyHash_=null;this.priorityNode_&&Fe(this.priorityNode_);this.children_.isEmpty()&&o.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}Object.defineProperty(e,"EMPTY_NODE",{get:function(){return ot||(ot=new e(new Xe(it),null,nt.Default))},enumerable:true,configurable:true});e.prototype.isLeafNode=function(){return false};e.prototype.getPriority=function(){return this.priorityNode_||ot};e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)};e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?ot:t};e.prototype.getChild=function(e){var t=e.getFront();if(null===t)return this;return this.getImmediateChild(t).getChild(e.popFront())};e.prototype.hasChild=function(e){return null!==this.children_.get(e)};e.prototype.updateImmediateChild=function(t,n){o.assert(n,"We should always be passing snapshot nodes");if(".priority"===t)return this.updatePriority(n);var r=new De(t,n);var i=void 0,a=void 0,s=void 0;if(n.isEmpty()){i=this.children_.remove(t);a=this.indexMap_.removeFromIndexes(r,this.children_)}else{i=this.children_.insert(t,n);a=this.indexMap_.addToIndexes(r,this.children_)}s=i.isEmpty()?ot:this.priorityNode_;return new e(i,s,a)};e.prototype.updateChild=function(e,t){var n=e.getFront();if(null===n)return t;o.assert(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(e.popFront(),t);return this.updateImmediateChild(n,r)};e.prototype.isEmpty=function(){return this.children_.isEmpty()};e.prototype.numChildren=function(){return this.children_.count()};e.prototype.val=function(t){if(this.isEmpty())return null;var n={};var r=0,i=0,o=true;this.forEachChild(Ge,function(a,s){n[a]=s.val(t);r++;o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=false});if(!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val());return n};e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Ue(this.getPriority().val())+":");this.forEachChild(Ge,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)});this.lazyHash_=""===e?"":y(e)}return this.lazyHash_};e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new De(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)};e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()};e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new De(t,this.children_.get(t)):null};e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()};e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new De(t,this.children_.get(t)):null};e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)};e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)};e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});var r=this.children_.getIteratorFrom(e.name,De.Wrap);var i=r.peek();while(null!=i&&t.compare(i,e)<0){r.getNext();i=r.peek()}return r};e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)};e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});var r=this.children_.getReverseIteratorFrom(e.name,De.Wrap);var i=r.peek();while(null!=i&&t.compare(i,e)>0){r.getNext();i=r.peek()}return r};e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ut?-1:0};e.prototype.withIndex=function(t){if(t===Le||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)};e.prototype.isIndexed=function(e){return e===Le||this.indexMap_.hasIndex(e)};e.prototype.equals=function(e){if(e===this)return true;if(e.isLeafNode())return false;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){var n=this.getIterator(Ge);var r=t.getIterator(Ge);var i=n.getNext();var o=r.getNext();while(i&&o){if(i.name!==o.name||!i.node.equals(o.node))return false;i=n.getNext();o=r.getNext()}return null===i&&null===o}return false}return false};e.prototype.resolveIndex_=function(e){return e===Le?null:this.indexMap_.get(e.toString())};e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;return e}();var st=function(e){s.__extends(t,e);function t(){return e.call(this,new Xe(it),at.EMPTY_NODE,nt.Default)||this}t.prototype.compareTo=function(e){return e===this?0:1};t.prototype.equals=function(e){return e===this};t.prototype.getPriority=function(){return this};t.prototype.getImmediateChild=function(e){return at.EMPTY_NODE};t.prototype.isEmpty=function(){return false};return t}(at);var ut=new st;Object.defineProperties(De,{MIN:{value:new De(A,at.EMPTY_NODE)},MAX:{value:new De(D,ut)}});ke.__EMPTY_NODE=at.EMPTY_NODE;Be.__childrenNodeConstructor=at;Me(ut);He(ut);var ct=true;function lt(e,t){void 0===t&&(t=null);if(null===e)return at.EMPTY_NODE;"object"===typeof e&&".priority"in e&&(t=e[".priority"]);o.assert(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t);"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]);if("object"!==typeof e||".sv"in e){var n=e;return new Be(n,lt(t))}if(e instanceof Array||!ct){var r=at.EMPTY_NODE;var i=e;o.forEach(i,function(e,t){if(o.contains(i,e)&&"."!==e.substring(0,1)){var n=lt(t);!n.isLeafNode()&&n.isEmpty()||(r=r.updateImmediateChild(e,n))}});return r.updatePriority(lt(t))}var a=[];var s=false;var u=e;o.forEach(u,function(e,t){if("string"!==typeof e||"."!==e.substring(0,1)){var n=lt(u[e]);if(!n.isEmpty()){s=s||!n.getPriority().isEmpty();a.push(new De(e,n))}}});if(0==a.length)return at.EMPTY_NODE;var c=Ze(a,rt,function(e){return e.name},it);if(s){var l=Ze(a,Ge.getCompare());return new at(c,lt(t),new nt({".priority":l},{".priority":Ge}))}return new at(c,lt(t),nt.Default)}Ve(lt);var ht=function(e){s.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?R(e.name,t.name):n};t.prototype.isDefinedOn=function(e){return true};t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)};t.prototype.minPost=function(){return De.MIN};t.prototype.maxPost=function(){return De.MAX};t.prototype.makePost=function(e,t){var n=lt(e);return new De(t,n)};t.prototype.toString=function(){return".value"};return t}(Re);var ft=new ht;var pt=function(e){s.__extends(t,e);function t(t){var n=e.call(this)||this;n.indexPath_=t;o.assert(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key");return n}t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)};t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()};t.prototype.compare=function(e,t){var n=this.extractChild(e.node);var r=this.extractChild(t.node);var i=n.compareTo(r);return 0===i?R(e.name,t.name):i};t.prototype.makePost=function(e,t){var n=lt(e);var r=at.EMPTY_NODE.updateChild(this.indexPath_,n);return new De(t,r)};t.prototype.maxPost=function(){var e=at.EMPTY_NODE.updateChild(this.indexPath_,ut);return new De(D,e)};t.prototype.toString=function(){return this.indexPath_.slice().join("/")};return t}(Re);var dt=function(){function e(e,t,n){this.node_=e;this.ref_=t;this.index_=n}e.prototype.val=function(){o.validateArgCount("DataSnapshot.val",0,0,arguments.length);return this.node_.val()};e.prototype.exportVal=function(){o.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length);return this.node_.val(true)};e.prototype.toJSON=function(){o.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length);return this.exportVal()};e.prototype.exists=function(){o.validateArgCount("DataSnapshot.exists",0,0,arguments.length);return!this.node_.isEmpty()};e.prototype.child=function(t){o.validateArgCount("DataSnapshot.child",0,1,arguments.length);t=String(t);Ee("DataSnapshot.child",1,t,false);var n=new G(t);var r=this.ref_.child(n);return new e(this.node_.getChild(n),r,Ge)};e.prototype.hasChild=function(e){o.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length);Ee("DataSnapshot.hasChild",1,e,false);var t=new G(e);return!this.node_.getChild(t).isEmpty()};e.prototype.getPriority=function(){o.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length);return this.node_.getPriority().val()};e.prototype.forEach=function(t){var n=this;o.validateArgCount("DataSnapshot.forEach",1,1,arguments.length);o.validateCallback("DataSnapshot.forEach",1,t,false);if(this.node_.isLeafNode())return false;var r=this.node_;return!!r.forEachChild(this.index_,function(r,i){return t(new e(i,n.ref_.child(r),Ge))})};e.prototype.hasChildren=function(){o.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length);return!this.node_.isLeafNode()&&!this.node_.isEmpty()};Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:true,configurable:true});e.prototype.numChildren=function(){o.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length);return this.node_.numChildren()};e.prototype.getRef=function(){o.validateArgCount("DataSnapshot.ref",0,0,arguments.length);return this.ref_};Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:true,configurable:true});return e}();var vt=function(){function e(e,t,n,r){this.eventType=e;this.eventRegistration=t;this.snapshot=n;this.prevName=r}e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path};e.prototype.getEventType=function(){return this.eventType};e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)};e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+o.stringify(this.snapshot.exportVal())};return e}();var yt=function(){function e(e,t,n){this.eventRegistration=e;this.error=t;this.path=n}e.prototype.getPath=function(){return this.path};e.prototype.getEventType=function(){return"cancel"};e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)};e.prototype.toString=function(){return this.path.toString()+":cancel"};return e}();var gt=function(){function e(e,t,n){this.callback_=e;this.cancelCallback_=t;this.context_=n}e.prototype.respondsTo=function(e){return"value"===e};e.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new vt("value",this,new dt(e.snapshotNode,t.getRef(),n))};e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){o.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callback_;return function(){r.call(t,e.snapshot)}};e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new yt(this,e,t):null};e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)};e.prototype.hasAnyCallback=function(){return null!==this.callback_};return e}();var _t=function(){function e(e,t,n){this.callbacks_=e;this.cancelCallback_=t;this.context_=n}e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;t="children_removed"===t?"child_removed":t;return o.contains(this.callbacks_,t)};e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new yt(this,e,t):null};e.prototype.createEvent=function(e,t){o.assert(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName);var r=t.getQueryParams().getIndex();return new vt(e.type,this,new dt(e.snapshotNode,n,r),e.prevName)};e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){o.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callbacks_[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}};e.prototype.matches=function(t){if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return true;if(this.context_===t.context_){var n=o.getCount(t.callbacks_);var r=o.getCount(this.callbacks_);if(n===r){if(1===n){var i=o.getAnyKey(t.callbacks_);var a=o.getAnyKey(this.callbacks_);return a===i&&(!t.callbacks_[i]||!this.callbacks_[a]||t.callbacks_[i]===this.callbacks_[a])}return o.every(this.callbacks_,function(e,n){return t.callbacks_[e]===n})}}}return false};e.prototype.hasAnyCallback=function(){return null!==this.callbacks_};return e}();var mt;var bt=function(){function e(e,t,n,r){this.repo=e;this.path=t;this.queryParams_=n;this.orderByCalled_=r}Object.defineProperty(e,"__referenceConstructor",{get:function(){o.assert(mt,"Reference.ts has not been loaded");return mt},set:function(e){mt=e},enumerable:true,configurable:true});e.validateQueryEndpoints_=function(e){var t=null;var n=null;e.hasStart()&&(t=e.getIndexStartValue());e.hasEnd()&&(n=e.getIndexEndValue());if(e.getIndex()===Le){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().";var i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){var a=e.getIndexStartName();if(a!=A)throw new Error(r);if("string"!==typeof t)throw new Error(i)}if(e.hasEnd()){var s=e.getIndexEndName();if(s!=D)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(e.getIndex()===Ge){if(null!=t&&!de(t)||null!=n&&!de(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else{o.assert(e.getIndex()instanceof pt||e.getIndex()===ft,"unknown index type.");if(null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")}};e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")};e.prototype.validateNoPreviousOrderByCall_=function(e){if(true===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")};e.prototype.getQueryParams=function(){return this.queryParams_};e.prototype.getRef=function(){o.validateArgCount("Query.ref",0,0,arguments.length);return new e.__referenceConstructor(this.repo,this.path)};e.prototype.on=function(t,n,r,i){o.validateArgCount("Query.on",2,4,arguments.length);be("Query.on",1,t,false);o.validateCallback("Query.on",2,n,false);var a=e.getCancelAndContextArgs_("Query.on",r,i);if("value"===t)this.onValueEvent(n,a.cancel,a.context);else{var s={};s[t]=n;this.onChildEvent(s,a.cancel,a.context)}return n};e.prototype.onValueEvent=function(e,t,n){var r=new gt(e,t||null,n||null);this.repo.addEventCallbackForQuery(this,r)};e.prototype.onChildEvent=function(e,t,n){var r=new _t(e,t,n);this.repo.addEventCallbackForQuery(this,r)};e.prototype.off=function(e,t,n){o.validateArgCount("Query.off",0,3,arguments.length);be("Query.off",1,e,true);o.validateCallback("Query.off",2,t,true);o.validateContextObject("Query.off",3,n,true);var r=null;var i=null;if("value"===e){var a=t||null;r=new gt(a,null,n||null)}else if(e){if(t){i={};i[e]=t}r=new _t(i,null,n||null)}this.repo.removeEventCallbackForQuery(this,r)};e.prototype.once=function(t,n,r,i){var a=this;o.validateArgCount("Query.once",1,4,arguments.length);be("Query.once",1,t,false);o.validateCallback("Query.once",2,n,true);var s=e.getCancelAndContextArgs_("Query.once",r,i);var u=true;var c=new o.Deferred;c.promise.catch(function(){});var l=function(e){if(u){u=false;a.off(t,l);n&&n.bind(s.context)(e);c.resolve(e)}};this.on(t,l,function(e){a.off(t,l);s.cancel&&s.cancel.bind(s.context)(e);c.reject(e)});return c.promise};e.prototype.limitToFirst=function(t){o.validateArgCount("Query.limitToFirst",1,1,arguments.length);if("number"!==typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)};e.prototype.limitToLast=function(t){o.validateArgCount("Query.limitToLast",1,1,arguments.length);if("number"!==typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)};e.prototype.orderByChild=function(t){o.validateArgCount("Query.orderByChild",1,1,arguments.length);if("$key"===t)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Ee("Query.orderByChild",1,t,false);this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new G(t);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new pt(n);var i=this.queryParams_.orderBy(r);e.validateQueryEndpoints_(i);return new e(this.repo,this.path,i,true)};e.prototype.orderByKey=function(){o.validateArgCount("Query.orderByKey",0,0,arguments.length);this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(Le);e.validateQueryEndpoints_(t);return new e(this.repo,this.path,t,true)};e.prototype.orderByPriority=function(){o.validateArgCount("Query.orderByPriority",0,0,arguments.length);this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(Ge);e.validateQueryEndpoints_(t);return new e(this.repo,this.path,t,true)};e.prototype.orderByValue=function(){o.validateArgCount("Query.orderByValue",0,0,arguments.length);this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(ft);e.validateQueryEndpoints_(t);return new e(this.repo,this.path,t,true)};e.prototype.startAt=function(t,n){void 0===t&&(t=null);o.validateArgCount("Query.startAt",0,2,arguments.length);ve("Query.startAt",1,t,this.path,true);we("Query.startAt",2,n,true);var r=this.queryParams_.startAt(t,n);e.validateLimit_(r);e.validateQueryEndpoints_(r);if(this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");if(void 0===t){t=null;n=null}return new e(this.repo,this.path,r,this.orderByCalled_)};e.prototype.endAt=function(t,n){void 0===t&&(t=null);o.validateArgCount("Query.endAt",0,2,arguments.length);ve("Query.endAt",1,t,this.path,true);we("Query.endAt",2,n,true);var r=this.queryParams_.endAt(t,n);e.validateLimit_(r);e.validateQueryEndpoints_(r);if(this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,r,this.orderByCalled_)};e.prototype.equalTo=function(e,t){o.validateArgCount("Query.equalTo",1,2,arguments.length);ve("Query.equalTo",1,e,this.path,false);we("Query.equalTo",2,t,true);if(this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)};e.prototype.toString=function(){o.validateArgCount("Query.toString",0,0,arguments.length);return this.repo.toString()+this.path.toUrlEncodedString()};e.prototype.toJSON=function(){o.validateArgCount("Query.toJSON",0,1,arguments.length);return this.toString()};e.prototype.queryObject=function(){return this.queryParams_.getQueryObject()};e.prototype.queryIdentifier=function(){var e=this.queryObject();var t=L(e);return"{}"===t?"default":t};e.prototype.isEqual=function(t){o.validateArgCount("Query.isEqual",1,1,arguments.length);if(!(t instanceof e)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===t.repo;var i=this.path.equals(t.path);var a=this.queryIdentifier()===t.queryIdentifier();return r&&i&&a};e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:null,context:null};if(t&&n){r.cancel=t;o.validateCallback(e,3,r.cancel,true);r.context=n;o.validateContextObject(e,4,r.context,true)}else if(t)if("object"===typeof t&&null!==t)r.context=t;else{if("function"!==typeof t)throw new Error(o.errorPrefix(e,3,true)+" must either be a cancel callback or a context object.");r.cancel=t}return r};Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:true,configurable:true});return e}();var wt=function(){function e(){this.set={}}e.prototype.add=function(e,t){this.set[e]=null===t||t};e.prototype.contains=function(e){return o.contains(this.set,e)};e.prototype.get=function(e){return this.contains(e)?this.set[e]:void 0};e.prototype.remove=function(e){delete this.set[e]};e.prototype.clear=function(){this.set={}};e.prototype.isEmpty=function(){return o.isEmpty(this.set)};e.prototype.count=function(){return o.getCount(this.set)};e.prototype.each=function(e){o.forEach(this.set,function(t,n){return e(t,n)})};e.prototype.keys=function(){var e=[];o.forEach(this.set,function(t){e.push(t)});return e};return e}();var Et=function(){function e(){this.value_=null;this.children_=null}e.prototype.find=function(e){if(null!=this.value_)return this.value_.getChild(e);if(e.isEmpty()||null==this.children_)return null;var t=e.getFront();e=e.popFront();if(this.children_.contains(t)){var n=this.children_.get(t);return n.find(e)}return null};e.prototype.remember=function(t,n){if(t.isEmpty()){this.value_=n;this.children_=null}else if(null!==this.value_)this.value_=this.value_.updateChild(t,n);else{null==this.children_&&(this.children_=new wt);var r=t.getFront();this.children_.contains(r)||this.children_.add(r,new e);var i=this.children_.get(r);t=t.popFront();i.remember(t,n)}};e.prototype.forget=function(e){if(e.isEmpty()){this.value_=null;this.children_=null;return true}if(null!==this.value_){if(this.value_.isLeafNode())return false;var t=this.value_;this.value_=null;var n=this;t.forEachChild(Ge,function(e,t){n.remember(new G(e),t)});return this.forget(e)}if(null!==this.children_){var r=e.getFront();e=e.popFront();if(this.children_.contains(r)){var i=this.children_.get(r).forget(e);i&&this.children_.remove(r)}if(this.children_.isEmpty()){this.children_=null;return true}return false}return true};e.prototype.forEachTree=function(e,t){null!==this.value_?t(e,this.value_):this.forEachChild(function(n,r){var i=new G(e.toString()+"/"+n);r.forEachTree(i,t)})};e.prototype.forEachChild=function(e){null!==this.children_&&this.children_.each(function(t,n){e(t,n)})};return e}();var Tt=function(e){e=e||{};e["timestamp"]=e["timestamp"]||(new Date).getTime();return e};var St=function(e,t){if(e&&"object"===typeof e){o.assert(".sv"in e,"Unexpected leaf node or priority contents");return t[e[".sv"]]}return e};var It=function(e,t){var n=new Et;e.forEachTree(new G(""),function(e,r){n.remember(e,Ct(r,t))});return n};var Ct=function(e,t){var n=e.getPriority().val();var r=St(n,t);var i;if(e.isLeafNode()){var o=e;var a=St(o.getValue(),t);return a!==o.getValue()||r!==o.getPriority().val()?new Be(a,lt(r)):e}var s=e;i=s;r!==s.getPriority().val()&&(i=i.updatePriority(new Be(r)));s.forEachChild(Ge,function(e,n){var r=Ct(n,t);r!==n&&(i=i.updateImmediateChild(e,r))});return i};var Ot;(function(e){e[e["OVERWRITE"]=0]="OVERWRITE";e[e["MERGE"]=1]="MERGE";e[e["ACK_USER_WRITE"]=2]="ACK_USER_WRITE";e[e["LISTEN_COMPLETE"]=3]="LISTEN_COMPLETE"})(Ot||(Ot={}));var Nt=function(){function e(e,t,n,r){this.fromUser=e;this.fromServer=t;this.queryId=n;this.tagged=r;o.assert(!r||t,"Tagged queries must be from server.")}e.User=new e(true,false,null,false);e.Server=new e(false,true,null,false);e.forServerTaggedQuery=function(t){return new e(false,true,t,true)};return e}();var At=function(){function e(e,t,n){this.path=e;this.affectedTree=t;this.revert=n;this.type=Ot.ACK_USER_WRITE;this.source=Nt.User}e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value){o.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths.");return this}var n=this.affectedTree.subtree(new G(t));return new e(G.Empty,n,this.revert)}o.assert(this.path.getFront()===t,"operationForChild called for unrelated child.");return new e(this.path.popFront(),this.affectedTree,this.revert)};return e}();var Dt;var Rt=function(){Dt||(Dt=new Xe(P));return Dt};var Pt=function(){function e(e,t){void 0===t&&(t=Rt());this.value=e;this.children=t}e.fromObject=function(t){var n=e.Empty;o.forEach(t,function(e,t){n=n.set(new G(e),t)});return n};e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()};e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:G.Empty,value:this.value};if(e.isEmpty())return null;var n=e.getFront();var r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(e.popFront(),t);if(null!=i){var o=new G(n).child(i.path);return{path:o,value:i.value}}return null}return null};e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return true})};e.prototype.subtree=function(t){if(t.isEmpty())return this;var n=t.getFront();var r=this.children.get(n);return null!==r?r.subtree(t.popFront()):e.Empty};e.prototype.set=function(t,n){if(t.isEmpty())return new e(n,this.children);var r=t.getFront();var i=this.children.get(r)||e.Empty;var o=i.set(t.popFront(),n);var a=this.children.insert(r,o);return new e(this.value,a)};e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var n=t.getFront();var r=this.children.get(n);if(r){var i=r.remove(t.popFront());var o=void 0;o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i);return null===this.value&&o.isEmpty()?e.Empty:new e(this.value,o)}return this};e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront();var n=this.children.get(t);return n?n.get(e.popFront()):null};e.prototype.setTree=function(t,n){if(t.isEmpty())return n;var r=t.getFront();var i=this.children.get(r)||e.Empty;var o=i.setTree(t.popFront(),n);var a=void 0;a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o);return new e(this.value,a)};e.prototype.fold=function(e){return this.fold_(G.Empty,e)};e.prototype.fold_=function(e,t){var n={};this.children.inorderTraversal(function(r,i){n[r]=i.fold_(e.child(r),t)});return t(e,this.value,n)};e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,G.Empty,t)};e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(e.isEmpty())return null;var i=e.getFront();var o=this.children.get(i);return o?o.findOnPath_(e.popFront(),t.child(i),n):null};e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,G.Empty,t)};e.prototype.foreachOnPath_=function(t,n,r){if(t.isEmpty())return this;this.value&&r(n,this.value);var i=t.getFront();var o=this.children.get(i);return o?o.foreachOnPath_(t.popFront(),n.child(i),r):e.Empty};e.prototype.foreach=function(e){this.foreach_(G.Empty,e)};e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(e.child(n),t)});this.value&&t(e,this.value)};e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})};e.Empty=new e(null);return e}();var kt=function(){function e(e,t){this.source=e;this.path=t;this.type=Ot.LISTEN_COMPLETE}e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,G.Empty):new e(this.source,this.path.popFront())};return e}();var Lt=function(){function e(e,t,n){this.source=e;this.path=t;this.snap=n;this.type=Ot.OVERWRITE}e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,G.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)};return e}();var xt=function(){function e(e,t,n){this.source=e;this.path=t;this.children=n;this.type=Ot.MERGE}e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var n=this.children.subtree(new G(t));return n.isEmpty()?null:n.value?new Lt(this.source,G.Empty,n.value):new e(this.source,G.Empty,n)}o.assert(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation");return new e(this.source,this.path.popFront(),this.children)};e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"};return e}();var Mt=function(){function e(e,t,n){this.node_=e;this.fullyInitialized_=t;this.filtered_=n}e.prototype.isFullyInitialized=function(){return this.fullyInitialized_};e.prototype.isFiltered=function(){return this.filtered_};e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)};e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)};e.prototype.getNode=function(){return this.node_};return e}();var Ut=function(){function e(e,t){this.eventCache_=e;this.serverCache_=t}e.prototype.updateEventSnap=function(t,n,r){return new e(new Mt(t,n,r),this.serverCache_)};e.prototype.updateServerSnap=function(t,n,r){return new e(this.eventCache_,new Mt(t,n,r))};e.prototype.getEventCache=function(){return this.eventCache_};e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null};e.prototype.getServerCache=function(){return this.serverCache_};e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null};e.Empty=new e(new Mt(at.EMPTY_NODE,false,false),new Mt(at.EMPTY_NODE,false,false));return e}();var Ft=function(){function e(e,t,n,r,i){this.type=e;this.snapshotNode=t;this.childName=n;this.oldSnap=r;this.prevName=i}e.valueChange=function(t){return new e(e.VALUE,t)};e.childAddedChange=function(t,n){return new e(e.CHILD_ADDED,n,t)};e.childRemovedChange=function(t,n){return new e(e.CHILD_REMOVED,n,t)};e.childChangedChange=function(t,n,r){return new e(e.CHILD_CHANGED,n,t,r)};e.childMovedChange=function(t,n){return new e(e.CHILD_MOVED,n,t)};e.CHILD_ADDED="child_added";e.CHILD_REMOVED="child_removed";e.CHILD_CHANGED="child_changed";e.CHILD_MOVED="child_moved";e.VALUE="value";return e}();var jt=function(){function e(e){this.index_=e}e.prototype.updateChild=function(e,t,n,r,i,a){o.assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=e.getImmediateChild(t);if(s.getChild(r).equals(n.getChild(r))&&s.isEmpty()==n.isEmpty())return e;null!=a&&(n.isEmpty()?e.hasChild(t)?a.trackChildChange(Ft.childRemovedChange(t,s)):o.assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(Ft.childAddedChange(t,n)):a.trackChildChange(Ft.childChangedChange(t,n,s)));return e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_)};e.prototype.updateFullNode=function(e,t,n){if(null!=n){e.isLeafNode()||e.forEachChild(Ge,function(e,r){t.hasChild(e)||n.trackChildChange(Ft.childRemovedChange(e,r))});t.isLeafNode()||t.forEachChild(Ge,function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Ft.childChangedChange(t,r,i))}else n.trackChildChange(Ft.childAddedChange(t,r))})}return t.withIndex(this.index_)};e.prototype.updatePriority=function(e,t){return e.isEmpty()?at.EMPTY_NODE:e.updatePriority(t)};e.prototype.filtersNodes=function(){return false};e.prototype.getIndexedFilter=function(){return this};e.prototype.getIndex=function(){return this.index_};return e}();var Bt=function(){function e(){this.changeMap_={}}e.prototype.trackChildChange=function(e){var t=e.type;var n=e.childName;o.assert(t==Ft.CHILD_ADDED||t==Ft.CHILD_CHANGED||t==Ft.CHILD_REMOVED,"Only child changes supported for tracking");o.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=o.safeGet(this.changeMap_,n);if(r){var i=r.type;if(t==Ft.CHILD_ADDED&&i==Ft.CHILD_REMOVED)this.changeMap_[n]=Ft.childChangedChange(n,e.snapshotNode,r.snapshotNode);else if(t==Ft.CHILD_REMOVED&&i==Ft.CHILD_ADDED)delete this.changeMap_[n];else if(t==Ft.CHILD_REMOVED&&i==Ft.CHILD_CHANGED)this.changeMap_[n]=Ft.childRemovedChange(n,r.oldSnap);else if(t==Ft.CHILD_CHANGED&&i==Ft.CHILD_ADDED)this.changeMap_[n]=Ft.childAddedChange(n,e.snapshotNode);else{if(t!=Ft.CHILD_CHANGED||i!=Ft.CHILD_CHANGED)throw o.assertionError("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap_[n]=Ft.childChangedChange(n,e.snapshotNode,r.oldSnap)}}else this.changeMap_[n]=e};e.prototype.getChanges=function(){return o.getValues(this.changeMap_)};return e}();var Wt=function(){function e(){}e.prototype.getCompleteChild=function(e){return null};e.prototype.getChildAfterChild=function(e,t,n){return null};return e}();var qt=new Wt;var Vt=function(){function e(e,t,n){void 0===n&&(n=null);this.writes_=e;this.viewCache_=t;this.optCompleteServerCache_=n}e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new Mt(this.optCompleteServerCache_,true,false):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,n)};e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap();var i=this.writes_.calcIndexedSlice(r,t,1,n,e);return 0===i.length?null:i[0]};return e}();var Ht=function(){function e(e,t){this.viewCache=e;this.changes=t}return e}();var Kt=function(){function e(e){this.filter_=e}e.prototype.assertIndexed=function(e){o.assert(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed");o.assert(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")};e.prototype.applyOperation=function(t,n,r,i){var a=new Bt;var s,u;if(n.type===Ot.OVERWRITE){var c=n;if(c.source.fromUser)s=this.applyUserOverwrite_(t,c.path,c.snap,r,i,a);else{o.assert(c.source.fromServer,"Unknown source.");u=c.source.tagged||t.getServerCache().isFiltered()&&!c.path.isEmpty();s=this.applyServerOverwrite_(t,c.path,c.snap,r,i,u,a)}}else if(n.type===Ot.MERGE){var l=n;if(l.source.fromUser)s=this.applyUserMerge_(t,l.path,l.children,r,i,a);else{o.assert(l.source.fromServer,"Unknown source.");u=l.source.tagged||t.getServerCache().isFiltered();s=this.applyServerMerge_(t,l.path,l.children,r,i,u,a)}}else if(n.type===Ot.ACK_USER_WRITE){var h=n;s=h.revert?this.revertUserWrite_(t,h.path,r,i,a):this.ackUserWrite_(t,h.path,h.affectedTree,r,i,a)}else{if(n.type!==Ot.LISTEN_COMPLETE)throw o.assertionError("Unknown operation type: "+n.type);s=this.listenComplete_(t,n.path,r,a)}var f=a.getChanges();e.maybeAddValueEvent_(t,s,f);return new Ht(s,f)};e.maybeAddValueEvent_=function(e,t,n){var r=t.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty();var o=e.getCompleteEventSnap();(n.length>0||!e.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Ft.valueChange(t.getCompleteEventSnap()))}};e.prototype.generateEventCacheAfterServerEvent_=function(e,t,n,r,i){var a=e.getEventCache();if(null!=n.shadowingWrite(t))return e;var s=void 0,u=void 0;if(t.isEmpty()){o.assert(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data");if(e.getServerCache().isFiltered()){var c=e.getCompleteServerSnap();var l=c instanceof at?c:at.EMPTY_NODE;var h=n.calcCompleteEventChildren(l);s=this.filter_.updateFullNode(e.getEventCache().getNode(),h,i)}else{var f=n.calcCompleteEventCache(e.getCompleteServerSnap());s=this.filter_.updateFullNode(e.getEventCache().getNode(),f,i)}}else{var p=t.getFront();if(".priority"==p){o.assert(1==t.getLength(),"Can't have a priority with additional path components");var d=a.getNode();u=e.getServerCache().getNode();var v=n.calcEventCacheAfterServerOverwrite(t,d,u);s=null!=v?this.filter_.updatePriority(d,v):a.getNode()}else{var y=t.popFront();var g=void 0;if(a.isCompleteForChild(p)){u=e.getServerCache().getNode();var _=n.calcEventCacheAfterServerOverwrite(t,a.getNode(),u);g=null!=_?a.getNode().getImmediateChild(p).updateChild(y,_):a.getNode().getImmediateChild(p)}else g=n.calcCompleteChild(p,e.getServerCache());s=null!=g?this.filter_.updateChild(a.getNode(),p,g,y,r,i):a.getNode()}}return e.updateEventSnap(s,a.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())};e.prototype.applyServerOverwrite_=function(e,t,n,r,i,o,a){var s=e.getServerCache();var u;var c=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())u=c.updateFullNode(s.getNode(),n,null);else if(c.filtersNodes()&&!s.isFiltered()){var l=s.getNode().updateChild(t,n);u=c.updateFullNode(s.getNode(),l,null)}else{var h=t.getFront();if(!s.isCompleteForPath(t)&&t.getLength()>1)return e;var f=t.popFront();var p=s.getNode().getImmediateChild(h);var d=p.updateChild(f,n);u=".priority"==h?c.updatePriority(s.getNode(),d):c.updateChild(s.getNode(),h,d,f,qt,null)}var v=e.updateServerSnap(u,s.isFullyInitialized()||t.isEmpty(),c.filtersNodes());var y=new Vt(r,v,i);return this.generateEventCacheAfterServerEvent_(v,t,r,y,a)};e.prototype.applyUserOverwrite_=function(e,t,n,r,i,o){var a=e.getEventCache();var s,u;var c=new Vt(r,e,i);if(t.isEmpty()){u=this.filter_.updateFullNode(e.getEventCache().getNode(),n,o);s=e.updateEventSnap(u,true,this.filter_.filtersNodes())}else{var l=t.getFront();if(".priority"===l){u=this.filter_.updatePriority(e.getEventCache().getNode(),n);s=e.updateEventSnap(u,a.isFullyInitialized(),a.isFiltered())}else{var h=t.popFront();var f=a.getNode().getImmediateChild(l);var p=void 0;if(h.isEmpty())p=n;else{var d=c.getCompleteChild(l);p=null!=d?".priority"===h.getBack()&&d.getChild(h.parent()).isEmpty()?d:d.updateChild(h,n):at.EMPTY_NODE}if(f.equals(p))s=e;else{var v=this.filter_.updateChild(a.getNode(),l,p,h,c,o);s=e.updateEventSnap(v,a.isFullyInitialized(),this.filter_.filtersNodes())}}}return s};e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)};e.prototype.applyUserMerge_=function(t,n,r,i,o,a){var s=this;var u=t;r.foreach(function(r,c){var l=n.child(r);e.cacheHasChild_(t,l.getFront())&&(u=s.applyUserOverwrite_(u,l,c,i,o,a))});r.foreach(function(r,c){var l=n.child(r);e.cacheHasChild_(t,l.getFront())||(u=s.applyUserOverwrite_(u,l,c,i,o,a))});return u};e.prototype.applyMerge_=function(e,t){t.foreach(function(t,n){e=e.updateChild(t,n)});return e};e.prototype.applyServerMerge_=function(e,t,n,r,i,o,a){var s=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var u=e;var c;c=t.isEmpty()?n:Pt.Empty.setTree(t,n);var l=e.getServerCache().getNode();c.children.inorderTraversal(function(t,n){if(l.hasChild(t)){var c=e.getServerCache().getNode().getImmediateChild(t);var h=s.applyMerge_(c,n);u=s.applyServerOverwrite_(u,new G(t),h,r,i,o,a)}});c.children.inorderTraversal(function(t,n){var c=!e.getServerCache().isCompleteForChild(t)&&null==n.value;if(!l.hasChild(t)&&!c){var h=e.getServerCache().getNode().getImmediateChild(t);var f=s.applyMerge_(h,n);u=s.applyServerOverwrite_(u,new G(t),f,r,i,o,a)}});return u};e.prototype.ackUserWrite_=function(e,t,n,r,i,o){if(null!=r.shadowingWrite(t))return e;var a=e.getServerCache().isFiltered();var s=e.getServerCache();if(null!=n.value){if(t.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,s.getNode().getChild(t),r,i,a,o);if(t.isEmpty()){var u=Pt.Empty;s.getNode().forEachChild(Le,function(e,t){u=u.set(new G(e),t)});return this.applyServerMerge_(e,t,u,r,i,a,o)}return e}var c=Pt.Empty;n.foreach(function(e,n){var r=t.child(e);s.isCompleteForPath(r)&&(c=c.set(e,s.getNode().getChild(r)))});return this.applyServerMerge_(e,t,c,r,i,a,o)};e.prototype.listenComplete_=function(e,t,n,r){var i=e.getServerCache();var o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,t,n,qt,r)};e.prototype.revertUserWrite_=function(e,t,n,r,i){var a;if(null!=n.shadowingWrite(t))return e;var s=new Vt(n,e,r);var u=e.getEventCache().getNode();var c=void 0;if(t.isEmpty()||".priority"===t.getFront()){var l=void 0;if(e.getServerCache().isFullyInitialized())l=n.calcCompleteEventCache(e.getCompleteServerSnap());else{var h=e.getServerCache().getNode();o.assert(h instanceof at,"serverChildren would be complete if leaf node");l=n.calcCompleteEventChildren(h)}l=l;c=this.filter_.updateFullNode(u,l,i)}else{var f=t.getFront();var p=n.calcCompleteChild(f,e.getServerCache());null==p&&e.getServerCache().isCompleteForChild(f)&&(p=u.getImmediateChild(f));c=null!=p?this.filter_.updateChild(u,f,p,t.popFront(),s,i):e.getEventCache().getNode().hasChild(f)?this.filter_.updateChild(u,f,at.EMPTY_NODE,t.popFront(),s,i):u;if(c.isEmpty()&&e.getServerCache().isFullyInitialized()){a=n.calcCompleteEventCache(e.getCompleteServerSnap());a.isLeafNode()&&(c=this.filter_.updateFullNode(c,a,i))}}a=e.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(G.Empty);return e.updateEventSnap(c,a,this.filter_.filtersNodes())};return e}();var Gt=function(){function e(e){this.query_=e;this.index_=this.query_.getQueryParams().getIndex()}e.prototype.generateEventsForChanges=function(e,t,n){var r=this;var i=[];var o=[];e.forEach(function(e){e.type===Ft.CHILD_CHANGED&&r.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(Ft.childMovedChange(e.childName,e.snapshotNode))});this.generateEventsForType_(i,Ft.CHILD_REMOVED,e,n,t);this.generateEventsForType_(i,Ft.CHILD_ADDED,e,n,t);this.generateEventsForType_(i,Ft.CHILD_MOVED,o,n,t);this.generateEventsForType_(i,Ft.CHILD_CHANGED,e,n,t);this.generateEventsForType_(i,Ft.VALUE,e,n,t);return i};e.prototype.generateEventsForType_=function(e,t,n,r,i){var o=this;var a=n.filter(function(e){return e.type===t});a.sort(this.compareChanges_.bind(this));a.forEach(function(t){var n=o.materializeSingleChange_(t,i);r.forEach(function(r){r.respondsTo(t.type)&&e.push(r.createEvent(n,o.query_))})})};e.prototype.materializeSingleChange_=function(e,t){if("value"===e.type||"child_removed"===e.type)return e;e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_);return e};e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw o.assertionError("Should only compare child_ events.");var n=new De(e.childName,e.snapshotNode);var r=new De(t.childName,t.snapshotNode);return this.index_.compare(n,r)};return e}();var zt=function(){function e(e,t){this.query_=e;this.eventRegistrations_=[];var n=this.query_.getQueryParams();var r=new jt(n.getIndex());var i=n.getNodeFilter();this.processor_=new Kt(i);var o=t.getServerCache();var a=t.getEventCache();var s=r.updateFullNode(at.EMPTY_NODE,o.getNode(),null);var u=i.updateFullNode(at.EMPTY_NODE,a.getNode(),null);var c=new Mt(s,o.isFullyInitialized(),r.filtersNodes());var l=new Mt(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Ut(l,c);this.eventGenerator_=new Gt(this.query_)}e.prototype.getQuery=function(){return this.query_};e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()};e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();if(t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty()))return t.getChild(e);return null};e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length};e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)};e.prototype.removeEventRegistration=function(e,t){var n=[];if(t){o.assert(null==e,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(e){t=t;var i=e.createCancelEvent(t,r);i&&n.push(i)})}if(e){var i=[];for(var a=0;a<this.eventRegistrations_.length;++a){var s=this.eventRegistrations_[a];if(s.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(a+1));break}}else i.push(s)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n};e.prototype.applyOperation=function(e,t,n){if(e.type===Ot.MERGE&&null!==e.source.queryId){o.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges");o.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache")}var r=this.viewCache_;var i=this.processor_.applyOperation(r,e,t,n);this.processor_.assertIndexed(i.viewCache);o.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back");this.viewCache_=i.viewCache;return this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)};e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache();var n=[];if(!t.getNode().isLeafNode()){var r=t.getNode();r.forEachChild(Ge,function(e,t){n.push(Ft.childAddedChange(e,t))})}t.isFullyInitialized()&&n.push(Ft.valueChange(t.getNode()));return this.generateEventsForChanges_(n,t.getNode(),e)};e.prototype.generateEventsForChanges_=function(e,t,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,r)};return e}();var Qt;var Yt=function(){function e(){this.views_={}}Object.defineProperty(e,"__referenceConstructor",{get:function(){o.assert(Qt,"Reference.ts has not been loaded");return Qt},set:function(e){o.assert(!Qt,"__referenceConstructor has already been defined");Qt=e},enumerable:true,configurable:true});e.prototype.isEmpty=function(){return o.isEmpty(this.views_)};e.prototype.applyOperation=function(e,t,n){var r=e.source.queryId;if(null!==r){var i=o.safeGet(this.views_,r);o.assert(null!=i,"SyncTree gave us an op for an invalid query.");return i.applyOperation(e,t,n)}var a=[];o.forEach(this.views_,function(r,i){a=a.concat(i.applyOperation(e,t,n))});return a};e.prototype.addEventRegistration=function(e,t,n,r,i){var a=e.queryIdentifier();var s=o.safeGet(this.views_,a);if(!s){var u=n.calcCompleteEventCache(i?r:null);var c=false;if(u)c=true;else if(r instanceof at){u=n.calcCompleteEventChildren(r);c=false}else{u=at.EMPTY_NODE;c=false}var l=new Ut(new Mt(u,c,false),new Mt(r,i,false));s=new zt(e,l);this.views_[a]=s}s.addEventRegistration(t);return s.getInitialEvents(t)};e.prototype.removeEventRegistration=function(t,n,r){var i=t.queryIdentifier();var a=[];var s=[];var u=this.hasCompleteView();if("default"===i){var c=this;o.forEach(this.views_,function(e,t){s=s.concat(t.removeEventRegistration(n,r));if(t.isEmpty()){delete c.views_[e];t.getQuery().getQueryParams().loadsAllData()||a.push(t.getQuery())}})}else{var l=o.safeGet(this.views_,i);if(l){s=s.concat(l.removeEventRegistration(n,r));if(l.isEmpty()){delete this.views_[i];l.getQuery().getQueryParams().loadsAllData()||a.push(l.getQuery())}}}u&&!this.hasCompleteView()&&a.push(new e.__referenceConstructor(t.repo,t.path));return{removed:a,events:s}};e.prototype.getQueryViews=function(){var e=this;var t=Object.keys(this.views_).map(function(t){return e.views_[t]});return t.filter(function(e){return!e.getQuery().getQueryParams().loadsAllData()})};e.prototype.getCompleteServerCache=function(e){var t=null;o.forEach(this.views_,function(n,r){t=t||r.getCompleteServerCache(e)});return t};e.prototype.viewForQuery=function(e){var t=e.getQueryParams();if(t.loadsAllData())return this.getCompleteView();var n=e.queryIdentifier();return o.safeGet(this.views_,n)};e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)};e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()};e.prototype.getCompleteView=function(){var e=o.findValue(this.views_,function(e){return e.getQuery().getQueryParams().loadsAllData()});return e||null};return e}();var Xt=function(){function e(e){this.writeTree_=e}e.prototype.addWrite=function(t,n){if(t.isEmpty())return new e(new Pt(n));var r=this.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path;var o=r.value;var a=G.relativePath(i,t);o=o.updateChild(a,n);return new e(this.writeTree_.set(i,o))}var s=new Pt(n);var u=this.writeTree_.setTree(t,s);return new e(u)};e.prototype.addWrites=function(e,t){var n=this;o.forEach(t,function(t,r){n=n.addWrite(e.child(t),r)});return n};e.prototype.removeWrite=function(t){if(t.isEmpty())return e.Empty;var n=this.writeTree_.setTree(t,Pt.Empty);return new e(n)};e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)};e.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(G.relativePath(t.path,e)):null};e.prototype.getCompleteChildren=function(){var e=[];var t=this.writeTree_.value;null!=t?t.isLeafNode()||t.forEachChild(Ge,function(t,n){e.push(new De(t,n))}):this.writeTree_.children.inorderTraversal(function(t,n){null!=n.value&&e.push(new De(t,n.value))});return e};e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var n=this.getCompleteNode(t);return new e(null!=n?new Pt(n):this.writeTree_.subtree(t))};e.prototype.isEmpty=function(){return this.writeTree_.isEmpty()};e.prototype.apply=function(t){return e.applySubtreeWrite_(G.Empty,this.writeTree_,t)};e.Empty=new e(new Pt(null));e.applySubtreeWrite_=function(t,n,r){if(null!=n.value)return r.updateChild(t,n.value);var i=null;n.children.inorderTraversal(function(n,a){if(".priority"===n){o.assert(null!==a.value,"Priority writes must always be leaf nodes");i=a.value}else r=e.applySubtreeWrite_(t.child(n),a,r)});r.getChild(t).isEmpty()||null===i||(r=r.updateChild(t.child(".priority"),i));return r};return e}();var $t=function(){function e(){this.visibleWrites_=Xt.Empty;this.allWrites_=[];this.lastWriteId_=-1}e.prototype.childWrites=function(e){return new Jt(e,this)};e.prototype.addOverwrite=function(e,t,n,r){o.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones");void 0===r&&(r=true);this.allWrites_.push({path:e,snap:t,writeId:n,visible:r});r&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t));this.lastWriteId_=n};e.prototype.addMerge=function(e,t,n){o.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones");this.allWrites_.push({path:e,children:t,writeId:n,visible:true});this.visibleWrites_=this.visibleWrites_.addWrites(e,t);this.lastWriteId_=n};e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var n=this.allWrites_[t];if(n.writeId===e)return n}return null};e.prototype.removeWrite=function(e){var t=this;var n=this.allWrites_.findIndex(function(t){return t.writeId===e});o.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);var i=r.visible;var a=false;var s=this.allWrites_.length-1;while(i&&s>=0){var u=this.allWrites_[s];u.visible&&(s>=n&&this.recordContainsPath_(u,r.path)?i=false:r.path.contains(u.path)&&(a=true));s--}if(i){if(a){this.resetTree_();return true}if(r.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(r.path);else{var c=r.children;o.forEach(c,function(e){t.visibleWrites_=t.visibleWrites_.removeWrite(r.path.child(e))})}return true}return false};e.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)};e.prototype.calcCompleteEventCache=function(t,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(t);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(G.Empty)){var a=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))};var s=e.layerTree_(this.allWrites_,a,t);var u=n||at.EMPTY_NODE;return s.apply(u)}return null}var c=this.visibleWrites_.getCompleteNode(t);if(null!=c)return c;var l=this.visibleWrites_.childCompoundWrite(t);if(l.isEmpty())return n;if(null!=n||l.hasCompleteWrite(G.Empty)){var u=n||at.EMPTY_NODE;return l.apply(u)}return null};e.prototype.calcCompleteEventChildren=function(e,t){var n=at.EMPTY_NODE;var r=this.visibleWrites_.getCompleteNode(e);if(r){r.isLeafNode()||r.forEachChild(Ge,function(e,t){n=n.updateImmediateChild(e,t)});return n}if(t){var i=this.visibleWrites_.childCompoundWrite(e);t.forEachChild(Ge,function(e,t){var r=i.childCompoundWrite(new G(e)).apply(t);n=n.updateImmediateChild(e,r)});i.getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)});return n}var o=this.visibleWrites_.childCompoundWrite(e);o.getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)});return n};e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n,r){o.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=e.child(t);if(this.visibleWrites_.hasCompleteWrite(i))return null;var a=this.visibleWrites_.childCompoundWrite(i);return a.isEmpty()?r.getChild(t):a.apply(r.getChild(t))};e.prototype.calcCompleteChild=function(e,t,n){var r=e.child(t);var i=this.visibleWrites_.getCompleteNode(r);if(null!=i)return i;if(n.isCompleteForChild(t)){var o=this.visibleWrites_.childCompoundWrite(r);return o.apply(n.getNode().getImmediateChild(t))}return null};e.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)};e.prototype.calcIndexedSlice=function(e,t,n,r,i,o){var a;var s=this.visibleWrites_.childCompoundWrite(e);var u=s.getCompleteNode(G.Empty);if(null!=u)a=u;else{if(null==t)return[];a=s.apply(t)}a=a.withIndex(o);if(a.isEmpty()||a.isLeafNode())return[];var c=[];var l=o.getCompare();var h=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o);var f=h.getNext();while(f&&c.length<r){0!==l(f,n)&&c.push(f);f=h.getNext()}return c};e.prototype.recordContainsPath_=function(e,t){return e.snap?e.path.contains(t):!!o.findKey(e.children,function(n,r){return e.path.child(r).contains(t)})};e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,G.Empty);this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1};e.DefaultFilter_=function(e){return e.visible};e.layerTree_=function(e,t,n){var r=Xt.Empty;for(var i=0;i<e.length;++i){var a=e[i];if(t(a)){var s=a.path;var u=void 0;if(a.snap){if(n.contains(s)){u=G.relativePath(n,s);r=r.addWrite(u,a.snap)}else if(s.contains(n)){u=G.relativePath(s,n);r=r.addWrite(G.Empty,a.snap.getChild(u))}}else{if(!a.children)throw o.assertionError("WriteRecord should have .snap or .children");if(n.contains(s)){u=G.relativePath(n,s);r=r.addWrites(u,a.children)}else if(s.contains(n)){u=G.relativePath(s,n);if(u.isEmpty())r=r.addWrites(G.Empty,a.children);else{var c=o.safeGet(a.children,u.getFront());if(c){var l=c.getChild(u.popFront());r=r.addWrite(G.Empty,l)}}}}}}return r};return e}();var Jt=function(){function e(e,t){this.treePath_=e;this.writeTree_=t}e.prototype.calcCompleteEventCache=function(e,t,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,n)};e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)};e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,n)};e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))};e.prototype.calcIndexedSlice=function(e,t,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,n,r,i)};e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)};e.prototype.child=function(t){return new e(this.treePath_.child(t),this.writeTree_)};return e}();var Zt=function(){function e(e){this.listenProvider_=e;this.syncPointTree_=Pt.Empty;this.pendingWriteTree_=new $t;this.tagToQueryMap_={};this.queryToTagMap_={}}e.prototype.applyUserOverwrite=function(e,t,n,r){this.pendingWriteTree_.addOverwrite(e,t,n,r);return r?this.applyOperationToSyncPoints_(new Lt(Nt.User,e,t)):[]};e.prototype.applyUserMerge=function(e,t,n){this.pendingWriteTree_.addMerge(e,t,n);var r=Pt.fromObject(t);return this.applyOperationToSyncPoints_(new xt(Nt.User,e,r))};e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=false);var n=this.pendingWriteTree_.getWrite(e);var r=this.pendingWriteTree_.removeWrite(e);if(r){var i=Pt.Empty;null!=n.snap?i=i.set(G.Empty,true):o.forEach(n.children,function(e,t){i=i.set(new G(e),t)});return this.applyOperationToSyncPoints_(new At(n.path,i,t))}return[]};e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new Lt(Nt.Server,e,t))};e.prototype.applyServerMerge=function(e,t){var n=Pt.fromObject(t);return this.applyOperationToSyncPoints_(new xt(Nt.Server,e,n))};e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new kt(Nt.Server,e))};e.prototype.applyTaggedQueryOverwrite=function(t,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=e.parseQueryKey_(i);var a=o.path,s=o.queryId;var u=G.relativePath(a,t);var c=new Lt(Nt.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]};e.prototype.applyTaggedQueryMerge=function(t,n,r){var i=this.queryKeyForTag_(r);if(i){var o=e.parseQueryKey_(i);var a=o.path,s=o.queryId;var u=G.relativePath(a,t);var c=Pt.fromObject(n);var l=new xt(Nt.forServerTaggedQuery(s),u,c);return this.applyTaggedOperation_(a,l)}return[]};e.prototype.applyTaggedListenComplete=function(t,n){var r=this.queryKeyForTag_(n);if(r){var i=e.parseQueryKey_(r);var o=i.path,a=i.queryId;var s=G.relativePath(o,t);var u=new kt(Nt.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]};e.prototype.addEventRegistration=function(t,n){var r=t.path;var i=null;var a=false;this.syncPointTree_.foreachOnPath(r,function(e,t){var n=G.relativePath(e,r);i=i||t.getCompleteServerCache(n);a=a||t.hasCompleteView()});var s=this.syncPointTree_.get(r);if(s){a=a||s.hasCompleteView();i=i||s.getCompleteServerCache(G.Empty)}else{s=new Yt;this.syncPointTree_=this.syncPointTree_.set(r,s)}var u;if(null!=i)u=true;else{u=false;i=at.EMPTY_NODE;var c=this.syncPointTree_.subtree(r);c.foreachChild(function(e,t){var n=t.getCompleteServerCache(G.Empty);n&&(i=i.updateImmediateChild(e,n))})}var l=s.viewExistsForQuery(t);if(!l&&!t.getQueryParams().loadsAllData()){var h=e.makeQueryKey_(t);o.assert(!(h in this.queryToTagMap_),"View does not exist, but we have a tag");var f=e.getNextQueryTag_();this.queryToTagMap_[h]=f;this.tagToQueryMap_["_"+f]=h}var p=this.pendingWriteTree_.childWrites(r);var d=s.addEventRegistration(t,n,p,i,u);if(!l&&!a){var v=s.viewForQuery(t);d=d.concat(this.setupListener_(t,v))}return d};e.prototype.removeEventRegistration=function(t,n,r){var i=this;var o=t.path;var a=this.syncPointTree_.get(o);var s=[];if(a&&("default"===t.queryIdentifier()||a.viewExistsForQuery(t))){var u=a.removeEventRegistration(t,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var l=-1!==c.findIndex(function(e){return e.getQueryParams().loadsAllData()});var h=this.syncPointTree_.findOnPath(o,function(e,t){return t.hasCompleteView()});if(l&&!h){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty()){var p=this.collectDistinctViewsForSubTree_(f);for(var d=0;d<p.length;++d){var v=p[d],y=v.getQuery();var g=this.createListenerForView_(v);this.listenProvider_.startListening(e.queryForListening_(y),this.tagForQuery_(y),g.hashFn,g.onComplete)}}}if(!h&&c.length>0&&!r)if(l){var _=null;this.listenProvider_.stopListening(e.queryForListening_(t),_)}else c.forEach(function(t){var n=i.queryToTagMap_[e.makeQueryKey_(t)];i.listenProvider_.stopListening(e.queryForListening_(t),n)});this.removeTags_(c)}return s};e.prototype.calcCompleteEventCache=function(e,t){var n=true;var r=this.pendingWriteTree_;var i=this.syncPointTree_.findOnPath(e,function(t,n){var r=G.relativePath(t,e);var i=n.getCompleteServerCache(r);if(i)return i});return r.calcCompleteEventCache(e,i,t,n)};e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,n){if(t&&t.hasCompleteView()){var r=t.getCompleteView();return[r]}var i=[];t&&(i=t.getQueryViews());o.forEach(n,function(e,t){i=i.concat(t)});return i})};e.prototype.removeTags_=function(t){for(var n=0;n<t.length;++n){var r=t[n];if(!r.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(r);var o=this.queryToTagMap_[i];delete this.queryToTagMap_[i];delete this.tagToQueryMap_["_"+o]}}};e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e};e.prototype.setupListener_=function(t,n){var r=t.path;var i=this.tagForQuery_(t);var a=this.createListenerForView_(n);var s=this.listenProvider_.startListening(e.queryForListening_(t),i,a.hashFn,a.onComplete);var u=this.syncPointTree_.subtree(r);if(i)o.assert(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else{var c=u.fold(function(e,t,n){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var r=[];t&&(r=r.concat(t.getQueryViews().map(function(e){return e.getQuery()})));o.forEach(n,function(e,t){r=r.concat(t)});return r});for(var l=0;l<c.length;++l){var h=c[l];this.listenProvider_.stopListening(e.queryForListening_(h),this.tagForQuery_(h))}}return s};e.prototype.createListenerForView_=function(e){var t=this;var n=e.getQuery();var r=this.tagForQuery_(n);return{hashFn:function(){var t=e.getServerCache()||at.EMPTY_NODE;return t.hash()},onComplete:function(e){if("ok"===e)return r?t.applyTaggedListenComplete(n.path,r):t.applyListenComplete(n.path);var i=B(e,n);return t.removeEventRegistration(n,null,i)}}};e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()};e.parseQueryKey_=function(e){var t=e.indexOf("$");o.assert(-1!==t&&t<e.length-1,"Bad queryKey.");return{queryId:e.substr(t+1),path:new G(e.substr(0,t))}};e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap_["_"+e]};e.prototype.tagForQuery_=function(t){var n=e.makeQueryKey_(t);return o.safeGet(this.queryToTagMap_,n)};e.getNextQueryTag_=function(){return e.nextQueryTag_++};e.prototype.applyTaggedOperation_=function(e,t){var n=this.syncPointTree_.get(e);o.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(e);return n.applyOperation(t,r,null)};e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(G.Empty))};e.prototype.applyOperationHelper_=function(e,t,n,r){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,n,r);var i=t.get(G.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(G.Empty));var o=[];var a=e.path.getFront();var s=e.operationForChild(a);var u=t.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null;var l=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,l))}i&&(o=o.concat(i.applyOperation(e,r,n)));return o};e.prototype.applyOperationDescendantsHelper_=function(e,t,n,r){var i=this;var o=t.get(G.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(G.Empty));var a=[];t.children.inorderTraversal(function(t,o){var s=n?n.getImmediateChild(t):null;var u=r.child(t);var c=e.operationForChild(t);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))});o&&(a=a.concat(o.applyOperation(e,r,n)));return a};e.nextQueryTag_=1;return e}();var en=function(){function e(){this.rootNode_=at.EMPTY_NODE}e.prototype.getNode=function(e){return this.rootNode_.getChild(e)};e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)};return e}();var tn=function(){function e(e){this.app_=e}e.prototype.getToken=function(e){return this.app_["INTERNAL"]["getToken"](e).then(null,function(e){if(e&&"auth/token-not-initialized"===e.code){w("Got auth/token-not-initialized error.  Treating as null token.");return null}return Promise.reject(e)})};e.prototype.addTokenChangeListener=function(e){this.app_["INTERNAL"]["addAuthTokenListener"](e)};e.prototype.removeTokenChangeListener=function(e){this.app_["INTERNAL"]["removeAuthTokenListener"](e)};e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.';I(e)};return e}();var nn=function(){function e(){this.counters_={}}e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1);o.contains(this.counters_,e)||(this.counters_[e]=0);this.counters_[e]+=t};e.prototype.get=function(){return o.deepCopy(this.counters_)};return e}();var rn=function(){function e(){}e.getCollection=function(e){var t=e.toString();this.collections_[t]||(this.collections_[t]=new nn);return this.collections_[t]};e.getOrCreateReporter=function(e,t){var n=e.toString();this.reporters_[n]||(this.reporters_[n]=t());return this.reporters_[n]};e.collections_={};e.reporters_={};return e}();var on=function(){function e(e){this.collection_=e;this.last_=null}e.prototype.get=function(){var e=this.collection_.get();var t=o.clone(e);this.last_&&o.forEach(this.last_,function(e,n){t[e]=t[e]-n});this.last_=e;return t};return e}();var an=1e4;var sn=3e4;var un=3e5;var cn=function(){function e(e,t){this.server_=t;this.statsToReport_={};this.statsListener_=new on(e);var n=an+(sn-an)*Math.random();K(this.reportStats_.bind(this),Math.floor(n))}e.prototype.includeStat=function(e){this.statsToReport_[e]=true};e.prototype.reportStats_=function(){var e=this;var t=this.statsListener_.get();var n={};var r=false;o.forEach(t,function(t,i){if(i>0&&o.contains(e.statsToReport_,t)){n[t]=i;r=true}});r&&this.server_.reportStats(n);K(this.reportStats_.bind(this),Math.floor(2*Math.random()*un))};return e}();var ln=function(){function e(){this.eventLists_=[];this.recursionDepth_=0}e.prototype.queueEvents=function(e){var t=null;for(var n=0;n<e.length;n++){var r=e[n];var i=r.getPath();if(null!==t&&!i.equals(t.getPath())){this.eventLists_.push(t);t=null}null===t&&(t=new hn(i));t.add(r)}t&&this.eventLists_.push(t)};e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t);this.raiseQueuedEventsMatchingPredicate_(function(t){return t.equals(e)})};e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t);this.raiseQueuedEventsMatchingPredicate_(function(t){return t.contains(e)||e.contains(t)})};e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;var t=true;for(var n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];if(r){var i=r.getPath();if(e(i)){this.eventLists_[n].raise();this.eventLists_[n]=null}else t=false}}t&&(this.eventLists_=[]);this.recursionDepth_--};return e}();var hn=function(){function e(e){this.path_=e;this.events_=[]}e.prototype.add=function(e){this.events_.push(e)};e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var n=t.getEventRunner();_&&w("event: "+t.toString());V(n)}}};e.prototype.getPath=function(){return this.path_};return e}();var fn=function(){function e(e){this.allowedEvents_=e;this.listeners_={};o.assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}e.prototype.trigger=function(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e])){var r=this.listeners_[e].slice();for(var i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}};e.prototype.on=function(e,t,n){this.validateEventType_(e);this.listeners_[e]=this.listeners_[e]||[];this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)};e.prototype.off=function(e,t,n){this.validateEventType_(e);var r=this.listeners_[e]||[];for(var i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context)){r.splice(i,1);return}};e.prototype.validateEventType_=function(e){o.assert(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)};return e}();var pn=function(e){s.__extends(t,e);function t(){var t=e.call(this,["visible"])||this;var n;var r;if("undefined"!==typeof document&&"undefined"!==typeof document.addEventListener)if("undefined"!==typeof document["hidden"]){r="visibilitychange";n="hidden"}else if("undefined"!==typeof document["mozHidden"]){r="mozvisibilitychange";n="mozHidden"}else if("undefined"!==typeof document["msHidden"]){r="msvisibilitychange";n="msHidden"}else if("undefined"!==typeof document["webkitHidden"]){r="webkitvisibilitychange";n="webkitHidden"}t.visible_=true;r&&document.addEventListener(r,function(){var e=!document[n];if(e!==t.visible_){t.visible_=e;t.trigger("visible",e)}},false);return t}t.getInstance=function(){return new t};t.prototype.getInitialEvent=function(e){o.assert("visible"===e,"Unknown event type: "+e);return[this.visible_]};return t}(fn);var dn=function(e){s.__extends(t,e);function t(){var t=e.call(this,["online"])||this;t.online_=true;if("undefined"!==typeof window&&"undefined"!==typeof window.addEventListener&&!o.isMobileCordova()){window.addEventListener("online",function(){if(!t.online_){t.online_=true;t.trigger("online",true)}},false);window.addEventListener("offline",function(){if(t.online_){t.online_=false;t.trigger("online",false)}},false)}return t}t.getInstance=function(){return new t};t.prototype.getInitialEvent=function(e){o.assert("online"===e,"Unknown event type: "+e);return[this.online_]};t.prototype.currentlyOnline=function(){return this.online_};return t}(fn);var vn=function(){function e(e){this.onMessage_=e;this.pendingResponses=[];this.currentResponseNum=0;this.closeAfterResponse=-1;this.onClose=null}e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e;this.onClose=t;if(this.closeAfterResponse<this.currentResponseNum){this.onClose();this.onClose=null}};e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;var r=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];var t=function(t){e[t]&&V(function(){n.onMessage_(e[t])})};for(var r=0;r<e.length;++r)t(r);if(i.currentResponseNum===i.closeAfterResponse){if(i.onClose){i.onClose();i.onClose=null}return"break"}i.currentResponseNum++};var i=this;while(this.pendingResponses[this.currentResponseNum]){var o=r();if("break"===o)break}};return e}();var yn="start";var gn="close";var _n="pLPCommand";var mn="pRTLPCB";var bn="id";var wn="pw";var En="ser";var Tn="cb";var Sn="seg";var In="ts";var Cn="d";var On="disconn";var Nn="dframe";var An=1870;var Dn=30;var Rn=An-Dn;var Pn=25e3;var kn=3e4;var Ln=function(){function e(e,t,n,r){this.connId=e;this.repoInfo=t;this.transportSessionId=n;this.lastSessionId=r;this.bytesSent=0;this.bytesReceived=0;this.everConnected_=false;this.log_=E(e);this.stats_=rn.getCollection(t);this.urlFn=function(e){return t.connectionURL(ne,e)}}e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0;this.onDisconnect_=t;this.myPacketOrderer=new vn(e);this.isClosed_=false;this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect.");n.onClosed_();n.connectTimeoutTimer_=null},Math.floor(kn));N(function(){if(n.isClosed_)return;n.scriptTagHolder=new xn(function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],i=e[1],o=e[2];n.incrementIncomingBytes_(e);if(!n.scriptTagHolder)return;if(n.connectTimeoutTimer_){clearTimeout(n.connectTimeoutTimer_);n.connectTimeoutTimer_=null}n.everConnected_=true;if(r==yn){n.id=i;n.password=o}else{if(r!==gn)throw new Error("Unrecognized command received: "+r);if(i){n.scriptTagHolder.sendNewPolls=false;n.myPacketOrderer.closeAfter(i,function(){n.onClosed_()})}else n.onClosed_()}},function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],i=e[1];n.incrementIncomingBytes_(e);n.myPacketOrderer.handleResponse(r,i)},function(){n.onClosed_()},n.urlFn);var e={};e[yn]="t";e[En]=Math.floor(1e8*Math.random());n.scriptTagHolder.uniqueCallbackIdentifier&&(e[Tn]=n.scriptTagHolder.uniqueCallbackIdentifier);e[Y]=Q;n.transportSessionId&&(e[X]=n.transportSessionId);n.lastSessionId&&(e[ee]=n.lastSessionId);!o.isNodeSdk()&&"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf(Z)&&(e[$]=J);var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t);n.scriptTagHolder.addTag(t,function(){})})};e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password);this.addDisconnectPingFrame(this.id,this.password)};e.forceAllow=function(){e.forceAllow_=true};e.forceDisallow=function(){e.forceDisallow_=true};e.isAvailable=function(){return e.forceAllow_||!e.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!F()&&!j()&&!o.isNodeSdk()};e.prototype.markConnectionHealthy=function(){};e.prototype.shutdown_=function(){this.isClosed_=true;if(this.scriptTagHolder){this.scriptTagHolder.close();this.scriptTagHolder=null}if(this.myDisconnFrame){document.body.removeChild(this.myDisconnFrame);this.myDisconnFrame=null}if(this.connectTimeoutTimer_){clearTimeout(this.connectTimeoutTimer_);this.connectTimeoutTimer_=null}};e.prototype.onClosed_=function(){if(!this.isClosed_){this.log_("Longpoll is closing itself");this.shutdown_();if(this.onDisconnect_){this.onDisconnect_(this.everConnected_);this.onDisconnect_=null}}};e.prototype.close=function(){if(!this.isClosed_){this.log_("Longpoll is being closed.");this.shutdown_()}};e.prototype.send=function(e){var t=o.stringify(e);this.bytesSent+=t.length;this.stats_.incrementCounter("bytes_sent",t.length);var n=o.base64Encode(t);var r=x(n,Rn);for(var i=0;i<r.length;i++){this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]);this.curSegmentNum++}};e.prototype.addDisconnectPingFrame=function(e,t){if(o.isNodeSdk())return;this.myDisconnFrame=document.createElement("iframe");var n={};n[Nn]="t";n[bn]=e;n[wn]=t;this.myDisconnFrame.src=this.urlFn(n);this.myDisconnFrame.style.display="none";document.body.appendChild(this.myDisconnFrame)};e.prototype.incrementIncomingBytes_=function(e){var t=o.stringify(e).length;this.bytesReceived+=t;this.stats_.incrementCounter("bytes_received",t)};return e}();var xn=function(){function e(t,n,r,i){this.onDisconnect=r;this.urlFn=i;this.outstandingRequests=new wt;this.pendingSegs=[];this.currentSerial=Math.floor(1e8*Math.random());this.sendNewPolls=true;if(o.isNodeSdk()){this.commandCB=t;this.onMessageCB=n}else{this.uniqueCallbackIdentifier=v();window[_n+this.uniqueCallbackIdentifier]=t;window[mn+this.uniqueCallbackIdentifier]=n;this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){var s=document.domain;a='<script>document.domain="'+s+'";<\/script>'}var u="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open();this.myIFrame.doc.write(u);this.myIFrame.doc.close()}catch(e){w("frame writing exception");e.stack&&w(e.stack);w(e)}}}e.createIFrame_=function(){var e=document.createElement("iframe");e.style.display="none";if(!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{var t=e.contentWindow.document;t||w("No IE domain setting required")}catch(t){var n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document);return e};e.prototype.close=function(){var t=this;this.alive=false;if(this.myIFrame){this.myIFrame.doc.body.innerHTML="";setTimeout(function(){if(null!==t.myIFrame){document.body.removeChild(t.myIFrame);t.myIFrame=null}},Math.floor(0))}if(o.isNodeSdk()&&this.myID){var n={};n[On]="t";n[bn]=this.myID;n[wn]=this.myPW;var r=this.urlFn(n);e.nodeRestRequest(r)}var i=this.onDisconnect;if(i){this.onDisconnect=null;i()}};e.prototype.startLongPoll=function(e,t){this.myID=e;this.myPW=t;this.alive=true;while(this.newRequest_());};e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e[bn]=this.myID;e[wn]=this.myPW;e[En]=this.currentSerial;var t=this.urlFn(e);var n="";var r=0;while(this.pendingSegs.length>0){var i=this.pendingSegs[0];if(!(i.d.length+Dn+n.length<=An))break;var o=this.pendingSegs.shift();n=n+"&"+Sn+r+"="+o.seg+"&"+In+r+"="+o.ts+"&"+Cn+r+"="+o.d;r++}t+=n;this.addLongPollTag_(t,this.currentSerial);return true}return false};e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n});this.alive&&this.newRequest_()};e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t,1);var r=function(){n.outstandingRequests.remove(t);n.newRequest_()};var i=setTimeout(r,Math.floor(Pn));var o=function(){clearTimeout(i);r()};this.addTag(e,o)};e.prototype.addTag=function(e,t){var n=this;o.isNodeSdk()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript";r.async=true;r.src=e;r.onload=r.onreadystatechange=function(){var e=r.readyState;if(!e||"loaded"===e||"complete"===e){r.onload=r.onreadystatechange=null;r.parentNode&&r.parentNode.removeChild(r);t()}};r.onerror=function(){w("Long-poll script failed to load: "+e);n.sendNewPolls=false;n.close()};n.myIFrame.doc.body.appendChild(r)}catch(e){}},Math.floor(1))};return e}();var Mn=16384;var Un=45e3;var Fn=null;"undefined"!==typeof MozWebSocket?Fn=MozWebSocket:"undefined"!==typeof WebSocket&&(Fn=WebSocket);var jn=function(){function e(t,n,r,i){this.connId=t;this.keepaliveTimer=null;this.frames=null;this.totalFrames=0;this.bytesSent=0;this.bytesReceived=0;this.log_=E(this.connId);this.stats_=rn.getCollection(n);this.connURL=e.connectionURL_(n,r,i)}e.connectionURL_=function(e,t,n){var r={};r[Y]=Q;!o.isNodeSdk()&&"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf(Z)&&(r[$]=J);t&&(r[X]=t);n&&(r[ee]=n);return e.connectionURL(te,r)};e.prototype.open=function(e,t){var n=this;this.onDisconnect=t;this.onMessage=e;this.log_("Websocket connecting to "+this.connURL);this.everConnected_=false;f.set("previous_websocket_failure",true);try{if(o.isNodeSdk()){var i=o.CONSTANTS.NODE_ADMIN?"AdminNode":"Node";var a={headers:{"User-Agent":"Firebase/"+Q+"/"+u.SDK_VERSION+"/"+r.platform+"/"+i}};var s=r["env"];var c=0==this.connURL.indexOf("wss://")?s["HTTPS_PROXY"]||s["https_proxy"]:s["HTTP_PROXY"]||s["http_proxy"];c&&(a["proxy"]={origin:c});this.mySock=new Fn(this.connURL,[],a)}else this.mySock=new Fn(this.connURL)}catch(e){this.log_("Error instantiating WebSocket.");var l=e.message||e.data;l&&this.log_(l);this.onClosed_();return}this.mySock.onopen=function(){n.log_("Websocket connected.");n.everConnected_=true};this.mySock.onclose=function(){n.log_("Websocket connection was disconnected.");n.mySock=null;n.onClosed_()};this.mySock.onmessage=function(e){n.handleIncomingFrame(e)};this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t);n.onClosed_()}};e.prototype.start=function(){};e.forceDisallow=function(){e.forceDisallow_=true};e.isAvailable=function(){var t=false;if("undefined"!==typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/;var r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=true)}return!t&&null!==Fn&&!e.forceDisallow_};e.previouslyFailed=function(){return f.isInMemoryStorage||true===f.get("previous_websocket_failure")};e.prototype.markConnectionHealthy=function(){f.remove("previous_websocket_failure")};e.prototype.appendFrame_=function(e){this.frames.push(e);if(this.frames.length==this.totalFrames){var t=this.frames.join("");this.frames=null;var n=o.jsonEval(t);this.onMessage(n)}};e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e;this.frames=[]};e.prototype.extractFrameCount_=function(e){o.assert(null===this.frames,"We already have a frame buffer");if(e.length<=6){var t=Number(e);if(!isNaN(t)){this.handleNewFrameCount_(t);return null}}this.handleNewFrameCount_(1);return e};e.prototype.handleIncomingFrame=function(e){if(null===this.mySock)return;var t=e["data"];this.bytesReceived+=t.length;this.stats_.incrementCounter("bytes_received",t.length);this.resetKeepAlive();if(null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}};e.prototype.send=function(e){this.resetKeepAlive();var t=o.stringify(e);this.bytesSent+=t.length;this.stats_.incrementCounter("bytes_sent",t.length);var n=x(t,Mn);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])};e.prototype.shutdown_=function(){this.isClosed_=true;if(this.keepaliveTimer){clearInterval(this.keepaliveTimer);this.keepaliveTimer=null}if(this.mySock){this.mySock.close();this.mySock=null}};e.prototype.onClosed_=function(){if(!this.isClosed_){this.log_("WebSocket is closing itself");this.shutdown_();if(this.onDisconnect){this.onDisconnect(this.everConnected_);this.onDisconnect=null}}};e.prototype.close=function(){if(!this.isClosed_){this.log_("WebSocket is being closed");this.shutdown_()}};e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer);this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0");e.resetKeepAlive()},Math.floor(Un))};e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection.");setTimeout(this.onClosed_.bind(this),0)}};e.responsesRequiredToBeHealthy=2;e.healthyTimeout=3e4;return e}();var Bn=function(){function e(e){this.initTransports_(e)}Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[Ln,jn]},enumerable:true,configurable:true});e.prototype.initTransports_=function(t){var n=jn&&jn["isAvailable"]();var r=n&&!jn.previouslyFailed();if(t.webSocketOnly){n||I("wss:// URL used, but browser isn't known to support websockets.  Trying anyway.");r=true}if(r)this.transports_=[jn];else{var i=this.transports_=[];M(e.ALL_TRANSPORTS,function(e,t){t&&t["isAvailable"]()&&i.push(t)})}};e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")};e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null};return e}();var Wn=6e4;var qn=5e3;var Vn=10240;var Hn=102400;var Kn="t";var Gn="d";var zn="s";var Qn="r";var Yn="e";var Xn="o";var $n="a";var Jn="n";var Zn="p";var er="h";var tr=function(){function e(e,t,n,r,i,o,a){this.id=e;this.repoInfo_=t;this.onMessage_=n;this.onReady_=r;this.onDisconnect_=i;this.onKill_=o;this.lastSessionId=a;this.connectionCount=0;this.pendingDataMessages=[];this.state_=0;this.log_=E("c:"+this.id+":");this.transportManager_=new Bn(t);this.log_("Connection created");this.start_()}e.prototype.start_=function(){var e=this;var t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId);this.primaryResponsesRequired_=t["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.conn_);var r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_;this.rx_=this.conn_;this.secondaryConn_=null;this.isHealthy_=false;setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t["healthyTimeout"]||0;i>0&&(this.healthyTimeout_=K(function(){e.healthyTimeout_=null;if(!e.isHealthy_)if(e.conn_&&e.conn_.bytesReceived>Hn){e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy.");e.isHealthy_=true;e.conn_.markConnectionHealthy()}else if(e.conn_&&e.conn_.bytesSent>Vn)e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive.");else{e.log_("Closing unhealthy connection after timeout.");e.close()}},Math.floor(i)))};e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++};e.prototype.disconnReceiver_=function(e){var t=this;return function(n){if(e===t.conn_)t.onConnectionLost_(n);else if(e===t.secondaryConn_){t.log_("Secondary connection lost.");t.onSecondaryConnectionLost_()}else t.log_("closing an old connection")}};e.prototype.connReceiver_=function(e){var t=this;return function(n){2!=t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}};e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)};e.prototype.tryCleanupConnection=function(){if(this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_){this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId);this.conn_=this.secondaryConn_;this.secondaryConn_=null}};e.prototype.onSecondaryControl_=function(e){if(Kn in e){var t=e[Kn];if(t===$n)this.upgradeIfSecondaryHealthy_();else if(t===Qn){this.log_("Got a reset on secondary, closing it");this.secondaryConn_.close();this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()}else if(t===Xn){this.log_("got pong on secondary.");this.secondaryResponsesRequired_--;this.upgradeIfSecondaryHealthy_()}}};e.prototype.onSecondaryMessageReceived_=function(e){var t=k("t",e);var n=k("d",e);if("c"==t)this.onSecondaryControl_(n);else{if("d"!=t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}};e.prototype.upgradeIfSecondaryHealthy_=function(){if(this.secondaryResponsesRequired_<=0){this.log_("Secondary connection is healthy.");this.isHealthy_=true;this.secondaryConn_.markConnectionHealthy();this.proceedWithUpgrade_()}else{this.log_("sending ping on secondary.");this.secondaryConn_.send({t:"c",d:{t:Zn,d:{}}})}};e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start();this.log_("sending client ack on secondary");this.secondaryConn_.send({t:"c",d:{t:$n,d:{}}});this.log_("Ending transmission on primary");this.conn_.send({t:"c",d:{t:Jn,d:{}}});this.tx_=this.secondaryConn_;this.tryCleanupConnection()};e.prototype.onPrimaryMessageReceived_=function(e){var t=k("t",e);var n=k("d",e);"c"==t?this.onControl_(n):"d"==t&&this.onDataMessage_(n)};e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_();this.onMessage_(e)};e.prototype.onPrimaryResponse_=function(){if(!this.isHealthy_){this.primaryResponsesRequired_--;if(this.primaryResponsesRequired_<=0){this.log_("Primary connection is healthy.");this.isHealthy_=true;this.conn_.markConnectionHealthy()}}};e.prototype.onControl_=function(e){var t=k(Kn,e);if(Gn in e){var n=e[Gn];if(t===er)this.onHandshake_(n);else if(t===Jn){this.log_("recvd end transmission on primary");this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[];this.tryCleanupConnection()}else if(t===zn)this.onConnectionShutdown_(n);else if(t===Qn)this.onReset_(n);else if(t===Yn)T("Server Error: "+n);else if(t===Xn){this.log_("got pong on primary.");this.onPrimaryResponse_();this.sendPingOnPrimaryIfNecessary_()}else T("Unknown control packet command: "+t)}};e.prototype.onHandshake_=function(e){var t=e.ts;var n=e.v;var r=e.h;this.sessionId=e.s;this.repoInfo_.updateHost(r);if(0==this.state_){this.conn_.start();this.onConnectionEstablished_(this.conn_,t);Q!==n&&I("Protocol version mismatch detected");this.tryStartUpgrade_()}};e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)};e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.sessionId);this.secondaryResponsesRequired_=e["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.secondaryConn_);var r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r);K(function(){if(t.secondaryConn_){t.log_("Timed out trying to upgrade.");t.secondaryConn_.close()}},Math.floor(Wn))};e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e);this.repoInfo_.updateHost(e);if(1===this.state_)this.close();else{this.closeConnections_();this.start_()}};e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established.");this.conn_=e;this.state_=1;if(this.onReady_){this.onReady_(t,this.sessionId);this.onReady_=null}if(0===this.primaryResponsesRequired_){this.log_("Primary connection is healthy.");this.isHealthy_=true}else K(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(qn))};e.prototype.sendPingOnPrimaryIfNecessary_=function(){if(!this.isHealthy_&&1===this.state_){this.log_("sending ping on primary.");this.sendData_({t:"c",d:{t:Zn,d:{}}})}};e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null;this.tx_!==e&&this.rx_!==e||this.close()};e.prototype.onConnectionLost_=function(e){this.conn_=null;if(e||0!==this.state_)1===this.state_&&this.log_("Realtime connection lost.");else{this.log_("Realtime connection failed.");if(this.repoInfo_.isCacheableHost()){f.remove("host:"+this.repoInfo_.host);this.repoInfo_.internalHost=this.repoInfo_.host}}this.close()};e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down...");if(this.onKill_){this.onKill_(e);this.onKill_=null}this.onDisconnect_=null;this.close()};e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)};e.prototype.close=function(){if(2!==this.state_){this.log_("Closing realtime connection.");this.state_=2;this.closeConnections_();if(this.onDisconnect_){this.onDisconnect_();this.onDisconnect_=null}}};e.prototype.closeConnections_=function(){this.log_("Shutting down all connections");if(this.conn_){this.conn_.close();this.conn_=null}if(this.secondaryConn_){this.secondaryConn_.close();this.secondaryConn_=null}if(this.healthyTimeout_){clearTimeout(this.healthyTimeout_);this.healthyTimeout_=null}};return e}();var nr=function(){function e(){}e.prototype.put=function(e,t,n,r){};e.prototype.merge=function(e,t,n,r){};e.prototype.refreshAuthToken=function(e){};e.prototype.onDisconnectPut=function(e,t,n){};e.prototype.onDisconnectMerge=function(e,t,n){};e.prototype.onDisconnectCancel=function(e,t){};e.prototype.reportStats=function(e){};return e}();var rr=1e3;var ir=3e5;var or=3e4;var ar=1.3;var sr=3e4;var ur="server_kill";var cr=3;var lr=function(e){s.__extends(t,e);function t(n,r,i,a,s,u){var c=e.call(this)||this;c.repoInfo_=n;c.onDataUpdate_=r;c.onConnectStatus_=i;c.onServerInfoUpdate_=a;c.authTokenProvider_=s;c.authOverride_=u;c.id=t.nextPersistentConnectionId_++;c.log_=E("p:"+c.id+":");c.interruptReasons_={};c.listens_={};c.outstandingPuts_=[];c.outstandingPutCount_=0;c.onDisconnectRequestQueue_=[];c.connected_=false;c.reconnectDelay_=rr;c.maxReconnectDelay_=ir;c.securityDebugCallback_=null;c.lastSessionId=null;c.establishConnectionTimer_=null;c.visible_=false;c.requestCBHash_={};c.requestNumber_=0;c.realtime_=null;c.authToken_=null;c.forceTokenRefresh_=false;c.invalidAuthTokenCount_=0;c.firstConnection_=true;c.lastConnectionAttemptTime_=null;c.lastConnectionEstablishedTime_=null;if(u&&!o.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");c.scheduleConnect_(0);pn.getInstance().on("visible",c.onVisible_,c);-1===n.host.indexOf("fblocal")&&dn.getInstance().on("online",c.onOnline_,c);return c}t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_;var i={r:r,a:e,b:t};this.log_(o.stringify(i));o.assert(this.connected_,"sendRequest call when we're not connected not allowed.");this.realtime_.sendRequest(i);n&&(this.requestCBHash_[r]=n)};t.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier();var a=e.path.toString();this.log_("Listen called for "+a+" "+i);this.listens_[a]=this.listens_[a]||{};o.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query");o.assert(!this.listens_[a][i],"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:t,query:e,tag:n};this.listens_[a][i]=s;this.connected_&&this.sendListen_(s)};t.prototype.sendListen_=function(e){var n=this;var r=e.query;var i=r.path.toString();var o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};var s="q";if(e.tag){a["q"]=r.queryObject();a["t"]=e.tag}a["h"]=e.hashFn();this.sendRequest(s,a,function(a){var s=a["d"];var u=a["s"];t.warnOnListenWarnings_(s,r);var c=n.listens_[i]&&n.listens_[i][o];if(c===e){n.log_("listen response",a);"ok"!==u&&n.removeListen_(i,o);e.onComplete&&e.onComplete(u,s)}})};t.warnOnListenWarnings_=function(e,t){if(e&&"object"===typeof e&&o.contains(e,"w")){var n=o.safeGet(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"';var i=t.path.toString();I("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}};t.prototype.refreshAuthToken=function(e){this.authToken_=e;this.log_("Auth token refreshed");this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){});this.reduceReconnectDelayIfAdminCredential_(e)};t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){var t=e&&40===e.length;if(t||o.isAdmin(e)){this.log_("Admin auth credential detected.  Reducing max reconnect time.");this.maxReconnectDelay_=or}};t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_;var n=o.isValidFormat(t)?"auth":"gauth";var r={cred:t};null===this.authOverride_?r["noauth"]=true:"object"===typeof this.authOverride_&&(r["authvar"]=this.authOverride_);this.sendRequest(n,r,function(n){var r=n["s"];var i=n["d"]||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}};t.prototype.unlisten=function(e,t){var n=e.path.toString();var r=e.queryIdentifier();this.log_("Unlisten called for "+n+" "+r);o.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query");var i=this.removeListen_(n,r);i&&this.connected_&&this.sendUnlisten_(n,r,e.queryObject(),t)};t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};var o="n";if(r){i["q"]=n;i["t"]=r}this.sendRequest(o,i)};t.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})};t.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})};t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})};t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i);this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e["s"],e["d"])},Math.floor(0))})};t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)};t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)};t.prototype.putInternal=function(e,t,n,r,i){var o={p:t,d:n};void 0!==i&&(o["h"]=i);this.outstandingPuts_.push({action:e,request:o,onComplete:r});this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)};t.prototype.sendPut_=function(e){var t=this;var n=this.outstandingPuts_[e].action;var r=this.outstandingPuts_[e].request;var i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_;this.sendRequest(n,r,function(r){t.log_(n+" response",r);delete t.outstandingPuts_[e];t.outstandingPutCount_--;0===t.outstandingPutCount_&&(t.outstandingPuts_=[]);i&&i(r["s"],r["d"])})};t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n);this.sendRequest("s",n,function(e){var n=e["s"];if("ok"!==n){var r=e["d"];t.log_("reportStats","Error sending stats: "+r)}})}};t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+o.stringify(e));var t=e["r"];var n=this.requestCBHash_[t];if(n){delete this.requestCBHash_[t];n(e["b"])}}else{if("error"in e)throw"A server-side error has occurred: "+e["error"];"a"in e&&this.onDataPush_(e["a"],e["b"])}};t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t);"d"===e?this.onDataUpdate_(t["p"],t["d"],false,t["t"]):"m"===e?this.onDataUpdate_(t["p"],t["d"],true,t["t"]):"c"===e?this.onListenRevoked_(t["p"],t["q"]):"ac"===e?this.onAuthRevoked_(t["s"],t["d"]):"sd"===e?this.onSecurityDebugPacket_(t):T("Unrecognized action received from server: "+o.stringify(e)+"\nAre you using the latest client?")};t.prototype.onReady_=function(e,t){this.log_("connection ready");this.connected_=true;this.lastConnectionEstablishedTime_=(new Date).getTime();this.handleTimestamp_(e);this.lastSessionId=t;this.firstConnection_&&this.sendConnectStats_();this.restoreState_();this.firstConnection_=false;this.onConnectStatus_(true)};t.prototype.scheduleConnect_=function(e){var t=this;o.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?");this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_);this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null;t.establishConnection_()},Math.floor(e))};t.prototype.onVisible_=function(e){if(e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_){this.log_("Window became visible.  Reducing delay.");this.reconnectDelay_=rr;this.realtime_||this.scheduleConnect_(0)}this.visible_=e};t.prototype.onOnline_=function(e){if(e){this.log_("Browser went online.");this.reconnectDelay_=rr;this.realtime_||this.scheduleConnect_(0)}else{this.log_("Browser went offline.  Killing connection.");this.realtime_&&this.realtime_.close()}};t.prototype.onRealtimeDisconnect_=function(){this.log_("data client disconnected");this.connected_=false;this.realtime_=null;this.cancelSentTransactions_();this.requestCBHash_={};if(this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var e=(new Date).getTime()-this.lastConnectionEstablishedTime_;e>sr&&(this.reconnectDelay_=rr);this.lastConnectionEstablishedTime_=null}}else{this.log_("Window isn't visible.  Delaying reconnect.");this.reconnectDelay_=this.maxReconnectDelay_;this.lastConnectionAttemptTime_=(new Date).getTime()}var t=(new Date).getTime()-this.lastConnectionAttemptTime_;var n=Math.max(0,this.reconnectDelay_-t);n=Math.random()*n;this.log_("Trying to reconnect in "+n+"ms");this.scheduleConnect_(n);this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ar)}this.onConnectStatus_(false)};t.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt");this.lastConnectionAttemptTime_=(new Date).getTime();this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this);var n=this.onReady_.bind(this);var r=this.onRealtimeDisconnect_.bind(this);var i=this.id+":"+t.nextConnectionId_++;var a=this;var s=this.lastSessionId;var u=false;var c=null;var l=function(){if(c)c.close();else{u=true;r()}};var h=function(e){o.assert(c,"sendRequest call when we're not connected not allowed.");c.sendRequest(e)};this.realtime_={close:l,sendRequest:h};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=false;this.authTokenProvider_.getToken(f).then(function(t){if(u)w("getToken() completed but was canceled");else{w("getToken() completed. Creating connection.");a.authToken_=t&&t.accessToken;c=new tr(i,a.repoInfo_,e,n,r,function(e){I(e+" ("+a.repoInfo_.toString()+")");a.interrupt(ur)},s)}}).then(null,function(e){a.log_("Failed to get token: "+e);if(!u){o.CONSTANTS.NODE_ADMIN&&I(e);l()}})}};t.prototype.interrupt=function(e){w("Interrupting connection for reason: "+e);this.interruptReasons_[e]=true;if(this.realtime_)this.realtime_.close();else{if(this.establishConnectionTimer_){clearTimeout(this.establishConnectionTimer_);this.establishConnectionTimer_=null}this.connected_&&this.onRealtimeDisconnect_()}};t.prototype.resume=function(e){w("Resuming connection for reason: "+e);delete this.interruptReasons_[e];if(o.isEmpty(this.interruptReasons_)){this.reconnectDelay_=rr;this.realtime_||this.scheduleConnect_(0)}};t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})};t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];if(t&&"h"in t.request&&t.queued){t.onComplete&&t.onComplete("disconnect");delete this.outstandingPuts_[e];this.outstandingPutCount_--}}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])};t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map(function(e){return L(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")};t.prototype.removeListen_=function(e,t){var n=new G(e).toString();var r;if(void 0!==this.listens_[n]){r=this.listens_[n][t];delete this.listens_[n][t];0===o.getCount(this.listens_[n])&&delete this.listens_[n]}else r=void 0;return r};t.prototype.onAuthRevoked_=function(e,t){w("Auth token revoked: "+e+"/"+t);this.authToken_=null;this.forceTokenRefresh_=true;this.realtime_.close();if("invalid_token"===e||"permission_denied"===e){this.invalidAuthTokenCount_++;if(this.invalidAuthTokenCount_>=cr){this.reconnectDelay_=or;this.authTokenProvider_.notifyForInvalidToken()}}};t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e["msg"].replace("\n","\nFIREBASE: "))};t.prototype.restoreState_=function(){var e=this;this.tryAuth();o.forEach(this.listens_,function(t,n){o.forEach(n,function(t,n){e.sendListen_(n)})});for(var t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);while(this.onDisconnectRequestQueue_.length){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}};t.prototype.sendConnectStats_=function(){var e={};var t="js";o.CONSTANTS.NODE_ADMIN?t="admin_node":o.CONSTANTS.NODE_CLIENT&&(t="node");e["sdk."+t+"."+u.SDK_VERSION.replace(/\./g,"-")]=1;o.isMobileCordova()?e["framework.cordova"]=1:o.isReactNative()&&(e["framework.reactnative"]=1);this.reportStats(e)};t.prototype.shouldReconnect_=function(){var e=dn.getInstance().currentlyOnline();return o.isEmpty(this.interruptReasons_)&&e};t.nextPersistentConnectionId_=0;t.nextConnectionId_=0;return t}(nr);var hr=function(e){s.__extends(t,e);function t(t,n,r){var i=e.call(this)||this;i.repoInfo_=t;i.onDataUpdate_=n;i.authTokenProvider_=r;i.log_=E("p:rest:");i.listens_={};return i}t.prototype.reportStats=function(e){throw new Error("Method not implemented.")};t.getListenId_=function(e,t){if(void 0!==t)return"tag$"+t;o.assert(e.getQueryParams().isDefault(),"should have a tag if it's not a default query.");return e.path.toString()};t.prototype.listen=function(e,n,r,i){var a=this;var s=e.path.toString();this.log_("Listen called for "+s+" "+e.queryIdentifier());var u=t.getListenId_(e,r);var c={};this.listens_[u]=c;var l=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(s+".json",l,function(e,t){var n=t;if(404===e){n=null;e=null}null===e&&a.onDataUpdate_(s,n,false,r);if(o.safeGet(a.listens_,u)===c){var l;l=e?401==e?"permission_denied":"rest_error:"+e:"ok";i(l,null)}})};t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]};t.prototype.refreshAuthToken=function(e){};t.prototype.restRequest_=function(e,t,n){var r=this;void 0===t&&(t={});t["format"]="export";this.authTokenProvider_.getToken(false).then(function(i){var a=i&&i.accessToken;a&&(t["auth"]=a);var s=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?"+o.querystring(t);r.log_("Sending REST request for "+s);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+s+" received. status:",u.status,"response:",u.responseText);var e=null;if(u.status>=200&&u.status<300){try{e=o.jsonEval(u.responseText)}catch(e){I("Failed to parse JSON response for "+s+": "+u.responseText)}n(null,e)}else{401!==u.status&&404!==u.status&&I("Got unsuccessful REST response for "+s+" Status: "+u.status);n(u.status)}n=null}};u.open("GET",s,true);u.send()})};return t}(nr);var fr="repo_interrupt";var pr=function(){function e(e,t,n){var r=this;this.repoInfo_=e;this.app=n;this.dataUpdateCount=0;this.statsListener_=null;this.eventQueue_=new ln;this.nextWriteId_=1;this.interceptServerDataCallback_=null;this.onDisconnect_=new Et;this.persistentConnection_=null;var i=new tn(n);this.stats_=rn.getCollection(e);if(t||H()){this.server_=new hr(this.repoInfo_,this.onDataUpdate_.bind(this),i);setTimeout(this.onConnectStatus_.bind(this,true),0)}else{var a=n.options["databaseAuthVariableOverride"];if("undefined"!==typeof a&&null!==a){if("object"!==typeof a)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{o.stringify(a)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new lr(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,a);this.server_=this.persistentConnection_}i.addTokenChangeListener(function(e){r.server_.refreshAuthToken(e)});this.statsReporter_=rn.getOrCreateReporter(e,function(){return new cn(r.stats_,r.server_)});this.transactions_init_();this.infoData_=new en;this.infoSyncTree_=new Zt({startListening:function(e,t,n,i){var o=[];var a=r.infoData_.getNode(e.path);if(!a.isEmpty()){o=r.infoSyncTree_.applyServerOverwrite(e.path,a);setTimeout(function(){i("ok")},0)}return o},stopListening:function(){}});this.updateInfo_("connected",false);this.serverSyncTree_=new Zt({startListening:function(e,t,n,i){r.server_.listen(e,n,t,function(t,n){var o=i(t,n);r.eventQueue_.raiseEventsForChangedPath(e.path,o)});return[]},stopListening:function(e,t){r.server_.unlisten(e,t)}})}e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host};e.prototype.name=function(){return this.repoInfo_.namespace};e.prototype.serverTime=function(){var e=this.infoData_.getNode(new G(".info/serverTimeOffset"));var t=e.val()||0;return(new Date).getTime()+t};e.prototype.generateServerValues=function(){return Tt({timestamp:this.serverTime()})};e.prototype.onDataUpdate_=function(e,t,n,r){this.dataUpdateCount++;var i=new G(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var a=[];if(r)if(n){var s=o.map(t,function(e){return lt(e)});a=this.serverSyncTree_.applyTaggedQueryMerge(i,s,r)}else{var u=lt(t);a=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=o.map(t,function(e){return lt(e)});a=this.serverSyncTree_.applyServerMerge(i,c)}else{var l=lt(t);a=this.serverSyncTree_.applyServerOverwrite(i,l)}var h=i;a.length>0&&(h=this.rerunTransactions_(i));this.eventQueue_.raiseEventsForChangedPath(h,a)};e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e};e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e);false===e&&this.runOnDisconnectEvents_()};e.prototype.onServerInfoUpdate_=function(e){var t=this;M(e,function(e,n){t.updateInfo_(n,e)})};e.prototype.updateInfo_=function(e,t){var n=new G("/.info/"+e);var r=lt(t);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)};e.prototype.getNextWriteId_=function(){return this.nextWriteId_++};e.prototype.setWithPriority=function(e,t,n,r){var i=this;this.log_("set",{path:e.toString(),value:t,priority:n});var o=this.generateServerValues();var a=lt(t,n);var s=Ct(a,o);var u=this.getNextWriteId_();var c=this.serverSyncTree_.applyUserOverwrite(e,s,u,true);this.eventQueue_.queueEvents(c);this.server_.put(e.toString(),a.val(true),function(t,n){var o="ok"===t;o||I("set at "+e+" failed: "+t);var a=i.serverSyncTree_.ackUserWrite(u,!o);i.eventQueue_.raiseEventsForChangedPath(e,a);i.callOnCompleteCallback(r,t,n)});var l=this.abortTransactions_(e);this.rerunTransactions_(l);this.eventQueue_.raiseEventsForChangedPath(l,[])};e.prototype.update=function(e,t,n){var r=this;this.log_("update",{path:e.toString(),value:t});var i=true;var a=this.generateServerValues();var s={};o.forEach(t,function(e,t){i=false;var n=lt(t);s[e]=Ct(n,a)});if(i){w("update() called with empty data.  Don't do anything.");this.callOnCompleteCallback(n,"ok")}else{var u=this.getNextWriteId_();var c=this.serverSyncTree_.applyUserMerge(e,s,u);this.eventQueue_.queueEvents(c);this.server_.merge(e.toString(),t,function(t,i){var o="ok"===t;o||I("update at "+e+" failed: "+t);var a=r.serverSyncTree_.ackUserWrite(u,!o);var s=a.length>0?r.rerunTransactions_(e):e;r.eventQueue_.raiseEventsForChangedPath(s,a);r.callOnCompleteCallback(n,t,i)});o.forEach(t,function(t){var n=r.abortTransactions_(e.child(t));r.rerunTransactions_(n)});this.eventQueue_.raiseEventsForChangedPath(e,[])}};e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues();var n=It(this.onDisconnect_,t);var r=[];n.forEachTree(G.Empty,function(t,n){r=r.concat(e.serverSyncTree_.applyServerOverwrite(t,n));var i=e.abortTransactions_(t);e.rerunTransactions_(i)});this.onDisconnect_=new Et;this.eventQueue_.raiseEventsForChangedPath(G.Empty,r)};e.prototype.onDisconnectCancel=function(e,t){var n=this;this.server_.onDisconnectCancel(e.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(e);n.callOnCompleteCallback(t,r,i)})};e.prototype.onDisconnectSet=function(e,t,n){var r=this;var i=lt(t);this.server_.onDisconnectPut(e.toString(),i.val(true),function(t,o){"ok"===t&&r.onDisconnect_.remember(e,i);r.callOnCompleteCallback(n,t,o)})};e.prototype.onDisconnectSetWithPriority=function(e,t,n,r){var i=this;var o=lt(t,n);this.server_.onDisconnectPut(e.toString(),o.val(true),function(t,n){"ok"===t&&i.onDisconnect_.remember(e,o);i.callOnCompleteCallback(r,t,n)})};e.prototype.onDisconnectUpdate=function(e,t,n){var r=this;if(o.isEmpty(t)){w("onDisconnect().update() called with empty data.  Don't do anything.");this.callOnCompleteCallback(n,"ok");return}this.server_.onDisconnectMerge(e.toString(),t,function(i,a){"ok"===i&&o.forEach(t,function(t,n){var i=lt(n);r.onDisconnect_.remember(e.child(t),i)});r.callOnCompleteCallback(n,i,a)})};e.prototype.addEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t);this.eventQueue_.raiseEventsAtPath(e.path,n)};e.prototype.removeEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t);this.eventQueue_.raiseEventsAtPath(e.path,n)};e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(fr)};e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(fr)};e.prototype.stats=function(e){void 0===e&&(e=false);if("undefined"===typeof console)return;var t;if(e){this.statsListener_||(this.statsListener_=new on(this.stats_));t=this.statsListener_.get()}else t=this.stats_.get();var n=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);o.forEach(t,function(e,t){for(var r=e.length;r<n+2;r++)e+=" ";console.log(e+t)})};e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e);this.statsReporter_.includeStat(e)};e.prototype.log_=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":");w.apply(void 0,[n].concat(e))};e.prototype.callOnCompleteCallback=function(e,t,n){e&&V(function(){if("ok"==t)e(null);else{var r=(t||"error").toUpperCase();var i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r;e(o)}})};Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new Sr(this))},enumerable:true,configurable:true});return e}();var dr=function(){function e(t){this.indexedFilter_=new jt(t.getIndex());this.index_=t.getIndex();this.startPost_=e.getStartPost_(t);this.endPost_=e.getEndPost_(t)}e.prototype.getStartPost=function(){return this.startPost_};e.prototype.getEndPost=function(){return this.endPost_};e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0};e.prototype.updateChild=function(e,t,n,r,i,o){this.matches(new De(t,n))||(n=at.EMPTY_NODE);return this.indexedFilter_.updateChild(e,t,n,r,i,o)};e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=at.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(at.EMPTY_NODE);var i=this;t.forEachChild(Ge,function(e,t){i.matches(new De(e,t))||(r=r.updateImmediateChild(e,at.EMPTY_NODE))});return this.indexedFilter_.updateFullNode(e,r,n)};e.prototype.updatePriority=function(e,t){return e};e.prototype.filtersNodes=function(){return true};e.prototype.getIndexedFilter=function(){return this.indexedFilter_};e.prototype.getIndex=function(){return this.index_};e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()};e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()};return e}();var vr=function(){function e(e){this.rangedFilter_=new dr(e);this.index_=e.getIndex();this.limit_=e.getLimit();this.reverse_=!e.isViewFromLeft()}e.prototype.updateChild=function(e,t,n,r,i,o){this.rangedFilter_.matches(new De(t,n))||(n=at.EMPTY_NODE);return e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)};e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=at.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=at.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);var o=0;while(i.hasNext()&&o<this.limit_){var a=i.getNext();var s=void 0;s=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0;if(!s)break;r=r.updateImmediateChild(a.name,a.node);o++}}else{r=t.withIndex(this.index_);r=r.updatePriority(at.EMPTY_NODE);var u=void 0;var c=void 0;var l=void 0;var i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_);u=this.rangedFilter_.getEndPost();c=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();l=function(e,t){return h(t,e)}}else{i=r.getIterator(this.index_);u=this.rangedFilter_.getStartPost();c=this.rangedFilter_.getEndPost();l=this.index_.getCompare()}var o=0;var f=false;while(i.hasNext()){var a=i.getNext();!f&&l(u,a)<=0&&(f=true);var s=f&&o<this.limit_&&l(a,c)<=0;s?o++:r=r.updateImmediateChild(a.name,at.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)};e.prototype.updatePriority=function(e,t){return e};e.prototype.filtersNodes=function(){return true};e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()};e.prototype.getIndex=function(){return this.index_};e.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(e,t){return s(t,e)}}else a=this.index_.getCompare();var u=e;o.assert(u.numChildren()==this.limit_,"");var c=new De(t,n);var l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_);var h=this.rangedFilter_.matches(c);if(u.hasChild(t)){var f=u.getImmediateChild(t);var p=r.getChildAfterChild(this.index_,l,this.reverse_);while(null!=p&&(p.name==t||u.hasChild(p.name)))p=r.getChildAfterChild(this.index_,p,this.reverse_);var d=null==p?1:a(p,c);var v=h&&!n.isEmpty()&&d>=0;if(v){null!=i&&i.trackChildChange(Ft.childChangedChange(t,n,f));return u.updateImmediateChild(t,n)}null!=i&&i.trackChildChange(Ft.childRemovedChange(t,f));var y=u.updateImmediateChild(t,at.EMPTY_NODE);var g=null!=p&&this.rangedFilter_.matches(p);if(g){null!=i&&i.trackChildChange(Ft.childAddedChange(p.name,p.node));return y.updateImmediateChild(p.name,p.node)}return y}if(n.isEmpty())return e;if(h){if(a(l,c)>=0){if(null!=i){i.trackChildChange(Ft.childRemovedChange(l.name,l.node));i.trackChildChange(Ft.childAddedChange(t,n))}return u.updateImmediateChild(t,n).updateImmediateChild(l.name,at.EMPTY_NODE)}return e}return e};return e}();var yr=function(){function e(){this.limitSet_=false;this.startSet_=false;this.startNameSet_=false;this.endSet_=false;this.endNameSet_=false;this.limit_=0;this.viewFrom_="";this.indexStartValue_=null;this.indexStartName_="";this.indexEndValue_=null;this.indexEndName_="";this.index_=Ge}e.prototype.hasStart=function(){return this.startSet_};e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT};e.prototype.getIndexStartValue=function(){o.assert(this.startSet_,"Only valid if start has been set");return this.indexStartValue_};e.prototype.getIndexStartName=function(){o.assert(this.startSet_,"Only valid if start has been set");return this.startNameSet_?this.indexStartName_:A};e.prototype.hasEnd=function(){return this.endSet_};e.prototype.getIndexEndValue=function(){o.assert(this.endSet_,"Only valid if end has been set");return this.indexEndValue_};e.prototype.getIndexEndName=function(){o.assert(this.endSet_,"Only valid if end has been set");return this.endNameSet_?this.indexEndName_:D};e.prototype.hasLimit=function(){return this.limitSet_};e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_};e.prototype.getLimit=function(){o.assert(this.limitSet_,"Only valid if limit has been set");return this.limit_};e.prototype.getIndex=function(){return this.index_};e.prototype.copy_=function(){var t=new e;t.limitSet_=this.limitSet_;t.limit_=this.limit_;t.startSet_=this.startSet_;t.indexStartValue_=this.indexStartValue_;t.startNameSet_=this.startNameSet_;t.indexStartName_=this.indexStartName_;t.endSet_=this.endSet_;t.indexEndValue_=this.indexEndValue_;t.endNameSet_=this.endNameSet_;t.indexEndName_=this.indexEndName_;t.index_=this.index_;t.viewFrom_=this.viewFrom_;return t};e.prototype.limit=function(e){var t=this.copy_();t.limitSet_=true;t.limit_=e;t.viewFrom_="";return t};e.prototype.limitToFirst=function(t){var n=this.copy_();n.limitSet_=true;n.limit_=t;n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT;return n};e.prototype.limitToLast=function(t){var n=this.copy_();n.limitSet_=true;n.limit_=t;n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT;return n};e.prototype.startAt=function(e,t){var n=this.copy_();n.startSet_=true;void 0!==e||(e=null);n.indexStartValue_=e;if(null!=t){n.startNameSet_=true;n.indexStartName_=t}else{n.startNameSet_=false;n.indexStartName_=""}return n};e.prototype.endAt=function(e,t){var n=this.copy_();n.endSet_=true;void 0!==e||(e=null);n.indexEndValue_=e;if(void 0!==t){n.endNameSet_=true;n.indexEndName_=t}else{n.endNameSet_=false;n.indexEndName_=""}return n};e.prototype.orderBy=function(e){var t=this.copy_();t.index_=e;return t};e.prototype.getQueryObject=function(){var t=e.WIRE_PROTOCOL_CONSTANTS_;var n={};if(this.startSet_){n[t.INDEX_START_VALUE]=this.indexStartValue_;this.startNameSet_&&(n[t.INDEX_START_NAME]=this.indexStartName_)}if(this.endSet_){n[t.INDEX_END_VALUE]=this.indexEndValue_;this.endNameSet_&&(n[t.INDEX_END_NAME]=this.indexEndName_)}if(this.limitSet_){n[t.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT);n[t.VIEW_FROM]=r}this.index_!==Ge&&(n[t.INDEX]=this.index_.toString());return n};e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)};e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==Ge};e.prototype.getNodeFilter=function(){return this.loadsAllData()?new jt(this.getIndex()):this.hasLimit()?new vr(this):new dr(this)};e.prototype.toRestQueryStringParameters=function(){var t=e.REST_QUERY_CONSTANTS_;var n={};if(this.isDefault())return n;var r;if(this.index_===Ge)r=t.PRIORITY_INDEX;else if(this.index_===ft)r=t.VALUE_INDEX;else if(this.index_===Le)r=t.KEY_INDEX;else{o.assert(this.index_ instanceof pt,"Unrecognized index type!");r=this.index_.toString()}n[t.ORDER_BY]=o.stringify(r);if(this.startSet_){n[t.START_AT]=o.stringify(this.indexStartValue_);this.startNameSet_&&(n[t.START_AT]+=","+o.stringify(this.indexStartName_))}if(this.endSet_){n[t.END_AT]=o.stringify(this.indexEndValue_);this.endNameSet_&&(n[t.END_AT]+=","+o.stringify(this.indexEndName_))}this.limitSet_&&(this.isViewFromLeft()?n[t.LIMIT_TO_FIRST]=this.limit_:n[t.LIMIT_TO_LAST]=this.limit_);return n};e.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"};e.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"};e.DEFAULT=new e;return e}();var gr=function(e){s.__extends(t,e);function t(t,n){var r=this;if(!(t instanceof pr))throw new Error("new Reference() no longer supported - use app.database().");r=e.call(this,t,n,yr.DEFAULT,false)||this;return r}t.prototype.getKey=function(){o.validateArgCount("Reference.key",0,0,arguments.length);return this.path.isEmpty()?null:this.path.getBack()};t.prototype.child=function(e){o.validateArgCount("Reference.child",1,1,arguments.length);"number"===typeof e?e=String(e):e instanceof G||(null===this.path.getFront()?Te("Reference.child",1,e,false):Ee("Reference.child",1,e,false));return new t(this.repo,this.path.child(e))};t.prototype.getParent=function(){o.validateArgCount("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)};t.prototype.getRoot=function(){o.validateArgCount("Reference.root",0,0,arguments.length);var e=this;while(null!==e.getParent())e=e.getParent();return e};t.prototype.databaseProp=function(){return this.repo.database};t.prototype.set=function(e,t){o.validateArgCount("Reference.set",1,2,arguments.length);Se("Reference.set",this.path);ve("Reference.set",1,e,this.path,false);o.validateCallback("Reference.set",2,t,true);var n=new o.Deferred;this.repo.setWithPriority(this.path,e,null,n.wrapCallback(t));return n.promise};t.prototype.update=function(e,t){o.validateArgCount("Reference.update",1,2,arguments.length);Se("Reference.update",this.path);if(Array.isArray(e)){var n={};for(var r=0;r<e.length;++r)n[""+r]=e[r];e=n;I("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_e("Reference.update",1,e,this.path,false);o.validateCallback("Reference.update",2,t,true);var i=new o.Deferred;this.repo.update(this.path,e,i.wrapCallback(t));return i.promise};t.prototype.setWithPriority=function(e,t,n){o.validateArgCount("Reference.setWithPriority",2,3,arguments.length);Se("Reference.setWithPriority",this.path);ve("Reference.setWithPriority",1,e,this.path,false);me("Reference.setWithPriority",2,t,false);o.validateCallback("Reference.setWithPriority",3,n,true);if(".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new o.Deferred;this.repo.setWithPriority(this.path,e,t,r.wrapCallback(n));return r.promise};t.prototype.remove=function(e){o.validateArgCount("Reference.remove",0,1,arguments.length);Se("Reference.remove",this.path);o.validateCallback("Reference.remove",1,e,true);return this.set(null,e)};t.prototype.transaction=function(e,t,n){o.validateArgCount("Reference.transaction",1,3,arguments.length);Se("Reference.transaction",this.path);o.validateCallback("Reference.transaction",1,e,false);o.validateCallback("Reference.transaction",2,t,true);Ce("Reference.transaction",3,n,true);if(".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=true);var r=new o.Deferred;"function"===typeof t&&r.promise.catch(function(){});var i=function(e,n,i){e?r.reject(e):r.resolve(new Ne(n,i));"function"===typeof t&&t(e,n,i)};this.repo.startTransaction(this.path,e,i,n);return r.promise};t.prototype.setPriority=function(e,t){o.validateArgCount("Reference.setPriority",1,2,arguments.length);Se("Reference.setPriority",this.path);me("Reference.setPriority",1,e,false);o.validateCallback("Reference.setPriority",2,t,true);var n=new o.Deferred;this.repo.setWithPriority(this.path.child(".priority"),e,null,n.wrapCallback(t));return n.promise};t.prototype.push=function(e,t){o.validateArgCount("Reference.push",0,2,arguments.length);Se("Reference.push",this.path);ve("Reference.push",1,e,this.path,true);o.validateCallback("Reference.push",2,t,true);var n=this.repo.serverTime();var r=Ae(n);var i=this.child(r);var a=this.child(r);var s;s=null!=e?i.set(e,t).then(function(){return a}):Promise.resolve(a);i.then=s.then.bind(s);i.catch=s.then.bind(s,void 0);"function"===typeof t&&s.catch(function(){});return i};t.prototype.onDisconnect=function(){Se("Reference.onDisconnect",this.path);return new Oe(this.repo,this.path)};Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:true,configurable:true});return t}(bt);bt.__referenceConstructor=gr;Yt.__referenceConstructor=gr;var _r=function(){function e(){this.children={};this.childCount=0;this.value=null}return e}();var mr=function(){function e(e,t,n){void 0===e&&(e="");void 0===t&&(t=null);void 0===n&&(n=new _r);this.name_=e;this.parent_=t;this.node_=n}e.prototype.subTree=function(t){var n=t instanceof G?t:new G(t);var r=this,i;while(null!==(i=n.getFront())){var a=o.safeGet(r.node_.children,i)||new _r;r=new e(i,r,a);n=n.popFront()}return r};e.prototype.getValue=function(){return this.node_.value};e.prototype.setValue=function(e){o.assert("undefined"!==typeof e,"Cannot set value to undefined");this.node_.value=e;this.updateParents_()};e.prototype.clear=function(){this.node_.value=null;this.node_.children={};this.node_.childCount=0;this.updateParents_()};e.prototype.hasChildren=function(){return this.node_.childCount>0};e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()};e.prototype.forEachChild=function(t){var n=this;o.forEach(this.node_.children,function(r,i){t(new e(r,n,i))})};e.prototype.forEachDescendant=function(e,t,n){t&&!n&&e(this);this.forEachChild(function(t){t.forEachDescendant(e,true,n)});t&&n&&e(this)};e.prototype.forEachAncestor=function(e,t){var n=t?this:this.parent();while(null!==n){if(e(n))return true;n=n.parent()}return false};e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})};e.prototype.path=function(){return new G(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)};e.prototype.name=function(){return this.name_};e.prototype.parent=function(){return this.parent_};e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)};e.prototype.updateChild_=function(e,t){var n=t.isEmpty();var r=o.contains(this.node_.children,e);if(n&&r){delete this.node_.children[e];this.node_.childCount--;this.updateParents_()}else if(!n&&!r){this.node_.children[e]=t.node_;this.node_.childCount++;this.updateParents_()}};return e}();var br;(function(e){e[e["RUN"]=0]="RUN";e[e["SENT"]=1]="SENT";e[e["COMPLETED"]=2]="COMPLETED";e[e["SENT_NEEDS_ABORT"]=3]="SENT_NEEDS_ABORT";e[e["NEEDS_ABORT"]=4]="NEEDS_ABORT"})(br||(br={}));pr.MAX_TRANSACTION_RETRIES_=25;pr.prototype.transactions_init_=function(){this.transactionQueueTree_=new mr};pr.prototype.startTransaction=function(e,t,n,r){this.log_("transaction on "+e);var i=function(){};var a=new gr(this,e);a.on("value",i);var s=function(){a.off("value",i)};var u={path:e,update:t,onComplete:n,status:null,order:v(),applyLocally:r,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null};var c=this.getLatestState_(e);u.currentInputSnapshot=c;var l=u.update(c.val());if(void 0===l){u.unwatcher();u.currentOutputSnapshotRaw=null;u.currentOutputSnapshotResolved=null;if(u.onComplete){var h=new dt(u.currentInputSnapshot,new gr(this,u.path),Ge);u.onComplete(null,false,h)}}else{ye("transaction failed: Data returned ",l,u.path);u.status=br.RUN;var f=this.transactionQueueTree_.subTree(e);var p=f.getValue()||[];p.push(u);f.setValue(p);var d=void 0;if("object"===typeof l&&null!==l&&o.contains(l,".priority")){d=o.safeGet(l,".priority");o.assert(de(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")}else{var y=this.serverSyncTree_.calcCompleteEventCache(e)||at.EMPTY_NODE;d=y.getPriority().val()}d=d;var g=this.generateServerValues();var _=lt(l,d);var m=Ct(_,g);u.currentOutputSnapshotRaw=_;u.currentOutputSnapshotResolved=m;u.currentWriteId=this.getNextWriteId_();var b=this.serverSyncTree_.applyUserOverwrite(e,m,u.currentWriteId,u.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,b);this.sendReadyTransactions_()}};pr.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||at.EMPTY_NODE};pr.prototype.sendReadyTransactions_=function(e){var t=this;void 0===e&&(e=this.transactionQueueTree_);e||this.pruneCompletedTransactionsBelowNode_(e);if(null!==e.getValue()){var n=this.buildTransactionQueue_(e);o.assert(n.length>0,"Sending zero length transaction queue");var r=n.every(function(e){return e.status===br.RUN});r&&this.sendTransactionQueue_(e.path(),n)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})};pr.prototype.sendTransactionQueue_=function(e,t){var n=this;var r=t.map(function(e){return e.currentWriteId});var i=this.getLatestState_(e,r);var a=i;var s=i.hash();for(var u=0;u<t.length;u++){var c=t[u];o.assert(c.status===br.RUN,"tryToSendTransactionQueue_: items in queue should all be run.");c.status=br.SENT;c.retryCount++;var l=G.relativePath(e,c.path);a=a.updateChild(l,c.currentOutputSnapshotRaw)}var h=a.val(true);var f=e;this.server_.put(f.toString(),h,function(r){n.log_("transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){var o=[];for(var a=0;a<t.length;a++){t[a].status=br.COMPLETED;i=i.concat(n.serverSyncTree_.ackUserWrite(t[a].currentWriteId));if(t[a].onComplete){var s=t[a].currentOutputSnapshotResolved;var u=new gr(n,t[a].path);var c=new dt(s,u,Ge);o.push(t[a].onComplete.bind(null,null,true,c))}t[a].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(e));n.sendReadyTransactions_();n.eventQueue_.raiseEventsForChangedPath(e,i);for(var a=0;a<o.length;a++)V(o[a])}else{if("datastale"===r)for(var a=0;a<t.length;a++)t[a].status===br.SENT_NEEDS_ABORT?t[a].status=br.NEEDS_ABORT:t[a].status=br.RUN;else{I("transaction at "+f.toString()+" failed: "+r);for(var a=0;a<t.length;a++){t[a].status=br.NEEDS_ABORT;t[a].abortReason=r}}n.rerunTransactions_(e)}},s)};pr.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e);var n=t.path();var r=this.buildTransactionQueue_(t);this.rerunTransactionQueue_(r,n);return n};pr.prototype.rerunTransactionQueue_=function(e,t){if(0===e.length)return;var n=[];var r=[];var i=e.filter(function(e){return e.status===br.RUN});var a=i.map(function(e){return e.currentWriteId});for(var s=0;s<e.length;s++){var u=e[s];var c=G.relativePath(t,u.path);var l=false,h=void 0;o.assert(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null.");if(u.status===br.NEEDS_ABORT){l=true;h=u.abortReason;r=r.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,true))}else if(u.status===br.RUN)if(u.retryCount>=pr.MAX_TRANSACTION_RETRIES_){l=true;h="maxretry";r=r.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,true))}else{var f=this.getLatestState_(u.path,a);u.currentInputSnapshot=f;var p=e[s].update(f.val());if(void 0!==p){ye("transaction failed: Data returned ",p,u.path);var d=lt(p);var v="object"===typeof p&&null!=p&&o.contains(p,".priority");v||(d=d.updatePriority(f.getPriority()));var y=u.currentWriteId;var g=this.generateServerValues();var _=Ct(d,g);u.currentOutputSnapshotRaw=d;u.currentOutputSnapshotResolved=_;u.currentWriteId=this.getNextWriteId_();a.splice(a.indexOf(y),1);r=r.concat(this.serverSyncTree_.applyUserOverwrite(u.path,_,u.currentWriteId,u.applyLocally));r=r.concat(this.serverSyncTree_.ackUserWrite(y,true))}else{l=true;h="nodata";r=r.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,true))}}this.eventQueue_.raiseEventsForChangedPath(t,r);r=[];if(l){e[s].status=br.COMPLETED;(function(e){setTimeout(e,Math.floor(0))})(e[s].unwatcher);if(e[s].onComplete)if("nodata"===h){var m=new gr(this,e[s].path);var b=e[s].currentInputSnapshot;var w=new dt(b,m,Ge);n.push(e[s].onComplete.bind(null,null,false,w))}else n.push(e[s].onComplete.bind(null,new Error(h),false,null))}}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(var s=0;s<n.length;s++)V(n[s]);this.sendReadyTransactions_()};pr.prototype.getAncestorTransactionNode_=function(e){var t;var n=this.transactionQueueTree_;while(null!==(t=e.getFront())&&null===n.getValue()){n=n.subTree(t);e=e.popFront()}return n};pr.prototype.buildTransactionQueue_=function(e){var t=[];this.aggregateTransactionQueuesForNode_(e,t);t.sort(function(e,t){return e.order-t.order});return t};pr.prototype.aggregateTransactionQueuesForNode_=function(e,t){var n=this;var r=e.getValue();if(null!==r)for(var i=0;i<r.length;i++)t.push(r[i]);e.forEachChild(function(e){n.aggregateTransactionQueuesForNode_(e,t)})};pr.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this;var n=e.getValue();if(n){var r=0;for(var i=0;i<n.length;i++)if(n[i].status!==br.COMPLETED){n[r]=n[i];r++}n.length=r;e.setValue(n.length>0?n:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})};pr.prototype.abortTransactions_=function(e){var t=this;var n=this.getAncestorTransactionNode_(e).path();var r=this.transactionQueueTree_.subTree(e);r.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)});this.abortTransactionsOnNode_(r);r.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)});return n};pr.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){var n=[];var r=[];var i=-1;for(var a=0;a<t.length;a++)if(t[a].status===br.SENT_NEEDS_ABORT);else if(t[a].status===br.SENT){o.assert(i===a-1,"All SENT items should be at beginning of queue.");i=a;t[a].status=br.SENT_NEEDS_ABORT;t[a].abortReason="set"}else{o.assert(t[a].status===br.RUN,"Unexpected transaction status in abort");t[a].unwatcher();r=r.concat(this.serverSyncTree_.ackUserWrite(t[a].currentWriteId,true));if(t[a].onComplete){var s=null;n.push(t[a].onComplete.bind(null,new Error("set"),false,s))}}-1===i?e.setValue(null):t.length=i+1;this.eventQueue_.raiseEventsForChangedPath(e.path(),r);for(var a=0;a<n.length;a++)V(n[a])}};var wr="databaseURL";var Er;var Tr=function(){function e(){this.repos_={};this.useRestClient_=false}e.getInstance=function(){Er||(Er=new e);return Er};e.prototype.interrupt=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].interrupt()};e.prototype.resume=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].resume()};e.prototype.databaseFromApp=function(e,t){var n=t||e.options[wr];void 0===n&&S("Can't determine Firebase Database URL.  Be sure to include "+wr+" option when calling firebase.initializeApp().");var r=ae(n);var i=r.repoInfo;Ie("Invalid Firebase Database URL",1,r);r.path.isEmpty()||S("Database URL must point to the root of a Firebase Database (not including a child path).");var o=this.createRepo(i,e);return o.database};e.prototype.deleteRepo=function(e){var t=o.safeGet(this.repos_,e.app.name);t&&o.safeGet(t,e.repoInfo_.toURLString())===e||S("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted.");e.interrupt();delete t[e.repoInfo_.toURLString()]};e.prototype.createRepo=function(e,t){var n=o.safeGet(this.repos_,t.name);if(!n){n={};this.repos_[t.name]=n}var r=o.safeGet(n,e.toURLString());r&&S("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");r=new pr(e,this.useRestClient_,t);n[e.toURLString()]=r;return r};e.prototype.forceRestClient=function(e){this.useRestClient_=e};return e}();var Sr=function(){function e(e){this.repo_=e;e instanceof pr||S("Don't call new Database() directly - please use firebase.database().");this.root_=new gr(e,G.Empty);this.INTERNAL=new Ir(this)}Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:true,configurable:true});e.prototype.ref=function(e){this.checkDeleted_("ref");o.validateArgCount("database.ref",0,1,arguments.length);if(e instanceof gr)return this.refFromURL(e.toString());return void 0!==e?this.root_.child(e):this.root_};e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t);o.validateArgCount(t,1,1,arguments.length);var n=ae(e);Ie(t,1,n);var r=n.repoInfo;r.host!==this.repo_.repoInfo_.host&&S(t+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")");return this.ref(n.path.toString())};e.prototype.checkDeleted_=function(e){null===this.repo_&&S("Cannot call "+e+" on a deleted database.")};e.prototype.goOffline=function(){o.validateArgCount("database.goOffline",0,0,arguments.length);this.checkDeleted_("goOffline");this.repo_.interrupt()};e.prototype.goOnline=function(){o.validateArgCount("database.goOnline",0,0,arguments.length);this.checkDeleted_("goOnline");this.repo_.resume()};e.ServerValue={TIMESTAMP:{".sv":"timestamp"}};return e}();var Ir=function(){function e(e){this.database=e}e.prototype.delete=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){this.database.checkDeleted_("delete");Tr.getInstance().deleteRepo(this.database.repo_);this.database.repo_=null;this.database.root_=null;this.database.INTERNAL=null;this.database=null;return[2]})})};return e}();var Cr=function(){jn.forceDisallow();Ln.forceAllow()};var Or=function(){Ln.forceDisallow()};var Nr=function(){return jn["isAvailable"]()};var Ar=function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t};var Dr=function(e,t){e.repo.stats(t)};var Rr=function(e,t){e.repo.statsIncrementCounter(t)};var Pr=function(e){return e.repo.dataUpdateCount};var kr=function(e,t){return e.repo.interceptServerData_(t)};var Lr=Object.freeze({forceLongPolling:Cr,forceWebSockets:Or,isWebSocketsAvailable:Nr,setSecurityDebugCallback:Ar,stats:Dr,statsIncrementCounter:Rr,dataUpdateCount:Pr,interceptServerData:kr});var xr=lr;lr.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)};lr.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Mr=tr;var Ur=function(e){var t=lr.prototype.put;lr.prototype.put=function(n,r,i,o){void 0!==o&&(o=e());t.call(this,n,r,i,o)};return function(){lr.prototype.put=t}};var Fr=re;var jr=function(e){return e.queryIdentifier()};var Br=function(e){return e.repo.persistentConnection_.listens_};var Wr=function(e){Tr.getInstance().forceRestClient(e)};var qr=Object.freeze({DataConnection:xr,RealTimeConnection:Mr,hijackHash:Ur,ConnectionTarget:Fr,queryIdentifier:jr,listens:Br,forceRestClient:Wr});var Vr=Sr.ServerValue;function Hr(t){var n=t.INTERNAL.registerService("database",function(e,t,n){return Tr.getInstance().databaseFromApp(e,n)},{Reference:gr,Query:bt,Database:Sr,enableLogging:b,INTERNAL:Lr,ServerValue:Vr,TEST_ACCESS:qr},null,true);o.isNodeSdk()&&(e.exports=n)}Hr(u);t.registerDatabase=Hr;t.Database=Sr;t.Query=bt;t.Reference=gr;t.enableLogging=b;t.ServerValue=Vr;t.DataSnapshot=dt;t.OnDisconnect=Oe}).call(t,n(39))},1535:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});n.d(t,"setLogLevel",function(){return u});n.d(t,"Logger",function(){return s});n.d(t,"LogLevel",function(){return i});var r=[];var i;(function(e){e[e["DEBUG"]=0]="DEBUG";e[e["VERBOSE"]=1]="VERBOSE";e[e["INFO"]=2]="INFO";e[e["WARN"]=3]="WARN";e[e["ERROR"]=4]="ERROR";e[e["SILENT"]=5]="SILENT"})(i||(i={}));var o=i.INFO;var a=function(e,t){var n=[];for(var r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(t<e.logLevel)return;var o=(new Date).toISOString();switch(t){case i.DEBUG:console.log.apply(console,["["+o+"]  "+e.name+":"].concat(n));break;case i.VERBOSE:console.log.apply(console,["["+o+"]  "+e.name+":"].concat(n));break;case i.INFO:console.info.apply(console,["["+o+"]  "+e.name+":"].concat(n));break;case i.WARN:console.warn.apply(console,["["+o+"]  "+e.name+":"].concat(n));break;case i.ERROR:console.error.apply(console,["["+o+"]  "+e.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}};var s=function(){function e(e){this.name=e;this._logLevel=o;this._logHandler=a;r.push(this)}Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:true,configurable:true});e.prototype.debug=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.DEBUG].concat(e))};e.prototype.log=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.VERBOSE].concat(e))};e.prototype.info=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.INFO].concat(e))};e.prototype.warn=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.WARN].concat(e))};e.prototype.error=function(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.ERROR].concat(e))};return e}();function u(e){r.forEach(function(t){t.logLevel=e})}},1536:function(e,t,n){n(1537)},1537:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});n.d(t,"registerMessaging",function(){return W});var r=n(405);var i=n.n(r);var o=n(406);var a=n(215);var s={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",TOKEN_UNSUBSCRIBE_FAILED:"token-unsubscribe-failed",TOKEN_UPDATE_FAILED:"token-update-failed",TOKEN_UPDATE_NO_TOKEN:"token-update-no-token",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key",INVALID_PUBLIC_VAPID_KEY:"invalid-public-vapid-key",USE_PUBLIC_KEY_BEFORE_GET_TOKEN:"use-public-key-before-get-token",PUBLIC_KEY_DECRYPTION_FAILED:"public-vapid-key-decryption-failed"};var u=(l={},l[s.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",l[s.AVAILABLE_IN_SW]="This method is available in a service worker context.",l[s.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",l[s.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",l[s.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",l[s.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",l[s.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",l[s.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",l[s.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",l[s.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",l[s.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",l[s.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",l[s.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",l[s.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",l[s.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",l[s.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",l[s.TOKEN_UNSUBSCRIBE_FAILED]="A problem occured while unsubscribing the user from FCM: {$message}",l[s.TOKEN_UPDATE_FAILED]="A problem occured while updating the user from FCM: {$message}",l[s.TOKEN_UPDATE_NO_TOKEN]="FCM returned no token when updating the user to push.",l[s.USE_SW_BEFORE_GET_TOKEN]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",l[s.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",l[s.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",l[s.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",l[s.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",l[s.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",l[s.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",l[s.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",l[s.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",l[s.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",l[s.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",l[s.BAD_SCOPE]="The service worker scope must be a string with at least one character.",l[s.BAD_VAPID_KEY]="The public VAPID key is not a Uint8Array with 65 bytes.",l[s.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",l[s.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",l[s.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",l[s.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",l[s.INVALID_PUBLIC_VAPID_KEY]="The public VAPID key must be a string.",l[s.PUBLIC_KEY_DECRYPTION_FAILED]="The public VAPID key did not equal 65 bytes when decrypted.",l);var c=new r["ErrorFactory"]("messaging","Messaging",u);var l;var h=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]);var f="https://fcm.googleapis.com";var p;(function(e){e["TYPE_OF_MSG"]="firebase-messaging-msg-type";e["DATA"]="firebase-messaging-msg-data"})(p||(p={}));var d;(function(e){e["PUSH_MSG_RECEIVED"]="push-msg-received";e["NOTIFICATION_CLICKED"]="notification-clicked"})(d||(d={}));function v(e,t){if(null==e||null==t)return false;if(e===t)return true;if(e.byteLength!==t.byteLength)return false;var n=new DataView(e);var r=new DataView(t);for(var i=0;i<e.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return false;return true}function y(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(null,t))}function g(e){var t=y(e);return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var _=function(){function e(){}e.prototype.getToken=function(e,t,n){return Object(o["__awaiter"])(this,void 0,void 0,function(){var r,i,a,u,l,p,d,v,y,_;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:r=g(t.getKey("p256dh"));i=g(t.getKey("auth"));a="authorized_entity="+e+"&endpoint="+t.endpoint+"&encryption_key="+r+"&encryption_auth="+i;if(n!==h){u=g(n);a+="&application_pub_key="+u}l=new Headers;l.append("Content-Type","application/x-www-form-urlencoded");p={method:"POST",headers:l,body:a};o.label=1;case 1:o.trys.push([1,4,,5]);return[4,fetch(f+"/fcm/connect/subscribe",p)];case 2:v=o.sent();return[4,v.json()];case 3:d=o.sent();return[3,5];case 4:y=o.sent();throw c.create(s.TOKEN_SUBSCRIBE_FAILED);case 5:if(d.error){_=d.error.message;throw c.create(s.TOKEN_SUBSCRIBE_FAILED,{message:_})}if(!d.token)throw c.create(s.TOKEN_SUBSCRIBE_NO_TOKEN);if(!d.pushSet)throw c.create(s.TOKEN_SUBSCRIBE_NO_PUSH_SET);return[2,{token:d.token,pushSet:d.pushSet}]}})})};e.prototype.updateToken=function(e,t,n,r,i){return Object(o["__awaiter"])(this,void 0,void 0,function(){var a,u,l,p,d,v,y,_,m,b;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:a=g(r.getKey("p256dh"));u=g(r.getKey("auth"));l="push_set="+n+"&token="+t+"&authorized_entity="+e+"&endpoint="+r.endpoint+"&encryption_key="+a+"&encryption_auth="+u;if(i!==h){p=g(i);l+="&application_pub_key="+p}d=new Headers;d.append("Content-Type","application/x-www-form-urlencoded");v={method:"POST",headers:d,body:l};o.label=1;case 1:o.trys.push([1,4,,5]);return[4,fetch(f+"/fcm/connect/subscribe",v)];case 2:_=o.sent();return[4,_.json()];case 3:y=o.sent();return[3,5];case 4:m=o.sent();throw c.create(s.TOKEN_UPDATE_FAILED);case 5:if(y.error){b=y.error.message;throw c.create(s.TOKEN_UPDATE_FAILED,{message:b})}if(!y.token)throw c.create(s.TOKEN_UPDATE_NO_TOKEN);return[2,y.token]}})})};e.prototype.deleteToken=function(e,t,n){return Object(o["__awaiter"])(this,void 0,void 0,function(){var r,i,a,u,l,h,p;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:r="authorized_entity="+e+"&token="+t+"&pushSet="+n;i=new Headers;i.append("Content-Type","application/x-www-form-urlencoded");a={method:"POST",headers:i,body:r};o.label=1;case 1:o.trys.push([1,4,,5]);return[4,fetch(f+"/fcm/connect/unsubscribe",a)];case 2:u=o.sent();return[4,u.json()];case 3:l=o.sent();if(l.error){h=l.error.message;throw c.create(s.TOKEN_UNSUBSCRIBE_FAILED,{message:h})}return[3,5];case 4:p=o.sent();throw c.create(s.TOKEN_UNSUBSCRIBE_FAILED);case 5:return[2]}})})};return e}();function m(e){var t="=".repeat((4-e.length%4)%4);var n=(e+t).replace(/\-/g,"+").replace(/_/g,"/");var r=window.atob(n);var i=new Uint8Array(r.length);for(var o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}var b="undefined";var w="fcm_token_object_Store";function E(e){if(!e.objectStoreNames.contains(w))return;var t=e.transaction(w);var n=t.objectStore(w);var r=new _;var i=n.openCursor();i.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)};i.onsuccess=function(){var t=i.result;if(t){var n=t.value;r.deleteToken(n.fcmSenderId,n.fcmToken,n.fcmPushSet);t.continue()}else{e.close();indexedDB.deleteDatabase(b)}}}function T(){var e=indexedDB.open(b);e.onerror=function(e){};e.onsuccess=function(t){var n=e.result;E(n)}}var S=function(){function e(){this.dbPromise=null}e.prototype.get=function(e){return this.createTransaction(function(t){return t.get(e)})};e.prototype.getIndex=function(e,t){function n(n){var r=n.index(e);return r.get(t)}return this.createTransaction(n)};e.prototype.put=function(e){return this.createTransaction(function(t){return t.put(e)},"readwrite")};e.prototype.delete=function(e){return this.createTransaction(function(t){return t.delete(e)},"readwrite")};e.prototype.closeDatabase=function(){return Object(o["__awaiter"])(this,void 0,void 0,function(){var e;return Object(o["__generator"])(this,function(t){switch(t.label){case 0:if(!this.dbPromise)return[3,2];return[4,this.dbPromise];case 1:e=t.sent();e.close();this.dbPromise=null;t.label=2;case 2:return[2]}})})};e.prototype.createTransaction=function(e,t){return Object(o["__awaiter"])(this,void 0,void 0,function(){var n,r,i,a;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:return[4,this.getDb()];case 1:n=o.sent();r=n.transaction(this.objectStoreName,t);i=r.objectStore(this.objectStoreName);return[4,I(e(i))];case 2:a=o.sent();return[2,new Promise(function(e,t){r.oncomplete=function(){e(a)};r.onerror=function(){t(r.error)}})]}})})};e.prototype.getDb=function(){var e=this;this.dbPromise||(this.dbPromise=new Promise(function(t,n){var r=indexedDB.open(e.dbName,e.dbVersion);r.onsuccess=function(){t(r.result)};r.onerror=function(){e.dbPromise=null;n(r.error)};r.onupgradeneeded=function(t){return e.onDbUpgrade(r,t)}}));return this.dbPromise};return e}();function I(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)};e.onerror=function(){n(e.error)}})}var C=function(e){Object(o["__extends"])(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.dbName="fcm_token_details_db";t.dbVersion=3;t.objectStoreName="fcm_token_object_Store";return t}t.prototype.onDbUpgrade=function(e,t){var n=e.result;switch(t.oldVersion){case 0:var r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"});r.createIndex("fcmSenderId","fcmSenderId",{unique:false});r.createIndex("fcmToken","fcmToken",{unique:true});case 1:T();case 2:var r=e.transaction.objectStore(this.objectStoreName);var i=r.openCursor();i.onsuccess=function(){var e=i.result;if(e){var t=e.value;var n=Object(o["__assign"])({},t);t.createTime||(n.createTime=Date.now());"string"===typeof t.vapidKey&&(n.vapidKey=m(t.vapidKey));"string"===typeof t.auth&&(n.auth=m(t.auth).buffer);"string"===typeof t.auth&&(n.p256dh=m(t.p256dh).buffer);e.update(n);e.continue()}}}};t.prototype.getTokenDetailsFromToken=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){return Object(o["__generator"])(this,function(t){if(!e)throw c.create(s.BAD_TOKEN);O({fcmToken:e});return[2,this.getIndex("fcmToken",e)]})})};t.prototype.getTokenDetailsFromSWScope=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){return Object(o["__generator"])(this,function(t){if(!e)throw c.create(s.BAD_SCOPE);O({swScope:e});return[2,this.get(e)]})})};t.prototype.saveTokenDetails=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){return Object(o["__generator"])(this,function(t){if(!e.swScope)throw c.create(s.BAD_SCOPE);if(!e.vapidKey)throw c.create(s.BAD_VAPID_KEY);if(!e.endpoint||!e.auth||!e.p256dh)throw c.create(s.BAD_SUBSCRIPTION);if(!e.fcmSenderId)throw c.create(s.BAD_SENDER_ID);if(!e.fcmToken)throw c.create(s.BAD_TOKEN);if(!e.fcmPushSet)throw c.create(s.BAD_PUSH_SET);O(e);return[2,this.put(e)]})})};t.prototype.deleteToken=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var t;return Object(o["__generator"])(this,function(n){switch(n.label){case 0:if("string"!==typeof e||0===e.length)return[2,Promise.reject(c.create(s.INVALID_DELETE_TOKEN))];return[4,this.getTokenDetailsFromToken(e)];case 1:t=n.sent();if(!t)throw c.create(s.DELETE_TOKEN_NOT_FOUND);return[4,this.delete(t.swScope)];case 2:n.sent();return[2,t]}})})};return t}(S);function O(e){if(e.fcmToken&&("string"!==typeof e.fcmToken||0===e.fcmToken.length))throw c.create(s.BAD_TOKEN);if(e.swScope&&("string"!==typeof e.swScope||0===e.swScope.length))throw c.create(s.BAD_SCOPE);if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw c.create(s.BAD_VAPID_KEY);if(e.endpoint&&("string"!==typeof e.endpoint||0===e.endpoint.length))throw c.create(s.BAD_SUBSCRIPTION);if(e.auth&&!(e.auth instanceof ArrayBuffer))throw c.create(s.BAD_SUBSCRIPTION);if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw c.create(s.BAD_SUBSCRIPTION);if(e.fcmSenderId&&("string"!==typeof e.fcmSenderId||0===e.fcmSenderId.length))throw c.create(s.BAD_SENDER_ID);if(e.fcmPushSet&&("string"!==typeof e.fcmPushSet||0===e.fcmPushSet.length))throw c.create(s.BAD_PUSH_SET)}var N=65;var A=function(e){Object(o["__extends"])(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.dbName="fcm_vapid_details_db";t.dbVersion=1;t.objectStoreName="fcm_vapid_object_Store";return t}t.prototype.onDbUpgrade=function(e){var t=e.result;t.createObjectStore(this.objectStoreName,{keyPath:"swScope"})};t.prototype.getVapidFromSWScope=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var t;return Object(o["__generator"])(this,function(n){switch(n.label){case 0:if("string"!==typeof e||0===e.length)throw c.create(s.BAD_SCOPE);return[4,this.get(e)];case 1:t=n.sent();return[2,t?t.vapidKey:void 0]}})})};t.prototype.saveVapidDetails=function(e,t){return Object(o["__awaiter"])(this,void 0,void 0,function(){var n;return Object(o["__generator"])(this,function(r){if("string"!==typeof e||0===e.length)throw c.create(s.BAD_SCOPE);if(null===t||t.length!==N)throw c.create(s.BAD_VAPID_KEY);n={swScope:e,vapidKey:t};return[2,this.put(n)]})})};t.prototype.deleteVapidDetails=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var t;return Object(o["__generator"])(this,function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(e)];case 1:t=n.sent();if(!t)throw c.create(s.DELETE_SCOPE_NOT_FOUND);return[4,this.delete(e)];case 2:n.sent();return[2,t]}})})};return t}(S);var D="messagingSenderId";var R=6048e5;var P=function(){function e(e){var t=this;if(!e.options[D]||"string"!==typeof e.options[D])throw c.create(s.BAD_SENDER_ID);this.messagingSenderId=e.options[D];this.tokenDetailsModel=new C;this.vapidDetailsModel=new A;this.iidModel=new _;this.app=e;this.INTERNAL={delete:function(){return t.delete()}}}e.prototype.getToken=function(){return Object(o["__awaiter"])(this,void 0,void 0,function(){var e,t,n,r,i;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:e=this.getNotificationPermission_();if("granted"!==e){if("denied"===e)return[2,Promise.reject(c.create(s.NOTIFICATIONS_BLOCKED))];return[2,Promise.resolve(null)]}return[4,this.getSWRegistration_()];case 1:t=o.sent();return[4,this.getPublicVapidKey_()];case 2:n=o.sent();return[4,this.getPushSubscription(t,n)];case 3:r=o.sent();return[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(t.scope)];case 4:i=o.sent();if(i)return[2,this.manageExistingToken(t,r,n,i)];return[2,this.getNewToken(t,r,n)]}})})};e.prototype.manageExistingToken=function(e,t,n,r){return Object(o["__awaiter"])(this,void 0,void 0,function(){var i,a;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:i=k(t,n,r);if(i){a=Date.now();return a<r.createTime+R?[2,r.fcmToken]:[2,this.updateToken(e,t,n,r)]}return[4,this.deleteTokenFromDB(r.fcmToken)];case 1:o.sent();return[2,this.getNewToken(e,t,n)]}})})};e.prototype.updateToken=function(e,t,n,r){return Object(o["__awaiter"])(this,void 0,void 0,function(){var i,a,s;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:o.trys.push([0,4,,6]);return[4,this.iidModel.updateToken(this.messagingSenderId,r.fcmToken,r.fcmPushSet,t,n)];case 1:i=o.sent();a={swScope:e.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:i,fcmPushSet:r.fcmPushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")};return[4,this.tokenDetailsModel.saveTokenDetails(a)];case 2:o.sent();return[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:o.sent();return[2,i];case 4:s=o.sent();return[4,this.deleteToken(r.fcmToken)];case 5:o.sent();throw s;case 6:return[2]}})})};e.prototype.getNewToken=function(e,t,n){return Object(o["__awaiter"])(this,void 0,void 0,function(){var r,i;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,t,n)];case 1:r=o.sent();i={swScope:e.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:r.token,fcmPushSet:r.pushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")};return[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:o.sent();return[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:o.sent();return[2,r.token]}})})};e.prototype.deleteToken=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var t,n;return Object(o["__generator"])(this,function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(e)];case 1:r.sent();return[4,this.getSWRegistration_()];case 2:t=r.sent();if(!t)return[3,4];return[4,t.pushManager.getSubscription()];case 3:n=r.sent();if(n)return[2,n.unsubscribe()];r.label=4;case 4:return[2,true]}})})};e.prototype.deleteTokenFromDB=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var t;return Object(o["__generator"])(this,function(n){switch(n.label){case 0:return[4,this.tokenDetailsModel.deleteToken(e)];case 1:t=n.sent();return[4,this.iidModel.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet)];case 2:n.sent();return[2]}})})};e.prototype.getPushSubscription=function(e,t){return e.pushManager.getSubscription().then(function(n){if(n)return n;return e.pushManager.subscribe({userVisibleOnly:true,applicationServerKey:t})})};e.prototype.requestPermission=function(){throw c.create(s.AVAILABLE_IN_WINDOW)};e.prototype.useServiceWorker=function(e){throw c.create(s.AVAILABLE_IN_WINDOW)};e.prototype.usePublicVapidKey=function(e){throw c.create(s.AVAILABLE_IN_WINDOW)};e.prototype.onMessage=function(e,t,n){throw c.create(s.AVAILABLE_IN_WINDOW)};e.prototype.onTokenRefresh=function(e,t,n){throw c.create(s.AVAILABLE_IN_WINDOW)};e.prototype.setBackgroundMessageHandler=function(e){throw c.create(s.AVAILABLE_IN_SW)};e.prototype.delete=function(){return Object(o["__awaiter"])(this,void 0,void 0,function(){return Object(o["__generator"])(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:e.sent();return[2]}})})};e.prototype.getNotificationPermission_=function(){return Notification.permission};e.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel};e.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel};e.prototype.getIIDModel=function(){return this.iidModel};return e}();function k(e,t,n){if(!v(t.buffer,n.vapidKey.buffer))return false;var r=e.endpoint===n.endpoint;var i=v(e.getKey("auth"),n.auth);var o=v(e.getKey("p256dh"),n.p256dh);return r&&i&&o}var L="FCM_MSG";var x=function(e){Object(o["__extends"])(t,e);function t(t){var n=e.call(this,t)||this;n.bgMessageHandler=null;self.addEventListener("push",function(e){n.onPush(e)});self.addEventListener("pushsubscriptionchange",function(e){n.onSubChange(e)});self.addEventListener("notificationclick",function(e){n.onNotificationClick(e)});return n}t.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))};t.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))};t.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))};t.prototype.onPush_=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var t,n,r,i,a;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:if(!e.data)return[2];try{t=e.data.json()}catch(e){return[2]}return[4,this.hasVisibleClients_()];case 1:n=o.sent();if(n){if(t.notification||this.bgMessageHandler)return[2,this.sendMessageToWindowClients_(t)];return[2]}r=this.getNotificationData_(t);if(!r)return[3,3];i=r.title||"";return[4,this.getSWRegistration_()];case 2:a=o.sent();return[2,a.showNotification(i,r)];case 3:if(!this.bgMessageHandler)return[3,5];return[4,this.bgMessageHandler(t)];case 4:o.sent();return[2];case 5:return[2]}})})};t.prototype.onSubChange_=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var e,t,n,r,i;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:o.trys.push([0,2,,3]);return[4,this.getSWRegistration_()];case 1:e=o.sent();return[3,3];case 2:t=o.sent();throw c.create(s.UNABLE_TO_RESUBSCRIBE,{message:t});case 3:o.trys.push([3,5,,8]);return[4,e.pushManager.getSubscription()];case 4:o.sent();return[3,8];case 5:n=o.sent();r=this.getTokenDetailsModel();return[4,r.getTokenDetailsFromSWScope(e.scope)];case 6:i=o.sent();if(!i)throw n;return[4,this.deleteToken(i.fcmToken)];case 7:o.sent();throw n;case 8:return[2]}})})};t.prototype.onNotificationClick_=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var t,n,r,i;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:if(!e.notification||!e.notification.data||!e.notification.data[L])return[2];e.stopImmediatePropagation();e.notification.close();t=e.notification.data[L];if(!t.notification)return[2];n=t.notification.click_action;if(!n)return[2];return[4,this.getWindowClient_(n)];case 1:r=o.sent();if(!!r)return[3,3];return[4,self.clients.openWindow(n)];case 2:r=o.sent();return[3,5];case 3:return[4,r.focus()];case 4:r=o.sent();o.label=5;case 5:if(!r)return[2];delete t.notification;i=U(d.NOTIFICATION_CLICKED,t);return[2,this.attemptToMessageClient_(r,i)]}})})};t.prototype.getNotificationData_=function(e){if(!e)return;if("object"!==typeof e.notification)return;var t=Object(o["__assign"])({},e.notification);t.data=(n={},n[L]=e,n);return t;var n};t.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!==typeof e)throw c.create(s.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler=e};t.prototype.getWindowClient_=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var t,n,r,i,a;return Object(o["__generator"])(this,function(o){switch(o.label){case 0:t=new URL(e,self.location.href).href;return[4,M()];case 1:n=o.sent();r=null;for(i=0;i<n.length;i++){a=new URL(n[i].url,self.location.href).href;if(a===t){r=n[i];break}}return[2,r]}})})};t.prototype.attemptToMessageClient_=function(e,t){return Object(o["__awaiter"])(this,void 0,void 0,function(){return Object(o["__generator"])(this,function(n){if(!e)throw c.create(s.NO_WINDOW_CLIENT_TO_MSG);e.postMessage(t);return[2]})})};t.prototype.hasVisibleClients_=function(){return Object(o["__awaiter"])(this,void 0,void 0,function(){var e;return Object(o["__generator"])(this,function(t){switch(t.label){case 0:return[4,M()];case 1:e=t.sent();return[2,e.some(function(e){return"visible"===e.visibilityState})]}})})};t.prototype.sendMessageToWindowClients_=function(e){return Object(o["__awaiter"])(this,void 0,void 0,function(){var t=this;var n,r;return Object(o["__generator"])(this,function(i){switch(i.label){case 0:return[4,M()];case 1:n=i.sent();r=U(d.PUSH_MSG_RECEIVED,e);return[4,Promise.all(n.map(function(e){return t.attemptToMessageClient_(e,r)}))];case 2:i.sent();return[2]}})})};t.prototype.getSWRegistration_=function(){return Object(o["__awaiter"])(this,void 0,void 0,function(){return Object(o["__generator"])(this,function(e){return[2,self.registration]})})};t.prototype.getPublicVapidKey_=function(){return Object(o["__awaiter"])(this,void 0,void 0,function(){var e,t;return Object(o["__generator"])(this,function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:e=n.sent();if(!e)throw c.create(s.SW_REGISTRATION_EXPECTED);return[4,this.getVapidDetailsModel().getVapidFromSWScope(e.scope)];case 2:t=n.sent();if(null==t)return[2,h];return[2,t]}})})};return t}(P);function M(){return self.clients.matchAll({type:"window",includeUncontrolled:true})}function U(e,t){return n={},n[p.TYPE_OF_MSG]=e,n[p.DATA]=t,n;var n}var F="/firebase-messaging-sw.js";var j="/firebase-cloud-messaging-push-scope";var B=function(e){Object(o["__extends"])(t,e);function t(t){var n=e.call(this,t)||this;n.registrationToUse=null;n.publicVapidKeyToUse=null;n.manifestCheckPromise=null;n.messageObserver=null;n.tokenRefreshObserver=null;n.onMessageInternal=Object(r["createSubscribe"])(function(e){n.messageObserver=e});n.onTokenRefreshInternal=Object(r["createSubscribe"])(function(e){n.tokenRefreshObserver=e});n.setupSWMessageListener_();return n}t.prototype.getToken=function(){var t=this;if(!this.isSupported_())return Promise.reject(c.create(s.UNSUPPORTED_BROWSER));return this.manifestCheck_().then(function(){return e.prototype.getToken.call(t)})};t.prototype.manifestCheck_=function(){if(this.manifestCheckPromise)return this.manifestCheckPromise;var e=document.querySelector('link[rel="manifest"]');this.manifestCheckPromise=e?fetch(e.href).then(function(e){return e.json()}).catch(function(){}).then(function(e){if(!e)return;if(!e["gcm_sender_id"])return;if("103953800507"!==e["gcm_sender_id"])throw c.create(s.INCORRECT_GCM_SENDER_ID)}):Promise.resolve();return this.manifestCheckPromise};t.prototype.requestPermission=function(){return Object(o["__awaiter"])(this,void 0,void 0,function(){return Object(o["__generator"])(this,function(e){if("granted"===Notification.permission)return[2];return[2,new Promise(function(e,t){var n=function(n){return"granted"===n?e():t("denied"===n?c.create(s.PERMISSION_BLOCKED):c.create(s.PERMISSION_DEFAULT))};var r=Notification.requestPermission(n);r&&r.then(n)})]})})};t.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw c.create(s.SW_REGISTRATION_EXPECTED);if(null!=this.registrationToUse)throw c.create(s.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse=e};t.prototype.usePublicVapidKey=function(e){if("string"!==typeof e)throw c.create(s.INVALID_PUBLIC_VAPID_KEY);if(null!=this.publicVapidKeyToUse)throw c.create(s.USE_PUBLIC_KEY_BEFORE_GET_TOKEN);var t=m(e);if(65!==t.length)throw c.create(s.PUBLIC_KEY_DECRYPTION_FAILED);this.publicVapidKeyToUse=t};t.prototype.onMessage=function(e,t,n){return"function"===typeof e?this.onMessageInternal(e,t,n):this.onMessageInternal(e)};t.prototype.onTokenRefresh=function(e,t,n){return"function"===typeof e?this.onTokenRefreshInternal(e,t,n):this.onTokenRefreshInternal(e)};t.prototype.waitForRegistrationToActivate_=function(e){var t=e.installing||e.waiting||e.active;return new Promise(function(n,r){if(!t){r(c.create(s.NO_SW_IN_REG));return}if("activated"===t.state){n(e);return}if("redundant"===t.state){r(c.create(s.SW_REG_REDUNDANT));return}var i=function(){if("activated"===t.state)n(e);else{if("redundant"!==t.state)return;r(c.create(s.SW_REG_REDUNDANT))}t.removeEventListener("statechange",i)};t.addEventListener("statechange",i)})};t.prototype.getSWRegistration_=function(){var e=this;if(this.registrationToUse)return this.waitForRegistrationToActivate_(this.registrationToUse);this.registrationToUse=null;return navigator.serviceWorker.register(F,{scope:j}).catch(function(e){throw c.create(s.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:e.message})}).then(function(t){return e.waitForRegistrationToActivate_(t).then(function(){e.registrationToUse=t;t.update();return t})})};t.prototype.getPublicVapidKey_=function(){if(this.publicVapidKeyToUse)return Promise.resolve(this.publicVapidKeyToUse);return Promise.resolve(h)};t.prototype.setupSWMessageListener_=function(){var e=this;if(!("serviceWorker"in navigator))return;navigator.serviceWorker.addEventListener("message",function(t){if(!t.data||!t.data[p.TYPE_OF_MSG])return;var n=t.data;switch(n[p.TYPE_OF_MSG]){case d.PUSH_MSG_RECEIVED:case d.NOTIFICATION_CLICKED:var r=n[p.DATA];e.messageObserver&&e.messageObserver.next(r);break;default:break}},false)};t.prototype.isSupported_=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")};return t}(P);function W(e){var t="messaging";var n=function(e){if(self&&"ServiceWorkerGlobalScope"in self)return new x(e);return new B(e)};var r={Messaging:B};e.INTERNAL.registerService(t,n,r)}W(a["default"])},1538:function(e,t,n){n(1539)},1539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});n.d(t,"registerStorage",function(){return Dt});var r=n(215);var i="https://firebasestorage.googleapis.com";var o="https://firebasestorage.googleapis.com";var a="/v0";var s="/v0";var u="storageBucket";var c=12e4;var l=6e4;var h=-9007199254740991;var f=function(){function e(e,t){this.code_=d(e);this.message_="Firebase Storage: "+t;this.serverResponse_=null;this.name_="FirebaseError"}e.prototype.codeProp=function(){return this.code};e.prototype.codeEquals=function(e){return d(e)===this.codeProp()};e.prototype.serverResponseProp=function(){return this.serverResponse_};e.prototype.setServerResponseProp=function(e){this.serverResponse_=e};Object.defineProperty(e.prototype,"name",{get:function(){return this.name_},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"code",{get:function(){return this.code_},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"message",{get:function(){return this.message_},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:true,configurable:true});return e}();var p={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function d(e){return"storage/"+e}function v(){var e="An unknown error occurred, please check the error payload for server response.";return new f(p.UNKNOWN,e)}function y(e){return new f(p.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function g(e){return new f(p.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function _(){var e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new f(p.UNAUTHENTICATED,e)}function m(e){return new f(p.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function b(){return new f(p.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function w(){return new f(p.CANCELED,"User canceled the upload/download.")}function E(e){return new f(p.INVALID_URL,"Invalid URL '"+e+"'.")}function T(e){return new f(p.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function S(){return new f(p.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function I(){return new f(p.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function C(){return new f(p.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function O(e,t,n){return new f(p.INVALID_ARGUMENT,"Invalid argument in `"+t+"` at index "+e+": "+n)}function N(e,t,n,r){var i;var o;if(e===t){i=e;o=1===e?"argument":"arguments"}else{i="between "+e+" and "+t;o="arguments"}return new f(p.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}function A(){return new f(p.APP_DELETED,"The Firebase app was deleted.")}function D(e){return new f(p.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function R(e,t){return new f(p.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function P(e){throw new f(p.INTERNAL_ERROR,"Internal error: "+e)}var k={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function L(e){switch(e){case k.RAW:case k.BASE64:case k.BASE64URL:case k.DATA_URL:return;default:throw"Expected one of the event types: ["+k.RAW+", "+k.BASE64+", "+k.BASE64URL+", "+k.DATA_URL+"]."}}var x=function(){function e(e,t){this.data=e;this.contentType=t||null}return e}();function M(e,t){switch(e){case k.RAW:return new x(U(t));case k.BASE64:case k.BASE64URL:return new x(j(e,t));case k.DATA_URL:return new x(W(t),q(t))}throw v()}function U(e){var t=[];for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){var i=n<e.length-1&&56320==(64512&e.charCodeAt(n+1));if(i){var o=r;var a=e.charCodeAt(++n);r=65536|(1023&o)<<10|1023&a;t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function F(e){var t;try{t=decodeURIComponent(e)}catch(e){throw R(k.DATA_URL,"Malformed data URL.")}return U(t)}function j(e,t){switch(e){case k.BASE64:var n=-1!==t.indexOf("-");var r=-1!==t.indexOf("_");if(n||r){var i=n?"-":"_";throw R(e,"Invalid character '"+i+"' found: is it base64url encoded?")}break;case k.BASE64URL:var o=-1!==t.indexOf("+");var a=-1!==t.indexOf("/");if(o||a){var i=o?"+":"/";throw R(e,"Invalid character '"+i+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}var s;try{s=atob(t)}catch(t){throw R(e,"Invalid character found")}var u=new Uint8Array(s.length);for(var c=0;c<s.length;c++)u[c]=s.charCodeAt(c);return u}var B=function(){function e(e){this.base64=false;this.contentType=null;var t=e.match(/^data:([^,]+)?,/);if(null===t)throw R(k.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=t[1]||null;if(null!=n){this.base64=V(n,";base64");this.contentType=this.base64?n.substring(0,n.length-";base64".length):n}this.rest=e.substring(e.indexOf(",")+1)}return e}();function W(e){var t=new B(e);return t.base64?j(k.BASE64,t.rest):F(t.rest)}function q(e){var t=new B(e);return t.contentType}function V(e,t){var n=e.length>=t.length;if(!n)return false;return e.substring(e.length-t.length)===t}var H={STATE_CHANGED:"state_changed"};var K={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"};var G={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function z(e){switch(e){case K.RUNNING:case K.PAUSING:case K.CANCELING:return G.RUNNING;case K.PAUSED:return G.PAUSED;case K.SUCCESS:return G.SUCCESS;case K.CANCELED:return G.CANCELED;case K.ERROR:return G.ERROR;default:return G.ERROR}}function Q(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Y(e,t){for(var n in e)Q(e,n)&&t(n,e[n])}function X(e){if(null==e)return{};var t={};Y(e,function(e,n){t[e]=n});return t}function $(e){return new Promise(e)}function J(e){return Promise.resolve(e)}function Z(e){return Promise.reject(e)}function ee(e){return null!=e}function te(e){return void 0!==e}function ne(e){return"function"===typeof e}function re(e){return"object"===typeof e}function ie(e){return re(e)&&null!==e}function oe(e){return re(e)&&!Array.isArray(e)}function ae(e){return"string"===typeof e||e instanceof String}function se(e){return"number"===typeof e||e instanceof Number}function ue(e){return ce()&&e instanceof Blob}function ce(){return"undefined"!==typeof Blob}var le;(function(e){e[e["NO_ERROR"]=0]="NO_ERROR";e[e["NETWORK_ERROR"]=1]="NETWORK_ERROR";e[e["ABORT"]=2]="ABORT"})(le||(le={}));var he=function(){function e(){var e=this;this.sent_=false;this.xhr_=new XMLHttpRequest;this.errorCode_=le.NO_ERROR;this.sendPromise_=$(function(t,n){e.xhr_.addEventListener("abort",function(n){e.errorCode_=le.ABORT;t(e)});e.xhr_.addEventListener("error",function(n){e.errorCode_=le.NETWORK_ERROR;t(e)});e.xhr_.addEventListener("load",function(n){t(e)})})}e.prototype.send=function(e,t,n,r){var i=this;if(this.sent_)throw P("cannot .send() more than once");this.sent_=true;this.xhr_.open(t,e,true);if(ee(r)){var o=r;Y(o,function(e,t){i.xhr_.setRequestHeader(e,t.toString())})}ee(n)?this.xhr_.send(n):this.xhr_.send();return this.sendPromise_};e.prototype.getErrorCode=function(){if(!this.sent_)throw P("cannot .getErrorCode() before sending");return this.errorCode_};e.prototype.getStatus=function(){if(!this.sent_)throw P("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}};e.prototype.getResponseText=function(){if(!this.sent_)throw P("cannot .getResponseText() before sending");return this.xhr_.responseText};e.prototype.abort=function(){this.xhr_.abort()};e.prototype.getResponseHeader=function(e){return this.xhr_.getResponseHeader(e)};e.prototype.addUploadProgressListener=function(e){ee(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",e)};e.prototype.removeUploadProgressListener=function(e){ee(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",e)};return e}();var fe=function(){function e(){}e.prototype.createXhrIo=function(){return new he};return e}();function pe(e){var t;try{t=JSON.parse(e)}catch(e){return null}return oe(t)?t:null}var de=function(){function e(e,t){this.bucket=e;this.path_=t}Object.defineProperty(e.prototype,"path",{get:function(){return this.path_},enumerable:true,configurable:true});e.prototype.fullServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)};e.prototype.bucketOnlyServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o"};e.makeFromBucketSpec=function(t){var n;try{n=e.makeFromUrl(t)}catch(n){return new e(t,"")}if(""===n.path)return n;throw T(t)};e.makeFromUrl=function(t){var n=null;var r="([A-Za-z0-9.\\-]+)";function i(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}var o="(/(.*))?$";var a="(/([^?#]*).*)?$";var s=new RegExp("^gs://"+r+o,"i");var u={bucket:1,path:3};function c(e){e.path_=decodeURIComponent(e.path)}var l="v[A-Za-z0-9_]+";var h=new RegExp("^https?://firebasestorage\\.googleapis\\.com/"+l+"/b/"+r+"/o"+a,"i");var f={bucket:1,path:3};var p=[{regex:s,indices:u,postModify:i},{regex:h,indices:f,postModify:c}];for(var d=0;d<p.length;d++){var v=p[d];var y=v.regex.exec(t);if(y){var g=y[v.indices.bucket];var _=y[v.indices.path];_||(_="");n=new e(g,_);v.postModify(n);break}}if(null==n)throw E(t);return n};return e}();function ve(e){if(0==e.length)return null;var t=e.lastIndexOf("/");if(-1===t)return"";var n=e.slice(0,t);return n}function ye(e,t){var n=t.split("/").filter(function(e){return e.length>0}).join("/");return 0===e.length?n:e+"/"+n}function ge(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function _e(e){return i+a+e}function me(e){return o+a+e}function be(e){return i+s+e}function we(e){var t=encodeURIComponent;var n="?";Y(e,function(e,r){var i=t(e)+"="+t(r);n=n+i+"&"});n=n.slice(0,-1);return n}function Ee(e,t){return t}var Te=function(){function e(e,t,n,r){this.server=e;this.local=t||e;this.writable=!!n;this.xform=r||Ee}return e}();var Se=null;function Ie(e){var t=ae(e);if(!t||e.length<2)return e;e=e;return ge(e)}function Ce(){if(Se)return Se;var e=[];e.push(new Te("bucket"));e.push(new Te("generation"));e.push(new Te("metageneration"));e.push(new Te("name","fullPath",true));function t(e,t){return Ie(t)}var n=new Te("name");n.xform=t;e.push(n);function r(e,t){return ee(t)?+t:t}var i=new Te("size");i.xform=r;e.push(i);e.push(new Te("timeCreated"));e.push(new Te("updated"));e.push(new Te("md5Hash",null,true));e.push(new Te("cacheControl",null,true));e.push(new Te("contentDisposition",null,true));e.push(new Te("contentEncoding",null,true));e.push(new Te("contentLanguage",null,true));e.push(new Te("contentType",null,true));e.push(new Te("metadata","customMetadata",true));function o(e,t){var n=ae(t)&&t.length>0;if(!n)return[];var r=encodeURIComponent;var i=t.split(",");var o=i.map(function(t){var n=e["bucket"];var i=e["fullPath"];var o="/b/"+r(n)+"/o/"+r(i);var a=me(o);var s=we({alt:"media",token:t});return a+s});return o}e.push(new Te("downloadTokens","downloadURLs",false,o));Se=e;return Se}function Oe(e,t){function n(){var n=e["bucket"];var r=e["fullPath"];var i=new de(n,r);return t.makeStorageReference(i)}Object.defineProperty(e,"ref",{get:n})}function Ne(e,t,n){var r={};r["type"]="file";var i=n.length;for(var o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,t[a.server])}Oe(r,e);return r}function Ae(e,t,n){var r=pe(t);if(null===r)return null;var i=r;return Ne(e,i,n)}function De(e,t){var n={};var r=t.length;for(var i=0;i<r;i++){var o=t[i];o.writable&&(n[o.server]=e[o.local])}return JSON.stringify(n)}function Re(e){var t=e&&re(e);if(!t)throw"Expected Metadata object.";for(var n in e){var r=e[n];if("customMetadata"===n){if(!re(r))throw"Expected object for 'customMetadata' mapping."}else if(ie(r))throw"Mapping for '"+n+"' cannot be an object."}}function Pe(e,t,n){var r=t.length;var i=t.length;for(var o=0;o<t.length;o++)if(t[o].optional){r=o;break}var a=r<=n.length&&n.length<=i;if(!a)throw N(r,i,e,n.length);for(var o=0;o<n.length;o++)try{t[o].validator(n[o])}catch(t){throw t instanceof Error?O(o,e,t.message):O(o,e,t)}}var ke=function(){function e(e,t){var n=this;this.validator=function(t){if(n.optional&&!te(t))return;e(t)};this.optional=!!t}return e}();function Le(e,t){return function(n){e(n);t(n)}}function xe(e,t){function n(e){if(!ae(e))throw"Expected string."}var r;r=e?Le(n,e):n;return new ke(r,t)}function Me(){function e(e){var t=e instanceof Uint8Array||e instanceof ArrayBuffer||ce()&&e instanceof Blob;if(!t)throw"Expected Blob or File."}return new ke(e)}function Ue(e){return new ke(Re,e)}function Fe(){function e(e){var t=se(e)&&e>=0;if(!t)throw"Expected a number 0 or greater."}return new ke(e)}function je(e,t){function n(t){var n=null===t||ee(t)&&t instanceof Object;if(!n)throw"Expected an Object.";void 0!==e&&null!==e&&e(t)}return new ke(n,t)}function Be(e){function t(e){var t=null===e||ne(e);if(!t)throw"Expected a Function."}return new ke(t,e)}function We(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function qe(){var e=[];for(var t=0;t<arguments.length;t++)e[t]=arguments[t];var n=We();if(void 0!==n){var r=new n;for(var i=0;i<e.length;i++)r.append(e[i]);return r.getBlob()}if(ce())return new Blob(e);throw Error("This browser doesn't seem to support creating Blobs")}function Ve(e,t,n){if(e.webkitSlice)return e.webkitSlice(t,n);if(e.mozSlice)return e.mozSlice(t,n);if(e.slice)return e.slice(t,n);return null}var He=function(){function e(e,t){var n=0;var r="";if(ue(e)){this.data_=e;n=e.size;r=e.type}else if(e instanceof ArrayBuffer){if(t)this.data_=new Uint8Array(e);else{this.data_=new Uint8Array(e.byteLength);this.data_.set(new Uint8Array(e))}n=this.data_.length}else if(e instanceof Uint8Array){if(t)this.data_=e;else{this.data_=new Uint8Array(e.length);this.data_.set(e)}n=e.length}this.size_=n;this.type_=r}e.prototype.size=function(){return this.size_};e.prototype.type=function(){return this.type_};e.prototype.slice=function(t,n){if(ue(this.data_)){var r=this.data_;var i=Ve(r,t,n);if(null===i)return null;return new e(i)}var o=new Uint8Array(this.data_.buffer,t,n-t);return new e(o,true)};e.getBlob=function(){var t=[];for(var n=0;n<arguments.length;n++)t[n]=arguments[n];if(ce()){var r=t.map(function(t){return t instanceof e?t.data_:t});return new e(qe.apply(null,r))}var i=t.map(function(e){return ae(e)?M(k.RAW,e).data:e.data_});var o=0;i.forEach(function(e){o+=e.byteLength});var a=new Uint8Array(o);var s=0;i.forEach(function(e){for(var t=0;t<e.length;t++)a[s++]=e[t]});return new e(a,true)};e.prototype.uploadData=function(){return this.data_};return e}();function Ke(e,t){return-1!==e.indexOf(t)}function Ge(e){return Array.prototype.slice.call(e)}function ze(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}var Qe=function(){function e(e,t,n,r){this.url=e;this.method=t;this.handler=n;this.timeout=r;this.urlParams={};this.headers={};this.body=null;this.errorHandler=null;this.progressCallback=null;this.successCodes=[200];this.additionalRetryCodes=[]}return e}();function Ye(e){if(!e)throw v()}function Xe(e,t){function n(n,r){var i=Ae(e,r,t);Ye(null!==i);return i}return n}function $e(e){function t(t,n){var r;r=401===t.getStatus()?_():402===t.getStatus()?g(e.bucket):403===t.getStatus()?m(e.path):n;r.setServerResponseProp(n.serverResponseProp());return r}return t}function Je(e){var t=$e(e);function n(n,r){var i=t(n,r);404===n.getStatus()&&(i=y(e.path));i.setServerResponseProp(r.serverResponseProp());return i}return n}function Ze(e,t,n){var r=t.fullServerUrl();var i=_e(r);var o="GET";var a=e.maxOperationRetryTime();var s=new Qe(i,o,Xe(e,n),a);s.errorHandler=Je(t);return s}function et(e,t,n,r){var i=t.fullServerUrl();var o=_e(i);var a="PATCH";var s=De(n,r);var u={"Content-Type":"application/json; charset=utf-8"};var c=e.maxOperationRetryTime();var l=new Qe(o,a,Xe(e,r),c);l.headers=u;l.body=s;l.errorHandler=Je(t);return l}function tt(e,t){var n=t.fullServerUrl();var r=_e(n);var i="DELETE";var o=e.maxOperationRetryTime();function a(e,t){}var s=new Qe(r,i,a,o);s.successCodes=[200,204];s.errorHandler=Je(t);return s}function nt(e,t){return e&&e["contentType"]||t&&t.type()||"application/octet-stream"}function rt(e,t,n){var r=X(n);r["fullPath"]=e.path;r["size"]=t.size();r["contentType"]||(r["contentType"]=nt(null,t));return r}function it(e,t,n,r,i){var o=t.bucketOnlyServerUrl();var a={"X-Goog-Upload-Protocol":"multipart"};function s(){var e="";for(var t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}var u=s();a["Content-Type"]="multipart/related; boundary="+u;var c=rt(t,r,i);var l=De(c,n);var h="--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+l+"\r\n--"+u+"\r\nContent-Type: "+c["contentType"]+"\r\n\r\n";var f="\r\n--"+u+"--";var p=He.getBlob(h,r,f);if(null===p)throw S();var d={name:c["fullPath"]};var v=be(o);var y="POST";var g=e.maxUploadRetryTime();var _=new Qe(v,y,Xe(e,n),g);_.urlParams=d;_.headers=a;_.body=p.uploadData();_.errorHandler=$e(t);return _}var ot=function(){function e(e,t,n,r){this.current=e;this.total=t;this.finalized=!!n;this.metadata=r||null}return e}();function at(e,t){var n;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){Ye(false)}var r=t||["active"];Ye(Ke(r,n));return n}function st(e,t,n,r,i){var o=t.bucketOnlyServerUrl();var a=rt(t,r,i);var s={name:a["fullPath"]};var u=be(o);var c="POST";var l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a["contentType"],"Content-Type":"application/json; charset=utf-8"};var h=De(a,n);var f=e.maxUploadRetryTime();function p(e,t){at(e);var n;try{n=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){Ye(false)}Ye(ae(n));return n}var d=new Qe(u,c,p,f);d.urlParams=s;d.headers=l;d.body=h;d.errorHandler=$e(t);return d}function ut(e,t,n,r){var i={"X-Goog-Upload-Command":"query"};function o(e,t){var n=at(e,["active","final"]);var i;try{i=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){Ye(false)}var o=parseInt(i,10);Ye(!isNaN(o));return new ot(o,r.size(),"final"===n)}var a="POST";var s=e.maxUploadRetryTime();var u=new Qe(n,a,o,s);u.headers=i;u.errorHandler=$e(t);return u}var ct=262144;function lt(e,t,n,r,i,o,a,s){var u=new ot(0,0);if(a){u.current=a.current;u.total=a.total}else{u.current=0;u.total=r.size()}if(r.size()!==u.total)throw I();var c=u.total-u.current;var l=c;i>0&&(l=Math.min(l,i));var h=u.current;var f=h+l;var p=l===c?"upload, finalize":"upload";var d={"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":u.current};var v=r.slice(h,f);if(null===v)throw S();function y(e,n){var i=at(e,["active","final"]);var a=u.current+l;var s=r.size();var c;c="final"===i?Xe(t,o)(e,n):null;return new ot(a,s,"final"===i,c)}var g="POST";var _=t.maxUploadRetryTime();var m=new Qe(n,g,y,_);m.headers=d;m.body=v.uploadData();m.progressCallback=s||null;m.errorHandler=$e(e);return m}var ht=function(){function e(e,t,n){var r=ne(e)||ee(t)||ee(n);if(r){this.next=e;this.error=t||null;this.complete=n||null}else{var i=e;this.next=i.next||null;this.error=i.error||null;this.complete=i.complete||null}}return e}();var ft=function(){function e(e,t,n,r,i,o){this.bytesTransferred=e;this.totalBytes=t;this.state=n;this.metadata=r;this.task=i;this.ref=o}Object.defineProperty(e.prototype,"downloadURL",{get:function(){if(null!==this.metadata){var e=this.metadata["downloadURLs"];return null!=e&&null!=e[0]?e[0]:null}return null},enumerable:true,configurable:true});return e}();function pt(e){return function(){var t=[];for(var n=0;n<arguments.length;n++)t[n]=arguments[n];J(true).then(function(){e.apply(null,t)})}}var dt=function(){function e(e,t,n,r,i,o){void 0===o&&(o=null);var a=this;this.transferred_=0;this.needToFetchStatus_=false;this.needToFetchMetadata_=false;this.observers_=[];this.error_=null;this.uploadUrl_=null;this.request_=null;this.chunkMultiplier_=1;this.resolve_=null;this.reject_=null;this.ref_=e;this.authWrapper_=t;this.location_=n;this.blob_=i;this.metadata_=o;this.mappings_=r;this.resumable_=this.shouldDoResumable_(this.blob_);this.state_=K.RUNNING;this.errorHandler_=function(e){a.request_=null;a.chunkMultiplier_=1;if(e.codeEquals(p.CANCELED)){a.needToFetchStatus_=true;a.completeTransitions_()}else{a.error_=e;a.transition_(K.ERROR)}};this.metadataErrorHandler_=function(e){a.request_=null;if(e.codeEquals(p.CANCELED))a.completeTransitions_();else{a.error_=e;a.transition_(K.ERROR)}};this.promise_=$(function(e,t){a.resolve_=e;a.reject_=t;a.start_()});this.promise_.then(null,function(){})}e.prototype.makeProgressCallback_=function(){var e=this;var t=this.transferred_;return function(n,r){e.updateProgress_(t+n)}};e.prototype.shouldDoResumable_=function(e){return e.size()>262144};e.prototype.start_=function(){if(this.state_!==K.RUNNING)return;if(null!==this.request_)return;this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_()};e.prototype.resolveToken_=function(e){var t=this;this.authWrapper_.getAuthToken().then(function(n){switch(t.state_){case K.RUNNING:e(n);break;case K.CANCELING:t.transition_(K.CANCELED);break;case K.PAUSING:t.transition_(K.PAUSED);break;default:}})};e.prototype.createResumable_=function(){var e=this;this.resolveToken_(function(t){var n=st(e.authWrapper_,e.location_,e.mappings_,e.blob_,e.metadata_);var r=e.authWrapper_.makeRequest(n,t);e.request_=r;r.getPromise().then(function(t){e.request_=null;e.uploadUrl_=t;e.needToFetchStatus_=false;e.completeTransitions_()},e.errorHandler_)})};e.prototype.fetchStatus_=function(){var e=this;var t=this.uploadUrl_;this.resolveToken_(function(n){var r=ut(e.authWrapper_,e.location_,t,e.blob_);var i=e.authWrapper_.makeRequest(r,n);e.request_=i;i.getPromise().then(function(t){t=t;e.request_=null;e.updateProgress_(t.current);e.needToFetchStatus_=false;t.finalized&&(e.needToFetchMetadata_=true);e.completeTransitions_()},e.errorHandler_)})};e.prototype.continueUpload_=function(){var e=this;var t=ct*this.chunkMultiplier_;var n=new ot(this.transferred_,this.blob_.size());var r=this.uploadUrl_;this.resolveToken_(function(i){var o;try{o=lt(e.location_,e.authWrapper_,r,e.blob_,t,e.mappings_,n,e.makeProgressCallback_())}catch(t){e.error_=t;e.transition_(K.ERROR);return}var a=e.authWrapper_.makeRequest(o,i);e.request_=a;a.getPromise().then(function(t){e.increaseMultiplier_();e.request_=null;e.updateProgress_(t.current);if(t.finalized){e.metadata_=t.metadata;e.transition_(K.SUCCESS)}else e.completeTransitions_()},e.errorHandler_)})};e.prototype.increaseMultiplier_=function(){var e=ct*this.chunkMultiplier_;e<33554432&&(this.chunkMultiplier_*=2)};e.prototype.fetchMetadata_=function(){var e=this;this.resolveToken_(function(t){var n=Ze(e.authWrapper_,e.location_,e.mappings_);var r=e.authWrapper_.makeRequest(n,t);e.request_=r;r.getPromise().then(function(t){e.request_=null;e.metadata_=t;e.transition_(K.SUCCESS)},e.metadataErrorHandler_)})};e.prototype.oneShotUpload_=function(){var e=this;this.resolveToken_(function(t){var n=it(e.authWrapper_,e.location_,e.mappings_,e.blob_,e.metadata_);var r=e.authWrapper_.makeRequest(n,t);e.request_=r;r.getPromise().then(function(t){e.request_=null;e.metadata_=t;e.updateProgress_(e.blob_.size());e.transition_(K.SUCCESS)},e.errorHandler_)})};e.prototype.updateProgress_=function(e){var t=this.transferred_;this.transferred_=e;this.transferred_!==t&&this.notifyObservers_()};e.prototype.transition_=function(e){if(this.state_===e)return;switch(e){case K.CANCELING:this.state_=e;null!==this.request_&&this.request_.cancel();break;case K.PAUSING:this.state_=e;null!==this.request_&&this.request_.cancel();break;case K.RUNNING:var t=this.state_===K.PAUSED;this.state_=e;if(t){this.notifyObservers_();this.start_()}break;case K.PAUSED:this.state_=e;this.notifyObservers_();break;case K.CANCELED:this.error_=w();this.state_=e;this.notifyObservers_();break;case K.ERROR:this.state_=e;this.notifyObservers_();break;case K.SUCCESS:this.state_=e;this.notifyObservers_();break}};e.prototype.completeTransitions_=function(){switch(this.state_){case K.PAUSING:this.transition_(K.PAUSED);break;case K.CANCELING:this.transition_(K.CANCELED);break;case K.RUNNING:this.start_();break;default:break}};Object.defineProperty(e.prototype,"snapshot",{get:function(){var e=z(this.state_);return new ft(this.transferred_,this.blob_.size(),e,this.metadata_,this,this.ref_)},enumerable:true,configurable:true});e.prototype.on=function(e,t,n,r){void 0===t&&(t=void 0);void 0===n&&(n=void 0);void 0===r&&(r=void 0);function i(t){if(e!==H.STATE_CHANGED)throw"Expected one of the event types: ["+H.STATE_CHANGED+"]."}var o="Expected a function or an Object with one of `next`, `error`, `complete` properties.";var a=Be(true).validator;var s=je(null,true).validator;function u(e){try{a(e);return}catch(e){}try{s(e);var t=te(e["next"])||te(e["error"])||te(e["complete"]);if(!t)throw"";return}catch(e){throw o}}var c=[xe(i),je(u,true),Be(true),Be(true)];Pe("on",c,arguments);var l=this;function h(e){function t(t,n,i){null!==e&&Pe("on",e,arguments);var o=new ht(t,n,r);l.addObserver_(o);return function(){l.removeObserver_(o)}}return t}function f(e){if(null===e)throw o;u(e)}var p=[je(f),Be(true),Be(true)];var d=!(te(t)||te(n)||te(r));return d?h(p):h(null)(t,n,r)};e.prototype.then=function(e,t){return this.promise_.then(e,t)};e.prototype.catch=function(e){return this.then(null,e)};e.prototype.addObserver_=function(e){this.observers_.push(e);this.notifyObserver_(e)};e.prototype.removeObserver_=function(e){ze(this.observers_,e)};e.prototype.notifyObservers_=function(){var e=this;this.finishPromise_();var t=Ge(this.observers_);t.forEach(function(t){e.notifyObserver_(t)})};e.prototype.finishPromise_=function(){if(null!==this.resolve_){var e=true;switch(z(this.state_)){case G.SUCCESS:pt(this.resolve_.bind(null,this.snapshot))();break;case G.CANCELED:case G.ERROR:var t=this.reject_;pt(t.bind(null,this.error_))();break;default:e=false;break}if(e){this.resolve_=null;this.reject_=null}}};e.prototype.notifyObserver_=function(e){var t=z(this.state_);switch(t){case G.RUNNING:case G.PAUSED:null!==e.next&&pt(e.next.bind(e,this.snapshot))();break;case G.SUCCESS:null!==e.complete&&pt(e.complete.bind(e))();break;case G.CANCELED:case G.ERROR:null!==e.error&&pt(e.error.bind(e,this.error_))();break;default:null!==e.error&&pt(e.error.bind(e,this.error_))()}};e.prototype.resume=function(){Pe("resume",[],arguments);var e=this.state_===K.PAUSED||this.state_===K.PAUSING;e&&this.transition_(K.RUNNING);return e};e.prototype.pause=function(){Pe("pause",[],arguments);var e=this.state_===K.RUNNING;e&&this.transition_(K.PAUSING);return e};e.prototype.cancel=function(){Pe("cancel",[],arguments);var e=this.state_===K.RUNNING||this.state_===K.PAUSING;e&&this.transition_(K.CANCELING);return e};return e}();var vt=function(){function e(e,t){this.authWrapper=e;this.location=t instanceof de?t:de.makeFromUrl(t)}e.prototype.toString=function(){Pe("toString",[],arguments);return"gs://"+this.location.bucket+"/"+this.location.path};e.prototype.newRef=function(t,n){return new e(t,n)};e.prototype.mappings=function(){return Ce()};e.prototype.child=function(e){Pe("child",[xe()],arguments);var t=ye(this.location.path,e);var n=new de(this.location.bucket,t);return this.newRef(this.authWrapper,n)};Object.defineProperty(e.prototype,"parent",{get:function(){var e=ve(this.location.path);if(null===e)return null;var t=new de(this.location.bucket,e);return this.newRef(this.authWrapper,t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"root",{get:function(){var e=new de(this.location.bucket,"");return this.newRef(this.authWrapper,e)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fullPath",{get:function(){return this.location.path},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"name",{get:function(){return ge(this.location.path)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:true,configurable:true});e.prototype.put=function(e,t){void 0===t&&(t=null);Pe("put",[Me(),Ue(true)],arguments);this.throwIfRoot_("put");return new dt(this,this.authWrapper,this.location,this.mappings(),new He(e),t)};e.prototype.putString=function(e,t,n){void 0===t&&(t=k.RAW);Pe("putString",[xe(),xe(L,true),Ue(true)],arguments);this.throwIfRoot_("putString");var r=M(t,e);var i=X(n);!ee(i["contentType"])&&ee(r.contentType)&&(i["contentType"]=r.contentType);return new dt(this,this.authWrapper,this.location,this.mappings(),new He(r.data,true),i)};e.prototype.delete=function(){Pe("delete",[],arguments);this.throwIfRoot_("delete");var e=this;return this.authWrapper.getAuthToken().then(function(t){var n=tt(e.authWrapper,e.location);return e.authWrapper.makeRequest(n,t).getPromise()})};e.prototype.getMetadata=function(){Pe("getMetadata",[],arguments);this.throwIfRoot_("getMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(t){var n=Ze(e.authWrapper,e.location,e.mappings());return e.authWrapper.makeRequest(n,t).getPromise()})};e.prototype.updateMetadata=function(e){Pe("updateMetadata",[Ue()],arguments);this.throwIfRoot_("updateMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(n){var r=et(t.authWrapper,t.location,e,t.mappings());return t.authWrapper.makeRequest(r,n).getPromise()})};e.prototype.getDownloadURL=function(){Pe("getDownloadURL",[],arguments);this.throwIfRoot_("getDownloadURL");return this.getMetadata().then(function(e){var t=e["downloadURLs"][0];if(ee(t))return t;throw C()})};e.prototype.throwIfRoot_=function(e){if(""===this.location.path)throw D(e)};return e}();var yt=function(){function e(e){this.promise_=Z(e)}e.prototype.getPromise=function(){return this.promise_};e.prototype.cancel=function(e){void 0===e&&(e=false)};return e}();var gt=function(){function e(){this.map_={};this.id_=h}e.prototype.addRequest=function(e){var t=this.id_;this.id_++;this.map_[t]=e;var n=this;function r(){delete n.map_[t]}e.getPromise().then(r,r)};e.prototype.clear=function(){Y(this.map_,function(e,t){t&&t.cancel(true)});this.map_={}};return e}();var _t=function(){function e(t,n,r,i,o){this.bucket_=null;this.deleted_=false;this.app_=t;if(null!==this.app_){var a=this.app_.options;ee(a)&&(this.bucket_=e.extractBucket_(a))}this.storageRefMaker_=n;this.requestMaker_=r;this.pool_=o;this.service_=i;this.maxOperationRetryTime_=c;this.maxUploadRetryTime_=l;this.requestMap_=new gt}e.extractBucket_=function(e){var t=e[u]||null;if(null==t)return null;var n=de.makeFromBucketSpec(t);return n.bucket};e.prototype.getAuthToken=function(){return null!==this.app_&&ee(this.app_.INTERNAL)&&ee(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(e){return null!==e?e.accessToken:null},function(e){return null}):J(null)};e.prototype.bucket=function(){if(this.deleted_)throw A();return this.bucket_};e.prototype.service=function(){return this.service_};e.prototype.makeStorageReference=function(e){return this.storageRefMaker_(this,e)};e.prototype.makeRequest=function(e,t){if(this.deleted_)return new yt(A());var n=this.requestMaker_(e,t,this.pool_);this.requestMap_.addRequest(n);return n};e.prototype.deleteApp=function(){this.deleted_=true;this.app_=null;this.requestMap_.clear()};e.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_};e.prototype.setMaxUploadRetryTime=function(e){this.maxUploadRetryTime_=e};e.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_};e.prototype.setMaxOperationRetryTime=function(e){this.maxOperationRetryTime_=e};return e}();function mt(e,t,n){var r=1;var i=null;var o=false;var a=0;function s(){return 2===a}var u=false;function c(){if(!u){u=true;t.apply(null,arguments)}}function l(t){i=setTimeout(function(){i=null;e(h,s())},t)}function h(e){var t=[];for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(u)return;if(e){c.apply(null,arguments);return}var i=s()||o;if(i){c.apply(null,arguments);return}r<64&&(r*=2);var h;if(1===a){a=2;h=0}else h=1e3*(r+Math.random());l(h)}var f=false;function p(e){if(f)return;f=true;if(u)return;if(null!==i){e||(a=2);clearTimeout(i);l(0)}else e||(a=1)}l(0);setTimeout(function(){o=true;p(true)},n);return p}function bt(e){e(false)}var wt=function(){function e(e,t,n,r,i,o,a,s,u,c,l){this.pendingXhr_=null;this.backoffId_=null;this.resolve_=null;this.reject_=null;this.canceled_=false;this.appDelete_=false;this.url_=e;this.method_=t;this.headers_=n;this.body_=r;this.successCodes_=i.slice();this.additionalRetryCodes_=o.slice();this.callback_=a;this.errorCallback_=s;this.progressCallback_=c;this.timeout_=u;this.pool_=l;var h=this;this.promise_=$(function(e,t){h.resolve_=e;h.reject_=t;h.start_()})}e.prototype.start_=function(){var e=this;function t(t,n){if(n){t(false,new Et(false,null,true));return}var r=e.pool_.createXhrIo();e.pendingXhr_=r;function i(t){var n=t.loaded;var r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)}null!==e.progressCallback_&&r.addUploadProgressListener(i);r.send(e.url_,e.method_,e.body_,e.headers_).then(function(n){null!==e.progressCallback_&&n.removeUploadProgressListener(i);e.pendingXhr_=null;n=n;var r=n.getErrorCode()===le.NO_ERROR;var o=n.getStatus();if(!r||e.isRetryStatusCode_(o)){var a=n.getErrorCode()===le.ABORT;t(false,new Et(false,null,a));return}var s=Ke(e.successCodes_,o);t(true,new Et(s,n))})}function n(t,n){var r=e.resolve_;var i=e.reject_;var o=n.xhr;if(n.wasSuccessCode)try{var a=e.callback_(o,o.getResponseText());te(a)?r(a):r()}catch(e){i(e)}else if(null!==o){var s=v();s.setServerResponseProp(o.getResponseText());e.errorCallback_?i(e.errorCallback_(o,s)):i(s)}else if(n.canceled){var s=e.appDelete_?A():w();i(s)}else{var s=b();i(s)}}this.canceled_?n(false,new Et(false,null,true)):this.backoffId_=mt(t,n,this.timeout_)};e.prototype.getPromise=function(){return this.promise_};e.prototype.cancel=function(e){this.canceled_=true;this.appDelete_=e||false;null!==this.backoffId_&&bt(this.backoffId_);null!==this.pendingXhr_&&this.pendingXhr_.abort()};e.prototype.isRetryStatusCode_=function(e){var t=e>=500&&e<600;var n=[408,429];var r=Ke(n,e);var i=Ke(this.additionalRetryCodes_,e);return t||r||i};return e}();var Et=function(){function e(e,t,n){this.wasSuccessCode=e;this.xhr=t;this.canceled=!!n}return e}();function Tt(e,t){null!==t&&t.length>0&&(e["Authorization"]="Firebase "+t)}function St(e){var t="undefined"!==typeof r["default"]?r["default"].SDK_VERSION:"AppManager";e["X-Firebase-Storage-Version"]="webjs/"+t}function It(e,t,n){var r=we(e.urlParams);var i=e.url+r;var o=X(e.headers);Tt(o,t);St(o);return new wt(i,e.method,o,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n)}var Ct=function(){function e(e,t,n){this.bucket_=null;function r(e,t){return new vt(e,t)}this.authWrapper_=new _t(e,r,It,this,t);this.app_=e;if(null!=n)this.bucket_=de.makeFromBucketSpec(n);else{var i=this.authWrapper_.bucket();null!=i&&(this.bucket_=new de(i,""))}this.internals_=new Ot(this)}e.prototype.ref=function(e){function t(e){if(/^[A-Za-z]+:\/\//.test(e))throw"Expected child path but got a URL, use refFromURL instead."}Pe("ref",[xe(t,true)],arguments);if(null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var n=new vt(this.authWrapper_,this.bucket_);return null!=e?n.child(e):n};e.prototype.refFromURL=function(e){function t(e){if(!/^[A-Za-z]+:\/\//.test(e))throw"Expected full URL but got a child path, use ref instead.";try{de.makeFromUrl(e)}catch(e){throw"Expected valid full URL but got an invalid one."}}Pe("refFromURL",[xe(t,false)],arguments);return new vt(this.authWrapper_,e)};Object.defineProperty(e.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:true,configurable:true});e.prototype.setMaxUploadRetryTime=function(e){Pe("setMaxUploadRetryTime",[Fe()],arguments);this.authWrapper_.setMaxUploadRetryTime(e)};Object.defineProperty(e.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:true,configurable:true});e.prototype.setMaxOperationRetryTime=function(e){Pe("setMaxOperationRetryTime",[Fe()],arguments);this.authWrapper_.setMaxOperationRetryTime(e)};Object.defineProperty(e.prototype,"app",{get:function(){return this.app_},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:true,configurable:true});return e}();var Ot=function(){function e(e){this.service_=e}e.prototype.delete=function(){this.service_.authWrapper_.deleteApp();return J(void 0)};return e}();var Nt="storage";function At(e,t,n){return new Ct(e,new fe,n)}function Dt(e){var t={TaskState:G,TaskEvent:H,StringFormat:k,Storage:Ct,Reference:vt};e.INTERNAL.registerService(Nt,At,t,void 0,true)}Dt(r["default"])},1540:function(e,t,n){var r=n(1541);function i(e){return decodeURIComponent(r(e).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();n.length<2&&(n="0"+n);return"%"+n}))}e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return i(t)}catch(e){return r(t)}}},1541:function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(e){this.message=e}r.prototype=new Error;r.prototype.name="InvalidCharacterError";function i(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var i=0,o,a,s=0,u="";a=t.charAt(s++);~a&&(o=i%4?64*o+a:a,i++%4)?u+=String.fromCharCode(255&o>>(-2*i&6)):0)a=n.indexOf(a);return u}e.exports="undefined"!==typeof window&&window.atob&&window.atob.bind(window)||i},1546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}return function(t,n,r){n&&e(t.prototype,n);r&&e(t,r);return t}}();var o=n(6);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c={firebase:{apiKey:"",authDomain:"",databaseURL:"",storageBucket:""},hotjar:{site_id:""},algolia:{appid:""},iframely:{key:""},mixpanel:{token:""},intercom:{app_id:""},slack:{client_id:"",redirect_uri:""},ga:{spaces:{id:"",view_id:""},website:{id:""}},sentry:{url:""},stripe:{public_key:""},urls:{api:"",spaces:"",website:""},domains:{spaces:""},cdn:{blobsurl:""},clearbit:{public_key:""},version:""};var l=function(e){u(t,e);function t(){a(this,t);return s(this,e.apply(this,arguments))}t.deserialize=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(r({},n))};t.prototype.serialize=function e(){return this.toJSON()};i(t,[{key:"isProd",get:function e(){return Boolean(this.domains.spaces)}},{key:"isDev",get:function e(){return!this.isProd}}]);return t}((0,o.Record)(c));t.default=l},1547:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}return function(t,n,r){n&&e(t.prototype,n);r&&e(t,r);return t}}();var o=n(6);var a=n(27);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(e){c(t,e);function t(){s(this,t);return u(this,e.apply(this,arguments))}t.queryBySpace=function e(t){return this.query(["spaces",t,"pageRatings"])};t.queryByID=function e(t){var n=t.spaceID,r=t.pageID;return this.queryBySpace(n).doc(r)};t.getReadingScore=function e(t,n){var r=t/n*100;if(r>80)return 5;if(r>=60)return 4;if(r>=40)return 3;if(r>=20)return 2;return 1};t.getHealthScore=function e(t,n){if(!t)return n;if(!n)return t;return.6*t+.4*n};t.deserialize=function e(n){return new t(r({},n,{ratings:(0,o.List)(n.ratings),updatedAt:new Date(n.updatedAt)}))};t.prototype.serialize=function e(){var t=this.count,n=this.ratings,r=this.updatedAt;return{count:t,ratings:n.toArray(),updatedAt:r.getTime()}};i(t,[{key:"ratersCount",get:function e(){return this.ratings.reduce(function(e,t){return e+t},0)}},{key:"averageScore",get:function e(){var t=this.ratersCount;if(!t)return null;var n=this.ratings.reduce(function(e,t,n){return e+(n+1)*t},0);return n/t}},{key:"sentimentScore",get:function e(){var t=this.ratings.get(4);var n=this.ratings.get(0)+this.ratings.get(1);var r=this.ratersCount;return r>0?(t-n)/r:null}}]);return t}((0,a.DatabaseModel)("pageRating",{count:0,ratings:(0,o.List)([0,0,0,0,0]),updatedAt:new Date}));t.default=l},1548:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}return function(t,n,r){n&&e(t.prototype,n);r&&e(t,r);return t}}();var o=n(718);var a=n(27);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(e){c(t,e);function t(){s(this,t);return u(this,e.apply(this,arguments))}t.queryByID=function e(t){var n=t.spaceID,r=t.pageID,i=t.userID;return this.query(["spaces",n,"userPageRatings",r]).doc(i)};t.prototype.query=function e(n){var r=n.spaceID,i=n.pageID;return t.queryByID({spaceID:r,pageID:i,userID:this.userID})};t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n instanceof t)return n;return new t(r({},n,{createdAt:new Date(n.createdAt||Date.now())}))};t.deserialize=function e(n){return new t(r({},n,{createdAt:new Date(n.createdAt)}))};t.displayRatingToRating=function e(t){return{BAD:0,OK:2,GOOD:4}[t]};t.valueToDisplayRating=function e(t){return{0:"BAD",1:"BAD",2:"OK",3:"GOOD",4:"GOOD"}[t]};t.prototype.serialize=function e(){return{userID:this.userID,rating:this.rating,versionID:this.versionID,revisionID:this.revisionID,createdAt:this.createdAt.getTime()}};i(t,[{key:"createdBy",get:function e(){return this.userID}},{key:"displayRating",get:function e(){return t.valueToDisplayRating(this.rating)}}]);return t}((0,a.DatabaseModel)("userPageRating",{userID:"",rating:0,createdAt:new Date,versionID:"",revisionID:""}));t.default=l},1549:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(6);var o=n(27);var a=n(719);var s=u(a);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){h(t,e);function t(){c(this,t);return l(this,e.apply(this,arguments))}t.queryBySpace=function e(t){return this.query(["spaces",t,"slack"])};t.queryByTeam=function e(t){var n=t.spaceID,r=t.teamID;return this.queryBySpace(n).doc(r)};t.queryByRootTeam=function e(t){return this.query(["slack",t])};t.prototype.query=function e(){return t.queryByTeam({spaceID:this.spaceID,teamID:this.teamID})};t.prototype.rootQuery=function e(){return t.queryByRootTeam(this.teamID).doc(this.spaceID)};t.prototype.toCreateUpdate=function e(){return(new o.DatabaseUpdate).set(this.query(),this).set(this.rootQuery(),this)};t.prototype.toRemoveUpdate=function e(){return(new o.DatabaseUpdate).delete(this.query()).delete(t.query(["slack",this.teamID]).doc(this.spaceID))};t.prototype.removeChannel=function e(t){return this.merge({channels:this.channels.delete(t.channelID)})};t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(r({},n,{channels:(0,i.OrderedMap)(n.channels||{}).map(function(e){return s.default.create(e)}),createdAt:new Date(n.createdAt||Date.now())}))};t.deserialize=function e(n){return new t(r({},n,{channels:(0,i.OrderedMap)(n.channels||{}).map(function(e){return s.default.deserialize(e)}),createdAt:new Date(n.createdAt)}))};t.prototype.serialize=function e(){return{spaceID:this.spaceID,token:this.token,teamID:this.teamID,teamName:this.teamName,channels:this.channels.map(function(e){return e.serialize()}).toObject(),createdAt:this.createdAt.getTime()}};return t}((0,o.DatabaseModel)("slackIntegration",{spaceID:"",token:"",teamID:"",teamName:"",channels:(0,i.OrderedMap)(),createdAt:new Date}));t.default=f},1550:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(27);var o=n(582);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=function(e){l(t,e);function t(){u(this,t);return c(this,e.apply(this,arguments))}t.queryByOrg=function e(t){return this.query(["orgs",t]).doc("saml")};t.prototype.query=function e(n){return t.queryByOrg(n)};t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n instanceof t)return n;return new t(r({},n,{createdAt:new Date(n.createdAt||Date.now())}))};t.deserialize=function e(n){return t.create(n)};t.prototype.serialize=function e(){return{label:this.label,ssoURL:this.ssoURL,entityID:this.entityID,certificate:this.certificate,createdAt:this.createdAt.getTime()}};t.prototype.toUpdate=function e(t){return(new i.DatabaseUpdate).set(this.query(t),this).update(a.default.queryByID(t),{ssoSignInLabel:this.label})};t.prototype.toRemoveUpdate=function e(t){return(new i.DatabaseUpdate).delete(this.query(t)).update(a.default.queryByID(t),{ssoSignInLabel:null})};return t}((0,i.DatabaseModel)("samlIdP",{label:"",ssoURL:"",entityID:"",certificate:"",createdAt:new Date}));t.default=h},1551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(720);var o=n(27);var a=n(721);var s=l(a);var u=n(722);var c=l(u);function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=function(e){p(t,e);function t(){h(this,t);return f(this,e.apply(this,arguments))}t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(r({},n,{billingAddress:c.default.create(n.billingAddress),card:s.default.create(n.card),createdAt:new Date(n.createdAt||new Date),updatedAt:new Date(n.updatedAt||new Date)}))};t.queryByID=function e(t){return this.query("billingConfig").doc(t)};t.prototype.query=function e(){return t.queryByID(this.orgID)};t.deserialize=function e(n){return t.create(n)};t.prototype.isLegacyPlan=function e(){var t=this;return this.plan&&Boolean(i.LEGACY_PLANS.find(function(e){return e===t.plan}))};t.prototype.isUpgrade=function e(n){return t.isUpgrade(n.plan,this.plan)};t.prototype.isDowngrade=function e(n){return t.isDowngrade(n.plan,this.plan)};t.computeOvercharge=function e(t){var n=t.plan,r=t.members;var o=i.BILLING_SPEC[n];if(!o)return 0;var a=i.BILLING_SPEC[n].membersIncluded?r-i.BILLING_SPEC[n].membersIncluded:r;return a>0?a*o.priceByMemberMonthly:0};t.prototype.serialize=function e(){return{orgID:this.orgID,billingAddress:this.billingAddress.serialize(),activePlan:this.activePlan,plan:this.plan,customerID:this.customerID,subscriptionID:this.subscriptionID,cardID:this.cardID,token:this.token,card:this.card&&this.card.serialize(),coupon:this.coupon,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime(),error:this.error}};t.isUpgrade=function e(t,n){var r=i.PLANS.indexOf(t);var o=i.PLANS.indexOf(n);return o>r};t.isDowngrade=function e(t,n){var r=i.PLANS.indexOf(t);var o=i.PLANS.indexOf(n);return o<r};return t}((0,o.DatabaseModel)("billingConfig",{orgID:"",billingAddress:c.default.create(),plan:"free",activePlan:"free",customerID:null,subscriptionID:null,cardID:null,token:null,card:null,coupon:null,createdAt:new Date,updatedAt:new Date,error:null}));t.default=d},1552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(27);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){o(this,t);return a(this,e.apply(this,arguments))}t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(r({},n,{updatedAt:new Date(n.updatedAt||new Date)}))};t.queryByID=function e(t){return this.query("orgUsage").doc(t)};t.prototype.query=function e(){return t.queryByID(this.orgID)};t.deserialize=function e(n){return t.create(n)};t.prototype.serialize=function e(){return{orgID:this.orgID,membersCount:this.membersCount,privateSpacesCount:this.privateSpacesCount,spacesCount:this.spacesCount,updatedAt:this.updatedAt.getTime()}};return t}((0,i.DatabaseModel)("orgUsage",{orgID:"",membersCount:0,privateSpacesCount:0,spacesCount:0,updatedAt:new Date}));t.default=u},1553:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}return function(t,n,r){n&&e(t.prototype,n);r&&e(t,r);return t}}();var o=n(6);var a=n(27);var s=n(723);var u=c(s);function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){f(t,e);function t(){l(this,t);return h(this,e.apply(this,arguments))}t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n instanceof t)return n;return new t(r({},n,{books:(0,o.Map)(n.books||{}).map(function(e){return u.default.deserialize(e)}),createdAt:new Date(n.createdAt||new Date),updatedAt:new Date(n.updatedAt||new Date)}))};t.queryByOrgID=function e(t){return this.query("migration/beta").doc(t)};t.queryByLegacyOrgID=function e(t){return this.query("migration/legacy").doc(t)};t.prototype.queryByOrgID=function e(){return t.queryByOrgID(this.orgID)};t.prototype.queryByLegacyOrgID=function e(){return t.queryByLegacyOrgID(this.legacyOrgID)};t.prototype.toSyncUpdate=function e(){var t=new a.DatabaseUpdate;t.set(this.queryByOrgID(),this).set(this.queryByLegacyOrgID(),this);return t};t.prototype.toDeleteUpdate=function e(){var t=new a.DatabaseUpdate;t.delete(this.queryByOrgID()).delete(this.queryByLegacyOrgID());return t};t.prototype.toBookUpdate=function e(t){var n=new a.DatabaseUpdate;n.updateProperty(this.queryByOrgID(),"books/"+t.bookID,t.serialize()).updateProperty(this.queryByLegacyOrgID(),"books/"+t.bookID,t.serialize());return n};t.prototype.getBookBySpaceID=function e(t){return this.books.find(function(e){return e.spaceID===t})||null};t.prototype.updateBook=function e(){var t;var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var r=this.books;var i=n instanceof u.default?n:u.default.create(n);return this.merge({books:r.merge((t={},t[i.bookID]=i,t))})};t.deserialize=function e(n){return t.create(n)};t.prototype.serialize=function e(){return{orgID:this.orgID,legacyOrgID:this.legacyOrgID,books:this.books.map(function(e){return e.serialize()}).toObject(),confirmed:this.confirmed,githubSync:this.githubSync,createdAt:this.createdAt.getTime(),updatedAt:this.updatedAt.getTime()}};i(t,[{key:"githubBooks",get:function e(){return this.books.filter(function(e){return!!e.repoID}).toList()}},{key:"readyAt",get:function e(){var t=864e5;return new Date(this.createdAt.getTime()+t)}},{key:"isReady",get:function e(){return this.readyAt.getTime()<Date.now()}}]);return t}((0,a.DatabaseModel)("migrationStatus",{orgID:"",legacyOrgID:"",books:(0,o.Map)(),createdAt:new Date,updatedAt:new Date,confirmed:false,githubSync:false}));t.default=p},1554:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(6);var o=n(27);var a=n(366);var s=u(a);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){h(t,e);function t(){c(this,t);return l(this,e.apply(this,arguments))}t.queryByID=function e(t){var n=t.orgID,r=t.teamID;return this.query(["orgs",n,"teams"]).doc(r)};t.queryByOrg=function e(t){return this.query(["orgs",t,"teams"])};t.queryCoreTeam=function e(t){return this.query(["orgs",t,"teams"]).doc("core")};t.prototype.query=function e(n){return t.queryByID({orgID:n,teamID:this.uid})};t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n instanceof t)return n;return new t(r({},n,{uid:n.uid||(0,o.genKey)()}))};t.createCoreTeam=function e(){return t.create({uid:"core",name:"Core team"})};t.prototype.toCreateUpdate=function e(t){var n=new o.DatabaseUpdate;n.set(this.query(t),this).merge(s.default.getNewInvitesUpdate(t,this.uid));return n};t.deserialize=function e(n){return new t(r({},n,{spacesPermission:(0,i.Map)(n.spacesPermission),createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt)}))};t.prototype.serialize=function e(){var t=this.uid,n=this.name,r=this.spacesPermission,i=this.createdAt,o=this.updatedAt;return{uid:t,name:n,spacesPermission:r.toJS(),createdAt:i.getTime(),updatedAt:o.getTime()}};return t}((0,o.DatabaseModel)("team",{uid:"",name:"",createdAt:new Date,updatedAt:new Date,spacesPermission:(0,i.Map)()}));t.default=f},1666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=n(43);var i=h(r);var o=n(15);var a=h(o);var s=n(37);var u=h(s);var c=n(1667);var l=h(c);function h(e){return e&&e.__esModule?e:{default:e}}var f="\nhtml {\n    font-size: 16px; /* We want rem = 16px */\n}\nbody {\n    font-size: "+i.default.SIZE_NORMAL+"px;\n}\nhtml, body {\n    box-sizing: border-box;\n    padding: 0;\n    margin: 0;\n    background: "+a.default.BG_BODY+";\n    color:  "+a.default.TEXT_COLOR+";\n    font-family: "+i.default.FAMILY+";\n    line-height: 1em;\n    width: 100%;\n    height: 100%;\n\n    @media "+u.default.TABLET+' {\n        /* PERF: https://marco.org/2012/11/15/text-rendering-optimize-legibility */\n        text-rendering: optimizeLegibility;\n    },\n\n    -moz-osx-font-smoothing: grayscale;\n    -webkit-font-smoothing: antialiased;\n    font-smoothing: antialiased;\n}\nbody > #root {\n    width: 100%;\n    height: 100%;\n}\n*, *:before, *:after {\n    outline: none;\n    box-sizing: inherit;\n}\n\n@font-face {\n    font-family: "Flow-Rounded";\n    src: url("'+l.default+"\") format('woff');\n    font-display: block;\n}\n\n/*\n MOBILE:\n At least 16px to prevent zoom on mobile, when focusing inputs.\n Setting this using Aphrodite does not work for mounting inputs.\n So we declare these base size beforehand.\n*/\ninput,\nselect,\ntextarea {\n  font-size: 16px;\n}\n\n/*\n DRAGGING class to add grabbing cursor for sortable elements beeing dragged\n It's here because we can't use '*:hover' with Aphrodite\n https://github.com/clauderic/react-sortable-hoc/issues/212\n*/\n.draggingElement,\n.draggingElement *:hover {\n    pointer-events: auto !important;\n    cursor: -moz-grabbing !important;\n    cursor: -webkit-grabbing !important;\n    cursor: grabbing !important\n}\n.draggingElement .draggingHidden {\n    display: none;\n}\n";t.default=f},1668:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r,i,o,a;var s=n(2);var u=n(37);var c=_(u);var l=n(15);var h=_(l);var f=n(289);var p=_(f);var d=n(21);var v=_(d);var y=n(177);var g=_(y);function _(e){return e&&e.__esModule?e:{default:e}}t.default=s.StyleSheet.create({content:(r={flex:1},r["@media "+c.default.SMALLER_THAN_TABLET]={position:"fixed",zIndex:g.default.SIDEBAR+1,top:0,left:0,height:"100%",width:"100%",overflowY:"auto",maxWidth:p.default.SIDEBAR_WIDTH+2*v.default.S300,backgroundColor:"#fff",transform:"translateX(0) !important",transition:"transform 0.2s",borderRight:"1px solid "+h.default.BORDER_LIGHT,boxShadow:"0 0 4px rgba(0,0,0,.14), 0 4px 8px rgba(0,0,0,.28)"},r),hiddenOnMobile:(i={},i["@media "+c.default.SMALLER_THAN_TABLET]={transform:"translateX(-100%) !important",boxShadow:"none"},i),overlay:(o={},o["@media "+c.default.SMALLER_THAN_TABLET]={zIndex:g.default.SIDEBAR,position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#000",opacity:.5,transition:"opacity 0.2s",transform:"translateX(0)"},o),overlayHidden:(a={},a["@media "+c.default.SMALLER_THAN_TABLET]={opacity:0,transform:"translateX(-100%)"},a)})},1674:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r,i;var o=n(0);var a=g(o);var s=n(2);var u=n(16);var c=y(u);var l=n(29);var h=y(l);var f=n(21);var p=y(f);var d=n(15);var v=y(d);function y(e){return e&&e.__esModule?e:{default:e}}function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e;return t}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function b(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var w=(i=r=function(e){b(t,e);function t(){_(this,t);return m(this,e.apply(this,arguments))}t.prototype.render=function e(){var n=t.INNER_STYLES;var r=this.props,i=r.icon,o=r.vertical,s=r.children,u=r.styles;return a.createElement(c.default,{styles:[n.alert,o&&n.alertVertical,u]},i&&a.createElement(c.default,{styles:[o?c.default.MARGIN.S100Bottom:c.default.MARGIN.S100Right,n.alertIcon]},i),a.createElement(c.default,null,a.createElement(h.default,null,s)))};return t}(a.Component),r.defaultProps={icon:null,vertical:false},r.INNER_STYLES=s.StyleSheet.create({alert:{borderRadius:3,marginBottom:p.default.S300,padding:p.default.S200,display:"flex",flexDirection:"row"},alertVertical:{flexDirection:"column",textAlign:"center"},alertIcon:{fontSize:24}}),r.STYLES=s.StyleSheet.create({info:{color:v.default.BLUE_BASE,background:v.default.BLUE_LIGHTEST},danger:{color:v.default.RED_BASE,background:v.default.RED_LIGHTEST},success:{color:v.default.GREEN_BASE,background:v.default.GREEN_LIGHTEST}}),i);t.default=w},177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r={CONTROLS:10,HEADER:20,CONTROLSBAR:25,SIDEBAR:30,LEGACYBANNER:40,TOOLTIP:100,POPUP:150,POPOVER:160};t.default=r},21:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=["S900","S800","S700","S600","S500","S400","S300","S200","S100"];var o={S900:88,S800:64,S700:56,S600:48,S500:40,S400:32,S300:24,S200:16,S100:8};t.default=r({SIZE_NAMES:i},o)},215:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});n.d(t,"firebase",function(){return p});var r=n(405);var i=n.n(r);var o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var a="[DEFAULT]";var s=[];var u=function(){function e(e,t,n){this.firebase_=n;this.isDeleted_=false;this.services_={};this.name_=t.name;this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled||false;this.options_=Object(r["deepCopy"])(e);this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){s.push(e);setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){s=s.filter(function(t){return t!==e})}}}Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){this.checkDestroyed_();return this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed_();this._automaticDataCollectionEnabled=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"name",{get:function(){this.checkDestroyed_();return this.name_},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"options",{get:function(){this.checkDestroyed_();return this.options_},enumerable:true,configurable:true});e.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_();t()}).then(function(){e.firebase_.INTERNAL.removeApp(e.name_);var t=[];Object.keys(e.services_).forEach(function(n){Object.keys(e.services_[n]).forEach(function(r){t.push(e.services_[n][r])})});return Promise.all(t.map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.isDeleted_=true;e.services_={}})};e.prototype._getService=function(e,t){void 0===t&&(t=a);this.checkDestroyed_();this.services_[e]||(this.services_[e]={});if(!this.services_[e][t]){var n=t!==a?t:void 0;var r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]};e.prototype.extendApp=function(e){var t=this;Object(r["deepExtend"])(this,e);if(e.INTERNAL&&e.INTERNAL.addAuthTokenListener){s.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)});s=[]}};e.prototype.checkDestroyed_=function(){this.isDeleted_&&l("app-deleted",{name:this.name_})};return e}();u.prototype.name&&u.prototype.options||u.prototype.delete||console.log("dc");function c(){var e={};var t={};var n={};var i={__esModule:true,initializeApp:f,app:h,apps:null,Promise:Promise,SDK_VERSION:"4.13.0",INTERNAL:{registerService:d,createFirebaseNamespace:c,extendNamespace:v,createSubscribe:r["createSubscribe"],ErrorFactory:r["ErrorFactory"],removeApp:s,factories:t,useAsService:g,Promise:Promise,deepExtend:r["deepExtend"]}};Object(r["patchProperty"])(i,"default",i);Object.defineProperty(i,"apps",{get:p});function s(t){var n=e[t];y(n,"delete");delete e[t]}function h(t){t=t||a;o(e,t)||l("no-app",{name:t});return e[t]}Object(r["patchProperty"])(h,"App",u);function f(t,n){void 0===n&&(n={});if("object"!==typeof n||null===n){var r=n;n={name:r}}var s=n;void 0===s.name&&(s.name=a);var c=s.name;"string"===typeof c&&c||l("bad-app-name",{name:c+""});o(e,c)&&l("duplicate-app",{name:c});var h=new u(t,s,i);e[c]=h;y(h,"create");return h}function p(){return Object.keys(e).map(function(t){return e[t]})}function d(e,o,a,s,c){t[e]&&l("duplicate-service",{name:e});t[e]=o;if(s){n[e]=s;p().forEach(function(e){s("create",e)})}var f=function(t){void 0===t&&(t=h());"function"!==typeof t[e]&&l("invalid-app-argument",{name:e});return t[e]()};void 0!==a&&Object(r["deepExtend"])(f,a);i[e]=f;u.prototype[e]=function(){var t=[];for(var n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this._getService.bind(this,e);return r.apply(this,c?t:[])};return f}function v(e){Object(r["deepExtend"])(i,e)}function y(e,r){Object.keys(t).forEach(function(t){var i=g(e,t);if(null===i)return;n[i]&&n[i](r,e)})}function g(e,t){if("serverAuth"===t)return null;var n=t;var r=e.options;return n}return i}function l(e,t){throw f.create(e,t)}var h={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."};var f=new r["ErrorFactory"]("app","Firebase",h);var p=c();t["default"]=p},2673:function(e,t,n){"use strict";var r=/.+\@.+\..+/;function i(e){return r.test(e)}e.exports=i},283:function(e,t,n){var r=n(1527);n(1531);n(1533);n(1536);n(1538);e.exports=r},289:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r={CONTAINER_WIDTH:1400,CONTAINER_PADDING:24,BODY_WIDTH:750,SIDEBAR_WIDTH:250};t.default=r},32:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=n(288);var i=s(r);var o=n(15);var a=s(o);function s(e){return e&&e.__esModule?e:{default:e}}var u=(0,i.default)(a.default.GREY_DARK).alpha(.1).toString();var c={BACKGROUND:"#fff",RADIUS_LARGE:4,RADIUS_NORMAL:3,RADIUS_SMALL:2,BORDER_LIGHT:"#e8eaed",BORDER_NORMAL:"#d4dadf",PADDING_LARGE:30,PADDING_NORMAL:16,PADDING_SMALL:8,SPACING_V_NORMAL:20,SHADOW_LOW:"0 1px 1px 0 "+u,SHADOW_HIGH:"0 3px 8px 0 "+u};t.default=c},366:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}return function(t,n,r){n&&e(t.prototype,n);r&&e(t,r);return t}}();var o=n(162);var a=h(o);var s=n(6);var u=n(27);var c=n(161);var l=h(c);function h(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){d(t,e);function t(){f(this,t);return p(this,e.apply(this,arguments))}t.create=function e(n){var r=n.role,i=n.teamID;return new t({uid:(0,u.genKey)(),teamID:i||null,role:r})};t.queryByOrg=function e(t){return this.query(["orgs",t,"invites"])};t.queryByID=function e(t){var n=t.orgID,r=t.inviteID;return this.queryByOrg(n).doc(r)};t.prototype.query=function e(n){return t.queryByID({orgID:n,inviteID:this.uid})};t.getNewInvitesMap=function e(n){return(0,a.default)(l.default).reduce(function(e,r){var i=t.create({role:r,teamID:n});return e.set(i.uid,i)},(0,s.Map)())};t.getNewInvitesUpdate=function e(n,r){var i=new u.DatabaseUpdate;var o=t.getNewInvitesMap(r);o.forEach(function(e){i.set(e.query(n),e)});return i};t.deserialize=function e(n){return new t(r({},n,{createdAt:new Date(n.createdAt)}))};t.prototype.serialize=function e(){return{uid:this.uid,role:this.role,teamID:this.teamID,createdAt:this.createdAt.getTime()}};i(t,[{key:"isTeam",get:function e(){return Boolean(this.teamID)}},{key:"canEdit",get:function e(){return/^(writer|reviewer|admin)$/.test(this.role)}},{key:"canReview",get:function e(){return/^(reviewer|admin)$/.test(this.role)}},{key:"canAdmin",get:function e(){return this.role==l.default.ADMIN}}]);return t}((0,u.DatabaseModel)("invite",{uid:"",role:"reader",createdAt:new Date,teamID:null}));t.default=v},405:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=n(406);var i={NODE_CLIENT:false,NODE_ADMIN:false,SDK_VERSION:"${JSCORE_VERSION}"};var o=function(e,t){if(!e)throw a(t)};var a=function(e){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)};var s=function(e){var t=[],n=0;for(var r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i<128)t[n++]=i;else if(i<2048){t[n++]=i>>6|192;t[n++]=63&i|128}else if(55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))){i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r));t[n++]=i>>18|240;t[n++]=i>>12&63|128;t[n++]=i>>6&63|128;t[n++]=63&i|128}else{t[n++]=i>>12|224;t[n++]=i>>6&63|128;t[n++]=63&i|128}}return t};var u=function(e){var t=[],n=0,r=0;while(n<e.length){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var o=e[n++];var a=e[n++];var s=e[n++];var u=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&s)-65536;t[r++]=String.fromCharCode(55296+(u>>10));t[r++]=String.fromCharCode(56320+(1023&u))}else{var o=e[n++];var a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")};var c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_;var r=[];for(var i=0;i<e.length;i+=3){var o=e[i];var a=i+1<e.length;var s=a?e[i+1]:0;var u=i+2<e.length;var c=u?e[i+2]:0;var l=o>>2;var h=(3&o)<<4|s>>4;var f=(15&s)<<2|c>>6;var p=63&c;if(!u){p=64;a||(f=64)}r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString:function(e,t){if(this.HAS_NATIVE_SUPPORT&&!t)return btoa(e);return this.encodeByteArray(s(e),t)},decodeString:function(e,t){if(this.HAS_NATIVE_SUPPORT&&!t)return atob(e);return u(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();var n=t?this.charToByteMapWebSafe_:this.charToByteMap_;var r=[];for(var i=0;i<e.length;){var o=n[e.charAt(i++)];var a=i<e.length;var s=a?n[e.charAt(i)]:0;++i;var u=i<e.length;var c=u?n[e.charAt(i)]:64;++i;var l=i<e.length;var h=l?n[e.charAt(i)]:64;++i;if(null==o||null==s||null==c||null==h)throw Error();var f=o<<2|s>>4;r.push(f);if(64!=c){var p=s<<4&240|c>>2;r.push(p);if(64!=h){var d=c<<6&192|h;r.push(d)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={};this.charToByteMap_={};this.byteToCharMapWebSafe_={};this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++){this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e);this.charToByteMap_[this.byteToCharMap_[e]]=e;this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e);this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e;if(e>=this.ENCODED_VALS_BASE.length){this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e;this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e}}}}};var l=function(e){var t=s(e);return c.encodeByteArray(t,true)};var h=function(e){try{return c.decodeString(e,true)}catch(e){console.error("base64Decode failed: ",e)}return null};function f(e){return p(void 0,e)}function p(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var n=t;return new Date(n.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r in t){if(!t.hasOwnProperty(r))continue;e[r]=p(e[r],t[r])}return e}function d(e,t,n){e[t]=n}var v=function(){function e(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t;e.reject=n})}e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r);if("function"===typeof e){t.promise.catch(function(){});1===e.length?e(n):e(n,r)}}};return e}();var y=function(){return"undefined"!==typeof navigator&&"string"===typeof navigator["userAgent"]?navigator["userAgent"]:""};var g=function(){return"undefined"!==typeof window&&!!(window["cordova"]||window["phonegap"]||window["PhoneGap"])&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())};var _=function(){return"object"===typeof navigator&&"ReactNative"===navigator["product"]};var m=function(){return true===i.NODE_CLIENT||true===i.NODE_ADMIN};var b="FirebaseError";var w=Error.captureStackTrace;function E(e){var t=w;w=e;return t}var T=function(){function e(e,t){this.code=e;this.message=t;if(w)w(this,S.prototype.create);else{var n=Error.apply(this,arguments);this.name=b;Object.defineProperty(this,"stack",{get:function(){return n.stack}})}}return e}();T.prototype=Object.create(Error.prototype);T.prototype.constructor=T;T.prototype.name=b;var S=function(){function e(e,t,n){this.service=e;this.serviceName=t;this.errors=n;this.pattern=/\{\$([^}]+)}/g}e.prototype.create=function(e,t){void 0===t&&(t={});var n=this.errors[e];var r=this.service+"/"+e;var i;i=void 0===n?"Error":n.replace(this.pattern,function(e,n){var r=t[n];return void 0!==r?r.toString():"<"+n+"?>"});i=this.serviceName+": "+i+" ("+r+").";var o=new T(r,i);for(var a in t){if(!t.hasOwnProperty(a)||"_"===a.slice(-1))continue;o[a]=t[a]}return o};return e}();function I(e){return JSON.parse(e)}function C(e){return JSON.stringify(e)}var O=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=I(h(o[0])||"");n=I(h(o[1])||"");i=o[2];r=n["d"]||{};delete n["d"]}catch(e){}return{header:t,claims:n,data:r,signature:i}};var N=function(e){var t=O(e).claims,n=Math.floor((new Date).getTime()/1e3),r,i;if("object"===typeof t){t.hasOwnProperty("nbf")?r=t["nbf"]:t.hasOwnProperty("iat")&&(r=t["iat"]);i=t.hasOwnProperty("exp")?t["exp"]:r+86400}return n&&r&&i&&n>=r&&n<=i};var A=function(e){var t=O(e).claims;if("object"===typeof t&&t.hasOwnProperty("iat"))return t["iat"];return null};var D=function(e){var t=O(e),n=t.claims;return!!t.signature&&!!n&&"object"===typeof n&&n.hasOwnProperty("iat")};var R=function(e){var t=O(e).claims;return"object"===typeof t&&true===t["admin"]};var P=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var k=function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};var L=function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])};var x=function(e,t){L(t,function(t,n){e[t]=n});return e};var M=function(e){return x({},e)};var U=function(e){return"object"===typeof e&&null!==e};var F=function(e){for(var t in e)return false;return true};var j=function(e){var t=0;for(var n in e)t++;return t};var B=function(e,t,n){var r={};for(var i in e)r[i]=t.call(n,e[i],i,e);return r};var W=function(e,t,n){for(var r in e)if(t.call(n,e[r],r,e))return r;return};var q=function(e,t,n){var r=W(e,t,n);return r&&e[r]};var V=function(e){for(var t in e)return t};var H=function(e){var t=[];var n=0;for(var r in e)t[n++]=e[r];return t};var K=function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!t(n,e[n]))return false;return true};var G=function(e){var t=[];L(e,function(e,n){Array.isArray(n)?n.forEach(function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))});return t.length?"&"+t.join("&"):""};var z=function(e){var t={};var n=e.replace(/^\?/,"").split("&");n.forEach(function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}});return t};var Q=function(){function e(){this.blockSize=-1}return e}();var Y=function(e){r.__extends(t,e);function t(){var t=e.call(this)||this;t.chain_=[];t.buf_=[];t.W_=[];t.pad_=[];t.inbuf_=0;t.total_=0;t.blockSize=64;t.pad_[0]=128;for(var n=1;n<t.blockSize;++n)t.pad_[n]=0;t.reset();return t}t.prototype.reset=function(){this.chain_[0]=1732584193;this.chain_[1]=4023233417;this.chain_[2]=2562383102;this.chain_[3]=271733878;this.chain_[4]=3285377520;this.inbuf_=0;this.total_=0};t.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++){n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3);t+=4}else for(var r=0;r<16;r++){n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];t+=4}for(var r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o=this.chain_[0];var a=this.chain_[1];var s=this.chain_[2];var u=this.chain_[3];var c=this.chain_[4];var l,h;for(var r=0;r<80;r++){if(r<40)if(r<20){l=u^a&(s^u);h=1518500249}else{l=a^s^u;h=1859775393}else if(r<60){l=a&s|u&(a|s);h=2400959708}else{l=a^s^u;h=3395469782}var i=(o<<5|o>>>27)+l+c+h+n[r]&4294967295;c=u;u=s;s=4294967295&(a<<30|a>>>2);a=o;o=i}this.chain_[0]=this.chain_[0]+o&4294967295;this.chain_[1]=this.chain_[1]+a&4294967295;this.chain_[2]=this.chain_[2]+s&4294967295;this.chain_[3]=this.chain_[3]+u&4294967295;this.chain_[4]=this.chain_[4]+c&4294967295};t.prototype.update=function(e,t){if(null==e)return;void 0===t&&(t=e.length);var n=t-this.blockSize;var r=0;var i=this.buf_;var o=this.inbuf_;while(r<t){if(0==o)while(r<=n){this.compress_(e,r);r+=this.blockSize}if("string"===typeof e)while(r<t){i[o]=e.charCodeAt(r);++o;++r;if(o==this.blockSize){this.compress_(i);o=0;break}}else while(r<t){i[o]=e[r];++o;++r;if(o==this.blockSize){this.compress_(i);o=0;break}}}this.inbuf_=o;this.total_+=t};t.prototype.digest=function(){var e=[];var t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--){this.buf_[n]=255&t;t/=256}this.compress_(this.buf_);var r=0;for(var n=0;n<5;n++)for(var i=24;i>=0;i-=8){e[r]=this.chain_[n]>>i&255;++r}return e};return t}(Q);function X(e,t){var n=new $(e,t);return n.subscribe.bind(n)}var $=function(){function e(e,t){var n=this;this.observers=[];this.unsubscribes=[];this.observerCount=0;this.task=Promise.resolve();this.finalized=false;this.onNoObservers=t;this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})};e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)});this.close(e)};e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()});this.close()};e.prototype.subscribe=function(e,t,n){var r=this;var i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=Z(e,["next","error","complete"])?e:{next:e,error:t,complete:n};void 0===i.next&&(i.next=ee);void 0===i.error&&(i.error=ee);void 0===i.complete&&(i.complete=ee);var o=this.unsubscribeOne.bind(this,this.observers.length);this.finalized&&this.task.then(function(){try{r.finalError?i.error(r.finalError):i.complete()}catch(e){}return});this.observers.push(i);return o};e.prototype.unsubscribeOne=function(e){if(void 0===this.observers||void 0===this.observers[e])return;delete this.observers[e];this.observerCount-=1;0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this)};e.prototype.forEachObserver=function(e){if(this.finalized)return;for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)};e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!==typeof console&&console.error&&console.error(e)}})};e.prototype.close=function(e){var t=this;if(this.finalized)return;this.finalized=true;void 0!==e&&(this.finalError=e);this.task.then(function(){t.observers=void 0;t.onNoObservers=void 0})};return e}();function J(e,t){return function(){var n=[];for(var r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(true).then(function(){e.apply(void 0,n)}).catch(function(e){t&&t(e)})}}function Z(e,t){if("object"!==typeof e||null===e)return false;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"===typeof e[i])return true}return false}function ee(){}var te=function(e,t,n,r){var i;r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n);if(i){var o=e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}};function ne(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=e+" failed: ";i+=r+" argument ";return i}function re(e,t,n,r){if(r&&!n)return;if("string"!==typeof n)throw new Error(ne(e,t,r)+"must be a valid firebase namespace.")}function ie(e,t,n,r){if(r&&!n)return;if("function"!==typeof n)throw new Error(ne(e,t,r)+"must be a valid function.")}function oe(e,t,n,r){if(r&&!n)return;if("object"!==typeof n||null===n)throw new Error(ne(e,t,r)+"must be a valid context object.")}var ae=function(e){var t=[],n=0;for(var r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++;o(r<e.length,"Surrogate pair missing trail surrogate.");var s=e.charCodeAt(r)-56320;i=65536+(a<<10)+s}if(i<128)t[n++]=i;else if(i<2048){t[n++]=i>>6|192;t[n++]=63&i|128}else if(i<65536){t[n++]=i>>12|224;t[n++]=i>>6&63|128;t[n++]=63&i|128}else{t[n++]=i>>18|240;t[n++]=i>>12&63|128;t[n++]=i>>6&63|128;t[n++]=63&i|128}}return t};var se=function(e){var t=0;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128)t++;else if(r<2048)t+=2;else if(r>=55296&&r<=56319){t+=4;n++}else t+=3}return t};t.assert=o;t.assertionError=a;t.base64=c;t.base64Decode=h;t.base64Encode=l;t.CONSTANTS=i;t.deepCopy=f;t.deepExtend=p;t.patchProperty=d;t.Deferred=v;t.getUA=y;t.isMobileCordova=g;t.isNodeSdk=m;t.isReactNative=_;t.ErrorFactory=S;t.FirebaseError=T;t.patchCapture=E;t.jsonEval=I;t.stringify=C;t.decode=O;t.isAdmin=R;t.issuedAtTime=A;t.isValidFormat=D;t.isValidTimestamp=N;t.clone=M;t.contains=P;t.every=K;t.extend=x;t.findKey=W;t.findValue=q;t.forEach=L;t.getAnyKey=V;t.getCount=j;t.getValues=H;t.isEmpty=F;t.isNonNullObject=U;t.map=B;t.safeGet=k;t.querystring=G;t.querystringDecode=z;t.Sha1=Y;t.async=J;t.createSubscribe=X;t.errorPrefix=ne;t.validateArgCount=te;t.validateCallback=ie;t.validateContextObject=oe;t.validateNamespace=re;t.stringLength=se;t.stringToByteArray=ae},406:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t["__extends"]=i;n.d(t,"__assign",function(){return o});t["__rest"]=a;t["__decorate"]=s;t["__param"]=u;t["__metadata"]=c;t["__awaiter"]=l;t["__generator"]=h;t["__exportStar"]=f;t["__values"]=p;t["__read"]=d;t["__spread"]=v;t["__await"]=y;t["__asyncGenerator"]=g;t["__asyncDelegator"]=_;t["__asyncValues"]=m;t["__makeTemplateObject"]=b;t["__importStar"]=w;t["__importDefault"]=E;var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function i(e,t){r(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=Object.assign||function e(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]]);return n}function s(e,t,n,r){var i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r,a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r["throw"](e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})}function h(e,t){var n={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return u([e,t])}}function u(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=i[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(i,a[1])).done)return o;(i=0,o)&&(a=[0,o.value]);switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){n=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(6===a[0]&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}o[2]&&n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:true}}}function f(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function p(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;if(t)return t.call(e);return{next:function(){e&&n>=e.length&&(e=void 0);return{value:e&&e[n++],done:!e}}}}function d(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,o=[],a;try{while((void 0===t||t-->0)&&!(i=r.next()).done)o.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(n=r["return"])&&n.call(r)}finally{if(a)throw a.error}}return o}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function g(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(e){r[e]&&(i[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{u(r[e](t))}catch(e){h(o[0][3],e)}}function u(e){e.value instanceof y?Promise.resolve(e.value.v).then(c,l):h(o[0][2],e)}function c(e){s("next",e)}function l(e){s("throw",e)}function h(e,t){(e(t),o.shift(),o.length)&&s(o[0][0],o[0][1])}}function _(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){e[r]&&(t[r]=function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:i?i(t):t})}}function m(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"===typeof p?p(e):e[Symbol.iterator]()}function b(e,t){Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t;return e}function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e;return t}function E(e){return e&&e.__esModule?e:{default:e}}},426:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(2);var o=n(15);var a=p(o);var s=n(32);var u=p(s);var c=n(70);var l=p(c);var h=n(177);var f=p(h);function p(e){return e&&e.__esModule?e:{default:e}}var d={opacity:0,animationName:l.default.fadeIn,animationDuration:"0.2s",animationFillMode:"forwards"};var v=i.StyleSheet.create({tooltipped:{position:"relative",":hover":{":after":r({lineHeight:"1em",background:a.default.BG_DARKER,borderRadius:u.default.RADIUS_LARGE,bottom:"auto",top:"calc(100% + 10px)",color:a.default.TEXT_TOOLTIP,content:"attr(aria-label)",display:"block",left:"50%",padding:u.default.PADDING_SMALL,position:"absolute",whiteSpace:"nowrap",zIndex:f.default.TOOLTIP,fontSize:13,textTransform:"none",fontWeight:400,pointerEvents:"none",transform:"translateX(-50%)"},d),":before":r({borderStyle:"solid",borderColor:a.default.BG_DARKER+" transparent",bottom:"auto",top:"calc(100% + 5px)",borderWidth:"0px 5px 5px 5px",content:'""',display:"block",left:"50%",position:"absolute",zIndex:f.default.TOOLTIP+1,transform:"translateX(-50%)"},d)}},delayed:{":hover":{":after":{animationDelay:"0.7s"},":before":{animationDelay:"0.7s"}}},top:{":hover":{":after":{top:-7,left:"50%",right:"auto",bottom:"auto",transform:"translate(-50%, -100%)"},":before":{top:-7,borderWidth:"5px 5px 0 5px",borderColor:a.default.BG_DARKER+" transparent"}}},topRight:{":hover":{":after":{top:-7,left:0,right:"auto",bottom:"auto",transform:"translateY(-100%)"},":before":{top:-7,borderWidth:"5px 5px 0 5px",borderColor:a.default.BG_DARKER+" transparent"}}},topLeft:{":hover":{":after":{top:-7,left:"auto",right:0,bottom:"auto",transform:"translateY(-100%)"},":before":{top:-7,borderWidth:"5px 5px 0 5px",borderColor:a.default.BG_DARKER+" transparent"}}},bottomRight:{":hover":{":after":{left:0,transform:"translateX(0%)"}}},bottomLeft:{":hover":{":after":{left:"auto",right:0,transform:"translateX(0%)"}}}});t.default=v},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(2);var o={DisplayH900:{fontSize:32,lineHeight:1.5,fontWeight:500},DisplayH800:{fontSize:28,lineHeight:1.5,fontWeight:500},DisplayH700:{fontSize:24,lineHeight:1.5,fontWeight:500},HeadingH700:{fontSize:24,lineHeight:1.5,fontWeight:700},HeadingH600:{fontSize:20,lineHeight:1.5,fontWeight:700},HeadingH400:{fontSize:16,lineHeight:1.5,fontWeight:700},TextH500:{fontSize:18,lineHeight:1.625,fontWeight:400},TextH400:{fontSize:16,lineHeight:1.625,fontWeight:400},TextH300:{fontSize:12,lineHeight:1.625,fontWeight:400},UIH400:{fontSize:16,lineHeight:1.5,fontWeight:500},UIH300:{fontSize:14,lineHeight:1.5,fontWeight:500},UIH200:{fontSize:12,lineHeight:1.5,fontWeight:500},InfoH200:{fontSize:12,lineHeight:1.2,fontWeight:700,textTransform:"uppercase",letterSpacing:"1.2px"},InfoH100:{fontSize:10,lineHeight:1,fontWeight:700,textTransform:"uppercase",letterSpacing:"1.2px"}};var a=i.StyleSheet.create(r({},o));t.default={FONTS:o,KINDS:a,FAMILY:"Roboto, sans-serif",FAMILY_CODE:'"Source Code Pro", Menlo, monospace',FAMILY_PLACEHOLDER:"Flow-Rounded, sans-serif",SANS_SERIF_SRC:"https://fonts.googleapis.com/css?family=Roboto:400,500,700",MONOSPACE_SRC:"https://fonts.googleapis.com/css?family=Source+Code+Pro:500",SIZE_XSMALL:12,SIZE_SMALL:13,SIZE_NORMAL:15,SIZE_MEDIUM:16,SIZE_MEDIUM_LARGE:20,SIZE_LARGE:24,SIZE_XLARGE:28,SIZE_MAIN:16,SIZE_CODE:"85%",LINE_PX_NORMAL:15,LINE_PX_MEDIUM:21,LINE_PX_LARGE:22,LINE_PX_XLARGE:32,LINE_SMALL:1.2,LINE_NORMAL:1.5,LINE_CODE:1.7,WEIGHT_LIGHT:300,WEIGHT_NORMAL:400,WEIGHT_BOLD:500,WEIGHT_BOLDER:700}},594:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}return function(t,n,r){n&&e(t.prototype,n);r&&e(t,r);return t}}();var o=n(6);var a=n(161);var s=u(a);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){h(t,e);function t(){c(this,t);return l(this,e.apply(this,arguments))}t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(r({joinedAt:new Date},n))};t.deserialize=function e(n){return t.create(r({},n,{joinedAt:new Date(n.joinedAt)}))};t.prototype.serialize=function e(){return{role:this.role,joinedAt:this.joinedAt.getTime()}};i(t,[{key:"canEdit",get:function e(){return/^(writer|reviewer|admin)$/.test(this.role)}},{key:"canReview",get:function e(){return/^(reviewer|admin)$/.test(this.role)}},{key:"canAdmin",get:function e(){return this.role==s.default.ADMIN}}]);return t}((0,o.Record)({role:s.default.READER,joinedAt:new Date}));t.default=f},649:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}return function(t,n,r){n&&e(t.prototype,n);r&&e(t,r);return t}}();var o,a;var s=n(369);var u=v(s);var c=n(6);var l=n(27);var h=n(389);var f=v(h);var p=n(368);var d=v(p);function v(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function _(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m=(a=o=function(e){_(t,e);function t(){y(this,t);return g(this,e.apply(this,arguments))}t.pathFromUid=function e(t){return t.replace(/\//g,"%2F")};t.uidFromPath=function e(t){return t.replace(/%2F/g,"/")};t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n instanceof t)return n;var r=n.page||d.default.create();return new t({ref:n.ref||r.path,title:n.title||"",github:n.github?f.default.create(n.github):null,page:r})};t.createVersions=function e(n){return(0,c.OrderedMap)(n.map(function(e){var n=t.create(e);return[n.ref,n]}))};t.createInitialVersion=function e(){return t.create({ref:"master",title:"Primary version",page:d.default.create({title:"Initial page",path:"master"})})};t.createInitialVersions=function e(){var t;var n=this.createInitialVersion();return(0,c.OrderedMap)((t={},t[n.uid]=n,t))};t.deserialize=function e(n){var r=d.default.deserializeTree(n);var i=n.ref||r.path;if(!i)throw new Error("Missing ref to deserialize a Version");return t.create({ref:i,title:n.title,page:r,github:n.github?f.default.deserialize(n.github):null})};t.deserializeVersions=function e(n){return(0,c.OrderedMap)(Array.isArray(n)?n.map(function(e,t){return[t,e]}):n).mapEntries(function(e){var n=e[0],r=e[1];var i=t.deserialize(r);return[i.uid,{index:r.index,version:i}]}).sortBy(function(e){var t=e.index;return t}).map(function(e){var t=e.version;return t})};t.serializeVersions=function e(t){return t.mapEntries(function(e,t){var n=e[0],i=e[1];return[(0,l.escapeKey)(i.uid),r({index:t},i.serialize())]}).toObject()};t.normalizeRef=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"undefined";var r=(0,u.default)(t,{tone:false,separateNumbers:false,custom:{".":".","/":"/","+":"+"}}).slice(0,100);return r||n};t.prototype.serialize=function e(){return r({ref:this.ref,title:this.title,github:this.github?this.github.serialize():null},this.page.serializeTree())};t.prototype.setPage=function e(t){return this.updatePage(t,function(e){return t})};t.prototype.updatePage=function e(t,n){return this.set("page",this.page.updatePage(t,n))};t.prototype.updateRef=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;var i=r>0?n+"-"+r:n;if(t.has(i))return this.updateRef(t,n,r+1);return this.set("ref",i)};i(t,[{key:"uid",get:function e(){return this.ref}},{key:"path",get:function e(){return t.pathFromUid(this.ref)}}]);return t}((0,c.Record)({ref:"",title:"",page:d.default.create(),github:null})),o.REF_LIMIT=100,a);t.default=m},651:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r,i;var o=n(652);var a=u(o);var s=n(6);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=(i=r=function(e){h(t,e);function t(){c(this,t);return l(this,e.apply(this,arguments))}t.createFromFirebase=function e(n){return new t({name:a.default.basename(n.name),contentType:n.contentType,downloadURL:n.downloadURLs[0],blobSize:n.size,createdAt:new Date(n.timeCreated),lastModifiedAt:new Date(n.updated)})};t.createFromGCloud=function e(n){var r=n.mediaLink.replace("https://www.googleapis.com/download/storage/v1/b/","https://firebasestorage.googleapis.com/v0/b/");return new t({name:a.default.basename(n.name),contentType:n.contentType,downloadURL:r,blobSize:+n.size,createdAt:new Date(n.timeCreated),lastModifiedAt:new Date(n.updated)})};return t}((0,s.Record)({name:"",contentType:"",downloadURL:"",blobSize:0,createdAt:new Date,lastModifiedAt:new Date})),r.MIME_TYPE_DEFAULT="application/octet-stream",r.MIME_TYPE_JSON="application/json",r.MIME_TYPE_SVG="image/svg+xml",i);t.default=f},711:function(e,t,n){"use strict";var r=n(1540);function i(e){this.message=e}i.prototype=new Error;i.prototype.name="InvalidTokenError";e.exports=function(e,t){if("string"!==typeof e)throw new i("Invalid token specified");t=t||{};var n=true===t.header?0:1;try{return JSON.parse(r(e.split(".")[n]))}catch(e){throw new i("Invalid token specified: "+e.message)}};e.exports.InvalidTokenError=i},712:function(e,t){e.exports=function(e,t){if("string"!==typeof e)throw new TypeError("Expected a string");var n=String(e);var r="";var i=!!t&&!!t.extended;var o=!!t&&!!t.globstar;var a=false;var s=t&&"string"===typeof t.flags?t.flags:"";var u;for(var c=0,l=n.length;c<l;c++){u=n[c];switch(u){case"\\":case"/":case"$":case"^":case"+":case".":case"(":case")":case"=":case"!":case"|":r+="\\"+u;break;case"?":if(i){r+=".";break}case"[":case"]":if(i){r+=u;break}case"{":if(i){a=true;r+="(";break}case"}":if(i){a=false;r+=")";break}case",":if(a){r+="|";break}r+="\\"+u;break;case"*":var h=n[c-1];var f=1;while("*"===n[c+1]){f++;c++}var p=n[c+1];if(o){var d=f>1&&("/"===h||void 0===h)&&("/"===p||void 0===p);if(d){r+="(?:[^/]*(?:/|$))*";c++}else r+="[^/]*"}else r+=".*";break;default:r+=u}}s&&~s.indexOf("g")||(r="^"+r+"$");return new RegExp(r,s)}},713:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}return function(t,n,r){n&&e(t.prototype,n);r&&e(t,r);return t}}();var o,a;var s=n(6);var u=n(27);var c=n(714);var l=g(c);var h=n(715);var f=g(h);var p=n(648);var d=g(p);var v=n(367);var y=g(v);function g(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function b(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var w=(a=o=function(e){b(t,e);function t(){_(this,t);return m(this,e.apply(this,arguments))}t.queryByID=function e(t){return this.query("spaces/"+t).doc("infos")};t.prototype.query=function e(){return t.queryByID(this.uid)};t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n instanceof t)return n;return new t(r({},n,{uid:n.uid||(0,u.genKey)(),colorPrimary:n.colorPrimary||"#f47c24",googleAnalyticsID:n.googleAnalyticsID?n.googleAnalyticsID:null}))};t.prototype.regenerateUID=function e(){return this.merge({uid:(0,u.genKey)()})};t.prototype.setVisibility=function e(t){switch(t){case"private":return this.merge({isPrivate:true,isUnlisted:false});case"unlisted":return this.merge({isPrivate:false,isUnlisted:true});default:return this.merge({isPrivate:false,isUnlisted:false})}};t.prototype.getURL=function e(t,n){if(this.customDomain)return"https://"+this.customDomain+"/";return t.getSpacesURL(n)+"/"+this.baseName+"/"};t.prototype.limitLinks=function e(){return this.merge({links:this.links.take(t.LINKS_LIMIT)})};t.prototype.moveLink=function e(t,n){var r=this.links;var i=r.get(t);var o=r.splice(t,1).splice(n,0,i);return this.merge({links:o})};t.prototype.toLinksUpdate=function e(){var n=this.links;return(new u.DatabaseUpdate).update(t.queryByID(this.uid),{links:n.map(function(e){return e.serialize()}).toArray()})};t.prototype.toCustomDomainUpdate=function e(n){var r=this.merge({customDomain:n});var i=y.default.createFromSpace(r);var o=y.default.createFromSpace(this);var a=new u.DatabaseUpdate;a.update(t.queryByID(this.uid),{customDomain:i?n:null});o&&this.customDomain&&this.customDomain!==n&&a.set(y.default.queryByDomain(this.customDomain),o.merge({deprecated:true}));i&&a.set(y.default.queryByDomain(i.domain),i);return a};t.prototype.toBaseNameUpdate=function e(n){var r=f.default.createFromSpace(this.merge({baseName:n}));return(new u.DatabaseUpdate).set(r.query(this.orgID),r).delete(f.default.queryByName({orgID:this.orgID,baseName:this.baseName})).update(t.queryByID(this.uid),{baseName:n})};t.prototype.toCreateUpdate=function e(){var n=f.default.createFromSpace(this);var r=y.default.createFromSpace(this);var i=(new u.DatabaseUpdate).set(t.queryByID(this.uid),this).set(f.default.queryByName({orgID:this.orgID,baseName:this.baseName}),n);r&&i.set(y.default.queryByDomain(r.domain),r);return i};t.prototype.toDeleteUpdate=function e(){var n=new u.DatabaseUpdate;n.deleteCollection(t.query("spaces/"+this.uid));n.delete(f.default.queryByName({orgID:this.orgID,baseName:this.baseName}));this.customDomain&&n.delete(y.default.queryByDomain(this.customDomain));return n};t.prototype.toCheckoutUpdate=function e(n){return(new u.DatabaseUpdate).update(t.queryByID(this.uid),{primaryRevision:n.uid})};t.prototype.toVisibilityUpdate=function e(){return(new u.DatabaseUpdate).update(t.queryByID(this.uid),{isPrivate:this.isPrivate,isUnlisted:this.isUnlisted})};t.deserialize=function e(n){return new t(r({},n,{isUnlisted:Boolean(n.isUnlisted),createdAt:new Date(n.createdAt),links:(0,s.List)((n.links||[]).map(function(e){return l.default.deserialize(e)}))}))};t.prototype.serialize=function e(){return{uid:this.uid,name:this.name,orgID:this.orgID,isPrivate:this.isPrivate,isUnlisted:this.isUnlisted,logoURL:this.logoURL,primaryRevision:this.primaryRevision,colorPrimary:this.colorPrimary,createdAt:this.createdAt.getTime(),createdBy:this.createdBy,algoliaAPIKey:this.algoliaAPIKey,baseName:this.baseName,customDomain:this.customDomain,links:this.links.map(function(e){return e.serialize()}).toArray(),hasGitHubSync:this.hasGitHubSync,editOnGitHub:this.editOnGitHub,googleAnalyticsID:this.googleAnalyticsID}};t.prototype.setBaseName=function e(n){return this.merge({baseName:t.normalizeBaseName(n)})};t.normalizeBaseName=function e(t){return t.trim().replace(/[^a-zA-Z0-9-]/g,"-").replace(/-+/g,"-").toLowerCase().substr(0,50).replace(/-$/,"")};t.validateBaseName=function e(t){return Boolean(/^[a-z0-9-_]+$/.test(t)&&t.length>=1&&t.length<=50)};t.validateColor=function e(t){return/^#([0-9a-f]{6}|[0-9a-f]{3})$/i.test(t)};i(t,[{key:"visibility",get:function e(){if(this.isPrivate)return"private";if(this.isUnlisted)return"unlisted";return"public"}}]);return t}((0,u.DatabaseModel)("space",{uid:"",name:"",baseName:"",orgID:"",isPrivate:false,isUnlisted:false,createdAt:new Date,createdBy:"",logoURL:null,colorPrimary:"#3884FF",primaryRevision:"",algoliaAPIKey:"",customDomain:null,links:(0,s.List)(),hasGitHubSync:false,editOnGitHub:null,googleAnalyticsID:null})),o.LINKS_LIMIT=4,a);t.default=w},714:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;"value"in r&&(r.writable=true);Object.defineProperty(e,r.key,r)}}return function(t,n,r){n&&e(t.prototype,n);r&&e(t,r);return t}}();var o=n(6);var a=n(211);var s=l(a);var u=n(2673);var c=l(u);function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=function(e){p(t,e);function t(){h(this,t);return f(this,e.apply(this,arguments))}t.prototype.updateTitle=function e(t){return this.merge({title:t})};t.prototype.updateHref=function e(t){return this.merge({href:t,pageID:null})};t.prototype.updatePageID=function e(t){return this.merge({pageID:t,href:null})};t.deserialize=function e(n){return new t(r({},n))};t.prototype.serialize=function e(){var t=this.title,n=this.href,r=this.pageID;return{title:t,href:n,pageID:r}};i(t,[{key:"isValid",get:function e(){return Boolean(this.title&&(this.isValidHref||this.pageID))}},{key:"isValidHref",get:function e(){var t=this.href;if(!t||t.length>=512)return false;return/^https?:\/\//.test(t)&&(0,s.default)(t)||/^mailto:/.test(t)&&(0,c.default)(t.replace("mailto:",""))}}]);return t}((0,o.Record)({title:"",href:null,pageID:null}));t.default=d},719:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(6);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){o(this,t);return a(this,e.apply(this,arguments))}t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.deserialize(r({},n,{createdAt:n.createdAt||Date.now()}))};t.deserialize=function e(n){return new t(r({},n,{createdAt:new Date(n.createdAt)}))};t.prototype.serialize=function e(){return{token:this.token,channelName:this.channelName,channelID:this.channelID,webhookURL:this.webhookURL,createdAt:this.createdAt.getTime()}};return t}((0,i.Record)({token:"",channelName:"",channelID:"",webhookURL:"",createdAt:new Date}));t.default=u},721:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(6);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){o(this,t);return a(this,e.apply(this,arguments))}t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(r({},n))};t.deserialize=function e(n){return t.create(n)};t.prototype.serialize=function e(){return{brand:this.brand,last4:this.last4,expMonth:this.expMonth,expYear:this.expYear}};return t}((0,i.Record)({brand:"",last4:"",expMonth:0,expYear:0}));t.default=u},722:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(6);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){o(this,t);return a(this,e.apply(this,arguments))}t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(r({},n))};t.deserialize=function e(n){return t.create(n)};t.prototype.serialize=function e(){return{firstName:this.firstName,lastName:this.lastName,email:this.email,phone:this.phone,organization:this.organization,street:this.street,country:this.country,region:this.region,city:this.city,zip:this.zip,vat:this.vat}};return t}((0,i.Record)({firstName:"",lastName:"",email:"",phone:"",organization:"",street:"",country:"",region:"",city:"",zip:"",vat:""}));t.default=u},723:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i=n(6);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){s(t,e);function t(){o(this,t);return a(this,e.apply(this,arguments))}t.create=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n instanceof t)return n;return new t(r({},n,{repoID:n.repoID||null,customDomain:n.customDomain||null,completedAt:new Date(n.completedAt||new Date)}))};t.deserialize=function e(n){return t.create(n)};t.prototype.serialize=function e(){return{bookID:this.bookID,spaceID:this.spaceID,message:this.message,repoID:this.repoID,customDomain:this.customDomain,status:this.status,completedAt:this.completedAt.getTime()}};t.prototype.markAsPending=function e(){return this.set("status","pending")};return t}((0,i.Record)({bookID:"",spaceID:"",message:"",status:"pending",repoID:null,customDomain:null,completedAt:new Date}));t.default=u}});