;/*!wiki-m-common:node_modules/@searchfe/assert/index.js*/
define("wiki-m-common:node_modules/@searchfe/assert/index",["require"],function(){function e(e,n){if(!e)throw new Error(n)}function n(n,r,o){return e(n==r,o)}var r=e;return r.ok=e,r.equal=n,r});
;/*!wiki-m-common:node_modules/@searchfe/underscore/src/index.js*/
define("wiki-m-common:node_modules/@searchfe/underscore/src/index",["require","wiki-m-common:node_modules/@searchfe/assert/index"],function(n){function r(n,r){var t=n;return(r||"").split(".").forEach(function(n){t=t?t[n]:void 0}),t}function t(n,r,t){n=n||{};var e=(r||"").split(".");e.forEach(function(r,u){n[r]=void 0!==n[r]?n[r]:{},u===e.length-1?n[r]=t:n=n[r]})}function e(n,r){for(var t=r.split("."),e=0;u(n,t[e])&&e<t.length;)n=n[t[e++]];return e>=t.length}function u(n,r){return null!==n&&void 0!==n&&H.call(n,r)}function o(n){return n=f(n),n.shift(),n}function i(n){var r=[];for(var t in n)r.push(t);return r}function a(n){return Object.keys(Object(n))}function c(n,r){n=n||{};for(var t in n)if(n.hasOwnProperty(t)&&r(n[t],t,n)===!1)break;return n}function f(n){return n?B.slice.call(n):[]}function s(n){var r=o(arguments);return B.forEach.apply(n||[],r)}function p(n){var r=o(arguments);return B.filter.apply(n||[],r)}function l(n,r){if(x(n)){var t=o(arguments);return B.map.apply(n||[],t)}var e=[];return c(n,function(){e.push(r.apply(null,arguments))}),e}function g(n,r,t){if(x(n)){var e=o(arguments);return B.reduce.apply(n,e)}var u,i,c=a(n);for(arguments.length>=3?(u=t,i=0):c.length>0&&(u=n[c[0]],i=1);i<c.length;i++){var f=c[i];u=r(u,n[f],f,n)}return u}function y(n){var r=o(arguments);return B.slice.apply(n||[],r)}function v(n){var r=o(arguments);return B.splice.apply(n||[],r)}function m(n){var r=o(arguments);return J.split.apply(n||"",r)}function h(n,r,t){for(var e=t||0;e<n.length;e++)if(r(n[e],e,n))return e;return-1}function d(n){return o(arguments).reduce(function(n,r){return n.replace("%s",r)},n)}function E(){return R.apply(null,y(arguments,0).reverse())}function b(n){var r;return L(n)?(r=[],n.forEach(function(n){r.push(b(n))}),r):O(n)?(r={},c(n,function(n,t){r[t]=n}),r):n}function w(n){var r;return A(n)?n:L(n)?(r=[],n.forEach(function(n){r.push(w(n))}),r):O(n)?(r={},c(n,function(n,t){r[t]=w(n)}),r):n}function O(n){var r=typeof n;return null!=n&&("object"===r||"function"===r)}function k(n){return"number"==typeof n&&n>-1&&n%1===0&&Q>=n}function x(n){return null!=n&&k(n.length)&&!A(n)}function A(n){var r=typeof n;return"function"===r}function j(n){return n instanceof String||"string"==typeof n}function _(n,r,t){return void 0===t&&(t=0),n.indexOf(r,t)>-1}function P(n){return n instanceof RegExp}function R(n){n=null==n?{}:n;var r=y(arguments,1);return s(r,function(r){I(n,r)}),n}function S(n,r){return n?void c(r,function(r,t){return O(r)&&O(n[t])?S(n[t],r):void(n[t]=r)}):n}function I(n,r){return n?(c(r,function(r,t){n[t]=r}),n):n}function D(){var n={},r=y(arguments,0).reverse();return s(r,function(r){S(n,r)}),n}function F(n){var r={};return l(n,function(n){var t=n[0],e=n[1];r[t]=e}),r}function L(n){return n instanceof Array}function N(n){return L(n)?0===n.length:!n}function q(n){return function(){return!n.apply(null,arguments)}}function G(n){return n.bind.apply(n,y(arguments))}function M(n){var r=y(arguments);return r.shift(),function(){var t=y(arguments),e=[t,arguments.length,0].concat(r);return v.apply(null,e),n.apply(null,t)}}function T(n,r){return z("function"==typeof r,"wrapper should be a function"),function(){var t=Array.prototype.slice.call(arguments,0);return t.unshift(n),r.apply(this,t)}}function X(n,r){var t=function(){};t.prototype=r.prototype;var e=n.prototype,u=n.prototype=new t;for(var o in e)e.hasOwnProperty(o)&&(u[o]=e[o]);return n.prototype.constructor=n,n}var z=n("wiki-m-common:node_modules/@searchfe/assert/index"),B=Array.prototype,C=Object.prototype,H=C.hasOwnProperty,J=String.prototype,K={},Q=Number.MAX_SAFE_INTEGER||9007199254740991;return K.keysIn=i,K.keys=a,K.get=r,K.set=t,K.has=e,K.forOwn=c,K.assign=R,K.clone=b,K.cloneDeep=w,K.merge=R,K.extend=R,K.defaults=E,K.defaultsDeep=D,K.fromPairs=F,K.slice=y,K.splice=v,K.forEach=s,K.filter=p,K.map=l,K.reduce=g,K.toArray=f,K.findIndex=h,K.split=m,K.format=d,K.isArray=L,K.isFunction=A,K.isEmpty=N,K.isString=j,K.isObject=O,K.isArrayLike=x,K.isLength=k,K.isRegExp=P,K.inherits=X,K.contains=_,K.noop=function(){},K.partial=G,K.partialRight=M,K.negate=q,K.wrap=T,K});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/di.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/di",["require","wiki-m-common:node_modules/@searchfe/assert/index","wiki-m-common:node_modules/@searchfe/underscore/src/index"],function(e){function n(e){this.config=this.normalize(e),this.container=Object.create(null)}var o=e("wiki-m-common:node_modules/@searchfe/assert/index"),t=e("wiki-m-common:node_modules/@searchfe/underscore/src/index");return n.prototype.resolve=function(e){var n=this.config[e];if(o(n,"module declaration not found: "+e),this.container[e]&&n.cache)return this.container[e];switch(void 0===n.value&&n.module&&(n.value=n.module),n.type){case"value":return this.container[e]=n.value;case"factory":o("function"==typeof n.value,"entity not injectable: "+n.value);var t=n.args||[];return this.container[e]=this.inject(n.value,t);default:throw new Error("DI type "+n.type+" not recognized")}},n.prototype.inject=function(e,n){var o=n.map(function(e){return this.resolve(e)},this);return e.apply(null,o)},n.prototype.normalize=function(e){return t.forOwn(e,function(e){void 0===e.cache&&(e.cache=!0),void 0===e.type&&(e.type="value")}),e},n});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/cache-namespace.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/cache-namespace",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index"],function(i){function t(){}function n(i,n){this.name=i,this.list=[],this.options=e.assign({limit:3,onRemove:t},n)}var e=i("wiki-m-common:node_modules/@searchfe/underscore/src/index");return n.prototype={constructor:n,setLimit:function(i){this.options.limit=i},get:function(i){var t=this.findIndexByKey(i);if(-1===t)return void 0;var n=this.list[t];return this.list.splice(t,1),this.list.push(n),n.value},set:function(i,t){for(this.remove(i);this.list.length>=this.options.limit;){var n=this.list.shift();this.options.onRemove(n.value,n.key,!0)}return this.list.push({key:i,value:t}),this},contains:function(i){return this.has(i)},has:function(i){return this.findIndexByKey(i)>-1},rename:function(i,t){if(i===t)return this;this.remove(t);var n=this.findIndexByKey(i);if(-1===n)throw new Error("key not found:"+i);return this.list[n].key=t,this},remove:function(i){var t=this.findIndexByKey(i);if(t>-1){var n=this.list[t];this.options.onRemove(n.value,n.key,!1),this.list.splice(t,1)}return this},size:function(){return this.list.length},clear:function(){return this.list=[],this},findIndexByKey:function(i){return e.findIndex(this.list,function(t){return t.key===i})}},n});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/cache.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/cache",["require","wiki-m-common:node_modules/@searchfe/assert/index","wiki-m-common:node_modules/ralltiir/src/utils/cache-namespace"],function(e){function n(e){if(!i.hasOwnProperty(e))throw new Error("cache namespace "+e+" undefined");return i[e]}var r=e("wiki-m-common:node_modules/@searchfe/assert/index"),t=e("wiki-m-common:node_modules/ralltiir/src/utils/cache-namespace"),i={},o={};return o.create=function(e,n){return r(e,"cannot create namespace with empty name"),r(!i[e],"namespace with "+e+" already created"),i[e]=new t(e,n)},o.destroy=function(e){r(i[e],"namespace with "+e+" not exist"),delete i[e]},o.using=function(e){return n(e)},o.set=function(e,r,t){return n(e).set(r,t)},o.get=function(e,r){return n(e).get(r)},o.size=function(e){return n(e).size()},o.rename=function(e,r,t){return n(e).rename(r,t)},o.remove=function(e,r){return n(e).remove(r)},o.clear=function(e){return 0!==arguments.length?n(e).clear():void(i={})},o.contains=function(e,n){if(0===arguments.length)throw new Error("namespace not specified");return 1===arguments.length?i.hasOwnProperty(e):i.hasOwnProperty(e)?i[e].contains(n):!1},o.has=function(e){return i.hasOwnProperty(e)},o});
;/*!wiki-m-common:node_modules/@searchfe/promise/src/set-immediate.js*/
define("wiki-m-common:node_modules/@searchfe/promise/src/set-immediate",["require"],function(){function e(e,n){var t=e.setImmediate;t(n)}function n(e,n){var t=e.setTimeout;t(n)}function t(e,n){var t=new e.MessageChannel;t.port1.onmessage=function(){n()},t.port2.postMessage(r)}function s(e,n){e.addEventListener("message",function t(){e.removeEventListener("message",t,!1),n()},!1),e.postMessage(r,"*")}function i(i,o){u?n(i,o):i.setImmediate?e(i,o):i.MessageChannel?t(i,o):i.addEventListener&&i.postMessage?s(i,o):n(i,o)}function o(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:Function("return this")()}function a(e){var n=o();i(n,e)}var r="setImmediate polyfill",u=/baiduboxapp/.test(window.navigator.userAgent);return a.impl=i,a});
;/*!wiki-m-common:node_modules/@searchfe/promise/src/promise.js*/
define("wiki-m-common:node_modules/@searchfe/promise/src/promise",["require","wiki-m-common:node_modules/@searchfe/assert/index","wiki-m-common:node_modules/@searchfe/promise/src/set-immediate"],function(t){function e(t){f(this instanceof e,"Promise must be called with new operator"),f("function"==typeof t,"callback not defined"),this._state=o,this._fulfilledCbs=[],this._rejectedCbs=[],this._errorPending=!1,this._fromResolver(t)}function n(t){f(t._state===s,c);var e;e="function"==typeof window.PromiseRejectionEvent?window.PromiseRejectionEvent:CustomEvent;var n=new e("unhandledrejection",{promise:t,reason:t._result});return n.reason=n.reason||t._result,n}function i(t){return t&&"function"==typeof t.then}var o=0,r=1,s=2,c="cannot make RejectionEvent when promise not rejected",u={longStackTraces:!1},f=t("wiki-m-common:node_modules/@searchfe/assert/index"),h=t("wiki-m-common:node_modules/@searchfe/promise/src/set-immediate");return e.prototype._fulfill=function(t){this._result=t,this._state=r,this._flush()},e.prototype._reject=function(t){u.longStackTraces&&t&&(t.stack+="\n"+this._originalStack),this._result=t,this._state=s,this._errorPending=!0,this._flush(),h(function(){this._checkUnHandledRejection()}.bind(this))},e.prototype._resolve=function(t){i(t)?this._fromResolver(t.then.bind(t)):this._fulfill(t)},e.prototype._fromResolver=function(t){var e=!1,n=this;try{t(function(t){e||(e=!0,n._resolve(t))},function(t){e||(e=!0,n._reject(t))})}catch(i){if(e)return;e=!0,n._reject(i)}},e.prototype._checkUnHandledRejection=function(){if(this._errorPending){var t=n(this);window.dispatchEvent(t)}},e.prototype._flush=function(){if(this._state!==o){var t=this._state===s?this._rejectedCbs:this._fulfilledCbs;t.forEach(function(t){if(this._state===s&&this._errorPending&&(this._errorPending=!1),"function"==typeof t){var e=this._result;h(function(){t(e)})}},this),this._rejectedCbs=[],this._fulfilledCbs=[]}},e.prototype._done=function(t,e){this._fulfilledCbs.push(t),this._rejectedCbs.push(e),this._flush()},e.prototype.then=function(t,n){var i=this;return new e(function(e,o){var r;i._done(function(n){if("function"!=typeof t)return e(n);try{r=t(n)}catch(i){return o(i)}e(r)},function(t){if("function"!=typeof n)return o(t);try{r=n(t)}catch(i){return o(i)}e(r)})})},e.prototype.catch=function(t){return this.then(function(t){return t},t)},e.prototype.finally=function(t){return this.then(t,t)},e.resolve=function(t){return t instanceof e?t:new e(function(e){return e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.all=function(t){return new e(function(n,i){function o(){0>=s&&n(r)}var r=t.map(function(){return void 0}),s=t.length;t.map(e.resolve).forEach(function(t,e){t.then(function(t){r[e]=t,s--,o()},i)}),o()})},e.fromCallback=function(t){return new e(function(e){t(function(t){e(t)})})},e.mapSeries=function(t,n){var i,o=[];return 0===t.length?e.resolve(o):(t.forEach(function(r,s){i=i?e.resolve(i).then(function(){return n(r,s,t)}):e.resolve(n(r,s,t)),i=i.then(function(t){o.push(t)})}),i.then(function(){return o}))},e});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/emitter.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/emitter",["require"],function(){function t(){}var e=t.prototype;e._getEvents=function(){return this._events||(this._events={}),this._events},e._getMaxListeners=function(){return isNaN(this.maxListeners)&&(this.maxListeners=10),this.maxListeners},e.on=function(t,e){var n=this._getEvents(),r=this._getMaxListeners();n[t]=n[t]||[];var s=n[t].length;if(s>=r&&0!==r){var i="Warning: possible Emitter memory leak detected. "+s+" listeners added.";console.warn(i)}return n[t].push(e),this},e.once=function(t,e){function n(){r.off(t,n),e.apply(this,arguments)}var r=this;return n.listener=e,this.on(t,n),this},e.off=function(t,e){var n=this._getEvents();if(0===arguments.length)return this._events={},this;var r=n[t];if(!r)return this;if(1===arguments.length)return delete n[t],this;for(var s,i=0;i<r.length;i++)if(s=r[i],s===e||s.listener===e){r.splice(i,1);break}return this},e.emit=function(t){for(var e=this._getEvents(),n=e[t],r=[],s=1;s<arguments.length;s++)r.push(arguments[s]);if(n)for(n=n.slice(0),s=0;s<n.length;s++)try{n[s].apply(this,r)}catch(i){console.error(i)}return this},e.listeners=function(t){var e=this._getEvents();return e[t]||[]},e.setMaxListeners=function(t){return this.maxListeners=t,this};var n=Object.keys(e);return t.mixin=function(t){for(var r,s=0,i=n.length;i>s;s++)r=n[s],t[r]=e[r];return t},t});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/logger.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/logger",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/emitter"],function(e){function o(){m=u=Date.now()}function n(){var e=Array.prototype.slice.call(arguments);l&&e.unshift("["+r()+"]");var o,n=new Error("logger track").stack||"",i=n.split("\n")[3]||"",t="";o=/at\s+\(?(.*):\d+:\d+\)?$/.exec(i)||[];var c=o[1];o=/([^/?#]+)([?#]|$)/.exec(c)||[];var a=o[1];t+=a?a+":":"",o=/at ([\w\d.]+)\s*\(/.exec(i)||[];var s=o[1]||"anonymous";return t+=s,e.unshift("["+t+"]"),e}function r(){var e=Date.now(),o=(e-u)/1e3,n=o+"(+"+(e-m)+")";return m=e,n}function i(e,o,n){o.apply(console,n),n.unshift(e),d.emit.apply(d,n)}function t(e,o){return!c&&/log|debug|info/.test(e)?a.noop:function(){var r=n.apply(null,arguments);i(e,o,r)}}var l=!!location.search.match(/rt-debug-timming/i),c=!!location.search.match(/rt-debug/i),a=e("wiki-m-common:node_modules/@searchfe/underscore/src/index"),s=e("wiki-m-common:node_modules/ralltiir/src/utils/emitter"),u=Date.now(),m=u,d=new s;return c&&console.log("Ralltiir debug enabled"),l&&console.log("Ralltiir timming debug enabled"),d.log=t("log",console.log),d.debug=t("debug",console.log),d.info=t("info",console.info),d.warn=t("warn",console.warn),d.error=t("error",console.error),d.reset=o,d});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/dom.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/dom",["require"],function(){function s(s,n){e(s,n)||(s.className&&(s.className+=" "),s.className+=n)}function e(s,e){return n(e).test(s.className)}function n(s){return new RegExp("(^|\\s)"+s+"(\\s|$)")}return{addClass:s,hasClass:e}});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/util/uri-parser.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/util/uri-parser",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index"],function(n){function e(n){var e={},r=["scheme","username","password","host","port","path","query","fragment"];return r.forEach(function(r){e[r]=n[r]||u}),e}function r(n){var e={};return n.replace(/^([^@]+@)?([^:]+)(:\d+)?$/,function(n,r,t,i){r&&(r=r.slice(0,-1),r=r.split(":"),e.username=r[0],e.password=r[1]),e.host=t,i&&(e.port=i.substring(1))}),e}function t(n,e){var t=/[^:]+:\d{2,}(\/|$)/.test(n);return t&&(n=n.split("/"),o.extend(e,r(n.shift())),n.length>0&&(e.path="/"+n.join("/"))),t}function i(n,e){var r=n.indexOf(":"),t=n.indexOf("/");t=t>=0?t:n.length;var i=r>=0&&t>r;return i&&(e.scheme=n.substring(0,r),e.path=n.substring(r+1)),i}function s(n){var e={},s=n.indexOf("#");return s>=0&&(e.fragment=n.substring(s+1),n=n.substring(0,s)),s=n.indexOf("?"),s>=0&&(e.query=n.substring(s+1),n=n.substring(0,s)),s=n.indexOf("://"),s>=0?(e.scheme=n.substring(0,s),n=n.substring(s+3),"file"===e.scheme?e.path=n:(n=n.split("/"),o.extend(e,r(n.shift())),n.length>0&&(e.path="/"+n.join("/"))),e):t(n,e)?e:i(n,e)?e:(n=n.split("/"),e.host=n.shift(),n.length>0&&(e.path="/"+n.join("/")),e)}var u,o=n("wiki-m-common:node_modules/@searchfe/underscore/src/index");return function(n){return o.isString(n)&&(n=s(n)),e(n)}});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract",["require"],function(){function t(){var t=Array.prototype.slice.call(arguments);this.set.apply(this,t)}return t.prototype.get=function(){return this.data},t.prototype.set=function(t){this.data=t||""},t.prototype.add=function(t){this.set(t)},t.prototype.remove=function(){this.data=""},t.prototype.toString=function(){return this.data.toString()},t.prototype.equal=function(o){return o instanceof t&&(o=o.get()),this.data==o},t});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Scheme.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Scheme",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"],function(e){function o(e){n.call(this,e)}var i=e("wiki-m-common:node_modules/@searchfe/underscore/src/index"),n=e("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract");return i.inherits(o,n),o.prototype.set=function(e){e=e||"",this.data=e.toLowerCase()},o.prototype.equal=function(e){return e=e instanceof o?e.get():e||"",this.data===e.toLowerCase()},o});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/component/UserName.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/UserName",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"],function(e){function i(e){r.call(this,e)}var o=e("wiki-m-common:node_modules/@searchfe/underscore/src/index"),r=e("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract");return o.inherits(i,r),i});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Password.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Password",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"],function(i){function o(i){r.call(this,i)}var e=i("wiki-m-common:node_modules/@searchfe/underscore/src/index").inherits,r=i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract");return e(o,r),o});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Host.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Host",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"],function(o){function e(o){t.call(this,o)}var i=o("wiki-m-common:node_modules/@searchfe/underscore/src/index").inherits,t=o("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract");return i(e,t),e.prototype.set=function(o){o=o||"",this.data=o.toLowerCase()},e.prototype.equal=function(o){return o=o instanceof e?o.get():o||"",this.data===o.toLowerCase()},e});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Port.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Port",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"],function(t){function o(t){i.call(this,t)}var e=t("wiki-m-common:node_modules/@searchfe/underscore/src/index").inherits,i=t("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"),n={ftp:"21",ssh:"22",telnet:"23",http:"80",https:"443",ws:"80",wss:"443"};return e(o,i),o.prototype.equal=function(t,e){var i=this.data||n[e];return t instanceof o&&(t=t.get()),t=t||n[e],i===t},o.prototype.toString=function(){return this.data?":"+this.data:""},o});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Path.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Path",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"],function(t){function e(t){return t||(t="/"),t}function n(t){return t=t.split("/"),t.pop(),t.join("/")}function r(t,e){for(var n,r=0,i=t.length-1;n=t[i];i--)"."===n?t.splice(i,1):".."===n?(t.splice(i,1),r++):r&&(t.splice(i,1),r--);if(e)for(;r-->0;)t.unshift("..");return t}function i(t,e){s.call(this,t,e)}var o=t("wiki-m-common:node_modules/@searchfe/underscore/src/index").inherits,s=t("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract");return i.resolve=function(t,e){if(e=e||"","/"===e.charAt(0))return i.resolve(e);var o="/"===t.charAt(0),s=!1;e?(t=n(t),s="/"===e.charAt(e.length-1)):t.length>1&&(s="/"===t.charAt(t.length-1));var c=t.split("/").concat(e.split("/")).filter(function(t){return!!t});return c=r(c,!o),(o?"/":"")+(c.length>0?c.join("/")+(s?"/":""):"")},o(i,s),i.prototype.set=function(t,e){e instanceof i&&(e=e.get());var n=[t||""];e&&n.unshift(e),this.data=i.resolve.apply(i,n)},i.prototype.equal=function(t){var n=e(this.data);return t=e(t instanceof i?t.get():i.resolve(t||"")),n===t},i.prototype.resolve=function(t,e){t instanceof i&&(t=t.get());var n=[this.data];e?n.unshift(t):n.push(t),this.data=i.resolve.apply(i,n)},i});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/util/parse-query.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/util/parse-query",["require"],function(){function r(r){var e={};r=r.split("&");var i,t;return r.forEach(function(r){r&&(r=r.split("="),i=r[0],t=r.length>=2?n(r[1]):null,e[i]?(Array.isArray(e[i])||(e[i]=[e[i]]),e[i].push(t)):e[i]=t)}),e}function n(r){return r=String(r).replace(/\+/g,"%20"),decodeURIComponent(r)}return r});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/util/stringify-query.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/util/stringify-query",["require"],function(){function n(n){var r,i=[];return Object.keys(n).forEach(function(e){r=n[e],Array.isArray(r)||(r=[r]),r.forEach(function(n){i.push(null===n?e:e+"="+encodeURIComponent(n||""))})}),i.join("&")}return n});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Query.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Query",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract","wiki-m-common:node_modules/ralltiir/src/utils/uri/util/parse-query","wiki-m-common:node_modules/ralltiir/src/utils/uri/util/stringify-query"],function(r){function t(r,t){if(!Array.isArray(r)||!Array.isArray(t))return!1;if(r.length!==t.length)return!1;r=r.slice(0),r=r.slice(0),r.sort(),t.sort();for(var i=!0,e=0,n=r.length;i&&n>e;e++)i=r[e]==t[e];return i}function i(r,i){if(!a.isObject(r)||!a.isObject(i))return!1;var e=Object.keys(r),n=Object.keys(i);if(e.length!==n.length)return!1;for(var o,s,u=!0,c=0;u&&(o=e[c]);c++){if(!i.hasOwnProperty(o)){u=!1;break}s=r[o],u=Array.isArray(s)?t(s,i[o]):s==i[o]}return u}function e(r){return r=Array.isArray(r)?r.map(function(r){return n(r)}):null===r||void 0===r?null:n(r)}function n(r){return r=String(r).replace(/\+/g,"%20"),decodeURIComponent(r)}function o(r,t,i){var n=i[r];return t=e(t),n?(Array.isArray(n)||(n=[n]),Array.isArray(t)?n=n.concat(t):n.push(t)):n=t,i[r]=n,i}function s(r){r=r||{},u.call(this,r)}var a=r("wiki-m-common:node_modules/@searchfe/underscore/src/index"),u=r("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"),c=r("wiki-m-common:node_modules/ralltiir/src/utils/uri/util/parse-query"),l=r("wiki-m-common:node_modules/ralltiir/src/utils/uri/util/stringify-query"),m="?";return a.inherits(s,u),s.prototype.set=function(){if(1===arguments.length){var r=arguments[0];if(a.isObject(r)){var t=this.data={};a.forOwn(r,function(r,i){t[i]=e(r)})}else this.data=c(r)}else this.data[arguments[0]]=e(arguments[1])},s.prototype.get=function(r){return r?this.data[r]:a.extend({},this.data)},s.prototype.toString=function(r){r=r||m;var t=l(this.data);return t?r+t:""},s.prototype.equal=function(r){return a.isString(r)?r=c(r):r instanceof s&&(r=r.get()),i(this.data,r)},s.prototype.add=function(r,t){var i=this.data;a.isObject(r)?Object.keys(r).forEach(function(t){o(t,r[t],i)}):o(r,t,i),this.data=i},s.prototype.remove=function(r){r?this.data.hasOwnProperty(r)&&delete this.data[r]:this.data={}},s});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Fragment.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Fragment",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"],function(i){function o(i){e.call(this,i)}var r=i("wiki-m-common:node_modules/@searchfe/underscore/src/index").inherits,e=i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Abstract"),n="#";return r(o,e),o.prototype.toString=function(i){return i=i||n,this.data?i+this.data:""},o});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/uri/URI.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/uri/URI",["require","wiki-m-common:node_modules/ralltiir/src/utils/uri/util/uri-parser","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Scheme","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/UserName","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Password","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Host","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Port","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Path","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Query","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Fragment"],function(i){function o(i){i=t(i);var o,r=this;Object.keys(e).forEach(function(t){o=e[t],r[t]=new o(i[t])})}function r(i){var o=[],r=i.username.toString(),t=i.password.toString(),e=i.host.toString(),n=i.port.toString();return(r||t)&&o.push(r+":"+t+"@"),o.push(e),o.push(n),o.join("")}var t=i("wiki-m-common:node_modules/ralltiir/src/utils/uri/util/uri-parser"),e={scheme:i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Scheme"),username:i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/UserName"),password:i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Password"),host:i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Host"),port:i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Port"),path:i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Path"),query:i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Query"),fragment:i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Fragment")};return o.prototype.set=function(){var i=0,o={};arguments.length>1&&(o.name=arguments[i++]),o.data=Array.prototype.slice.call(arguments,i);var r=this[o.name];if(r)r.set.apply(r,o.data);else{var n=this,s=t(o.data[0]);Object.keys(e).forEach(function(i){n[i].set(s[i])})}},o.prototype.get=function(){var i={name:arguments[0],data:Array.prototype.slice.call(arguments,1)},o=this[i.name];return o?o.get.apply(o,i.data):void 0},o.prototype.toString=function(i){var o,t=this[i];if(t)o=t.toString();else{o=[];var e=this.scheme.toString();e&&o.push(e+":");var n=r(this);e&&n&&o.push("//"),o.push(n),o.push(this.path.toString()),o.push(this.query.toString()),o.push(this.fragment.toString()),o=o.join("")}return o},o.prototype.equal=function(i){i instanceof o||(i=new o(i));for(var r,t=!0,n=Object.keys(e),s=0;t&&(r=n[s]);s++)t="port"===r?this[r].equal(i[r].get(),this.scheme.get()):this[r].equal(i[r]);return t},o});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/url.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/url",["require","wiki-m-common:node_modules/ralltiir/src/utils/uri/URI","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Path","wiki-m-common:node_modules/ralltiir/src/utils/uri/util/uri-parser"],function(i){function r(i){return new o(i)}var o=i("wiki-m-common:node_modules/ralltiir/src/utils/uri/URI"),e=i("wiki-m-common:node_modules/@searchfe/underscore/src/index"),n=i("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Path"),m=i("wiki-m-common:node_modules/ralltiir/src/utils/uri/util/uri-parser");return r.parse=function(i){return m(i)},r.resolve=function(i,r){return n.resolve(i,r)},r.param=function(i){return e.isObject(i)?e.map(i,function(i,r){return encodeURIComponent(r)+"="+encodeURIComponent(i)}).join("&"):i},r});
;/*!wiki-m-common:node_modules/ralltiir/src/action.js*/
define("wiki-m-common:node_modules/ralltiir/src/action",["require","wiki-m-common:node_modules/ralltiir/src/utils/cache","wiki-m-common:node_modules/@searchfe/promise/src/promise","wiki-m-common:node_modules/@searchfe/assert/index","wiki-m-common:node_modules/ralltiir/src/utils/logger","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/utils/dom","wiki-m-common:node_modules/ralltiir/src/utils/url"],function(e){function t(e,t,u,l,d,m){function f(){function e(e,t){return function(r){return arguments[0]=(r||"").replace(/#.*$/,""),e.apply(t,arguments)}}var t=r.create("pages",{onRemove:function(e,t,r){s.isFunction(e.onRemove)&&e.onRemove(t,r)},limit:1e6});return t.get=e(t.get,t),t.set=e(t.set,t),t.contains=e(t.contains,t),t}function g(){return t.pathname+t.search}function p(){function e(e){return c=e,a=(a+1)%o,u}function t(e,t){var o=a;return s.isFunction(r)&&r(),r=e,n.mapSeries(c,function(e){return"function"==typeof e&&o===a?(i.log("calling lifecycle",e.name||"anonymous"),e()):void 0}).catch(t).then(function(){r=null})}var r,o=1e4,a=0,c=[],u={reset:e,exec:t,aborted:!1};return u}function h(e){var t=c.parse(e);return"sfr"===t.scheme&&"index"===t.host?x:e}function v(){var e,t=g();e=_.get(t),e?e.scrollTop=window.pageYOffset:_.set(t,{scrollTop:window.pageYOffset})}function w(r,n){var o=e.ignoreRoot(t.pathname+t.search),s=e.createURL(o).toString(),a=e.createURL(r,n).toString();return i.log("[transfering page] from:",s,"to:",a),_.contains(s)?void _.set(a,_.get(s)):void console.warn("current page not found, cannot transfer to",r)}function k(e){e=e||window.event;var t=b(e.target||e.srcElement,function(e){return"A"===e.tagName});if(t){var r=t.getAttribute("data-sf-href"),n=t.getAttribute("data-sf-options");if(r){e.preventDefault();try{n=JSON.parse(n)||{}}catch(o){console.warn("JSON parse failed, fallback to empty options"),n={}}n.src="hijack";var i={event:e,anchor:t},s=y(t)+r;U.redirect(s,null,n,i),a.addClass(t,A.visitedClassName)}}}function y(e){var t=b(e,function(e){return/(^|\s)rt-view($|\s)/.test(e.className)});return t?t.getAttribute("data-base")||"":""}function b(e,t){for(var r=e;null!==r&&!t(r);)r=r.parentNode;return r}var _,R,x,O,S,U=new d,A={},N={},C=p();return U.init=function(){U.started=!1,m.init(this.dispatch),U.pages=_=f(),R=!1,A={root:"/",visitedClassName:"visited"},x="/",O=!0,S=0},U.getState=function(){return N},U.regist=function(e,t){o(e,"invalid path pattern"),o(t,"invalid service"),t.singleton=!0,m.register(e,null,t)},U.unregist=function(e){m.unRegister(e)},U.dispatch=function(e,r){o(e,"cannot dispatch with options:"+e);var n=s.get(e,"options.src"),a=m.getOrCreate(r.url,r.pathPattern);r.service=a;var c=m.getOrCreate(e.url,e.pathPattern,"history"!==n&&"back"!==n);e.service=c,_.contains(e.url)||_.set(e.url,{id:S,isIndex:O}),e.page=_.get(e.url),r.page=_.get(r.url);var u=N;return N={},R&&(R=!1,e.options.src="back"),e.options&&"sync"===e.options.src?x=e.url||"/":O=!1,i.log("action dispatching to: "+e.url),U.emit("dispatching",{current:e,previous:r,extra:N}),l.ensureAttached(),C.reset([function(){return a?a.singleton?a.detach(e,r,u):a.beforeDetach(e,r,u):void 0},function(){return c?c.singleton?c.create(e,r,u):c.beforeAttach(e,r,u):void 0},function(){return a?a.singleton?a.destroy(e,r,u):a.detach(e,r,u):void 0},function(){return c?c.attach(e,r,u):void 0}]).exec(function(){c&&c.abort&&c.abort(e,r,u)},function(r){console.error(r),"sync"!==s.get(e,"options.src")&&t.replace(t.href)})},U.isIndexPage=function(){return O},U.exist=function(e){return m.isRegistered(e)},U.config=function(t){return 0!==arguments.length&&(s.assign(A,t),e.config(A)),A},U.redirect=function(r,n,o,a){i.log("action redirecting to: "+r),U.emit("redirecting",r),r=h(r),s.assign(N,a),o=s.assign({},o,{id:S++}),v();try{o.silent&&w(r,n),e.redirect(r,n,o)}catch(u){throw u.url=c.resolve(A.root,r),t.replace(u.url),U.emit("redirectFailed",u),u}},U.back=function(){R=!0,v(),u.back()},U.reset=function(t,r,n,o){O&&(x=t),w(t,r),s.assign(N,o),e.reset(t,r,n)},U.start=function(t){arguments.length&&U.config(t),document.body.addEventListener("click",k),e.start(),U.started=!0},U.stop=function(){document.body.removeEventListener("click",k),e.stop(),e.clear(),U.started=!1},U.destroy=function(){U.stop(),r.destroy("pages"),m.destroy(),U.pages=_=void 0,m.unRegisterAll()},U.update=function(r,n,o,i){o=o?o:{},o.hasOwnProperty("silent")||(o.silent=!0);var s=e.ignoreRoot(t.pathname+t.search),a=e.createURL(s).toString(),c=e.ignoreRoot(r),u=(c||"").replace(/\?.*/,""),l=e.getState(),d={from:{url:a},to:{url:c,path:u},extra:i};return U.partialUpdate(r,{replace:!0,state:l,transition:d,to:i&&i.container&&i.container.get(0),query:n,options:o})},U.partialUpdate=function(r,o){var i=e.ignoreRoot(t.pathname+t.search),a=e.createURL(i).toString(),c=_.get(a);w(r,o.query),o=s.assign({},{fromUrl:r,replace:!1,routerOptions:{},page:c},o);var u=m.getOrCreate(r),l=u.partialUpdate(r,o);return o.routerOptions.silent=!0,e.reset(r||t.href,o.query,o.routerOptions),n.resolve(l)},U.init(),U}var r=e("wiki-m-common:node_modules/ralltiir/src/utils/cache"),n=e("wiki-m-common:node_modules/@searchfe/promise/src/promise"),o=e("wiki-m-common:node_modules/@searchfe/assert/index"),i=e("wiki-m-common:node_modules/ralltiir/src/utils/logger"),s=e("wiki-m-common:node_modules/@searchfe/underscore/src/index"),a=e("wiki-m-common:node_modules/ralltiir/src/utils/dom"),c=e("wiki-m-common:node_modules/ralltiir/src/utils/url");return t});
;/*!wiki-m-common:node_modules/ralltiir/src/router/router/config.js*/
define("wiki-m-common:node_modules/ralltiir/src/router/router/config",[],{path:"/",root:"",mode:"async"});
;/*!wiki-m-common:node_modules/ralltiir/src/router/router/URL.js*/
define("wiki-m-common:node_modules/ralltiir/src/router/router/URL",["require","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Path","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Query","wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Fragment","wiki-m-common:node_modules/ralltiir/src/router/router/config"],function(t){function o(t,o){o=o||{},t=(t||"").trim()||n.path;var a=u.exec(t);a||console.warn("URI not valid:");var m=this.token=o.token||s,l=o.root||n.root;"/"===l.charAt(l.length-1)&&(l=l.substring(0,l.length-1)),this.root=l,t=t.split("#"),this.fragment=new i(t[1]),t=t[0].split(m);var h=o.base||{};this.path=new r(t[0],h.path),this.query=new e(t[1]);var c=this.path.get();this.outRoot=0===c.indexOf(".."),this.outRoot&&(c=r.resolve(l+"/",c),0===c.indexOf(l)&&(c=c.substring(l.length),this.path.set(c),this.outRoot=!1)),this.outRoot||"/"===c.charAt(0)||this.path.set("/"+c),o.query&&this.query.add(o.query)}var r=t("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Path"),e=t("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Query"),i=t("wiki-m-common:node_modules/ralltiir/src/utils/uri/component/Fragment"),n=t("wiki-m-common:node_modules/ralltiir/src/router/router/config"),u=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),s="?";return o.prototype.toString=function(){var t=this.root,o=this.path.get();return o=this.outRoot?r.resolve(t+"/",o):t+o,o+this.query.toString(this.token)+this.fragment.toString()},o.prototype.equalPath=function(t){return this.path.get()===t},o.prototype.equal=function(t){return this.query.equal(t.query)&&this.equalPath(t.path.get())},o.prototype.equalWithFragment=function(t){return this.equal(t)&&this.fragment.equal(t.fragment)},o.prototype.getQuery=function(){return this.query.get()},o.prototype.getPath=function(){return this.path.get()},o});
;/*!wiki-m-common:node_modules/ralltiir/src/router/router/controller.js*/
define("wiki-m-common:node_modules/ralltiir/src/router/router/controller",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/router/router/URL","wiki-m-common:node_modules/ralltiir/src/router/router/config"],function(e){function o(e,o){t(e,o)||(u(e,o),s=e)}function t(e,o){return s&&e.equal(s)&&!o.force}function r(e){var o=m.root;if("/"===e.charAt(0)&&o)if(0===e.indexOf(o))e=e.replace(o,"");else{var t=o.split("/").slice(1);t=t.map(function(){return".."}),e=t.join("/")+e,s=null}return e}function n(e,o){return e||(e=r(location.pathname)),new l(e,{query:o,base:s})}function i(e,t){if(e=e||{},!a.get(e,"state.disableServiceDispatch")){var i=r(location.pathname);if(location.search.length>1&&(i+=location.search),i=n(i),i.outRoot)return c(i.toString(),!0);var u=t?{src:"sync"}:a.extend({},e.state,{src:"history"});o(i,u)}}function c(e,o){d.dispose(),o?location.replace(e):location.href=e}var u,s,a=e("wiki-m-common:node_modules/@searchfe/underscore/src/index"),l=e("wiki-m-common:node_modules/ralltiir/src/router/router/URL"),m=e("wiki-m-common:node_modules/ralltiir/src/router/router/config"),d={};return d.init=function(e){window.addEventListener("popstate",i,!1),u=e,i(null,!0)},d.redirect=function(e,r,i){return i=i||{},e=n(e,r),e.outRoot||"page"===m.mode?!t(e,i)&&c(e.toString()):(s.equalWithFragment(e)||history.pushState(i,i.title,e.toString()),void(i.silent||o(e,i)))},d.reset=function(e,r,i){return i=i||{},e=n(e,r),e.outRoot||"page"===m.mode?!t(e,i)&&c(e.toString()):(i.silent?s=e:o(e,i),void history.replaceState(i,i.title,e.toString()))},d.dispose=function(){window.removeEventListener("popstate",i,!1),s=null},d.ignoreRoot=r,d.createURL=n,d});
;/*!wiki-m-common:node_modules/ralltiir/src/router/router.js*/
define("wiki-m-common:node_modules/ralltiir/src/router/router",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir/src/router/router/config","wiki-m-common:node_modules/ralltiir/src/router/router/controller","wiki-m-common:node_modules/ralltiir/src/utils/logger"],function(r){function o(){function r(r){var o=-1;return r=r.toString(),m.some(function(t,n){return t.raw.toString()===r&&(o=n),-1!==o}),o}function o(r,o){for(var t,n={},e=o.params||[],i=r.match(o.path)||[],a=1;a<i.length;a++)t=e[a-1]||"$"+a,n[t]=decodeURIComponent(i[a]);return n}function c(r,n){a.log("router apply: "+r),n=n||{};var i,c=t({},r.getQuery()),l={},s=r.getPath();if(i=u(r),!i)throw new Error("can not find route for: "+s);i.path instanceof RegExp&&i.path.test(s)&&(l=o(s,i));var m={path:s,pathPattern:i.raw,query:c,params:l,url:e.ignoreRoot(r.toString()),originalUrl:r.toString(),options:n},d=[m,f];f=m,a.log("router calling handler: "+i.name),i.fn.apply(i.thisArg,d)}function u(r){var o,t,n=r.getPath();return a.log("finding handlers for",r,"in rules:",m),m.some(function(e){return e.path instanceof RegExp?e.path.test(n)&&(o=e):r.equalPath(e.path)&&(o=e),e.path||(t=e),!!o}),o||t}function l(r){var o={params:[]};return o.path=r.replace(/:([^/]+)/g,function(r,t){return o.params.push(t),"([^/]+)"}),o.path=new RegExp("^"+o.path+"$"),o}var s={},m=[],f={};return s.pathPattern=function(r){r=e.ignoreRoot(r);var o=e.createURL(r),t=u(o);return t?t.raw:null},s.reset=function(r,o,t){e.reset(r,o,t)},s.config=function(r){r=r||{};var o=r.root;o&&"/"===o.charAt(o.length-1)&&(o=r.root=o.substring(0,o.length-1)),o&&"/"!==o.charAt(0)&&(r.root="/"+o),t(n,r)},s.add=function(o,n,e){if(r(o)>=0)throw new Error("path already exist");var a={raw:o,path:o,fn:n,thisArg:e};i.isString(o)&&i.contains(o,":")&&(a=t(a,l(o))),m.push(a)},s.remove=function(o){var t=r(o);t>=0&&m.splice(t,1)},s.exist=function(o){return r(o)>=0},s.clear=function(){m=[]},s.redirect=function(r,o,t){a.log("router redirecting to: "+r),e.redirect(r,o,t)},s.start=function(r){s.config(r),e.init(c)},s.stop=function(){e.dispose(),s.clear(),f={}},s.controller=function(r){var o=e;e=r,i.forOwn(o,function(r,o){e.hasOwnProperty(o)||(e[o]=r)})},s.getState=function(){return f},s.ignoreRoot=e.ignoreRoot,s.createURL=e.createURL,s}var t=r("wiki-m-common:node_modules/@searchfe/underscore/src/index").extend,n=r("wiki-m-common:node_modules/ralltiir/src/router/router/config"),e=r("wiki-m-common:node_modules/ralltiir/src/router/router/controller"),i=r("wiki-m-common:node_modules/@searchfe/underscore/src/index"),a=r("wiki-m-common:node_modules/ralltiir/src/utils/logger");return o});
;/*!wiki-m-common:node_modules/ralltiir/src/view.js*/
define("wiki-m-common:node_modules/ralltiir/src/view",["require"],function(){var n=function(){this._init()};return n.prototype={constructor:n,_init:function(){},set:function(){},get:function(){},create:function(){},render:function(){},update:function(){},attach:function(){},detach:function(){},destroy:function(){},on:function(){},off:function(){}},n});
;/*!wiki-m-common:node_modules/ralltiir/src/service.js*/
define("wiki-m-common:node_modules/ralltiir/src/service",["require"],function(){var t=function(){};return t.prototype.create=function(){},t.prototype.attach=function(){},t.prototype.detach=function(){},t.prototype.destroy=function(){},t.prototype.update=function(){},t});
;/*!wiki-m-common:node_modules/ralltiir/src/lang/map.js*/
define("wiki-m-common:node_modules/ralltiir/src/lang/map",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index"],function(t){function e(){this.size=0,this._data={}}function r(t){return a.isRegExp(t)?"reg_"+t:a.isString(t)?"str_"+t:"other_"+t}var a=t("wiki-m-common:node_modules/@searchfe/underscore/src/index");return e.prototype.set=function(t,e){var a=r(t);this._data.hasOwnProperty(a)||this.size++,this._data[a]={key:t,value:e}},e.prototype.keys=function(){var t=this._data;return Object.keys(this._data).map(function(e){var r=t[e];return r.key})},e.prototype.forEach=function(t){var e=this._data;Object.keys(this._data).forEach(function(r){var a=e[r];t(a.value,a.key)})},e.prototype.has=function(t){var e=r(t);return this._data.hasOwnProperty(e)},e.prototype.delete=function(t){var e=r(t);this._data.hasOwnProperty(e)&&(delete this._data[e],this.size--)},e.prototype.get=function(t){var e=r(t),a=this._data[e];return a?a.value:void 0},e.prototype.clear=function(){this.size=0,this._data={}},e});
;/*!wiki-m-common:node_modules/ralltiir/src/services.js*/
define("wiki-m-common:node_modules/ralltiir/src/services",["require","wiki-m-common:node_modules/ralltiir/src/lang/map","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/@searchfe/assert/index","wiki-m-common:node_modules/ralltiir/src/utils/logger","wiki-m-common:node_modules/ralltiir/src/utils/cache"],function(e){var i=e("wiki-m-common:node_modules/ralltiir/src/lang/map"),r=e("wiki-m-common:node_modules/@searchfe/underscore/src/index"),n=e("wiki-m-common:node_modules/@searchfe/assert/index"),t=e("wiki-m-common:node_modules/ralltiir/src/utils/logger"),o=e("wiki-m-common:node_modules/ralltiir/src/utils/cache");return function(e){function s(e){return p.serviceInstances.setLimit(e)}function c(e){_=new i,k=e,w=p.urlEntries=new i,h=p.serviceInstances=o.create("services",{onRemove:function(e,i,n){return!e.singleton&&r.isFunction(e.destroy)?e.destroy(i,n):void 0},limit:8})}function m(){o.destroy("services")}function a(i,r,o){n(i,"invalid path pattern"),n(!w.has(i),"path already registerd"),e.add(i,k),w.set(i,{service:o,config:r}),t.info("service",o,"registered to",i)}function d(e){return w.has(e)}function l(){w.keys().forEach(u),w.clear()}function u(i){n(i,"invalid path pattern"),n(d(i),"path not registered"),e.remove(i),w.delete(i),t.info("service unregistered from: "+i)}function f(e){var i=_.get(e);return void 0===i?void 0:h.get(i)}function g(e,i){var r=y++;return _.set(e,r),i.id=r,h.set(r,i),i}function v(i,r){var n=f(i);if(n)return n;arguments.length<2&&(r=e.pathPattern(i));var t=w.get(r);if(t){var o=t.service,s=t.config,c=o.singleton?o:new o(i,s);return g(i,c)}}var h,w,k,_,p={init:c,destroy:m,register:a,unRegister:u,isRegistered:d,unRegisterAll:l,getOrCreate:v,setInstanceLimit:s,urlEntries:null},y=0;return p}});
;/*!wiki-m-common:node_modules/ralltiir/src/utils/http.js*/
define("wiki-m-common:node_modules/ralltiir/src/utils/http",["require","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/@searchfe/promise/src/promise","wiki-m-common:node_modules/ralltiir/src/utils/url"],function(e){function t(e){return e instanceof FormData?"multipart/form-data":"application/x-www-form-urlencoded"}function n(e){var t;try{t=i.createXHR()}catch(n){return o.reject(n)}return t.open(e.method,e.url,!0),a.forOwn(e.headers,function(e,n){t.setRequestHeader(n,e)}),a.assign(t,e.xhrFields),new o(function(n,a){t.onreadystatechange=function(){4===t.readyState&&(t=r(t),t.status>=200&&t.status<300?n(t):a(t))},t.send(e.data)})}function r(e){var t=e.getAllResponseHeaders().split("\r\n").filter(a.negate(a.isEmpty)).map(function(e){return a.split(e,/\s*:\s*/)});if(e.responseHeaders=a.fromPairs(t),e.data=e.responseText,"application/json"===e.responseHeaders["Content-Type"])try{e.data=JSON.parse(e.responseText)}catch(n){console.warn("Invalid JSON content with Content-Type: application/json")}return e}var a=e("wiki-m-common:node_modules/@searchfe/underscore/src/index"),o=e("wiki-m-common:node_modules/@searchfe/promise/src/promise"),s=e("wiki-m-common:node_modules/ralltiir/src/utils/url"),i={};return i.ajax=function(e,r){return"object"==typeof e&&(r=e,e=""),r=a.defaultsDeep(r,{url:e,method:r&&r.type||"GET",headers:{},data:null,jsonp:!1,jsonpCallback:"sf_http_"+Math.random().toString(36).substr(2)}),a.forOwn(r.headers,function(e,t){r.headers[t]=e.toLowerCase(e)}),(r.headers["content-type"]||r.data)&&(r.headers["content-type"]=r.headers["content-type"]||t(r.data)),/application\/json/.test(r.headers["content-type"])?r.data=JSON.stringify(r.data):/form-urlencoded/.test(r.headers["content-type"])&&(r.data=s.param(r.data)),n(r)},i.get=function(e,t){return i.ajax(e,{data:t})},i.post=function(e,t){return i.ajax(e,{method:"POST",data:t})},i.put=function(e,t){return i.ajax(e,{method:"PUT",data:t})},i.delete=function(e,t){return i.ajax(e,{method:"DELETE",data:t})},i.createXHR=function(){var e=!1;if(window.XMLHttpRequest?e=new XMLHttpRequest:window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),!e)throw new Error("Cannot create an XHR instance");return e},i});
;/*!wiki-m-common:node_modules/ralltiir/src/resource.js*/
define("wiki-m-common:node_modules/ralltiir/src/resource",["require","wiki-m-common:node_modules/ralltiir/src/utils/http","wiki-m-common:node_modules/@searchfe/underscore/src/index"],function(r){function e(r){this.url=r}var t=r("wiki-m-common:node_modules/ralltiir/src/utils/http"),n=r("wiki-m-common:node_modules/@searchfe/underscore/src/index");return e.prototype={getUrl:function(r){var e=this.url;return n.forOwn(r,function(r,t){e=e.replace(":"+t,r)}),e=e.replace(/:[a-zA-Z]\w*/g,"")},create:function(r,e){var n=this.getUrl(e);return t.post(n,r)},query:function(r){var e=this.getUrl(r);return t.get(e)},update:function(r,e){var n=this.getUrl(e);return t.put(n,r)},"delete":function(r){var e=this.getUrl(r);return t.delete(e)}},e.prototype.constructor=e,e});
;/*!wiki-m-common:node_modules/ralltiir/src/doc.js*/
define("wiki-m-common:node_modules/ralltiir/src/doc",["require"],function(){function e(e){function r(){var r=e.querySelector("#sfr-app");r||e.body.appendChild(t)}var t=e.querySelector("#sfr-app");return t||(t=e.createElement("div"),t.setAttribute("id","sfr-app")),t.ensureAttached=r,t.ensureAttached(),t}return e});
;/*!wiki-m-common:node_modules/ralltiir/src/config.js*/
define("wiki-m-common:node_modules/ralltiir/src/config",["require","wiki-m-common:node_modules/ralltiir/src/action","wiki-m-common:node_modules/ralltiir/src/router/router","wiki-m-common:node_modules/ralltiir/src/view","wiki-m-common:node_modules/ralltiir/src/service","wiki-m-common:node_modules/ralltiir/src/services","wiki-m-common:node_modules/ralltiir/src/resource","wiki-m-common:node_modules/ralltiir/src/doc","wiki-m-common:node_modules/ralltiir/src/utils/cache","wiki-m-common:node_modules/ralltiir/src/utils/http","wiki-m-common:node_modules/ralltiir/src/utils/url","wiki-m-common:node_modules/ralltiir/src/utils/di","wiki-m-common:node_modules/ralltiir/src/utils/emitter","wiki-m-common:node_modules/@searchfe/assert/index","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/@searchfe/promise/src/promise","wiki-m-common:node_modules/ralltiir/src/lang/map","wiki-m-common:node_modules/ralltiir/src/utils/logger"],function(e){var o={action:{type:"factory",module:e("wiki-m-common:node_modules/ralltiir/src/action"),args:["router","location","history","doc","emitter","services"]},router:{type:"factory",module:e("wiki-m-common:node_modules/ralltiir/src/router/router")},view:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/view")},service:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/service")},services:{type:"factory",args:["router"],module:e("wiki-m-common:node_modules/ralltiir/src/services")},resource:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/resource")},doc:{type:"factory",module:e("wiki-m-common:node_modules/ralltiir/src/doc"),args:["document"]},cache:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/utils/cache")},http:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/utils/http")},url:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/utils/url")},di:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/utils/di")},emitter:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/utils/emitter")},assert:{type:"value",module:e("wiki-m-common:node_modules/@searchfe/assert/index")},_:{type:"value",module:e("wiki-m-common:node_modules/@searchfe/underscore/src/index")},promise:{type:"value",module:e("wiki-m-common:node_modules/@searchfe/promise/src/promise")},map:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/lang/map")},window:{type:"value",value:window},document:{type:"value",value:window.document},location:{type:"value",value:window.location},history:{type:"value",value:window.history},logger:{type:"value",module:e("wiki-m-common:node_modules/ralltiir/src/utils/logger")}};return o});
;/*!wiki-m-common:node_modules/ralltiir/src/index.js*/
define("ralltiir",["wiki-m-common:node_modules/ralltiir/src/utils/di","wiki-m-common:node_modules/ralltiir/src/config"],function(i,r){var e=new i(r);return Object.keys(r).forEach(e.resolve,e),e.container});
;/*!wiki-m-common:node_modules/ralltiir-application/utils/ua.js*/
define("wiki-m-common:node_modules/ralltiir-application/utils/ua",["require"],function(){var i=navigator.userAgent,e=/(iPad|iPhone|iPod)/.test(i),a=i.match(/ applewebkit\/(\d+)/i),t=a&&parseFloat(a[1]),o=+t>600,n=/baiduboxapp|baiduhi/.test(i);return{isIOS:e,isWKWebView:o,isBaidu:n}});
;/*!wiki-m-common:node_modules/ralltiir-application/utils/dom.js*/
define("wiki-m-common:node_modules/ralltiir-application/utils/dom",["require","ralltiir"],function(n){function e(n){n.parentNode&&n.parentNode.removeChild(n)}function t(n,e){for(var t=n;null!==t&&!e(t);)t=t.parentNode;return t}function i(n,e){var t=(n.className||"")+" "+e,i={};t.split(/\s+/g).forEach(function(n){i[n]=!0}),n.className=f.keys(i).join(" ")}function r(n,e){var t=n.className||"",i={};t.split(/\s+/g).forEach(function(n){i[n]=!0}),(e||"").split(/\s+/g).forEach(function(n){delete i[n]}),n.className=f.keys(i).join(" ")}function o(n){return s(n).childNodes[0]}function s(n){var e=document.createElement("div");return e.innerHTML=n||"",e}function a(n,e,t){var i=new Event(e,{bubbles:!0});f.assign(i,t),n.dispatchEvent(i)}function l(n,e){var t={},i=n.getAttribute("style")||"";i.split(";").forEach(function(n){var e=n.split(":"),i=(e[0]||"").trim(),r=(e[1]||"").trim();i&&r&&(t[i]=r)}),f.assign(t,e);var r="";f.forOwn(t,function(n,e){""!==n&&(r+=e+":"+n+";")}),n.setAttribute("style",r)}function c(n){l(n,{display:"block"})}function u(n){l(n,{display:"none"})}var f=n("ralltiir")._;return{css:l,removeClass:r,addClass:i,elementFromString:o,wrapElementFromString:s,trigger:a,show:c,removeNode:e,closest:t,hide:u}});
;/*!wiki-m-common:node_modules/ralltiir-application/utils/spark.js*/
!function(e,t){"function"==typeof define&&define.amd?define("wiki-m-common:node_modules/ralltiir-application/utils/spark",[],t):e.Spark=t()}(this,function(){var e={};return e.disposed=!1,e.dispose=function(){e.disposed=!0},function(){function t(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function n(e){return r?r+e:e.toLowerCase()}function a(e,n){var a="";for(var i in n)n[i]||0===n[i]?a+=t(i)+":"+n[i]+";":e.style.removeProperty(t(i));e.style.cssText+=";"+a}function i(e){return e.indexOf("translate")>-1?!0:(I.style[e]=0,"px"===I.style[e].replace(/\d/g,"")?!0:!1)}var r,o,u,s,c,f,d,l,m,p,w,y,h,v="",M={Webkit:"webkit",Moz:"",O:"o"},I=document.createElement("div"),b=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,O=Number.isNaN||window.isNaN;if(void 0===I.style.transform)for(var A in M)if(void 0!==I.style[A+"TransitionProperty"]){v="-"+A.toLowerCase()+"-",r=M[A];break}o=v+"transform",u=v+"transition-property",s=v+"transition-duration",f=v+"transition-delay",c=v+"transition-timing-function",y=n("TransitionEnd"),d=v+"animation-name",l=v+"animation-duration",p=v+"animation-delay",m=v+"animation-timing-function",w=v+"animation-fill-mode",h=n("AnimationEnd");var g={};g[u]="",g[s]="",g[f]="",g[c]="",g[d]="",g[l]="",g[p]="",g[m]="";var P=void 0===r&&void 0===I.style.transitionProperty,F={linear:"linear",ease:"ease","ease-in":"ease-in","ease-out":"ease-out","ease-in-out":"ease-in-out"},k=/^@(?:-webkit-)?keyframes\s+(?:['"])?(\w+)(?:['"])?\s*{/;e.css3=function(n,r,v,M,I,A){if(e.disposed=!1,n&&r){n.getAttribute("data-naboo")||n.setAttribute("data-naboo",0),n.setAttribute("data-naboo",+n.getAttribute("data-naboo")+1),P&&(v=0),v=Math.max(v,0),M=F[M]||"linear",I=Number(I)||0;var q,x={};if(v/=1e3,I/=1e3,"string"==typeof r){var T;if(k.test(r)){T=r.match(k)[1];var E=T+"_"+Date.now(),C=document.createElement("style");C.innerText=r.replace(new RegExp(T,"g"),E),document.head.appendChild(C),T=E}else T=r;x[d]=n.style[d]+(n.style[d]?", ":"")+T,x[l]=n.style[l]+(n.style[l]?", ":"")+v+"s",x[m]=n.style[m]+(n.style[m]?", ":"")+M,x[p]=n.style[p]+(n.style[p]?", ":"")+I+"s",x[w]="both",q=h}else if("[object Object]"===Object.prototype.toString.call(r)){var L=[],N="";for(var j in r){var B=r[j];!O(Number(B))&&i(j)&&(B+="px"),b.test(j)?N+=j+"("+B+") ":(x[j]=B,L.push(t(j)))}N&&(x[o]=N,L.push(o)),v>0&&(x[u]=n.style[u]+(n.style[u]?", ":"")+L.join(", "),x[s]=n.style[s]+(n.style[s]?", ":"")+v+"s",x[c]=n.style[c]+(n.style[c]?", ":"")+M,x[f]=n.style[f]+(n.style[f]?", ":"")+I+"s"),q=y}var D=!1,S=function(e){if(!e||e.elapsedTime===v+I){if("undefined"!=typeof e){if(e.target!==e.currentTarget)return;e.target.removeEventListener(q,S)}else n.removeEventListener(q,S);D=!0,n.setAttribute("data-naboo",+n.getAttribute("data-naboo")-1),0===+n.getAttribute("data-naboo")&&a(n,g),A&&A()}};v>0&&(n.addEventListener(q,S),setTimeout(function(){e.disposed||D||S()},1e3*(v+I)+25)),n.clientLeft,a(n,x)}}}(),function(){function t(e,t,n,a,i,r,o,u){function s(){c=Date.now();var l=c-f,m=o(l,n,d,r);i&&(m+=""+i),void 0!==e.style[t]?e.style[t]=m:e[t]=m,r>l?window.requestAnimationFrame(s):(void 0!==e.style[t]?e.style[t]=a+""+i:e[t]=a+""+i,u())}var c,f=Date.now(),d=a-n;s()}var n={Linear:{easeIn:function(e,t,n,a){return n*e/a+t},easeOut:function(e,t,n,a){return n*e/a+t},easeInOut:function(e,t,n,a){return n*e/a+t}},Quad:{easeIn:function(e,t,n,a){return n*(e/=a)*e+t},easeOut:function(e,t,n,a){return-n*(e/=a)*(e-2)+t},easeInOut:function(e,t,n,a){return(e/=a/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}},Cubic:{easeIn:function(e,t,n,a){return n*(e/=a)*e*e+t},easeOut:function(e,t,n,a){return n*((e=e/a-1)*e*e+1)+t},easeInOut:function(e,t,n,a){return(e/=a/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t}},Quart:{easeIn:function(e,t,n,a){return n*(e/=a)*e*e*e+t},easeOut:function(e,t,n,a){return-n*((e=e/a-1)*e*e*e-1)+t},easeInOut:function(e,t,n,a){return(e/=a/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t}},Quint:{easeIn:function(e,t,n,a){return n*(e/=a)*e*e*e*e+t},easeOut:function(e,t,n,a){return n*((e=e/a-1)*e*e*e*e+1)+t},easeInOut:function(e,t,n,a){return(e/=a/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t}},Sine:{easeIn:function(e,t,n,a){return-n*Math.cos(e/a*(Math.PI/2))+n+t},easeOut:function(e,t,n,a){return n*Math.sin(e/a*(Math.PI/2))+t},easeInOut:function(e,t,n,a){return-n/2*(Math.cos(Math.PI*e/a)-1)+t}},Expo:{easeIn:function(e,t,n,a){return 0==e?t:n*Math.pow(2,10*(e/a-1))+t},easeOut:function(e,t,n,a){return e==a?t+n:n*(-Math.pow(2,-10*e/a)+1)+t},easeInOut:function(e,t,n,a){return 0==e?t:e==a?t+n:(e/=a/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(-Math.pow(2,-10*--e)+2)+t}},Circ:{easeIn:function(e,t,n,a){return-n*(Math.sqrt(1-(e/=a)*e)-1)+t},easeOut:function(e,t,n,a){return n*Math.sqrt(1-(e=e/a-1)*e)+t},easeInOut:function(e,t,n,a){return(e/=a/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+t:n/2*(Math.sqrt(1-(e-=2)*e)+1)+t}},Elastic:{easeIn:function(e,t,n,a,i,r){var o;return 0==e?t:1==(e/=a)?t+n:("undefined"==typeof r&&(r=.3*a),!i||i<Math.abs(n)?(o=r/4,i=n):o=r/(2*Math.PI)*Math.asin(n/i),-(i*Math.pow(2,10*(e-=1))*Math.sin(2*(e*a-o)*Math.PI/r))+t)},easeOut:function(e,t,n,a,i,r){var o;return 0==e?t:1==(e/=a)?t+n:("undefined"==typeof r&&(r=.3*a),!i||i<Math.abs(n)?(i=n,o=r/4):o=r/(2*Math.PI)*Math.asin(n/i),i*Math.pow(2,-10*e)*Math.sin(2*(e*a-o)*Math.PI/r)+n+t)},easeInOut:function(e,t,n,a,i,r){var o;return 0==e?t:2==(e/=a/2)?t+n:("undefined"==typeof r&&(r=.3*a*1.5),!i||i<Math.abs(n)?(i=n,o=r/4):o=r/(2*Math.PI)*Math.asin(n/i),1>e?-.5*i*Math.pow(2,10*(e-=1))*Math.sin(2*(e*a-o)*Math.PI/r)+t:i*Math.pow(2,-10*(e-=1))*Math.sin(2*(e*a-o)*Math.PI/r)*.5+n+t)}},Back:{easeIn:function(e,t,n,a,i){return"undefined"==typeof i&&(i=1.70158),n*(e/=a)*e*((i+1)*e-i)+t},easeOut:function(e,t,n,a,i){return"undefined"==typeof i&&(i=1.70158),n*((e=e/a-1)*e*((i+1)*e+i)+1)+t},easeInOut:function(e,t,n,a,i){return"undefined"==typeof i&&(i=1.70158),(e/=a/2)<1?n/2*e*e*(((i*=1.525)+1)*e-i)+t:n/2*((e-=2)*e*(((i*=1.525)+1)*e+i)+2)+t}},Bounce:{easeIn:function(e,t,a,i){return a-n.Bounce.easeOut(i-e,0,a,i)+t},easeOut:function(e,t,n,a){return(e/=a)<1/2.75?7.5625*n*e*e+t:2/2.75>e?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:2.5/2.75>e?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},easeInOut:function(e,t,a,i){return i/2>e?.5*n.Bounce.easeIn(2*e,0,a,i)+t:.5*n.Bounce.easeOut(2*e-i,0,a,i)+.5*a+t}}};!function(){for(var t=0,n=["webkit","moz"],a=0;a<n.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[n[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[a]+"CancelAnimationFrame"]||window[n[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var a=(new Date).getTime(),i=Math.max(0,16.7-(a-t)),r=window.setTimeout(function(){e.disposed||n(a+i)},i);return t=a+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),e.js=function(a,i,r,o,u,s,c){e.disposed=!1;var f=n[o][u],d=a.ownerDocument.defaultView.getComputedStyle(a,null);c||(c=s,s=0);var l=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i;setTimeout(function(){if(!e.disposed){var n=0;for(var o in i){n++;var u=d[o]||d.getPropertyValue(o);u||0===u||(u=a[o]);var s=l.exec(u),m=s[3];u=parseFloat(s[2]);var p=parseFloat(i[o]);t(a,o,u,p,m,r,f,function(){n--,0>=n&&c()})}}},s)}}(),e});
;/*!wiki-m-common:node_modules/ralltiir-application/config.js*/
define("wiki-m-common:node_modules/ralltiir-application/config",["require"],function(){function e(){var e=/rt-duration=(\d+)/.exec(location.search);return e?Number(e[1]):300}var a={debugEnabled:/rt-debug/.test(location.search),cacheDisabled:/rt-cache-disable/.test(location.search),duration:e(),animationEase:"ease"};return a.enabled&&console.log("Ralltiir Application debug enabled"),a.cacheDisabled&&console.log("Ralltiir Application cache disabled"),a});
;/*!wiki-m-common:node_modules/ralltiir-application/utils/animation.js*/
define("wiki-m-common:node_modules/ralltiir-application/utils/animation",["require","wiki-m-common:node_modules/ralltiir-application/utils/ua","ralltiir","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/@searchfe/promise/src/promise","wiki-m-common:node_modules/ralltiir-application/utils/dom","wiki-m-common:node_modules/ralltiir-application/utils/spark","wiki-m-common:node_modules/ralltiir-application/config"],function(i){function o(i,o,e){a.debug("[restoreFixedPosition] with scrollLeft/Top:",o,e),i.scrollLeft=o,i.scrollTop=e,c.css(i.querySelector(".rt-head"),{"z-index":"610",top:(e||0)+"px"}),s.forEach(i.querySelectorAll(".rt-fixed"),function(i){c.css(i,{opacity:"0"})})}function e(){return n.isIOS?n.isWKWebView&&!n.isBaidu:!0}function t(i,o,e){return i=i?i:0,o=o?o:0,e=e?e:0,"number"==typeof i&&(i+="px"),"number"==typeof o&&(o+="px"),"number"==typeof e&&(e+="px"),"translate3d("+i+","+o+","+e+")"}var n=i("wiki-m-common:node_modules/ralltiir-application/utils/ua"),r=i("ralltiir"),s=i("wiki-m-common:node_modules/@searchfe/underscore/src/index"),l=i("wiki-m-common:node_modules/@searchfe/promise/src/promise"),a=r.logger,c=i("wiki-m-common:node_modules/ralltiir-application/utils/dom"),m=i("wiki-m-common:node_modules/ralltiir-application/utils/spark"),d=i("wiki-m-common:node_modules/ralltiir-application/config"),u={};return u.enter=function(i,e,n){return c.css(i,{display:"block",position:"fixed","z-index":"600",top:0,left:0,height:"100%",width:"100%",overflow:"hidden",opacity:0,"-webkit-transform":t("100%",0,0),transform:t("100%",0,0)}),o(i,e,n),new l(function(o){m.css3(i,{opacity:1,"-webkit-transform":t(0,0,0),transform:t(0,0,0)},d.duration,d.animationEase,0,o)})},u.prepareExit=function(i,n,r){a.debug("prepareing exit animation with scrollX/scrollY",n,r),c.css(i,{position:"fixed","z-index":"600",top:0,left:0,opacity:1,height:"100%",width:"100%",overflow:"hidden","-webkit-transform":t(0,0,0),transform:t(0,0,0)}),e()&&o(i,n,r)},u.exit=function(i){return new l(function(o){m.css3(i,{left:"100%","-webkit-transform":t(0,0,0),transform:t(0,0,0)},d.duration,d.animationEase,0,function(){c.css(i,{display:"none"}),o()})})},u.exitSilent=function(i){return c.css(i,{display:"none"}),l.resolve()},u.resetStyle=function(i){a.debug("resetting styles for",i),c.css(i,{display:"",opacity:"",position:"","z-index":"",top:"",left:"",height:"",width:"",overflow:"","-webkit-transform":"",transform:""}),c.css(i.querySelector(".rt-head"),{"z-index":"",position:"",top:""}),s.forEach(i.querySelectorAll(".rt-fixed"),function(i){c.css(i,{opacity:""})})},u});
;/*!wiki-m-common:node_modules/ralltiir-application/utils/url.js*/
define("wiki-m-common:node_modules/ralltiir-application/utils/url",["require","ralltiir"],function(e){function n(e,t,i){return"object"==typeof t?(o.forOwn(t,function(o,t){e=n(e,t,o)}),e):(e+=/\?/.test(e)?"&":"?",e+=encodeURIComponent(t)+"="+encodeURIComponent(i))}var o=e("ralltiir")._;return{setQuery:n}});
;/*!wiki-m-common:node_modules/ralltiir-application/view/loading.js*/
define("wiki-m-common:node_modules/ralltiir-application/view/loading",["require","wiki-m-common:node_modules/ralltiir-application/utils/dom"],function(i){function o(i){this.container=i,this.element=n.elementFromString(t)}var n=i("wiki-m-common:node_modules/ralltiir-application/utils/dom"),t=['<div class="rt-loading">','  <span class="rt-loading-logo"></span>','  <span class="rt-loading-bar"></span>',"</div>"].join("\n");return o.prototype.show=function(){n.css(this.container,{"background-color":"#fff"}),this.container.appendChild(this.element)},o.prototype.hide=function(){n.css(this.container,{"background-color":""}),n.removeNode(this.element)},o});
;/*!wiki-m-common:node_modules/ralltiir-application/view/render.js*/
define("wiki-m-common:node_modules/ralltiir-application/view/render",["require","wiki-m-common:node_modules/@searchfe/assert/index","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/@searchfe/promise/src/promise","wiki-m-common:node_modules/ralltiir-application/utils/dom"],function(e){function n(){}function t(e,n){for(;e.childNodes.length>0;)n.appendChild(e.childNodes[0])}function r(e,t){var r=l.toArray(e).filter(function(e){return p.test(e.rel)});return new f(function(e){function o(){i--,0===i&&e()}var i=r.length;return 0===i?(i=1,o()):void r.forEach(function(e){t.appendChild(e),n.loadResource(e,o)})})}function o(){var e="sf_closure_eval_"+Math.random().toString(36).substr(2);return window[e]=function(e){e()},e}function i(e){delete window[e]}function c(e,t,r){function o(){h.removeNode(e),r()}t.appendChild(e),e.src?n.loadResource(e,o):o()}function u(e){var n=document.createElement("script");return n.src=e.src,n}function d(e,n){l.isArrayLike(e)||(e=[e]),l.forEach(e,function(e){1===e.nodeType&&e.setAttribute("rt-renderid",n)})}function a(e){return function(n){if(1===n.nodeType){var t=n.getAttribute("rt-renderid");return n.removeAttribute("rt-renderid"),t!==e}return!0}}var s=e("wiki-m-common:node_modules/@searchfe/assert/index"),l=e("wiki-m-common:node_modules/@searchfe/underscore/src/index"),f=e("wiki-m-common:node_modules/@searchfe/promise/src/promise"),m=/^$|\/(?:java|ecma)script/i,p=/stylesheet/i,h=e("wiki-m-common:node_modules/ralltiir-application/utils/dom");return n.prototype.moveClasses=function(e,n){(e.className||"").split(/\s+/).forEach(function(e){h.addClass(n,e)})},n.prototype.render=function(e,n,o){var i=Math.random().toString(36).substr(1);return f.resolve().then(function(){s(n,"root element not exist");var t=n.querySelectorAll("link");return d(t,i),r(t,e)}).then(function(){o.replace&&l.filter(e.childNodes,a(i)).forEach(h.removeNode),t(n,e),o.onContentLoaded&&o.onContentLoaded()}).then(function(){return this.enforceJS(e,o.boforeEvalScript)}.bind(this))},n.parse=function(e){var n=document.createElement("div");return n.innerHTML=e,l.forEach(n.querySelectorAll("[data-rt-omit]"),function(e){h.removeNode(e)}),n},n.prototype.enforceJS=function(e){var n=o(this.global),t=l.toArray(e.querySelectorAll("script")).filter(function(e){return m.test(e.type)}).map(function(e){return e.src?u(e):this.wrapScript(e,n)},this);return new f(function(r){function o(){u--,0>=u&&(i(n),r())}var u=t.length;return 0===u?o():void t.forEach(function(n){c(n,e,o)})})},n.prototype.wrapScript=function(e,n){var t=document.createElement("script");return t.text=n+"("+this.clientFunction(e.innerHTML)+");",t},n.prototype.clientFunction=function(e){return"function(){"+e+"}"},n.loadResource=function(e,n){var t=!1;e.onload=e.onerror=e.onreadystatechange=function(){var r=e.readyState;if("undefined"==typeof r||/^(loaded|complete)$/.test(r)){if(t)return;t=!0,setTimeout(function(){n(e)})}}},n});
;/*!wiki-m-common:node_modules/ralltiir-application/view/view.js*/
define("wiki-m-common:node_modules/ralltiir-application/view/view",["require","wiki-m-common:node_modules/ralltiir-application/utils/animation","wiki-m-common:node_modules/ralltiir-application/utils/ua","wiki-m-common:node_modules/ralltiir-application/utils/url","wiki-m-common:node_modules/ralltiir-application/view/loading","wiki-m-common:node_modules/ralltiir-application/utils/dom","ralltiir","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/@searchfe/promise/src/promise","wiki-m-common:node_modules/@searchfe/assert/index","wiki-m-common:node_modules/ralltiir-application/view/render"],function(t){function e(t,e){this.renderer=new m,this.options=r(t.options),this.performance=t.performance,this.valid=!0,e?(this.initElement(e),this.populated=!0,this.options=h.defaultsDeep(r(o(e)),this.options),this.setData(this.options)):(this.initElement(this.createContainer()),this.setData(this.options)),this.loading=new a(this.viewEl)}function r(t){return t=t||{},t=h.cloneDeep(t),void 0===h.get(t,"back.html")&&history.length>1&&h.set(t,"back.html","<rt-back>"+e.backHtml+"</rt-back>"),t}function i(){"scrollRestoration"in history&&!l.isIOS&&(history.scrollRestoration="manual")}function o(t){var e=t.querySelector(".rt-head"),r={},i=e.querySelector(".rt-back");i&&i.innerHTML&&(r.back={html:i.innerHTML});var o=e.querySelector(".rt-title");o&&o.innerHTML&&(r.title={html:o.innerHTML});var n=e.querySelector(".rt-subtitle");n&&n.innerHTML&&(r.subtitle={html:n.innerHTML});var l=e.querySelector(".rt-actions");return l&&l.children.length&&(r.actions=[],h.forEach(l.children,function(t){t&&t.outerHTML&&r.actions.push({html:t.outerHTML})})),r}var n=t("wiki-m-common:node_modules/ralltiir-application/utils/animation"),l=t("wiki-m-common:node_modules/ralltiir-application/utils/ua"),s=t("wiki-m-common:node_modules/ralltiir-application/utils/url"),a=t("wiki-m-common:node_modules/ralltiir-application/view/loading"),c=t("wiki-m-common:node_modules/ralltiir-application/utils/dom"),d=t("ralltiir"),h=t("wiki-m-common:node_modules/@searchfe/underscore/src/index"),u=t("wiki-m-common:node_modules/@searchfe/promise/src/promise"),p=t("wiki-m-common:node_modules/@searchfe/assert/index"),m=t("wiki-m-common:node_modules/ralltiir-application/view/render"),v=d.logger,f=d.http,w=d.action,y=['<div class="rt-view active">','  <div class="rt-head">','    <div class="rt-back"></div>','    <div class="rt-actions"></div>','    <div class="rt-center">','      <span class="rt-title"></span>','      <span class="rt-subtitle"></span>',"    </div>","  </div>",'  <div class="rt-body"></div>',"</div>"].join("");return i(),e.prototype.initElement=function(t){p(t,".rt-view not exist"),this.viewEl=t,this.viewEl.setAttribute("data-base",this.options.baseUrl||""),this.headEl=this.viewEl.querySelector(".rt-head"),p(this.headEl,".rt-view>.rt-head not exist"),this.bodyEl=this.viewEl.querySelector(".rt-body"),p(this.bodyEl,".rt-view>rt-body not exist"),this.viewEl.ralltiir=this},e.prototype.render=function(){var t=this;return this.pendingFetch.then(function(e){t.performance.domLoading=Date.now();var i=e.data||"",n=m.parse(i);t.loading.hide();var l=n.querySelector(".rt-view");if(!l){var s='".rt-view" not found in retrieved HTML(from '+t.backendUrl+" )abort rendering...";throw new Error(s)}return t.renderer.moveClasses(l,t.viewEl),u.resolve().then(function(){return t.renderer.render(t.headEl,n.querySelector(".rt-head"),{replace:!0,onContentLoaded:function(){var e=o(c.wrapElementFromString(i));t.setData(r(e))}}).catch(function(t){throw t.code=t.code||910,t})}).then(function(){return t.performance.headInteractive=Date.now(),t.renderer.render(t.bodyEl,n.querySelector(".rt-body"),{replace:!0,onContentLoaded:function(){t.performance.domContentLoaded=Date.now()}}).catch(function(t){throw t.code=t.code||911,t})})}).then(function(){t.populated=!0}).catch(function(t){throw t.code=t.code||919,t})},e.prototype.partialUpdate=function(t,e){t=this.resolveUrl(t);var r=this.renderer,i=this.bodyEl,o=e.to?i.querySelector(e.to):i,n={url:t,options:e},l=new a(o);t!==location.pathname+location.search&&(this.valid=!1),e.to||(e.to=".rt-body"),e.from||(e.from=e.to),e.fromUrl||(e.fromUrl=t),c.trigger(o,"rt.willUpdate",n),e.replace&&(o.innerHTML="",l.show());var h=Math.random().toString(36).substr(2);return o.setAttribute("data-rt-token",h),this.fetch(s.setQuery(e.fromUrl,{"rt-partial":"true","rt-selector":e.from})).then(function(i){if(l.hide(),o.getAttribute("data-rt-token")===h){d.action.reset(t,null,{silent:!0});var s=m.parse(i.data||"");return s=e.from?s.querySelector(e.from):s,r.render(o,s,{replace:e.replace}).then(function(){c.trigger(o,"rt.updated",n)})}}).catch(function(e){console.warn("partialUpdate Error, redirecting",e),location.href=t})},e.prototype.setData=function(t){var e=this.headEl;if(this.updateTitleBarElement(e.querySelector(".rt-back"),t.back),this.updateTitleBarElement(e.querySelector(".rt-title"),t.title),this.updateTitleBarElement(e.querySelector(".rt-subtitle"),t.subtitle),t.actions){var r=e.querySelector(".rt-actions");r.innerHTML="",h.forEach(t.actions,function(t){var e=c.elementFromString('<span class="rt-action">');t.tryReplace=!0;var i=this.updateTitleBarElement(e,t);r.appendChild(i)},this)}},e.prototype.resetStyle=function(){n.resetStyle(this.viewEl)},e.prototype.setAttached=function(){var t=this;return new u(function(e){t.resetStyle(),t.restoreStates(),t.attached=!0,t.performance.domInteractive=Date.now(),setTimeout(function(){t.trigger("rt.attached"),e()})})},e.prototype.setActive=function(){this.trigger("rt.ready"),c.addClass(this.viewEl,"active")},e.prototype.reuse=function(){d.doc.appendChild(this.viewEl)},e.prototype.setDetached=function(){this.attached=!1,c.removeNode(this.viewEl),this.trigger("rt.detached")},e.prototype.trigger=function(t){return c.trigger(this.viewEl,t)},e.prototype.enter=function(t){if(this.trigger("rt.willAttach"),v.debug("[view.enter] resetting styles, useEnterAnimation",t),this.resetStyle(),!t)return v.debug("[view.enter] animation disabled restoreStates..."),this.restoreStates(),u.resolve();var e=this.viewEl;return v.debug("[view.enter] calling animaiton.enter with",this.scrollX,this.scrollY),n.enter(e,this.scrollX,this.scrollY)},e.prototype.prepareExit=function(){return this.trigger("rt.willDetach"),this.scrollX=window.scrollX,this.scrollY=window.scrollY,v.debug("[view.prepareExit] saving scrollX/scrollY",this.scrollX,this.scrollY),c.removeClass(this.viewEl,"active"),n.prepareExit(this.viewEl,this.scrollX,this.scrollY)},e.prototype.exit=function(t){return t?n.exit(this.viewEl,this.scrollX,this.scrollY):n.exitSilent(this.viewEl)},e.prototype.destroy=function(){this.trigger("rt.destroyed"),c.removeNode(this.viewEl),delete this.viewEl,delete this.headEl,delete this.bodyEl},e.prototype.restoreStates=function(){v.debug("restoring states to",this.scrollX,this.scrollY),this.hasOwnProperty("scrollX")&&scrollTo(this.scrollX,this.scrollY)},e.prototype.fetchUrl=function(t){this.loading.show(),this.pendingFetch=this.fetch(t)},e.prototype.fetch=function(t,e){return this.backendUrl=this.getBackendUrl(t),this.backendUrl=s.setQuery(this.backendUrl,"rt","true"),this.performance.requestStart=Date.now(),f.ajax(this.backendUrl,{headers:e||{},xhrFields:{withCredentials:!0}}).catch(function(t){throw t.code=t.status||900,t})},e.prototype.getBackendUrl=function(t){if(h.isFunction(this.options.backendUrl))return this.options.backendUrl(t);if(h.isString(this.options.backendUrl))return this.options.backendUrl;var e=d.action.config().root.replace(/\/+$/,"");return e+t},e.backHtml='<i class="c-icon">&#xe750;</i>',e.prototype.createContainer=function(){var t=c.elementFromString(y);return d.doc.appendChild(t),t},e.prototype.updateTitleBarElement=function(t,r){return h.has(r,"html")&&(t.innerHTML=r.html||"",t.querySelector("rt-back")?(t.innerHTML=t.innerHTML||e.backHtml,r.onClick=w.back.bind(w)):t.querySelector("rt-empty")&&(t.innerHTML=""),r.tryReplace&&t.children.length&&(t=t.children[0])),t.rtClickHandler||(t.rtClickHandler=h.noop,t.addEventListener("click",function(){t.rtClickHandler()})),h.has(r,"onClick")&&(t.rtClickHandler=h.get(r,"onClick")),t},e.prototype.resolveUrl=function(t){return this.options.baseUrl+t},e});
;/*!wiki-m-common:node_modules/ralltiir-application/utils/performance.js*/
define("wiki-m-common:node_modules/ralltiir-application/utils/performance",["require"],function(){function t(){this.init()}return t.prototype.init=function(){this.navigationStart=null,this.requestStart=null,this.domLoading=null,this.headInteractive=null,this.domContentLoaded=null,this.domInteractive=null},t.prototype.startNavigation=function(){this.init(),this.navigationStart=Date.now()},t});
;/*!wiki-m-common:node_modules/ralltiir-application/service.js*/
define("ralltiir-application",["require","ralltiir","wiki-m-common:node_modules/ralltiir-application/view/view","wiki-m-common:node_modules/ralltiir-application/utils/performance","wiki-m-common:node_modules/@searchfe/underscore/src/index","wiki-m-common:node_modules/ralltiir-application/config"],function(t){function i(t,i){this.options=o(i),this.scope={performance:new a,options:this.options},this.name=this.options.name}function e(t){return"sync"===c.get(t,"options.src")}function o(t){return t?(t=c.cloneDeep(t),(t.view||t.head)&&console.warn("[DEPRECATED] options.head, options.view will not be supported in future version","checkout: https://ralltiir.github.io/ralltiir/get-started/view-options.html"),t=c.assign({},t,t.view,t.head),c.isString(t.title)&&(t.title={html:t.title}),c.isString(t.subtitle)&&(t.subtitle={html:t.subtitle}),c.isString(t.back)&&(t.back={html:t.back}),c.forEach(t.actions,function(i,e){c.isString(i)&&(t.actions[e]={html:i})}),void 0===t.baseUrl&&(t.baseUrl=""),t):{}}var n=t("ralltiir"),r=n.promise,s=t("wiki-m-common:node_modules/ralltiir-application/view/view"),a=t("wiki-m-common:node_modules/ralltiir-application/utils/performance"),c=t("wiki-m-common:node_modules/@searchfe/underscore/src/index"),l=n.logger,h=t("wiki-m-common:node_modules/ralltiir-application/config");return i.prototype.hasValidView=function(){return this.view&&this.view.valid},i.prototype.shouldUseCache=function(t,i){if(h.cacheDisabled)return!1;if(this.options.isolateCSS&&i)return!1;var e=c.get(t,"options.src");return"back"===e||"history"===e},i.prototype.beforeAttach=function(t){this.scope.performance.startNavigation(),c.assign(this.options,t.options);var i=this.shouldEnterAnimate(t);if(l.debug("service.beforeAttach",this.beforeAttach),this.shouldUseCache(t,i)&&this.hasValidView())l.info("using cached dom for",t.url),this.view.reuse();else if(e(t)){var o=document.querySelector("#sfr-app .rt-view");this.view=new s(this.scope,o)}else this.view=new s(this.scope),this.view.fetchUrl(t.url);return this.view.enter(i)},i.prototype.shouldEnterAnimate=function(t){if(e(t))return!1;var i=c.get(t,"options.src");return!i||"hijack"===i},i.prototype.shouldExitAnimate=function(t){if(this.options.isolateCSS){if(!this.name)return!1;if(this.name!==c.get(t,"service.name"))return!1}var i=c.get(t,"options.src");return"back"===i},i.prototype.attach=function(t){var i=this.view;return i.setActive(),r.resolve().then(function(){return i.populated?"":i.render()}).then(function(){return i.setAttached()}).catch(function(i){var e=i.code||999,o=i.message||"unkown",n=location.search+(location.search?"&":"?");if(console.error(i),"sync"!==c.get(t,"options.src")&&-1===n.indexOf("rt-err=")){n+="rt-err="+e,n+="&rt-msg="+encodeURIComponent(o);var r=location.protocol+"//"+location.host+location.pathname+n+location.hash;location.replace(r)}})},i.prototype.beforeDetach=function(t,i){return this.view.prepareExit(this.shouldExitAnimate(t,i))},i.prototype.detach=function(t,i){var e=this.view;return e.exit(this.shouldExitAnimate(t,i)).then(function(){e.setDetached()})},i.prototype.destroy=function(){return this.view.destroy()},i.setBackHtml=function(t){s.backHtml=t},i});